<!DOCTYPE html>
<html>
<head>
    <title>Check Equipment Data</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        button { padding: 10px 20px; margin: 10px; font-size: 16px; }
        #results { margin-top: 20px; white-space: pre-wrap; background: #f5f5f5; padding: 15px; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>Equipment Database Check</h1>
    <button onclick="checkEquipment()">Check All Equipment</button>
    <button onclick="checkByDepartment('Moving Image Design')">Check Moving Image Design</button>
    <button onclick="checkByDepartment('Graphic Design')">Check Graphic Design</button>
    <button onclick="checkByDepartment('Illustration')">Check Illustration</button>
    <div id="results"></div>

    <script>
        const API_BASE = 'http://localhost:3001/api';

        async function checkEquipment() {
            try {
                const token = localStorage.getItem('token');
                const response = await fetch(`${API_BASE}/equipment`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                const data = await response.json();

                document.getElementById('results').textContent =
                    `Total Equipment: ${data.equipment?.length || 0}\n` +
                    `Pagination Total: ${data.pagination?.total || 0}\n\n` +
                    `Departments:\n` +
                    getDepartmentBreakdown(data.equipment || []);
            } catch (error) {
                document.getElementById('results').textContent = `Error: ${error.message}`;
            }
        }

        async function checkByDepartment(dept) {
            try {
                const token = localStorage.getItem('token');
                const response = await fetch(`${API_BASE}/equipment?department=${encodeURIComponent(dept)}`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                const data = await response.json();

                document.getElementById('results').textContent =
                    `Department: ${dept}\n` +
                    `Equipment Count: ${data.equipment?.length || 0}\n\n` +
                    `Sample Items:\n` +
                    (data.equipment || []).slice(0, 5).map(e => `- ${e.product_name} (${e.department})`).join('\n');
            } catch (error) {
                document.getElementById('results').textContent = `Error: ${error.message}`;
            }
        }

        function getDepartmentBreakdown(equipment) {
            const depts = {};
            equipment.forEach(e => {
                depts[e.department] = (depts[e.department] || 0) + 1;
            });
            return Object.entries(depts)
                .map(([dept, count]) => `  ${dept}: ${count}`)
                .join('\n');
        }
    </script>
</body>
</html>
