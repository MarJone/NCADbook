var jw=Object.defineProperty;var Sw=(t,e,n)=>e in t?jw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var At=(t,e,n)=>Sw(t,typeof e!="symbol"?e+"":e,n);function kw(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var as=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Nw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Cw(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var vy={exports:{}},Ph={},yy={exports:{}},yt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hd=Symbol.for("react.element"),Aw=Symbol.for("react.portal"),Ew=Symbol.for("react.fragment"),Dw=Symbol.for("react.strict_mode"),Pw=Symbol.for("react.profiler"),Lw=Symbol.for("react.provider"),Tw=Symbol.for("react.context"),Iw=Symbol.for("react.forward_ref"),Rw=Symbol.for("react.suspense"),qw=Symbol.for("react.memo"),Ow=Symbol.for("react.lazy"),h1=Symbol.iterator;function Fw(t){return t===null||typeof t!="object"?null:(t=h1&&t[h1]||t["@@iterator"],typeof t=="function"?t:null)}var by={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_y=Object.assign,xy={};function Nl(t,e,n){this.props=t,this.context=e,this.refs=xy,this.updater=n||by}Nl.prototype.isReactComponent={};Nl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Nl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function wy(){}wy.prototype=Nl.prototype;function vg(t,e,n){this.props=t,this.context=e,this.refs=xy,this.updater=n||by}var yg=vg.prototype=new wy;yg.constructor=vg;_y(yg,Nl.prototype);yg.isPureReactComponent=!0;var f1=Array.isArray,jy=Object.prototype.hasOwnProperty,bg={current:null},Sy={key:!0,ref:!0,__self:!0,__source:!0};function ky(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)jy.call(e,r)&&!Sy.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:hd,type:t,key:i,ref:o,props:s,_owner:bg.current}}function Mw(t,e){return{$$typeof:hd,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function _g(t){return typeof t=="object"&&t!==null&&t.$$typeof===hd}function Bw(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var p1=/\/+/g;function Mf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Bw(""+t.key):e.toString(36)}function Pu(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case hd:case Aw:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Mf(o,0):r,f1(s)?(n="",t!=null&&(n=t.replace(p1,"$&/")+"/"),Pu(s,e,n,"",function(d){return d})):s!=null&&(_g(s)&&(s=Mw(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(p1,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",f1(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+Mf(i,l);o+=Pu(i,e,n,c,s)}else if(c=Fw(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+Mf(i,l++),o+=Pu(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function nu(t,e,n){if(t==null)return t;var r=[],s=0;return Pu(t,r,"","",function(i){return e.call(n,i,s++)}),r}function Uw(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var pr={current:null},Lu={transition:null},$w={ReactCurrentDispatcher:pr,ReactCurrentBatchConfig:Lu,ReactCurrentOwner:bg};function Ny(){throw Error("act(...) is not supported in production builds of React.")}yt.Children={map:nu,forEach:function(t,e,n){nu(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return nu(t,function(){e++}),e},toArray:function(t){return nu(t,function(e){return e})||[]},only:function(t){if(!_g(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};yt.Component=Nl;yt.Fragment=Ew;yt.Profiler=Pw;yt.PureComponent=vg;yt.StrictMode=Dw;yt.Suspense=Rw;yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$w;yt.act=Ny;yt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=_y({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=bg.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)jy.call(e,c)&&!Sy.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:hd,type:t.type,key:s,ref:i,props:r,_owner:o}};yt.createContext=function(t){return t={$$typeof:Tw,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Lw,_context:t},t.Consumer=t};yt.createElement=ky;yt.createFactory=function(t){var e=ky.bind(null,t);return e.type=t,e};yt.createRef=function(){return{current:null}};yt.forwardRef=function(t){return{$$typeof:Iw,render:t}};yt.isValidElement=_g;yt.lazy=function(t){return{$$typeof:Ow,_payload:{_status:-1,_result:t},_init:Uw}};yt.memo=function(t,e){return{$$typeof:qw,type:t,compare:e===void 0?null:e}};yt.startTransition=function(t){var e=Lu.transition;Lu.transition={};try{t()}finally{Lu.transition=e}};yt.unstable_act=Ny;yt.useCallback=function(t,e){return pr.current.useCallback(t,e)};yt.useContext=function(t){return pr.current.useContext(t)};yt.useDebugValue=function(){};yt.useDeferredValue=function(t){return pr.current.useDeferredValue(t)};yt.useEffect=function(t,e){return pr.current.useEffect(t,e)};yt.useId=function(){return pr.current.useId()};yt.useImperativeHandle=function(t,e,n){return pr.current.useImperativeHandle(t,e,n)};yt.useInsertionEffect=function(t,e){return pr.current.useInsertionEffect(t,e)};yt.useLayoutEffect=function(t,e){return pr.current.useLayoutEffect(t,e)};yt.useMemo=function(t,e){return pr.current.useMemo(t,e)};yt.useReducer=function(t,e,n){return pr.current.useReducer(t,e,n)};yt.useRef=function(t){return pr.current.useRef(t)};yt.useState=function(t){return pr.current.useState(t)};yt.useSyncExternalStore=function(t,e,n){return pr.current.useSyncExternalStore(t,e,n)};yt.useTransition=function(){return pr.current.useTransition()};yt.version="18.3.1";yy.exports=yt;var O=yy.exports;const Cy=Nw(O),zw=kw({__proto__:null,default:Cy},[O]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ww=O,Hw=Symbol.for("react.element"),Vw=Symbol.for("react.fragment"),Gw=Object.prototype.hasOwnProperty,Kw=Ww.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Zw={key:!0,ref:!0,__self:!0,__source:!0};function Ay(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Gw.call(e,r)&&!Zw.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:Hw,type:t,key:i,ref:o,props:s,_owner:Kw.current}}Ph.Fragment=Vw;Ph.jsx=Ay;Ph.jsxs=Ay;vy.exports=Ph;var a=vy.exports,Gp={},Ey={exports:{}},$r={},Dy={exports:{}},Py={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Z,ae){var ee=Z.length;Z.push(ae);e:for(;0<ee;){var de=ee-1>>>1,E=Z[de];if(0<s(E,ae))Z[de]=ae,Z[ee]=E,ee=de;else break e}}function n(Z){return Z.length===0?null:Z[0]}function r(Z){if(Z.length===0)return null;var ae=Z[0],ee=Z.pop();if(ee!==ae){Z[0]=ee;e:for(var de=0,E=Z.length,H=E>>>1;de<H;){var J=2*(de+1)-1,V=Z[J],ne=J+1,le=Z[ne];if(0>s(V,ee))ne<E&&0>s(le,V)?(Z[de]=le,Z[ne]=ee,de=ne):(Z[de]=V,Z[J]=ee,de=J);else if(ne<E&&0>s(le,ee))Z[de]=le,Z[ne]=ee,de=ne;else break e}}return ae}function s(Z,ae){var ee=Z.sortIndex-ae.sortIndex;return ee!==0?ee:Z.id-ae.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,p=null,g=3,m=!1,j=!1,k=!1,w=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(Z){for(var ae=n(d);ae!==null;){if(ae.callback===null)r(d);else if(ae.startTime<=Z)r(d),ae.sortIndex=ae.expirationTime,e(c,ae);else break;ae=n(d)}}function N(Z){if(k=!1,S(Z),!j)if(n(c)!==null)j=!0,te(T);else{var ae=n(d);ae!==null&&oe(N,ae.startTime-Z)}}function T(Z,ae){j=!1,k&&(k=!1,y(b),b=-1),m=!0;var ee=g;try{for(S(ae),p=n(c);p!==null&&(!(p.expirationTime>ae)||Z&&!D());){var de=p.callback;if(typeof de=="function"){p.callback=null,g=p.priorityLevel;var E=de(p.expirationTime<=ae);ae=t.unstable_now(),typeof E=="function"?p.callback=E:p===n(c)&&r(c),S(ae)}else r(c);p=n(c)}if(p!==null)var H=!0;else{var J=n(d);J!==null&&oe(N,J.startTime-ae),H=!1}return H}finally{p=null,g=ee,m=!1}}var U=!1,P=null,b=-1,A=5,$=-1;function D(){return!(t.unstable_now()-$<A)}function F(){if(P!==null){var Z=t.unstable_now();$=Z;var ae=!0;try{ae=P(!0,Z)}finally{ae?L():(U=!1,P=null)}}else U=!1}var L;if(typeof _=="function")L=function(){_(F)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,X=I.port2;I.port1.onmessage=F,L=function(){X.postMessage(null)}}else L=function(){w(F,0)};function te(Z){P=Z,U||(U=!0,L())}function oe(Z,ae){b=w(function(){Z(t.unstable_now())},ae)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Z){Z.callback=null},t.unstable_continueExecution=function(){j||m||(j=!0,te(T))},t.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<Z?Math.floor(1e3/Z):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(Z){switch(g){case 1:case 2:case 3:var ae=3;break;default:ae=g}var ee=g;g=ae;try{return Z()}finally{g=ee}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Z,ae){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ee=g;g=Z;try{return ae()}finally{g=ee}},t.unstable_scheduleCallback=function(Z,ae,ee){var de=t.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?de+ee:de):ee=de,Z){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=ee+E,Z={id:u++,callback:ae,priorityLevel:Z,startTime:ee,expirationTime:E,sortIndex:-1},ee>de?(Z.sortIndex=ee,e(d,Z),n(c)===null&&Z===n(d)&&(k?(y(b),b=-1):k=!0,oe(N,ee-de))):(Z.sortIndex=E,e(c,Z),j||m||(j=!0,te(T))),Z},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(Z){var ae=g;return function(){var ee=g;g=ae;try{return Z.apply(this,arguments)}finally{g=ee}}}})(Py);Dy.exports=Py;var Yw=Dy.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jw=O,Ur=Yw;function De(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ly=new Set,$c={};function fo(t,e){vl(t,e),vl(t+"Capture",e)}function vl(t,e){for($c[t]=e,t=0;t<e.length;t++)Ly.add(e[t])}var ya=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Kp=Object.prototype.hasOwnProperty,Xw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m1={},g1={};function Qw(t){return Kp.call(g1,t)?!0:Kp.call(m1,t)?!1:Xw.test(t)?g1[t]=!0:(m1[t]=!0,!1)}function ej(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function tj(t,e,n,r){if(e===null||typeof e>"u"||ej(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function mr(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Zn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Zn[t]=new mr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Zn[e]=new mr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Zn[t]=new mr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Zn[t]=new mr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Zn[t]=new mr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Zn[t]=new mr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Zn[t]=new mr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Zn[t]=new mr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Zn[t]=new mr(t,5,!1,t.toLowerCase(),null,!1,!1)});var xg=/[\-:]([a-z])/g;function wg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(xg,wg);Zn[e]=new mr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(xg,wg);Zn[e]=new mr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(xg,wg);Zn[e]=new mr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Zn[t]=new mr(t,1,!1,t.toLowerCase(),null,!1,!1)});Zn.xlinkHref=new mr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Zn[t]=new mr(t,1,!1,t.toLowerCase(),null,!0,!0)});function jg(t,e,n,r){var s=Zn.hasOwnProperty(e)?Zn[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(tj(e,n,s,r)&&(n=null),r||s===null?Qw(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ja=Jw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ru=Symbol.for("react.element"),Ho=Symbol.for("react.portal"),Vo=Symbol.for("react.fragment"),Sg=Symbol.for("react.strict_mode"),Zp=Symbol.for("react.profiler"),Ty=Symbol.for("react.provider"),Iy=Symbol.for("react.context"),kg=Symbol.for("react.forward_ref"),Yp=Symbol.for("react.suspense"),Jp=Symbol.for("react.suspense_list"),Ng=Symbol.for("react.memo"),Ga=Symbol.for("react.lazy"),Ry=Symbol.for("react.offscreen"),v1=Symbol.iterator;function cc(t){return t===null||typeof t!="object"?null:(t=v1&&t[v1]||t["@@iterator"],typeof t=="function"?t:null)}var tn=Object.assign,Bf;function wc(t){if(Bf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Bf=e&&e[1]||""}return`
`+Bf+t}var Uf=!1;function $f(t,e){if(!t||Uf)return"";Uf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{Uf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?wc(t):""}function nj(t){switch(t.tag){case 5:return wc(t.type);case 16:return wc("Lazy");case 13:return wc("Suspense");case 19:return wc("SuspenseList");case 0:case 2:case 15:return t=$f(t.type,!1),t;case 11:return t=$f(t.type.render,!1),t;case 1:return t=$f(t.type,!0),t;default:return""}}function Xp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Vo:return"Fragment";case Ho:return"Portal";case Zp:return"Profiler";case Sg:return"StrictMode";case Yp:return"Suspense";case Jp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Iy:return(t.displayName||"Context")+".Consumer";case Ty:return(t._context.displayName||"Context")+".Provider";case kg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ng:return e=t.displayName||null,e!==null?e:Xp(t.type)||"Memo";case Ga:e=t._payload,t=t._init;try{return Xp(t(e))}catch{}}return null}function rj(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Xp(e);case 8:return e===Sg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function hi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function qy(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function sj(t){var e=qy(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function su(t){t._valueTracker||(t._valueTracker=sj(t))}function Oy(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=qy(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Zu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Qp(t,e){var n=e.checked;return tn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function y1(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=hi(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Fy(t,e){e=e.checked,e!=null&&jg(t,"checked",e,!1)}function em(t,e){Fy(t,e);var n=hi(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?tm(t,e.type,n):e.hasOwnProperty("defaultValue")&&tm(t,e.type,hi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function b1(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function tm(t,e,n){(e!=="number"||Zu(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var jc=Array.isArray;function al(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+hi(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function nm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(De(91));return tn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function _1(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(De(92));if(jc(n)){if(1<n.length)throw Error(De(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:hi(n)}}function My(t,e){var n=hi(e.value),r=hi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function x1(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function By(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?By(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var au,Uy=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(au=au||document.createElement("div"),au.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=au.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function zc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Cc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},aj=["Webkit","ms","Moz","O"];Object.keys(Cc).forEach(function(t){aj.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Cc[e]=Cc[t]})});function $y(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Cc.hasOwnProperty(t)&&Cc[t]?(""+e).trim():e+"px"}function zy(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=$y(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var ij=tn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function sm(t,e){if(e){if(ij[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(De(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(De(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(De(61))}if(e.style!=null&&typeof e.style!="object")throw Error(De(62))}}function am(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var im=null;function Cg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var om=null,il=null,ol=null;function w1(t){if(t=md(t)){if(typeof om!="function")throw Error(De(280));var e=t.stateNode;e&&(e=qh(e),om(t.stateNode,t.type,e))}}function Wy(t){il?ol?ol.push(t):ol=[t]:il=t}function Hy(){if(il){var t=il,e=ol;if(ol=il=null,w1(t),e)for(t=0;t<e.length;t++)w1(e[t])}}function Vy(t,e){return t(e)}function Gy(){}var zf=!1;function Ky(t,e,n){if(zf)return t(e,n);zf=!0;try{return Vy(t,e,n)}finally{zf=!1,(il!==null||ol!==null)&&(Gy(),Hy())}}function Wc(t,e){var n=t.stateNode;if(n===null)return null;var r=qh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(De(231,e,typeof n));return n}var lm=!1;if(ya)try{var dc={};Object.defineProperty(dc,"passive",{get:function(){lm=!0}}),window.addEventListener("test",dc,dc),window.removeEventListener("test",dc,dc)}catch{lm=!1}function oj(t,e,n,r,s,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(u){this.onError(u)}}var Ac=!1,Yu=null,Ju=!1,cm=null,lj={onError:function(t){Ac=!0,Yu=t}};function cj(t,e,n,r,s,i,o,l,c){Ac=!1,Yu=null,oj.apply(lj,arguments)}function dj(t,e,n,r,s,i,o,l,c){if(cj.apply(this,arguments),Ac){if(Ac){var d=Yu;Ac=!1,Yu=null}else throw Error(De(198));Ju||(Ju=!0,cm=d)}}function po(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Zy(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function j1(t){if(po(t)!==t)throw Error(De(188))}function uj(t){var e=t.alternate;if(!e){if(e=po(t),e===null)throw Error(De(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return j1(s),t;if(i===r)return j1(s),e;i=i.sibling}throw Error(De(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(De(189))}}if(n.alternate!==r)throw Error(De(190))}if(n.tag!==3)throw Error(De(188));return n.stateNode.current===n?t:e}function Yy(t){return t=uj(t),t!==null?Jy(t):null}function Jy(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Jy(t);if(e!==null)return e;t=t.sibling}return null}var Xy=Ur.unstable_scheduleCallback,S1=Ur.unstable_cancelCallback,hj=Ur.unstable_shouldYield,fj=Ur.unstable_requestPaint,yn=Ur.unstable_now,pj=Ur.unstable_getCurrentPriorityLevel,Ag=Ur.unstable_ImmediatePriority,Qy=Ur.unstable_UserBlockingPriority,Xu=Ur.unstable_NormalPriority,mj=Ur.unstable_LowPriority,eb=Ur.unstable_IdlePriority,Lh=null,Ws=null;function gj(t){if(Ws&&typeof Ws.onCommitFiberRoot=="function")try{Ws.onCommitFiberRoot(Lh,t,void 0,(t.current.flags&128)===128)}catch{}}var ws=Math.clz32?Math.clz32:bj,vj=Math.log,yj=Math.LN2;function bj(t){return t>>>=0,t===0?32:31-(vj(t)/yj|0)|0}var iu=64,ou=4194304;function Sc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Qu(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=Sc(l):(i&=o,i!==0&&(r=Sc(i)))}else o=n&~s,o!==0?r=Sc(o):i!==0&&(r=Sc(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-ws(e),s=1<<n,r|=t[n],e&=~s;return r}function _j(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xj(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-ws(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=_j(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function dm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function tb(){var t=iu;return iu<<=1,!(iu&4194240)&&(iu=64),t}function Wf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function fd(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ws(e),t[e]=n}function wj(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-ws(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Eg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-ws(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Tt=0;function nb(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var rb,Dg,sb,ab,ib,um=!1,lu=[],ni=null,ri=null,si=null,Hc=new Map,Vc=new Map,Za=[],jj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function k1(t,e){switch(t){case"focusin":case"focusout":ni=null;break;case"dragenter":case"dragleave":ri=null;break;case"mouseover":case"mouseout":si=null;break;case"pointerover":case"pointerout":Hc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vc.delete(e.pointerId)}}function uc(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=md(e),e!==null&&Dg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Sj(t,e,n,r,s){switch(e){case"focusin":return ni=uc(ni,t,e,n,r,s),!0;case"dragenter":return ri=uc(ri,t,e,n,r,s),!0;case"mouseover":return si=uc(si,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Hc.set(i,uc(Hc.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Vc.set(i,uc(Vc.get(i)||null,t,e,n,r,s)),!0}return!1}function ob(t){var e=Qi(t.target);if(e!==null){var n=po(e);if(n!==null){if(e=n.tag,e===13){if(e=Zy(n),e!==null){t.blockedOn=e,ib(t.priority,function(){sb(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Tu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=hm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);im=r,n.target.dispatchEvent(r),im=null}else return e=md(n),e!==null&&Dg(e),t.blockedOn=n,!1;e.shift()}return!0}function N1(t,e,n){Tu(t)&&n.delete(e)}function kj(){um=!1,ni!==null&&Tu(ni)&&(ni=null),ri!==null&&Tu(ri)&&(ri=null),si!==null&&Tu(si)&&(si=null),Hc.forEach(N1),Vc.forEach(N1)}function hc(t,e){t.blockedOn===e&&(t.blockedOn=null,um||(um=!0,Ur.unstable_scheduleCallback(Ur.unstable_NormalPriority,kj)))}function Gc(t){function e(s){return hc(s,t)}if(0<lu.length){hc(lu[0],t);for(var n=1;n<lu.length;n++){var r=lu[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ni!==null&&hc(ni,t),ri!==null&&hc(ri,t),si!==null&&hc(si,t),Hc.forEach(e),Vc.forEach(e),n=0;n<Za.length;n++)r=Za[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Za.length&&(n=Za[0],n.blockedOn===null);)ob(n),n.blockedOn===null&&Za.shift()}var ll=ja.ReactCurrentBatchConfig,eh=!0;function Nj(t,e,n,r){var s=Tt,i=ll.transition;ll.transition=null;try{Tt=1,Pg(t,e,n,r)}finally{Tt=s,ll.transition=i}}function Cj(t,e,n,r){var s=Tt,i=ll.transition;ll.transition=null;try{Tt=4,Pg(t,e,n,r)}finally{Tt=s,ll.transition=i}}function Pg(t,e,n,r){if(eh){var s=hm(t,e,n,r);if(s===null)ep(t,e,r,th,n),k1(t,r);else if(Sj(s,t,e,n,r))r.stopPropagation();else if(k1(t,r),e&4&&-1<jj.indexOf(t)){for(;s!==null;){var i=md(s);if(i!==null&&rb(i),i=hm(t,e,n,r),i===null&&ep(t,e,r,th,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else ep(t,e,r,null,n)}}var th=null;function hm(t,e,n,r){if(th=null,t=Cg(r),t=Qi(t),t!==null)if(e=po(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Zy(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return th=t,null}function lb(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(pj()){case Ag:return 1;case Qy:return 4;case Xu:case mj:return 16;case eb:return 536870912;default:return 16}default:return 16}}var Xa=null,Lg=null,Iu=null;function cb(){if(Iu)return Iu;var t,e=Lg,n=e.length,r,s="value"in Xa?Xa.value:Xa.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Iu=s.slice(t,1<r?1-r:void 0)}function Ru(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function cu(){return!0}function C1(){return!1}function zr(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?cu:C1,this.isPropagationStopped=C1,this}return tn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=cu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=cu)},persist:function(){},isPersistent:cu}),e}var Cl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Tg=zr(Cl),pd=tn({},Cl,{view:0,detail:0}),Aj=zr(pd),Hf,Vf,fc,Th=tn({},pd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ig,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==fc&&(fc&&t.type==="mousemove"?(Hf=t.screenX-fc.screenX,Vf=t.screenY-fc.screenY):Vf=Hf=0,fc=t),Hf)},movementY:function(t){return"movementY"in t?t.movementY:Vf}}),A1=zr(Th),Ej=tn({},Th,{dataTransfer:0}),Dj=zr(Ej),Pj=tn({},pd,{relatedTarget:0}),Gf=zr(Pj),Lj=tn({},Cl,{animationName:0,elapsedTime:0,pseudoElement:0}),Tj=zr(Lj),Ij=tn({},Cl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Rj=zr(Ij),qj=tn({},Cl,{data:0}),E1=zr(qj),Oj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Mj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Bj(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Mj[t])?!!e[t]:!1}function Ig(){return Bj}var Uj=tn({},pd,{key:function(t){if(t.key){var e=Oj[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ru(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Fj[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ig,charCode:function(t){return t.type==="keypress"?Ru(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ru(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),$j=zr(Uj),zj=tn({},Th,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),D1=zr(zj),Wj=tn({},pd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ig}),Hj=zr(Wj),Vj=tn({},Cl,{propertyName:0,elapsedTime:0,pseudoElement:0}),Gj=zr(Vj),Kj=tn({},Th,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Zj=zr(Kj),Yj=[9,13,27,32],Rg=ya&&"CompositionEvent"in window,Ec=null;ya&&"documentMode"in document&&(Ec=document.documentMode);var Jj=ya&&"TextEvent"in window&&!Ec,db=ya&&(!Rg||Ec&&8<Ec&&11>=Ec),P1=" ",L1=!1;function ub(t,e){switch(t){case"keyup":return Yj.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hb(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Go=!1;function Xj(t,e){switch(t){case"compositionend":return hb(e);case"keypress":return e.which!==32?null:(L1=!0,P1);case"textInput":return t=e.data,t===P1&&L1?null:t;default:return null}}function Qj(t,e){if(Go)return t==="compositionend"||!Rg&&ub(t,e)?(t=cb(),Iu=Lg=Xa=null,Go=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return db&&e.locale!=="ko"?null:e.data;default:return null}}var eS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function T1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!eS[t.type]:e==="textarea"}function fb(t,e,n,r){Wy(r),e=nh(e,"onChange"),0<e.length&&(n=new Tg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Dc=null,Kc=null;function tS(t){Sb(t,0)}function Ih(t){var e=Yo(t);if(Oy(e))return t}function nS(t,e){if(t==="change")return e}var pb=!1;if(ya){var Kf;if(ya){var Zf="oninput"in document;if(!Zf){var I1=document.createElement("div");I1.setAttribute("oninput","return;"),Zf=typeof I1.oninput=="function"}Kf=Zf}else Kf=!1;pb=Kf&&(!document.documentMode||9<document.documentMode)}function R1(){Dc&&(Dc.detachEvent("onpropertychange",mb),Kc=Dc=null)}function mb(t){if(t.propertyName==="value"&&Ih(Kc)){var e=[];fb(e,Kc,t,Cg(t)),Ky(tS,e)}}function rS(t,e,n){t==="focusin"?(R1(),Dc=e,Kc=n,Dc.attachEvent("onpropertychange",mb)):t==="focusout"&&R1()}function sS(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ih(Kc)}function aS(t,e){if(t==="click")return Ih(e)}function iS(t,e){if(t==="input"||t==="change")return Ih(e)}function oS(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ss=typeof Object.is=="function"?Object.is:oS;function Zc(t,e){if(Ss(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Kp.call(e,s)||!Ss(t[s],e[s]))return!1}return!0}function q1(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function O1(t,e){var n=q1(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=q1(n)}}function gb(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?gb(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function vb(){for(var t=window,e=Zu();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Zu(t.document)}return e}function qg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function lS(t){var e=vb(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&gb(n.ownerDocument.documentElement,n)){if(r!==null&&qg(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=O1(n,i);var o=O1(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var cS=ya&&"documentMode"in document&&11>=document.documentMode,Ko=null,fm=null,Pc=null,pm=!1;function F1(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;pm||Ko==null||Ko!==Zu(r)||(r=Ko,"selectionStart"in r&&qg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Pc&&Zc(Pc,r)||(Pc=r,r=nh(fm,"onSelect"),0<r.length&&(e=new Tg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ko)))}function du(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Zo={animationend:du("Animation","AnimationEnd"),animationiteration:du("Animation","AnimationIteration"),animationstart:du("Animation","AnimationStart"),transitionend:du("Transition","TransitionEnd")},Yf={},yb={};ya&&(yb=document.createElement("div").style,"AnimationEvent"in window||(delete Zo.animationend.animation,delete Zo.animationiteration.animation,delete Zo.animationstart.animation),"TransitionEvent"in window||delete Zo.transitionend.transition);function Rh(t){if(Yf[t])return Yf[t];if(!Zo[t])return t;var e=Zo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in yb)return Yf[t]=e[n];return t}var bb=Rh("animationend"),_b=Rh("animationiteration"),xb=Rh("animationstart"),wb=Rh("transitionend"),jb=new Map,M1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function mi(t,e){jb.set(t,e),fo(e,[t])}for(var Jf=0;Jf<M1.length;Jf++){var Xf=M1[Jf],dS=Xf.toLowerCase(),uS=Xf[0].toUpperCase()+Xf.slice(1);mi(dS,"on"+uS)}mi(bb,"onAnimationEnd");mi(_b,"onAnimationIteration");mi(xb,"onAnimationStart");mi("dblclick","onDoubleClick");mi("focusin","onFocus");mi("focusout","onBlur");mi(wb,"onTransitionEnd");vl("onMouseEnter",["mouseout","mouseover"]);vl("onMouseLeave",["mouseout","mouseover"]);vl("onPointerEnter",["pointerout","pointerover"]);vl("onPointerLeave",["pointerout","pointerover"]);fo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fo("onBeforeInput",["compositionend","keypress","textInput","paste"]);fo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var kc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hS=new Set("cancel close invalid load scroll toggle".split(" ").concat(kc));function B1(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,dj(r,e,void 0,t),t.currentTarget=null}function Sb(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;B1(s,l,d),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;B1(s,l,d),i=c}}}if(Ju)throw t=cm,Ju=!1,cm=null,t}function Vt(t,e){var n=e[bm];n===void 0&&(n=e[bm]=new Set);var r=t+"__bubble";n.has(r)||(kb(e,t,2,!1),n.add(r))}function Qf(t,e,n){var r=0;e&&(r|=4),kb(n,t,r,e)}var uu="_reactListening"+Math.random().toString(36).slice(2);function Yc(t){if(!t[uu]){t[uu]=!0,Ly.forEach(function(n){n!=="selectionchange"&&(hS.has(n)||Qf(n,!1,t),Qf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[uu]||(e[uu]=!0,Qf("selectionchange",!1,e))}}function kb(t,e,n,r){switch(lb(e)){case 1:var s=Nj;break;case 4:s=Cj;break;default:s=Pg}n=s.bind(null,e,n,t),s=void 0,!lm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function ep(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Qi(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}Ky(function(){var d=i,u=Cg(n),p=[];e:{var g=jb.get(t);if(g!==void 0){var m=Tg,j=t;switch(t){case"keypress":if(Ru(n)===0)break e;case"keydown":case"keyup":m=$j;break;case"focusin":j="focus",m=Gf;break;case"focusout":j="blur",m=Gf;break;case"beforeblur":case"afterblur":m=Gf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=A1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=Dj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=Hj;break;case bb:case _b:case xb:m=Tj;break;case wb:m=Gj;break;case"scroll":m=Aj;break;case"wheel":m=Zj;break;case"copy":case"cut":case"paste":m=Rj;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=D1}var k=(e&4)!==0,w=!k&&t==="scroll",y=k?g!==null?g+"Capture":null:g;k=[];for(var _=d,S;_!==null;){S=_;var N=S.stateNode;if(S.tag===5&&N!==null&&(S=N,y!==null&&(N=Wc(_,y),N!=null&&k.push(Jc(_,N,S)))),w)break;_=_.return}0<k.length&&(g=new m(g,j,null,n,u),p.push({event:g,listeners:k}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",g&&n!==im&&(j=n.relatedTarget||n.fromElement)&&(Qi(j)||j[ba]))break e;if((m||g)&&(g=u.window===u?u:(g=u.ownerDocument)?g.defaultView||g.parentWindow:window,m?(j=n.relatedTarget||n.toElement,m=d,j=j?Qi(j):null,j!==null&&(w=po(j),j!==w||j.tag!==5&&j.tag!==6)&&(j=null)):(m=null,j=d),m!==j)){if(k=A1,N="onMouseLeave",y="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(k=D1,N="onPointerLeave",y="onPointerEnter",_="pointer"),w=m==null?g:Yo(m),S=j==null?g:Yo(j),g=new k(N,_+"leave",m,n,u),g.target=w,g.relatedTarget=S,N=null,Qi(u)===d&&(k=new k(y,_+"enter",j,n,u),k.target=S,k.relatedTarget=w,N=k),w=N,m&&j)t:{for(k=m,y=j,_=0,S=k;S;S=Lo(S))_++;for(S=0,N=y;N;N=Lo(N))S++;for(;0<_-S;)k=Lo(k),_--;for(;0<S-_;)y=Lo(y),S--;for(;_--;){if(k===y||y!==null&&k===y.alternate)break t;k=Lo(k),y=Lo(y)}k=null}else k=null;m!==null&&U1(p,g,m,k,!1),j!==null&&w!==null&&U1(p,w,j,k,!0)}}e:{if(g=d?Yo(d):window,m=g.nodeName&&g.nodeName.toLowerCase(),m==="select"||m==="input"&&g.type==="file")var T=nS;else if(T1(g))if(pb)T=iS;else{T=sS;var U=rS}else(m=g.nodeName)&&m.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(T=aS);if(T&&(T=T(t,d))){fb(p,T,n,u);break e}U&&U(t,g,d),t==="focusout"&&(U=g._wrapperState)&&U.controlled&&g.type==="number"&&tm(g,"number",g.value)}switch(U=d?Yo(d):window,t){case"focusin":(T1(U)||U.contentEditable==="true")&&(Ko=U,fm=d,Pc=null);break;case"focusout":Pc=fm=Ko=null;break;case"mousedown":pm=!0;break;case"contextmenu":case"mouseup":case"dragend":pm=!1,F1(p,n,u);break;case"selectionchange":if(cS)break;case"keydown":case"keyup":F1(p,n,u)}var P;if(Rg)e:{switch(t){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Go?ub(t,n)&&(b="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(b="onCompositionStart");b&&(db&&n.locale!=="ko"&&(Go||b!=="onCompositionStart"?b==="onCompositionEnd"&&Go&&(P=cb()):(Xa=u,Lg="value"in Xa?Xa.value:Xa.textContent,Go=!0)),U=nh(d,b),0<U.length&&(b=new E1(b,t,null,n,u),p.push({event:b,listeners:U}),P?b.data=P:(P=hb(n),P!==null&&(b.data=P)))),(P=Jj?Xj(t,n):Qj(t,n))&&(d=nh(d,"onBeforeInput"),0<d.length&&(u=new E1("onBeforeInput","beforeinput",null,n,u),p.push({event:u,listeners:d}),u.data=P))}Sb(p,e)})}function Jc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function nh(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Wc(t,n),i!=null&&r.unshift(Jc(t,i,s)),i=Wc(t,e),i!=null&&r.push(Jc(t,i,s))),t=t.return}return r}function Lo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function U1(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,s?(c=Wc(n,i),c!=null&&o.unshift(Jc(n,c,l))):s||(c=Wc(n,i),c!=null&&o.push(Jc(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var fS=/\r\n?/g,pS=/\u0000|\uFFFD/g;function $1(t){return(typeof t=="string"?t:""+t).replace(fS,`
`).replace(pS,"")}function hu(t,e,n){if(e=$1(e),$1(t)!==e&&n)throw Error(De(425))}function rh(){}var mm=null,gm=null;function vm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ym=typeof setTimeout=="function"?setTimeout:void 0,mS=typeof clearTimeout=="function"?clearTimeout:void 0,z1=typeof Promise=="function"?Promise:void 0,gS=typeof queueMicrotask=="function"?queueMicrotask:typeof z1<"u"?function(t){return z1.resolve(null).then(t).catch(vS)}:ym;function vS(t){setTimeout(function(){throw t})}function tp(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Gc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Gc(e)}function ai(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function W1(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Al=Math.random().toString(36).slice(2),Us="__reactFiber$"+Al,Xc="__reactProps$"+Al,ba="__reactContainer$"+Al,bm="__reactEvents$"+Al,yS="__reactListeners$"+Al,bS="__reactHandles$"+Al;function Qi(t){var e=t[Us];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ba]||n[Us]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=W1(t);t!==null;){if(n=t[Us])return n;t=W1(t)}return e}t=n,n=t.parentNode}return null}function md(t){return t=t[Us]||t[ba],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Yo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(De(33))}function qh(t){return t[Xc]||null}var _m=[],Jo=-1;function gi(t){return{current:t}}function Kt(t){0>Jo||(t.current=_m[Jo],_m[Jo]=null,Jo--)}function Wt(t,e){Jo++,_m[Jo]=t.current,t.current=e}var fi={},lr=gi(fi),jr=gi(!1),ao=fi;function yl(t,e){var n=t.type.contextTypes;if(!n)return fi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Sr(t){return t=t.childContextTypes,t!=null}function sh(){Kt(jr),Kt(lr)}function H1(t,e,n){if(lr.current!==fi)throw Error(De(168));Wt(lr,e),Wt(jr,n)}function Nb(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(De(108,rj(t)||"Unknown",s));return tn({},n,r)}function ah(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||fi,ao=lr.current,Wt(lr,t),Wt(jr,jr.current),!0}function V1(t,e,n){var r=t.stateNode;if(!r)throw Error(De(169));n?(t=Nb(t,e,ao),r.__reactInternalMemoizedMergedChildContext=t,Kt(jr),Kt(lr),Wt(lr,t)):Kt(jr),Wt(jr,n)}var ha=null,Oh=!1,np=!1;function Cb(t){ha===null?ha=[t]:ha.push(t)}function _S(t){Oh=!0,Cb(t)}function vi(){if(!np&&ha!==null){np=!0;var t=0,e=Tt;try{var n=ha;for(Tt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ha=null,Oh=!1}catch(s){throw ha!==null&&(ha=ha.slice(t+1)),Xy(Ag,vi),s}finally{Tt=e,np=!1}}return null}var Xo=[],Qo=0,ih=null,oh=0,es=[],ts=0,io=null,pa=1,ma="";function Gi(t,e){Xo[Qo++]=oh,Xo[Qo++]=ih,ih=t,oh=e}function Ab(t,e,n){es[ts++]=pa,es[ts++]=ma,es[ts++]=io,io=t;var r=pa;t=ma;var s=32-ws(r)-1;r&=~(1<<s),n+=1;var i=32-ws(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,pa=1<<32-ws(e)+s|n<<s|r,ma=i+t}else pa=1<<i|n<<s|r,ma=t}function Og(t){t.return!==null&&(Gi(t,1),Ab(t,1,0))}function Fg(t){for(;t===ih;)ih=Xo[--Qo],Xo[Qo]=null,oh=Xo[--Qo],Xo[Qo]=null;for(;t===io;)io=es[--ts],es[ts]=null,ma=es[--ts],es[ts]=null,pa=es[--ts],es[ts]=null}var Br=null,Fr=null,Yt=!1,xs=null;function Eb(t,e){var n=ns(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function G1(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Br=t,Fr=ai(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Br=t,Fr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=io!==null?{id:pa,overflow:ma}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ns(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Br=t,Fr=null,!0):!1;default:return!1}}function xm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function wm(t){if(Yt){var e=Fr;if(e){var n=e;if(!G1(t,e)){if(xm(t))throw Error(De(418));e=ai(n.nextSibling);var r=Br;e&&G1(t,e)?Eb(r,n):(t.flags=t.flags&-4097|2,Yt=!1,Br=t)}}else{if(xm(t))throw Error(De(418));t.flags=t.flags&-4097|2,Yt=!1,Br=t}}}function K1(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Br=t}function fu(t){if(t!==Br)return!1;if(!Yt)return K1(t),Yt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!vm(t.type,t.memoizedProps)),e&&(e=Fr)){if(xm(t))throw Db(),Error(De(418));for(;e;)Eb(t,e),e=ai(e.nextSibling)}if(K1(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(De(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Fr=ai(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Fr=null}}else Fr=Br?ai(t.stateNode.nextSibling):null;return!0}function Db(){for(var t=Fr;t;)t=ai(t.nextSibling)}function bl(){Fr=Br=null,Yt=!1}function Mg(t){xs===null?xs=[t]:xs.push(t)}var xS=ja.ReactCurrentBatchConfig;function pc(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(De(309));var r=n.stateNode}if(!r)throw Error(De(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(De(284));if(!n._owner)throw Error(De(290,t))}return t}function pu(t,e){throw t=Object.prototype.toString.call(e),Error(De(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Z1(t){var e=t._init;return e(t._payload)}function Pb(t){function e(y,_){if(t){var S=y.deletions;S===null?(y.deletions=[_],y.flags|=16):S.push(_)}}function n(y,_){if(!t)return null;for(;_!==null;)e(y,_),_=_.sibling;return null}function r(y,_){for(y=new Map;_!==null;)_.key!==null?y.set(_.key,_):y.set(_.index,_),_=_.sibling;return y}function s(y,_){return y=ci(y,_),y.index=0,y.sibling=null,y}function i(y,_,S){return y.index=S,t?(S=y.alternate,S!==null?(S=S.index,S<_?(y.flags|=2,_):S):(y.flags|=2,_)):(y.flags|=1048576,_)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function l(y,_,S,N){return _===null||_.tag!==6?(_=cp(S,y.mode,N),_.return=y,_):(_=s(_,S),_.return=y,_)}function c(y,_,S,N){var T=S.type;return T===Vo?u(y,_,S.props.children,N,S.key):_!==null&&(_.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Ga&&Z1(T)===_.type)?(N=s(_,S.props),N.ref=pc(y,_,S),N.return=y,N):(N=$u(S.type,S.key,S.props,null,y.mode,N),N.ref=pc(y,_,S),N.return=y,N)}function d(y,_,S,N){return _===null||_.tag!==4||_.stateNode.containerInfo!==S.containerInfo||_.stateNode.implementation!==S.implementation?(_=dp(S,y.mode,N),_.return=y,_):(_=s(_,S.children||[]),_.return=y,_)}function u(y,_,S,N,T){return _===null||_.tag!==7?(_=ro(S,y.mode,N,T),_.return=y,_):(_=s(_,S),_.return=y,_)}function p(y,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return _=cp(""+_,y.mode,S),_.return=y,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case ru:return S=$u(_.type,_.key,_.props,null,y.mode,S),S.ref=pc(y,null,_),S.return=y,S;case Ho:return _=dp(_,y.mode,S),_.return=y,_;case Ga:var N=_._init;return p(y,N(_._payload),S)}if(jc(_)||cc(_))return _=ro(_,y.mode,S,null),_.return=y,_;pu(y,_)}return null}function g(y,_,S,N){var T=_!==null?_.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return T!==null?null:l(y,_,""+S,N);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case ru:return S.key===T?c(y,_,S,N):null;case Ho:return S.key===T?d(y,_,S,N):null;case Ga:return T=S._init,g(y,_,T(S._payload),N)}if(jc(S)||cc(S))return T!==null?null:u(y,_,S,N,null);pu(y,S)}return null}function m(y,_,S,N,T){if(typeof N=="string"&&N!==""||typeof N=="number")return y=y.get(S)||null,l(_,y,""+N,T);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case ru:return y=y.get(N.key===null?S:N.key)||null,c(_,y,N,T);case Ho:return y=y.get(N.key===null?S:N.key)||null,d(_,y,N,T);case Ga:var U=N._init;return m(y,_,S,U(N._payload),T)}if(jc(N)||cc(N))return y=y.get(S)||null,u(_,y,N,T,null);pu(_,N)}return null}function j(y,_,S,N){for(var T=null,U=null,P=_,b=_=0,A=null;P!==null&&b<S.length;b++){P.index>b?(A=P,P=null):A=P.sibling;var $=g(y,P,S[b],N);if($===null){P===null&&(P=A);break}t&&P&&$.alternate===null&&e(y,P),_=i($,_,b),U===null?T=$:U.sibling=$,U=$,P=A}if(b===S.length)return n(y,P),Yt&&Gi(y,b),T;if(P===null){for(;b<S.length;b++)P=p(y,S[b],N),P!==null&&(_=i(P,_,b),U===null?T=P:U.sibling=P,U=P);return Yt&&Gi(y,b),T}for(P=r(y,P);b<S.length;b++)A=m(P,y,b,S[b],N),A!==null&&(t&&A.alternate!==null&&P.delete(A.key===null?b:A.key),_=i(A,_,b),U===null?T=A:U.sibling=A,U=A);return t&&P.forEach(function(D){return e(y,D)}),Yt&&Gi(y,b),T}function k(y,_,S,N){var T=cc(S);if(typeof T!="function")throw Error(De(150));if(S=T.call(S),S==null)throw Error(De(151));for(var U=T=null,P=_,b=_=0,A=null,$=S.next();P!==null&&!$.done;b++,$=S.next()){P.index>b?(A=P,P=null):A=P.sibling;var D=g(y,P,$.value,N);if(D===null){P===null&&(P=A);break}t&&P&&D.alternate===null&&e(y,P),_=i(D,_,b),U===null?T=D:U.sibling=D,U=D,P=A}if($.done)return n(y,P),Yt&&Gi(y,b),T;if(P===null){for(;!$.done;b++,$=S.next())$=p(y,$.value,N),$!==null&&(_=i($,_,b),U===null?T=$:U.sibling=$,U=$);return Yt&&Gi(y,b),T}for(P=r(y,P);!$.done;b++,$=S.next())$=m(P,y,b,$.value,N),$!==null&&(t&&$.alternate!==null&&P.delete($.key===null?b:$.key),_=i($,_,b),U===null?T=$:U.sibling=$,U=$);return t&&P.forEach(function(F){return e(y,F)}),Yt&&Gi(y,b),T}function w(y,_,S,N){if(typeof S=="object"&&S!==null&&S.type===Vo&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case ru:e:{for(var T=S.key,U=_;U!==null;){if(U.key===T){if(T=S.type,T===Vo){if(U.tag===7){n(y,U.sibling),_=s(U,S.props.children),_.return=y,y=_;break e}}else if(U.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Ga&&Z1(T)===U.type){n(y,U.sibling),_=s(U,S.props),_.ref=pc(y,U,S),_.return=y,y=_;break e}n(y,U);break}else e(y,U);U=U.sibling}S.type===Vo?(_=ro(S.props.children,y.mode,N,S.key),_.return=y,y=_):(N=$u(S.type,S.key,S.props,null,y.mode,N),N.ref=pc(y,_,S),N.return=y,y=N)}return o(y);case Ho:e:{for(U=S.key;_!==null;){if(_.key===U)if(_.tag===4&&_.stateNode.containerInfo===S.containerInfo&&_.stateNode.implementation===S.implementation){n(y,_.sibling),_=s(_,S.children||[]),_.return=y,y=_;break e}else{n(y,_);break}else e(y,_);_=_.sibling}_=dp(S,y.mode,N),_.return=y,y=_}return o(y);case Ga:return U=S._init,w(y,_,U(S._payload),N)}if(jc(S))return j(y,_,S,N);if(cc(S))return k(y,_,S,N);pu(y,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,_!==null&&_.tag===6?(n(y,_.sibling),_=s(_,S),_.return=y,y=_):(n(y,_),_=cp(S,y.mode,N),_.return=y,y=_),o(y)):n(y,_)}return w}var _l=Pb(!0),Lb=Pb(!1),lh=gi(null),ch=null,el=null,Bg=null;function Ug(){Bg=el=ch=null}function $g(t){var e=lh.current;Kt(lh),t._currentValue=e}function jm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function cl(t,e){ch=t,Bg=el=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(wr=!0),t.firstContext=null)}function is(t){var e=t._currentValue;if(Bg!==t)if(t={context:t,memoizedValue:e,next:null},el===null){if(ch===null)throw Error(De(308));el=t,ch.dependencies={lanes:0,firstContext:t}}else el=el.next=t;return e}var eo=null;function zg(t){eo===null?eo=[t]:eo.push(t)}function Tb(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,zg(e)):(n.next=s.next,s.next=n),e.interleaved=n,_a(t,r)}function _a(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ka=!1;function Wg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ib(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function va(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ii(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,jt&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,_a(t,n)}return s=r.interleaved,s===null?(e.next=e,zg(r)):(e.next=s.next,s.next=e),r.interleaved=e,_a(t,n)}function qu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Eg(t,n)}}function Y1(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function dh(t,e,n,r){var s=t.updateQueue;Ka=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var u=t.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(i!==null){var p=s.baseState;o=0,u=d=c=null,l=i;do{var g=l.lane,m=l.eventTime;if((r&g)===g){u!==null&&(u=u.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var j=t,k=l;switch(g=e,m=n,k.tag){case 1:if(j=k.payload,typeof j=="function"){p=j.call(m,p,g);break e}p=j;break e;case 3:j.flags=j.flags&-65537|128;case 0:if(j=k.payload,g=typeof j=="function"?j.call(m,p,g):j,g==null)break e;p=tn({},p,g);break e;case 2:Ka=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,g=s.effects,g===null?s.effects=[l]:g.push(l))}else m={eventTime:m,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=m,c=p):u=u.next=m,o|=g;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;g=l,l=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(!0);if(u===null&&(c=p),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);lo|=o,t.lanes=o,t.memoizedState=p}}function J1(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(De(191,s));s.call(r)}}}var gd={},Hs=gi(gd),Qc=gi(gd),ed=gi(gd);function to(t){if(t===gd)throw Error(De(174));return t}function Hg(t,e){switch(Wt(ed,e),Wt(Qc,t),Wt(Hs,gd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:rm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=rm(e,t)}Kt(Hs),Wt(Hs,e)}function xl(){Kt(Hs),Kt(Qc),Kt(ed)}function Rb(t){to(ed.current);var e=to(Hs.current),n=rm(e,t.type);e!==n&&(Wt(Qc,t),Wt(Hs,n))}function Vg(t){Qc.current===t&&(Kt(Hs),Kt(Qc))}var Xt=gi(0);function uh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var rp=[];function Gg(){for(var t=0;t<rp.length;t++)rp[t]._workInProgressVersionPrimary=null;rp.length=0}var Ou=ja.ReactCurrentDispatcher,sp=ja.ReactCurrentBatchConfig,oo=0,Qt=null,In=null,On=null,hh=!1,Lc=!1,td=0,wS=0;function tr(){throw Error(De(321))}function Kg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ss(t[n],e[n]))return!1;return!0}function Zg(t,e,n,r,s,i){if(oo=i,Qt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ou.current=t===null||t.memoizedState===null?NS:CS,t=n(r,s),Lc){i=0;do{if(Lc=!1,td=0,25<=i)throw Error(De(301));i+=1,On=In=null,e.updateQueue=null,Ou.current=AS,t=n(r,s)}while(Lc)}if(Ou.current=fh,e=In!==null&&In.next!==null,oo=0,On=In=Qt=null,hh=!1,e)throw Error(De(300));return t}function Yg(){var t=td!==0;return td=0,t}function Ms(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return On===null?Qt.memoizedState=On=t:On=On.next=t,On}function os(){if(In===null){var t=Qt.alternate;t=t!==null?t.memoizedState:null}else t=In.next;var e=On===null?Qt.memoizedState:On.next;if(e!==null)On=e,In=t;else{if(t===null)throw Error(De(310));In=t,t={memoizedState:In.memoizedState,baseState:In.baseState,baseQueue:In.baseQueue,queue:In.queue,next:null},On===null?Qt.memoizedState=On=t:On=On.next=t}return On}function nd(t,e){return typeof e=="function"?e(t):e}function ap(t){var e=os(),n=e.queue;if(n===null)throw Error(De(311));n.lastRenderedReducer=t;var r=In,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,d=i;do{var u=d.lane;if((oo&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var p={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=p,o=r):c=c.next=p,Qt.lanes|=u,lo|=u}d=d.next}while(d!==null&&d!==i);c===null?o=r:c.next=l,Ss(r,e.memoizedState)||(wr=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Qt.lanes|=i,lo|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ip(t){var e=os(),n=e.queue;if(n===null)throw Error(De(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Ss(i,e.memoizedState)||(wr=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function qb(){}function Ob(t,e){var n=Qt,r=os(),s=e(),i=!Ss(r.memoizedState,s);if(i&&(r.memoizedState=s,wr=!0),r=r.queue,Jg(Bb.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||On!==null&&On.memoizedState.tag&1){if(n.flags|=2048,rd(9,Mb.bind(null,n,r,s,e),void 0,null),Mn===null)throw Error(De(349));oo&30||Fb(n,e,s)}return s}function Fb(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Qt.updateQueue,e===null?(e={lastEffect:null,stores:null},Qt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Mb(t,e,n,r){e.value=n,e.getSnapshot=r,Ub(e)&&$b(t)}function Bb(t,e,n){return n(function(){Ub(e)&&$b(t)})}function Ub(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ss(t,n)}catch{return!0}}function $b(t){var e=_a(t,1);e!==null&&js(e,t,1,-1)}function X1(t){var e=Ms();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:nd,lastRenderedState:t},e.queue=t,t=t.dispatch=kS.bind(null,Qt,t),[e.memoizedState,t]}function rd(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Qt.updateQueue,e===null?(e={lastEffect:null,stores:null},Qt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function zb(){return os().memoizedState}function Fu(t,e,n,r){var s=Ms();Qt.flags|=t,s.memoizedState=rd(1|e,n,void 0,r===void 0?null:r)}function Fh(t,e,n,r){var s=os();r=r===void 0?null:r;var i=void 0;if(In!==null){var o=In.memoizedState;if(i=o.destroy,r!==null&&Kg(r,o.deps)){s.memoizedState=rd(e,n,i,r);return}}Qt.flags|=t,s.memoizedState=rd(1|e,n,i,r)}function Q1(t,e){return Fu(8390656,8,t,e)}function Jg(t,e){return Fh(2048,8,t,e)}function Wb(t,e){return Fh(4,2,t,e)}function Hb(t,e){return Fh(4,4,t,e)}function Vb(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Gb(t,e,n){return n=n!=null?n.concat([t]):null,Fh(4,4,Vb.bind(null,e,t),n)}function Xg(){}function Kb(t,e){var n=os();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Kg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Zb(t,e){var n=os();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Kg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Yb(t,e,n){return oo&21?(Ss(n,e)||(n=tb(),Qt.lanes|=n,lo|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,wr=!0),t.memoizedState=n)}function jS(t,e){var n=Tt;Tt=n!==0&&4>n?n:4,t(!0);var r=sp.transition;sp.transition={};try{t(!1),e()}finally{Tt=n,sp.transition=r}}function Jb(){return os().memoizedState}function SS(t,e,n){var r=li(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Xb(t))Qb(e,n);else if(n=Tb(t,e,n,r),n!==null){var s=fr();js(n,t,r,s),e_(n,e,r)}}function kS(t,e,n){var r=li(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Xb(t))Qb(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,Ss(l,o)){var c=e.interleaved;c===null?(s.next=s,zg(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=Tb(t,e,s,r),n!==null&&(s=fr(),js(n,t,r,s),e_(n,e,r))}}function Xb(t){var e=t.alternate;return t===Qt||e!==null&&e===Qt}function Qb(t,e){Lc=hh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function e_(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Eg(t,n)}}var fh={readContext:is,useCallback:tr,useContext:tr,useEffect:tr,useImperativeHandle:tr,useInsertionEffect:tr,useLayoutEffect:tr,useMemo:tr,useReducer:tr,useRef:tr,useState:tr,useDebugValue:tr,useDeferredValue:tr,useTransition:tr,useMutableSource:tr,useSyncExternalStore:tr,useId:tr,unstable_isNewReconciler:!1},NS={readContext:is,useCallback:function(t,e){return Ms().memoizedState=[t,e===void 0?null:e],t},useContext:is,useEffect:Q1,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Fu(4194308,4,Vb.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Fu(4194308,4,t,e)},useInsertionEffect:function(t,e){return Fu(4,2,t,e)},useMemo:function(t,e){var n=Ms();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ms();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=SS.bind(null,Qt,t),[r.memoizedState,t]},useRef:function(t){var e=Ms();return t={current:t},e.memoizedState=t},useState:X1,useDebugValue:Xg,useDeferredValue:function(t){return Ms().memoizedState=t},useTransition:function(){var t=X1(!1),e=t[0];return t=jS.bind(null,t[1]),Ms().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Qt,s=Ms();if(Yt){if(n===void 0)throw Error(De(407));n=n()}else{if(n=e(),Mn===null)throw Error(De(349));oo&30||Fb(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Q1(Bb.bind(null,r,i,t),[t]),r.flags|=2048,rd(9,Mb.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Ms(),e=Mn.identifierPrefix;if(Yt){var n=ma,r=pa;n=(r&~(1<<32-ws(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=td++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=wS++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},CS={readContext:is,useCallback:Kb,useContext:is,useEffect:Jg,useImperativeHandle:Gb,useInsertionEffect:Wb,useLayoutEffect:Hb,useMemo:Zb,useReducer:ap,useRef:zb,useState:function(){return ap(nd)},useDebugValue:Xg,useDeferredValue:function(t){var e=os();return Yb(e,In.memoizedState,t)},useTransition:function(){var t=ap(nd)[0],e=os().memoizedState;return[t,e]},useMutableSource:qb,useSyncExternalStore:Ob,useId:Jb,unstable_isNewReconciler:!1},AS={readContext:is,useCallback:Kb,useContext:is,useEffect:Jg,useImperativeHandle:Gb,useInsertionEffect:Wb,useLayoutEffect:Hb,useMemo:Zb,useReducer:ip,useRef:zb,useState:function(){return ip(nd)},useDebugValue:Xg,useDeferredValue:function(t){var e=os();return In===null?e.memoizedState=t:Yb(e,In.memoizedState,t)},useTransition:function(){var t=ip(nd)[0],e=os().memoizedState;return[t,e]},useMutableSource:qb,useSyncExternalStore:Ob,useId:Jb,unstable_isNewReconciler:!1};function ys(t,e){if(t&&t.defaultProps){e=tn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Sm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:tn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Mh={isMounted:function(t){return(t=t._reactInternals)?po(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=fr(),s=li(t),i=va(r,s);i.payload=e,n!=null&&(i.callback=n),e=ii(t,i,s),e!==null&&(js(e,t,s,r),qu(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=fr(),s=li(t),i=va(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=ii(t,i,s),e!==null&&(js(e,t,s,r),qu(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=fr(),r=li(t),s=va(n,r);s.tag=2,e!=null&&(s.callback=e),e=ii(t,s,r),e!==null&&(js(e,t,r,n),qu(e,t,r))}};function ev(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Zc(n,r)||!Zc(s,i):!0}function t_(t,e,n){var r=!1,s=fi,i=e.contextType;return typeof i=="object"&&i!==null?i=is(i):(s=Sr(e)?ao:lr.current,r=e.contextTypes,i=(r=r!=null)?yl(t,s):fi),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Mh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function tv(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Mh.enqueueReplaceState(e,e.state,null)}function km(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Wg(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=is(i):(i=Sr(e)?ao:lr.current,s.context=yl(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Sm(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Mh.enqueueReplaceState(s,s.state,null),dh(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function wl(t,e){try{var n="",r=e;do n+=nj(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function op(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Nm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var ES=typeof WeakMap=="function"?WeakMap:Map;function n_(t,e,n){n=va(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){mh||(mh=!0,qm=r),Nm(t,e)},n}function r_(t,e,n){n=va(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Nm(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Nm(t,e),typeof r!="function"&&(oi===null?oi=new Set([this]):oi.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function nv(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new ES;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=zS.bind(null,t,e,n),e.then(t,t))}function rv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function sv(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=va(-1,1),e.tag=2,ii(n,e,1))),n.lanes|=1),t)}var DS=ja.ReactCurrentOwner,wr=!1;function hr(t,e,n,r){e.child=t===null?Lb(e,null,n,r):_l(e,t.child,n,r)}function av(t,e,n,r,s){n=n.render;var i=e.ref;return cl(e,s),r=Zg(t,e,n,r,i,s),n=Yg(),t!==null&&!wr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,xa(t,e,s)):(Yt&&n&&Og(e),e.flags|=1,hr(t,e,r,s),e.child)}function iv(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!i0(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,s_(t,e,i,r,s)):(t=$u(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Zc,n(o,r)&&t.ref===e.ref)return xa(t,e,s)}return e.flags|=1,t=ci(i,r),t.ref=e.ref,t.return=e,e.child=t}function s_(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Zc(i,r)&&t.ref===e.ref)if(wr=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(wr=!0);else return e.lanes=t.lanes,xa(t,e,s)}return Cm(t,e,n,r,s)}function a_(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Wt(nl,Or),Or|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Wt(nl,Or),Or|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Wt(nl,Or),Or|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Wt(nl,Or),Or|=r;return hr(t,e,s,n),e.child}function i_(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Cm(t,e,n,r,s){var i=Sr(n)?ao:lr.current;return i=yl(e,i),cl(e,s),n=Zg(t,e,n,r,i,s),r=Yg(),t!==null&&!wr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,xa(t,e,s)):(Yt&&r&&Og(e),e.flags|=1,hr(t,e,n,s),e.child)}function ov(t,e,n,r,s){if(Sr(n)){var i=!0;ah(e)}else i=!1;if(cl(e,s),e.stateNode===null)Mu(t,e),t_(e,n,r),km(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=is(d):(d=Sr(n)?ao:lr.current,d=yl(e,d));var u=n.getDerivedStateFromProps,p=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==d)&&tv(e,o,r,d),Ka=!1;var g=e.memoizedState;o.state=g,dh(e,r,o,s),c=e.memoizedState,l!==r||g!==c||jr.current||Ka?(typeof u=="function"&&(Sm(e,n,u,r),c=e.memoizedState),(l=Ka||ev(e,n,l,r,g,c,d))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Ib(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:ys(e.type,l),o.props=d,p=e.pendingProps,g=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=is(c):(c=Sr(n)?ao:lr.current,c=yl(e,c));var m=n.getDerivedStateFromProps;(u=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||g!==c)&&tv(e,o,r,c),Ka=!1,g=e.memoizedState,o.state=g,dh(e,r,o,s);var j=e.memoizedState;l!==p||g!==j||jr.current||Ka?(typeof m=="function"&&(Sm(e,n,m,r),j=e.memoizedState),(d=Ka||ev(e,n,d,r,g,j,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,j,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,j,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=j),o.props=r,o.state=j,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return Am(t,e,n,r,i,s)}function Am(t,e,n,r,s,i){i_(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&V1(e,n,!1),xa(t,e,i);r=e.stateNode,DS.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=_l(e,t.child,null,i),e.child=_l(e,null,l,i)):hr(t,e,l,i),e.memoizedState=r.state,s&&V1(e,n,!0),e.child}function o_(t){var e=t.stateNode;e.pendingContext?H1(t,e.pendingContext,e.pendingContext!==e.context):e.context&&H1(t,e.context,!1),Hg(t,e.containerInfo)}function lv(t,e,n,r,s){return bl(),Mg(s),e.flags|=256,hr(t,e,n,r),e.child}var Em={dehydrated:null,treeContext:null,retryLane:0};function Dm(t){return{baseLanes:t,cachePool:null,transitions:null}}function l_(t,e,n){var r=e.pendingProps,s=Xt.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Wt(Xt,s&1),t===null)return wm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=$h(o,r,0,null),t=ro(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Dm(n),e.memoizedState=Em,t):Qg(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return PS(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=ci(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=ci(l,i):(i=ro(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Dm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Em,r}return i=t.child,t=i.sibling,r=ci(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Qg(t,e){return e=$h({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function mu(t,e,n,r){return r!==null&&Mg(r),_l(e,t.child,null,n),t=Qg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function PS(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=op(Error(De(422))),mu(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=$h({mode:"visible",children:r.children},s,0,null),i=ro(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&_l(e,t.child,null,o),e.child.memoizedState=Dm(o),e.memoizedState=Em,i);if(!(e.mode&1))return mu(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(De(419)),r=op(i,r,void 0),mu(t,e,o,r)}if(l=(o&t.childLanes)!==0,wr||l){if(r=Mn,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,_a(t,s),js(r,t,s,-1))}return a0(),r=op(Error(De(421))),mu(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=WS.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Fr=ai(s.nextSibling),Br=e,Yt=!0,xs=null,t!==null&&(es[ts++]=pa,es[ts++]=ma,es[ts++]=io,pa=t.id,ma=t.overflow,io=e),e=Qg(e,r.children),e.flags|=4096,e)}function cv(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),jm(t.return,e,n)}function lp(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function c_(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(hr(t,e,r.children,n),r=Xt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&cv(t,n,e);else if(t.tag===19)cv(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Wt(Xt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&uh(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),lp(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&uh(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}lp(e,!0,n,null,i);break;case"together":lp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Mu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function xa(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),lo|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(De(153));if(e.child!==null){for(t=e.child,n=ci(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ci(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function LS(t,e,n){switch(e.tag){case 3:o_(e),bl();break;case 5:Rb(e);break;case 1:Sr(e.type)&&ah(e);break;case 4:Hg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Wt(lh,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Wt(Xt,Xt.current&1),e.flags|=128,null):n&e.child.childLanes?l_(t,e,n):(Wt(Xt,Xt.current&1),t=xa(t,e,n),t!==null?t.sibling:null);Wt(Xt,Xt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return c_(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Wt(Xt,Xt.current),r)break;return null;case 22:case 23:return e.lanes=0,a_(t,e,n)}return xa(t,e,n)}var d_,Pm,u_,h_;d_=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Pm=function(){};u_=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,to(Hs.current);var i=null;switch(n){case"input":s=Qp(t,s),r=Qp(t,r),i=[];break;case"select":s=tn({},s,{value:void 0}),r=tn({},r,{value:void 0}),i=[];break;case"textarea":s=nm(t,s),r=nm(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=rh)}sm(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&($c.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&($c.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Vt("scroll",t),i||l===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};h_=function(t,e,n,r){n!==r&&(e.flags|=4)};function mc(t,e){if(!Yt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function nr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function TS(t,e,n){var r=e.pendingProps;switch(Fg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nr(e),null;case 1:return Sr(e.type)&&sh(),nr(e),null;case 3:return r=e.stateNode,xl(),Kt(jr),Kt(lr),Gg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(fu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,xs!==null&&(Mm(xs),xs=null))),Pm(t,e),nr(e),null;case 5:Vg(e);var s=to(ed.current);if(n=e.type,t!==null&&e.stateNode!=null)u_(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(De(166));return nr(e),null}if(t=to(Hs.current),fu(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Us]=e,r[Xc]=i,t=(e.mode&1)!==0,n){case"dialog":Vt("cancel",r),Vt("close",r);break;case"iframe":case"object":case"embed":Vt("load",r);break;case"video":case"audio":for(s=0;s<kc.length;s++)Vt(kc[s],r);break;case"source":Vt("error",r);break;case"img":case"image":case"link":Vt("error",r),Vt("load",r);break;case"details":Vt("toggle",r);break;case"input":y1(r,i),Vt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Vt("invalid",r);break;case"textarea":_1(r,i),Vt("invalid",r)}sm(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&hu(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&hu(r.textContent,l,t),s=["children",""+l]):$c.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Vt("scroll",r)}switch(n){case"input":su(r),b1(r,i,!0);break;case"textarea":su(r),x1(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=rh)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=By(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Us]=e,t[Xc]=r,d_(t,e,!1,!1),e.stateNode=t;e:{switch(o=am(n,r),n){case"dialog":Vt("cancel",t),Vt("close",t),s=r;break;case"iframe":case"object":case"embed":Vt("load",t),s=r;break;case"video":case"audio":for(s=0;s<kc.length;s++)Vt(kc[s],t);s=r;break;case"source":Vt("error",t),s=r;break;case"img":case"image":case"link":Vt("error",t),Vt("load",t),s=r;break;case"details":Vt("toggle",t),s=r;break;case"input":y1(t,r),s=Qp(t,r),Vt("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=tn({},r,{value:void 0}),Vt("invalid",t);break;case"textarea":_1(t,r),s=nm(t,r),Vt("invalid",t);break;default:s=r}sm(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?zy(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Uy(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&zc(t,c):typeof c=="number"&&zc(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&($c.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Vt("scroll",t):c!=null&&jg(t,i,c,o))}switch(n){case"input":su(t),b1(t,r,!1);break;case"textarea":su(t),x1(t);break;case"option":r.value!=null&&t.setAttribute("value",""+hi(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?al(t,!!r.multiple,i,!1):r.defaultValue!=null&&al(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=rh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return nr(e),null;case 6:if(t&&e.stateNode!=null)h_(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(De(166));if(n=to(ed.current),to(Hs.current),fu(e)){if(r=e.stateNode,n=e.memoizedProps,r[Us]=e,(i=r.nodeValue!==n)&&(t=Br,t!==null))switch(t.tag){case 3:hu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&hu(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Us]=e,e.stateNode=r}return nr(e),null;case 13:if(Kt(Xt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Yt&&Fr!==null&&e.mode&1&&!(e.flags&128))Db(),bl(),e.flags|=98560,i=!1;else if(i=fu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(De(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(De(317));i[Us]=e}else bl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;nr(e),i=!1}else xs!==null&&(Mm(xs),xs=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Xt.current&1?Rn===0&&(Rn=3):a0())),e.updateQueue!==null&&(e.flags|=4),nr(e),null);case 4:return xl(),Pm(t,e),t===null&&Yc(e.stateNode.containerInfo),nr(e),null;case 10:return $g(e.type._context),nr(e),null;case 17:return Sr(e.type)&&sh(),nr(e),null;case 19:if(Kt(Xt),i=e.memoizedState,i===null)return nr(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)mc(i,!1);else{if(Rn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=uh(t),o!==null){for(e.flags|=128,mc(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Wt(Xt,Xt.current&1|2),e.child}t=t.sibling}i.tail!==null&&yn()>jl&&(e.flags|=128,r=!0,mc(i,!1),e.lanes=4194304)}else{if(!r)if(t=uh(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),mc(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Yt)return nr(e),null}else 2*yn()-i.renderingStartTime>jl&&n!==1073741824&&(e.flags|=128,r=!0,mc(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=yn(),e.sibling=null,n=Xt.current,Wt(Xt,r?n&1|2:n&1),e):(nr(e),null);case 22:case 23:return s0(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Or&1073741824&&(nr(e),e.subtreeFlags&6&&(e.flags|=8192)):nr(e),null;case 24:return null;case 25:return null}throw Error(De(156,e.tag))}function IS(t,e){switch(Fg(e),e.tag){case 1:return Sr(e.type)&&sh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return xl(),Kt(jr),Kt(lr),Gg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Vg(e),null;case 13:if(Kt(Xt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(De(340));bl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Kt(Xt),null;case 4:return xl(),null;case 10:return $g(e.type._context),null;case 22:case 23:return s0(),null;case 24:return null;default:return null}}var gu=!1,or=!1,RS=typeof WeakSet=="function"?WeakSet:Set,Ie=null;function tl(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ln(t,e,r)}else n.current=null}function Lm(t,e,n){try{n()}catch(r){ln(t,e,r)}}var dv=!1;function qS(t,e){if(mm=eh,t=vb(),qg(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,d=0,u=0,p=t,g=null;t:for(;;){for(var m;p!==n||s!==0&&p.nodeType!==3||(l=o+s),p!==i||r!==0&&p.nodeType!==3||(c=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(m=p.firstChild)!==null;)g=p,p=m;for(;;){if(p===t)break t;if(g===n&&++d===s&&(l=o),g===i&&++u===r&&(c=o),(m=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=m}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(gm={focusedElem:t,selectionRange:n},eh=!1,Ie=e;Ie!==null;)if(e=Ie,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ie=t;else for(;Ie!==null;){e=Ie;try{var j=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(j!==null){var k=j.memoizedProps,w=j.memoizedState,y=e.stateNode,_=y.getSnapshotBeforeUpdate(e.elementType===e.type?k:ys(e.type,k),w);y.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(De(163))}}catch(N){ln(e,e.return,N)}if(t=e.sibling,t!==null){t.return=e.return,Ie=t;break}Ie=e.return}return j=dv,dv=!1,j}function Tc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Lm(e,n,i)}s=s.next}while(s!==r)}}function Bh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Tm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function f_(t){var e=t.alternate;e!==null&&(t.alternate=null,f_(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Us],delete e[Xc],delete e[bm],delete e[yS],delete e[bS])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function p_(t){return t.tag===5||t.tag===3||t.tag===4}function uv(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||p_(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Im(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=rh));else if(r!==4&&(t=t.child,t!==null))for(Im(t,e,n),t=t.sibling;t!==null;)Im(t,e,n),t=t.sibling}function Rm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Rm(t,e,n),t=t.sibling;t!==null;)Rm(t,e,n),t=t.sibling}var Hn=null,bs=!1;function $a(t,e,n){for(n=n.child;n!==null;)m_(t,e,n),n=n.sibling}function m_(t,e,n){if(Ws&&typeof Ws.onCommitFiberUnmount=="function")try{Ws.onCommitFiberUnmount(Lh,n)}catch{}switch(n.tag){case 5:or||tl(n,e);case 6:var r=Hn,s=bs;Hn=null,$a(t,e,n),Hn=r,bs=s,Hn!==null&&(bs?(t=Hn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Hn.removeChild(n.stateNode));break;case 18:Hn!==null&&(bs?(t=Hn,n=n.stateNode,t.nodeType===8?tp(t.parentNode,n):t.nodeType===1&&tp(t,n),Gc(t)):tp(Hn,n.stateNode));break;case 4:r=Hn,s=bs,Hn=n.stateNode.containerInfo,bs=!0,$a(t,e,n),Hn=r,bs=s;break;case 0:case 11:case 14:case 15:if(!or&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Lm(n,e,o),s=s.next}while(s!==r)}$a(t,e,n);break;case 1:if(!or&&(tl(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){ln(n,e,l)}$a(t,e,n);break;case 21:$a(t,e,n);break;case 22:n.mode&1?(or=(r=or)||n.memoizedState!==null,$a(t,e,n),or=r):$a(t,e,n);break;default:$a(t,e,n)}}function hv(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new RS),e.forEach(function(r){var s=HS.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function gs(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Hn=l.stateNode,bs=!1;break e;case 3:Hn=l.stateNode.containerInfo,bs=!0;break e;case 4:Hn=l.stateNode.containerInfo,bs=!0;break e}l=l.return}if(Hn===null)throw Error(De(160));m_(i,o,s),Hn=null,bs=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){ln(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)g_(e,t),e=e.sibling}function g_(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(gs(e,t),Rs(t),r&4){try{Tc(3,t,t.return),Bh(3,t)}catch(k){ln(t,t.return,k)}try{Tc(5,t,t.return)}catch(k){ln(t,t.return,k)}}break;case 1:gs(e,t),Rs(t),r&512&&n!==null&&tl(n,n.return);break;case 5:if(gs(e,t),Rs(t),r&512&&n!==null&&tl(n,n.return),t.flags&32){var s=t.stateNode;try{zc(s,"")}catch(k){ln(t,t.return,k)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Fy(s,i),am(l,o);var d=am(l,i);for(o=0;o<c.length;o+=2){var u=c[o],p=c[o+1];u==="style"?zy(s,p):u==="dangerouslySetInnerHTML"?Uy(s,p):u==="children"?zc(s,p):jg(s,u,p,d)}switch(l){case"input":em(s,i);break;case"textarea":My(s,i);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?al(s,!!i.multiple,m,!1):g!==!!i.multiple&&(i.defaultValue!=null?al(s,!!i.multiple,i.defaultValue,!0):al(s,!!i.multiple,i.multiple?[]:"",!1))}s[Xc]=i}catch(k){ln(t,t.return,k)}}break;case 6:if(gs(e,t),Rs(t),r&4){if(t.stateNode===null)throw Error(De(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(k){ln(t,t.return,k)}}break;case 3:if(gs(e,t),Rs(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Gc(e.containerInfo)}catch(k){ln(t,t.return,k)}break;case 4:gs(e,t),Rs(t);break;case 13:gs(e,t),Rs(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(n0=yn())),r&4&&hv(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(or=(d=or)||u,gs(e,t),or=d):gs(e,t),Rs(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!u&&t.mode&1)for(Ie=t,u=t.child;u!==null;){for(p=Ie=u;Ie!==null;){switch(g=Ie,m=g.child,g.tag){case 0:case 11:case 14:case 15:Tc(4,g,g.return);break;case 1:tl(g,g.return);var j=g.stateNode;if(typeof j.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,j.props=e.memoizedProps,j.state=e.memoizedState,j.componentWillUnmount()}catch(k){ln(r,n,k)}}break;case 5:tl(g,g.return);break;case 22:if(g.memoizedState!==null){pv(p);continue}}m!==null?(m.return=g,Ie=m):pv(p)}u=u.sibling}e:for(u=null,p=t;;){if(p.tag===5){if(u===null){u=p;try{s=p.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=p.stateNode,c=p.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=$y("display",o))}catch(k){ln(t,t.return,k)}}}else if(p.tag===6){if(u===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(k){ln(t,t.return,k)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;u===p&&(u=null),p=p.return}u===p&&(u=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:gs(e,t),Rs(t),r&4&&hv(t);break;case 21:break;default:gs(e,t),Rs(t)}}function Rs(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(p_(n)){var r=n;break e}n=n.return}throw Error(De(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(zc(s,""),r.flags&=-33);var i=uv(t);Rm(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=uv(t);Im(t,l,o);break;default:throw Error(De(161))}}catch(c){ln(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function OS(t,e,n){Ie=t,v_(t)}function v_(t,e,n){for(var r=(t.mode&1)!==0;Ie!==null;){var s=Ie,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||gu;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||or;l=gu;var d=or;if(gu=o,(or=c)&&!d)for(Ie=s;Ie!==null;)o=Ie,c=o.child,o.tag===22&&o.memoizedState!==null?mv(s):c!==null?(c.return=o,Ie=c):mv(s);for(;i!==null;)Ie=i,v_(i),i=i.sibling;Ie=s,gu=l,or=d}fv(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Ie=i):fv(t)}}function fv(t){for(;Ie!==null;){var e=Ie;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:or||Bh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!or)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:ys(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&J1(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}J1(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var p=u.dehydrated;p!==null&&Gc(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(De(163))}or||e.flags&512&&Tm(e)}catch(g){ln(e,e.return,g)}}if(e===t){Ie=null;break}if(n=e.sibling,n!==null){n.return=e.return,Ie=n;break}Ie=e.return}}function pv(t){for(;Ie!==null;){var e=Ie;if(e===t){Ie=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Ie=n;break}Ie=e.return}}function mv(t){for(;Ie!==null;){var e=Ie;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Bh(4,e)}catch(c){ln(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){ln(e,s,c)}}var i=e.return;try{Tm(e)}catch(c){ln(e,i,c)}break;case 5:var o=e.return;try{Tm(e)}catch(c){ln(e,o,c)}}}catch(c){ln(e,e.return,c)}if(e===t){Ie=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Ie=l;break}Ie=e.return}}var FS=Math.ceil,ph=ja.ReactCurrentDispatcher,e0=ja.ReactCurrentOwner,ss=ja.ReactCurrentBatchConfig,jt=0,Mn=null,Nn=null,Kn=0,Or=0,nl=gi(0),Rn=0,sd=null,lo=0,Uh=0,t0=0,Ic=null,_r=null,n0=0,jl=1/0,da=null,mh=!1,qm=null,oi=null,vu=!1,Qa=null,gh=0,Rc=0,Om=null,Bu=-1,Uu=0;function fr(){return jt&6?yn():Bu!==-1?Bu:Bu=yn()}function li(t){return t.mode&1?jt&2&&Kn!==0?Kn&-Kn:xS.transition!==null?(Uu===0&&(Uu=tb()),Uu):(t=Tt,t!==0||(t=window.event,t=t===void 0?16:lb(t.type)),t):1}function js(t,e,n,r){if(50<Rc)throw Rc=0,Om=null,Error(De(185));fd(t,n,r),(!(jt&2)||t!==Mn)&&(t===Mn&&(!(jt&2)&&(Uh|=n),Rn===4&&Ya(t,Kn)),kr(t,r),n===1&&jt===0&&!(e.mode&1)&&(jl=yn()+500,Oh&&vi()))}function kr(t,e){var n=t.callbackNode;xj(t,e);var r=Qu(t,t===Mn?Kn:0);if(r===0)n!==null&&S1(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&S1(n),e===1)t.tag===0?_S(gv.bind(null,t)):Cb(gv.bind(null,t)),gS(function(){!(jt&6)&&vi()}),n=null;else{switch(nb(r)){case 1:n=Ag;break;case 4:n=Qy;break;case 16:n=Xu;break;case 536870912:n=eb;break;default:n=Xu}n=k_(n,y_.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function y_(t,e){if(Bu=-1,Uu=0,jt&6)throw Error(De(327));var n=t.callbackNode;if(dl()&&t.callbackNode!==n)return null;var r=Qu(t,t===Mn?Kn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=vh(t,r);else{e=r;var s=jt;jt|=2;var i=__();(Mn!==t||Kn!==e)&&(da=null,jl=yn()+500,no(t,e));do try{US();break}catch(l){b_(t,l)}while(!0);Ug(),ph.current=i,jt=s,Nn!==null?e=0:(Mn=null,Kn=0,e=Rn)}if(e!==0){if(e===2&&(s=dm(t),s!==0&&(r=s,e=Fm(t,s))),e===1)throw n=sd,no(t,0),Ya(t,r),kr(t,yn()),n;if(e===6)Ya(t,r);else{if(s=t.current.alternate,!(r&30)&&!MS(s)&&(e=vh(t,r),e===2&&(i=dm(t),i!==0&&(r=i,e=Fm(t,i))),e===1))throw n=sd,no(t,0),Ya(t,r),kr(t,yn()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(De(345));case 2:Ki(t,_r,da);break;case 3:if(Ya(t,r),(r&130023424)===r&&(e=n0+500-yn(),10<e)){if(Qu(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){fr(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=ym(Ki.bind(null,t,_r,da),e);break}Ki(t,_r,da);break;case 4:if(Ya(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-ws(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=yn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*FS(r/1960))-r,10<r){t.timeoutHandle=ym(Ki.bind(null,t,_r,da),r);break}Ki(t,_r,da);break;case 5:Ki(t,_r,da);break;default:throw Error(De(329))}}}return kr(t,yn()),t.callbackNode===n?y_.bind(null,t):null}function Fm(t,e){var n=Ic;return t.current.memoizedState.isDehydrated&&(no(t,e).flags|=256),t=vh(t,e),t!==2&&(e=_r,_r=n,e!==null&&Mm(e)),t}function Mm(t){_r===null?_r=t:_r.push.apply(_r,t)}function MS(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Ss(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ya(t,e){for(e&=~t0,e&=~Uh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ws(e),r=1<<n;t[n]=-1,e&=~r}}function gv(t){if(jt&6)throw Error(De(327));dl();var e=Qu(t,0);if(!(e&1))return kr(t,yn()),null;var n=vh(t,e);if(t.tag!==0&&n===2){var r=dm(t);r!==0&&(e=r,n=Fm(t,r))}if(n===1)throw n=sd,no(t,0),Ya(t,e),kr(t,yn()),n;if(n===6)throw Error(De(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ki(t,_r,da),kr(t,yn()),null}function r0(t,e){var n=jt;jt|=1;try{return t(e)}finally{jt=n,jt===0&&(jl=yn()+500,Oh&&vi())}}function co(t){Qa!==null&&Qa.tag===0&&!(jt&6)&&dl();var e=jt;jt|=1;var n=ss.transition,r=Tt;try{if(ss.transition=null,Tt=1,t)return t()}finally{Tt=r,ss.transition=n,jt=e,!(jt&6)&&vi()}}function s0(){Or=nl.current,Kt(nl)}function no(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,mS(n)),Nn!==null)for(n=Nn.return;n!==null;){var r=n;switch(Fg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&sh();break;case 3:xl(),Kt(jr),Kt(lr),Gg();break;case 5:Vg(r);break;case 4:xl();break;case 13:Kt(Xt);break;case 19:Kt(Xt);break;case 10:$g(r.type._context);break;case 22:case 23:s0()}n=n.return}if(Mn=t,Nn=t=ci(t.current,null),Kn=Or=e,Rn=0,sd=null,t0=Uh=lo=0,_r=Ic=null,eo!==null){for(e=0;e<eo.length;e++)if(n=eo[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}eo=null}return t}function b_(t,e){do{var n=Nn;try{if(Ug(),Ou.current=fh,hh){for(var r=Qt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}hh=!1}if(oo=0,On=In=Qt=null,Lc=!1,td=0,e0.current=null,n===null||n.return===null){Rn=1,sd=e,Nn=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=Kn,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,p=u.tag;if(!(u.mode&1)&&(p===0||p===11||p===15)){var g=u.alternate;g?(u.updateQueue=g.updateQueue,u.memoizedState=g.memoizedState,u.lanes=g.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=rv(o);if(m!==null){m.flags&=-257,sv(m,o,l,i,e),m.mode&1&&nv(i,d,e),e=m,c=d;var j=e.updateQueue;if(j===null){var k=new Set;k.add(c),e.updateQueue=k}else j.add(c);break e}else{if(!(e&1)){nv(i,d,e),a0();break e}c=Error(De(426))}}else if(Yt&&l.mode&1){var w=rv(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),sv(w,o,l,i,e),Mg(wl(c,l));break e}}i=c=wl(c,l),Rn!==4&&(Rn=2),Ic===null?Ic=[i]:Ic.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var y=n_(i,c,e);Y1(i,y);break e;case 1:l=c;var _=i.type,S=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(oi===null||!oi.has(S)))){i.flags|=65536,e&=-e,i.lanes|=e;var N=r_(i,l,e);Y1(i,N);break e}}i=i.return}while(i!==null)}w_(n)}catch(T){e=T,Nn===n&&n!==null&&(Nn=n=n.return);continue}break}while(!0)}function __(){var t=ph.current;return ph.current=fh,t===null?fh:t}function a0(){(Rn===0||Rn===3||Rn===2)&&(Rn=4),Mn===null||!(lo&268435455)&&!(Uh&268435455)||Ya(Mn,Kn)}function vh(t,e){var n=jt;jt|=2;var r=__();(Mn!==t||Kn!==e)&&(da=null,no(t,e));do try{BS();break}catch(s){b_(t,s)}while(!0);if(Ug(),jt=n,ph.current=r,Nn!==null)throw Error(De(261));return Mn=null,Kn=0,Rn}function BS(){for(;Nn!==null;)x_(Nn)}function US(){for(;Nn!==null&&!hj();)x_(Nn)}function x_(t){var e=S_(t.alternate,t,Or);t.memoizedProps=t.pendingProps,e===null?w_(t):Nn=e,e0.current=null}function w_(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=IS(n,e),n!==null){n.flags&=32767,Nn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Rn=6,Nn=null;return}}else if(n=TS(n,e,Or),n!==null){Nn=n;return}if(e=e.sibling,e!==null){Nn=e;return}Nn=e=t}while(e!==null);Rn===0&&(Rn=5)}function Ki(t,e,n){var r=Tt,s=ss.transition;try{ss.transition=null,Tt=1,$S(t,e,n,r)}finally{ss.transition=s,Tt=r}return null}function $S(t,e,n,r){do dl();while(Qa!==null);if(jt&6)throw Error(De(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(De(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(wj(t,i),t===Mn&&(Nn=Mn=null,Kn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||vu||(vu=!0,k_(Xu,function(){return dl(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=ss.transition,ss.transition=null;var o=Tt;Tt=1;var l=jt;jt|=4,e0.current=null,qS(t,n),g_(n,t),lS(gm),eh=!!mm,gm=mm=null,t.current=n,OS(n),fj(),jt=l,Tt=o,ss.transition=i}else t.current=n;if(vu&&(vu=!1,Qa=t,gh=s),i=t.pendingLanes,i===0&&(oi=null),gj(n.stateNode),kr(t,yn()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(mh)throw mh=!1,t=qm,qm=null,t;return gh&1&&t.tag!==0&&dl(),i=t.pendingLanes,i&1?t===Om?Rc++:(Rc=0,Om=t):Rc=0,vi(),null}function dl(){if(Qa!==null){var t=nb(gh),e=ss.transition,n=Tt;try{if(ss.transition=null,Tt=16>t?16:t,Qa===null)var r=!1;else{if(t=Qa,Qa=null,gh=0,jt&6)throw Error(De(331));var s=jt;for(jt|=4,Ie=t.current;Ie!==null;){var i=Ie,o=i.child;if(Ie.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(Ie=d;Ie!==null;){var u=Ie;switch(u.tag){case 0:case 11:case 15:Tc(8,u,i)}var p=u.child;if(p!==null)p.return=u,Ie=p;else for(;Ie!==null;){u=Ie;var g=u.sibling,m=u.return;if(f_(u),u===d){Ie=null;break}if(g!==null){g.return=m,Ie=g;break}Ie=m}}}var j=i.alternate;if(j!==null){var k=j.child;if(k!==null){j.child=null;do{var w=k.sibling;k.sibling=null,k=w}while(k!==null)}}Ie=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Ie=o;else e:for(;Ie!==null;){if(i=Ie,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Tc(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,Ie=y;break e}Ie=i.return}}var _=t.current;for(Ie=_;Ie!==null;){o=Ie;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,Ie=S;else e:for(o=_;Ie!==null;){if(l=Ie,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Bh(9,l)}}catch(T){ln(l,l.return,T)}if(l===o){Ie=null;break e}var N=l.sibling;if(N!==null){N.return=l.return,Ie=N;break e}Ie=l.return}}if(jt=s,vi(),Ws&&typeof Ws.onPostCommitFiberRoot=="function")try{Ws.onPostCommitFiberRoot(Lh,t)}catch{}r=!0}return r}finally{Tt=n,ss.transition=e}}return!1}function vv(t,e,n){e=wl(n,e),e=n_(t,e,1),t=ii(t,e,1),e=fr(),t!==null&&(fd(t,1,e),kr(t,e))}function ln(t,e,n){if(t.tag===3)vv(t,t,n);else for(;e!==null;){if(e.tag===3){vv(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(oi===null||!oi.has(r))){t=wl(n,t),t=r_(e,t,1),e=ii(e,t,1),t=fr(),e!==null&&(fd(e,1,t),kr(e,t));break}}e=e.return}}function zS(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=fr(),t.pingedLanes|=t.suspendedLanes&n,Mn===t&&(Kn&n)===n&&(Rn===4||Rn===3&&(Kn&130023424)===Kn&&500>yn()-n0?no(t,0):t0|=n),kr(t,e)}function j_(t,e){e===0&&(t.mode&1?(e=ou,ou<<=1,!(ou&130023424)&&(ou=4194304)):e=1);var n=fr();t=_a(t,e),t!==null&&(fd(t,e,n),kr(t,n))}function WS(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),j_(t,n)}function HS(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(De(314))}r!==null&&r.delete(e),j_(t,n)}var S_;S_=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||jr.current)wr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return wr=!1,LS(t,e,n);wr=!!(t.flags&131072)}else wr=!1,Yt&&e.flags&1048576&&Ab(e,oh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Mu(t,e),t=e.pendingProps;var s=yl(e,lr.current);cl(e,n),s=Zg(null,e,r,t,s,n);var i=Yg();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Sr(r)?(i=!0,ah(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Wg(e),s.updater=Mh,e.stateNode=s,s._reactInternals=e,km(e,r,t,n),e=Am(null,e,r,!0,i,n)):(e.tag=0,Yt&&i&&Og(e),hr(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Mu(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=GS(r),t=ys(r,t),s){case 0:e=Cm(null,e,r,t,n);break e;case 1:e=ov(null,e,r,t,n);break e;case 11:e=av(null,e,r,t,n);break e;case 14:e=iv(null,e,r,ys(r.type,t),n);break e}throw Error(De(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ys(r,s),Cm(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ys(r,s),ov(t,e,r,s,n);case 3:e:{if(o_(e),t===null)throw Error(De(387));r=e.pendingProps,i=e.memoizedState,s=i.element,Ib(t,e),dh(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=wl(Error(De(423)),e),e=lv(t,e,r,n,s);break e}else if(r!==s){s=wl(Error(De(424)),e),e=lv(t,e,r,n,s);break e}else for(Fr=ai(e.stateNode.containerInfo.firstChild),Br=e,Yt=!0,xs=null,n=Lb(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(bl(),r===s){e=xa(t,e,n);break e}hr(t,e,r,n)}e=e.child}return e;case 5:return Rb(e),t===null&&wm(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,vm(r,s)?o=null:i!==null&&vm(r,i)&&(e.flags|=32),i_(t,e),hr(t,e,o,n),e.child;case 6:return t===null&&wm(e),null;case 13:return l_(t,e,n);case 4:return Hg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=_l(e,null,r,n):hr(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ys(r,s),av(t,e,r,s,n);case 7:return hr(t,e,e.pendingProps,n),e.child;case 8:return hr(t,e,e.pendingProps.children,n),e.child;case 12:return hr(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Wt(lh,r._currentValue),r._currentValue=o,i!==null)if(Ss(i.value,o)){if(i.children===s.children&&!jr.current){e=xa(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=va(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),jm(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(De(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),jm(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}hr(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,cl(e,n),s=is(s),r=r(s),e.flags|=1,hr(t,e,r,n),e.child;case 14:return r=e.type,s=ys(r,e.pendingProps),s=ys(r.type,s),iv(t,e,r,s,n);case 15:return s_(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ys(r,s),Mu(t,e),e.tag=1,Sr(r)?(t=!0,ah(e)):t=!1,cl(e,n),t_(e,r,s),km(e,r,s,n),Am(null,e,r,!0,t,n);case 19:return c_(t,e,n);case 22:return a_(t,e,n)}throw Error(De(156,e.tag))};function k_(t,e){return Xy(t,e)}function VS(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ns(t,e,n,r){return new VS(t,e,n,r)}function i0(t){return t=t.prototype,!(!t||!t.isReactComponent)}function GS(t){if(typeof t=="function")return i0(t)?1:0;if(t!=null){if(t=t.$$typeof,t===kg)return 11;if(t===Ng)return 14}return 2}function ci(t,e){var n=t.alternate;return n===null?(n=ns(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function $u(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")i0(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Vo:return ro(n.children,s,i,e);case Sg:o=8,s|=8;break;case Zp:return t=ns(12,n,e,s|2),t.elementType=Zp,t.lanes=i,t;case Yp:return t=ns(13,n,e,s),t.elementType=Yp,t.lanes=i,t;case Jp:return t=ns(19,n,e,s),t.elementType=Jp,t.lanes=i,t;case Ry:return $h(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Ty:o=10;break e;case Iy:o=9;break e;case kg:o=11;break e;case Ng:o=14;break e;case Ga:o=16,r=null;break e}throw Error(De(130,t==null?t:typeof t,""))}return e=ns(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ro(t,e,n,r){return t=ns(7,t,r,e),t.lanes=n,t}function $h(t,e,n,r){return t=ns(22,t,r,e),t.elementType=Ry,t.lanes=n,t.stateNode={isHidden:!1},t}function cp(t,e,n){return t=ns(6,t,null,e),t.lanes=n,t}function dp(t,e,n){return e=ns(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function KS(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Wf(0),this.expirationTimes=Wf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wf(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function o0(t,e,n,r,s,i,o,l,c){return t=new KS(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=ns(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Wg(i),t}function ZS(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ho,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function N_(t){if(!t)return fi;t=t._reactInternals;e:{if(po(t)!==t||t.tag!==1)throw Error(De(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Sr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(De(171))}if(t.tag===1){var n=t.type;if(Sr(n))return Nb(t,n,e)}return e}function C_(t,e,n,r,s,i,o,l,c){return t=o0(n,r,!0,t,s,i,o,l,c),t.context=N_(null),n=t.current,r=fr(),s=li(n),i=va(r,s),i.callback=e??null,ii(n,i,s),t.current.lanes=s,fd(t,s,r),kr(t,r),t}function zh(t,e,n,r){var s=e.current,i=fr(),o=li(s);return n=N_(n),e.context===null?e.context=n:e.pendingContext=n,e=va(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ii(s,e,o),t!==null&&(js(t,s,o,i),qu(t,s,o)),o}function yh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function yv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function l0(t,e){yv(t,e),(t=t.alternate)&&yv(t,e)}function YS(){return null}var A_=typeof reportError=="function"?reportError:function(t){console.error(t)};function c0(t){this._internalRoot=t}Wh.prototype.render=c0.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(De(409));zh(t,e,null,null)};Wh.prototype.unmount=c0.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;co(function(){zh(null,t,null,null)}),e[ba]=null}};function Wh(t){this._internalRoot=t}Wh.prototype.unstable_scheduleHydration=function(t){if(t){var e=ab();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Za.length&&e!==0&&e<Za[n].priority;n++);Za.splice(n,0,t),n===0&&ob(t)}};function d0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Hh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function bv(){}function JS(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=yh(o);i.call(d)}}var o=C_(e,r,t,0,null,!1,!1,"",bv);return t._reactRootContainer=o,t[ba]=o.current,Yc(t.nodeType===8?t.parentNode:t),co(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=yh(c);l.call(d)}}var c=o0(t,0,!1,null,null,!1,!1,"",bv);return t._reactRootContainer=c,t[ba]=c.current,Yc(t.nodeType===8?t.parentNode:t),co(function(){zh(e,c,n,r)}),c}function Vh(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=yh(o);l.call(c)}}zh(e,o,t,s)}else o=JS(n,e,t,s,r);return yh(o)}rb=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Sc(e.pendingLanes);n!==0&&(Eg(e,n|1),kr(e,yn()),!(jt&6)&&(jl=yn()+500,vi()))}break;case 13:co(function(){var r=_a(t,1);if(r!==null){var s=fr();js(r,t,1,s)}}),l0(t,1)}};Dg=function(t){if(t.tag===13){var e=_a(t,134217728);if(e!==null){var n=fr();js(e,t,134217728,n)}l0(t,134217728)}};sb=function(t){if(t.tag===13){var e=li(t),n=_a(t,e);if(n!==null){var r=fr();js(n,t,e,r)}l0(t,e)}};ab=function(){return Tt};ib=function(t,e){var n=Tt;try{return Tt=t,e()}finally{Tt=n}};om=function(t,e,n){switch(e){case"input":if(em(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=qh(r);if(!s)throw Error(De(90));Oy(r),em(r,s)}}}break;case"textarea":My(t,n);break;case"select":e=n.value,e!=null&&al(t,!!n.multiple,e,!1)}};Vy=r0;Gy=co;var XS={usingClientEntryPoint:!1,Events:[md,Yo,qh,Wy,Hy,r0]},gc={findFiberByHostInstance:Qi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},QS={bundleType:gc.bundleType,version:gc.version,rendererPackageName:gc.rendererPackageName,rendererConfig:gc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ja.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Yy(t),t===null?null:t.stateNode},findFiberByHostInstance:gc.findFiberByHostInstance||YS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yu.isDisabled&&yu.supportsFiber)try{Lh=yu.inject(QS),Ws=yu}catch{}}$r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XS;$r.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d0(e))throw Error(De(200));return ZS(t,e,null,n)};$r.createRoot=function(t,e){if(!d0(t))throw Error(De(299));var n=!1,r="",s=A_;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=o0(t,1,!1,null,null,n,!1,r,s),t[ba]=e.current,Yc(t.nodeType===8?t.parentNode:t),new c0(e)};$r.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(De(188)):(t=Object.keys(t).join(","),Error(De(268,t)));return t=Yy(e),t=t===null?null:t.stateNode,t};$r.flushSync=function(t){return co(t)};$r.hydrate=function(t,e,n){if(!Hh(e))throw Error(De(200));return Vh(null,t,e,!0,n)};$r.hydrateRoot=function(t,e,n){if(!d0(t))throw Error(De(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=A_;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=C_(e,null,t,1,n??null,s,!1,i,o),t[ba]=e.current,Yc(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Wh(e)};$r.render=function(t,e,n){if(!Hh(e))throw Error(De(200));return Vh(null,t,e,!1,n)};$r.unmountComponentAtNode=function(t){if(!Hh(t))throw Error(De(40));return t._reactRootContainer?(co(function(){Vh(null,null,t,!1,function(){t._reactRootContainer=null,t[ba]=null})}),!0):!1};$r.unstable_batchedUpdates=r0;$r.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Hh(n))throw Error(De(200));if(t==null||t._reactInternals===void 0)throw Error(De(38));return Vh(t,e,n,!1,r)};$r.version="18.3.1-next-f1338f8080-20240426";function E_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(E_)}catch(t){console.error(t)}}E_(),Ey.exports=$r;var ek=Ey.exports,_v=ek;Gp.createRoot=_v.createRoot,Gp.hydrateRoot=_v.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ad(){return ad=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ad.apply(this,arguments)}var ei;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ei||(ei={}));const xv="popstate";function tk(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:l}=r.location;return Bm("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:bh(s)}return rk(e,n,null,t)}function en(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function D_(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function nk(){return Math.random().toString(36).substr(2,8)}function wv(t,e){return{usr:t.state,key:t.key,idx:e}}function Bm(t,e,n,r){return n===void 0&&(n=null),ad({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?El(e):e,{state:n,key:e&&e.key||r||nk()})}function bh(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function El(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function rk(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l=ei.Pop,c=null,d=u();d==null&&(d=0,o.replaceState(ad({},o.state,{idx:d}),""));function u(){return(o.state||{idx:null}).idx}function p(){l=ei.Pop;let w=u(),y=w==null?null:w-d;d=w,c&&c({action:l,location:k.location,delta:y})}function g(w,y){l=ei.Push;let _=Bm(k.location,w,y);d=u()+1;let S=wv(_,d),N=k.createHref(_);try{o.pushState(S,"",N)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;s.location.assign(N)}i&&c&&c({action:l,location:k.location,delta:1})}function m(w,y){l=ei.Replace;let _=Bm(k.location,w,y);d=u();let S=wv(_,d),N=k.createHref(_);o.replaceState(S,"",N),i&&c&&c({action:l,location:k.location,delta:0})}function j(w){let y=s.location.origin!=="null"?s.location.origin:s.location.href,_=typeof w=="string"?w:bh(w);return _=_.replace(/ $/,"%20"),en(y,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,y)}let k={get action(){return l},get location(){return t(s,o)},listen(w){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(xv,p),c=w,()=>{s.removeEventListener(xv,p),c=null}},createHref(w){return e(s,w)},createURL:j,encodeLocation(w){let y=j(w);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:g,replace:m,go(w){return o.go(w)}};return k}var jv;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(jv||(jv={}));function sk(t,e,n){return n===void 0&&(n="/"),ak(t,e,n)}function ak(t,e,n,r){let s=typeof e=="string"?El(e):e,i=Sl(s.pathname||"/",n);if(i==null)return null;let o=P_(t);ik(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let d=vk(i);l=mk(o[c],d)}return l}function P_(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(en(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let d=di([r,c.relativePath]),u=n.concat(c);i.children&&i.children.length>0&&(en(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),P_(i.children,e,u,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:fk(d,i.index),routesMeta:u})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of L_(i.path))s(i,o,c)}),e}function L_(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=L_(r.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function ik(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:pk(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const ok=/^:[\w-]+$/,lk=3,ck=2,dk=1,uk=10,hk=-2,Sv=t=>t==="*";function fk(t,e){let n=t.split("/"),r=n.length;return n.some(Sv)&&(r+=hk),e&&(r+=ck),n.filter(s=>!Sv(s)).reduce((s,i)=>s+(ok.test(i)?lk:i===""?dk:uk),r)}function pk(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function mk(t,e,n){let{routesMeta:r}=t,s={},i="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],d=l===r.length-1,u=i==="/"?e:e.slice(i.length)||"/",p=Um({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),g=c.route;if(!p)return null;Object.assign(s,p.params),o.push({params:s,pathname:di([i,p.pathname]),pathnameBase:xk(di([i,p.pathnameBase])),route:g}),p.pathnameBase!=="/"&&(i=di([i,p.pathnameBase]))}return o}function Um(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=gk(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((d,u,p)=>{let{paramName:g,isOptional:m}=u;if(g==="*"){let k=l[p]||"";o=i.slice(0,i.length-k.length).replace(/(.)\/+$/,"$1")}const j=l[p];return m&&!j?d[g]=void 0:d[g]=(j||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function gk(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),D_(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function vk(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return D_(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Sl(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function yk(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?El(t):t;return{pathname:n?n.startsWith("/")?n:bk(n,e):e,search:wk(r),hash:jk(s)}}function bk(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function up(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function _k(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function u0(t,e){let n=_k(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function h0(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=El(t):(s=ad({},t),en(!s.pathname||!s.pathname.includes("?"),up("?","pathname","search",s)),en(!s.pathname||!s.pathname.includes("#"),up("#","pathname","hash",s)),en(!s.search||!s.search.includes("#"),up("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=n;else{let p=e.length-1;if(!r&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),p-=1;s.pathname=g.join("/")}l=p>=0?e[p]:"/"}let c=yk(s,l),d=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}const di=t=>t.join("/").replace(/\/\/+/g,"/"),xk=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),wk=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,jk=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Sk(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const T_=["post","put","patch","delete"];new Set(T_);const kk=["get",...T_];new Set(kk);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function id(){return id=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},id.apply(this,arguments)}const Gh=O.createContext(null),I_=O.createContext(null),Sa=O.createContext(null),Kh=O.createContext(null),yi=O.createContext({outlet:null,matches:[],isDataRoute:!1}),R_=O.createContext(null);function Nk(t,e){let{relative:n}=e===void 0?{}:e;Dl()||en(!1);let{basename:r,navigator:s}=O.useContext(Sa),{hash:i,pathname:o,search:l}=Zh(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:di([r,o])),s.createHref({pathname:c,search:l,hash:i})}function Dl(){return O.useContext(Kh)!=null}function mo(){return Dl()||en(!1),O.useContext(Kh).location}function q_(t){O.useContext(Sa).static||O.useLayoutEffect(t)}function Pl(){let{isDataRoute:t}=O.useContext(yi);return t?Mk():Ck()}function Ck(){Dl()||en(!1);let t=O.useContext(Gh),{basename:e,future:n,navigator:r}=O.useContext(Sa),{matches:s}=O.useContext(yi),{pathname:i}=mo(),o=JSON.stringify(u0(s,n.v7_relativeSplatPath)),l=O.useRef(!1);return q_(()=>{l.current=!0}),O.useCallback(function(d,u){if(u===void 0&&(u={}),!l.current)return;if(typeof d=="number"){r.go(d);return}let p=h0(d,JSON.parse(o),i,u.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:di([e,p.pathname])),(u.replace?r.replace:r.push)(p,u.state,u)},[e,r,o,i,t])}function Zh(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=O.useContext(Sa),{matches:s}=O.useContext(yi),{pathname:i}=mo(),o=JSON.stringify(u0(s,r.v7_relativeSplatPath));return O.useMemo(()=>h0(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function Ak(t,e){return Ek(t,e)}function Ek(t,e,n,r){Dl()||en(!1);let{navigator:s}=O.useContext(Sa),{matches:i}=O.useContext(yi),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d=mo(),u;if(e){var p;let w=typeof e=="string"?El(e):e;c==="/"||(p=w.pathname)!=null&&p.startsWith(c)||en(!1),u=w}else u=d;let g=u.pathname||"/",m=g;if(c!=="/"){let w=c.replace(/^\//,"").split("/");m="/"+g.replace(/^\//,"").split("/").slice(w.length).join("/")}let j=sk(t,{pathname:m}),k=Ik(j&&j.map(w=>Object.assign({},w,{params:Object.assign({},l,w.params),pathname:di([c,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?c:di([c,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),i,n,r);return e&&k?O.createElement(Kh.Provider,{value:{location:id({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:ei.Pop}},k):k}function Dk(){let t=Fk(),e=Sk(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return O.createElement(O.Fragment,null,O.createElement("h2",null,"Unexpected Application Error!"),O.createElement("h3",{style:{fontStyle:"italic"}},e),n?O.createElement("pre",{style:s},n):null,null)}const Pk=O.createElement(Dk,null);class Lk extends O.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?O.createElement(yi.Provider,{value:this.props.routeContext},O.createElement(R_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Tk(t){let{routeContext:e,match:n,children:r}=t,s=O.useContext(Gh);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),O.createElement(yi.Provider,{value:e},r)}function Ik(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,l=(s=n)==null?void 0:s.errors;if(l!=null){let u=o.findIndex(p=>p.route.id&&(l==null?void 0:l[p.route.id])!==void 0);u>=0||en(!1),o=o.slice(0,Math.min(o.length,u+1))}let c=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<o.length;u++){let p=o[u];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=u),p.route.id){let{loaderData:g,errors:m}=n,j=p.route.loader&&g[p.route.id]===void 0&&(!m||m[p.route.id]===void 0);if(p.route.lazy||j){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((u,p,g)=>{let m,j=!1,k=null,w=null;n&&(m=l&&p.route.id?l[p.route.id]:void 0,k=p.route.errorElement||Pk,c&&(d<0&&g===0?(Bk("route-fallback"),j=!0,w=null):d===g&&(j=!0,w=p.route.hydrateFallbackElement||null)));let y=e.concat(o.slice(0,g+1)),_=()=>{let S;return m?S=k:j?S=w:p.route.Component?S=O.createElement(p.route.Component,null):p.route.element?S=p.route.element:S=u,O.createElement(Tk,{match:p,routeContext:{outlet:u,matches:y,isDataRoute:n!=null},children:S})};return n&&(p.route.ErrorBoundary||p.route.errorElement||g===0)?O.createElement(Lk,{location:n.location,revalidation:n.revalidation,component:k,error:m,children:_(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):_()},null)}var O_=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(O_||{}),F_=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(F_||{});function Rk(t){let e=O.useContext(Gh);return e||en(!1),e}function qk(t){let e=O.useContext(I_);return e||en(!1),e}function Ok(t){let e=O.useContext(yi);return e||en(!1),e}function M_(t){let e=Ok(),n=e.matches[e.matches.length-1];return n.route.id||en(!1),n.route.id}function Fk(){var t;let e=O.useContext(R_),n=qk(),r=M_();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function Mk(){let{router:t}=Rk(O_.UseNavigateStable),e=M_(F_.UseNavigateStable),n=O.useRef(!1);return q_(()=>{n.current=!0}),O.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,id({fromRouteId:e},i)))},[t,e])}const kv={};function Bk(t,e,n){kv[t]||(kv[t]=!0)}function Uk(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function $m(t){let{to:e,replace:n,state:r,relative:s}=t;Dl()||en(!1);let{future:i,static:o}=O.useContext(Sa),{matches:l}=O.useContext(yi),{pathname:c}=mo(),d=Pl(),u=h0(e,u0(l,i.v7_relativeSplatPath),c,s==="path"),p=JSON.stringify(u);return O.useEffect(()=>d(JSON.parse(p),{replace:n,state:r,relative:s}),[d,p,s,n,r]),null}function vt(t){en(!1)}function $k(t){let{basename:e="/",children:n=null,location:r,navigationType:s=ei.Pop,navigator:i,static:o=!1,future:l}=t;Dl()&&en(!1);let c=e.replace(/^\/*/,"/"),d=O.useMemo(()=>({basename:c,navigator:i,static:o,future:id({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof r=="string"&&(r=El(r));let{pathname:u="/",search:p="",hash:g="",state:m=null,key:j="default"}=r,k=O.useMemo(()=>{let w=Sl(u,c);return w==null?null:{location:{pathname:w,search:p,hash:g,state:m,key:j},navigationType:s}},[c,u,p,g,m,j,s]);return k==null?null:O.createElement(Sa.Provider,{value:d},O.createElement(Kh.Provider,{children:n,value:k}))}function Yh(t){let{children:e,location:n}=t;return Ak(zm(e),n)}new Promise(()=>{});function zm(t,e){e===void 0&&(e=[]);let n=[];return O.Children.forEach(t,(r,s)=>{if(!O.isValidElement(r))return;let i=[...e,s];if(r.type===O.Fragment){n.push.apply(n,zm(r.props.children,i));return}r.type!==vt&&en(!1),!r.props.index||!r.props.children||en(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=zm(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _h(){return _h=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},_h.apply(this,arguments)}function B_(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function zk(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Wk(t,e){return t.button===0&&(!e||e==="_self")&&!zk(t)}const Hk=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Vk=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Gk="6";try{window.__reactRouterVersion=Gk}catch{}const Kk=O.createContext({isTransitioning:!1}),Zk="startTransition",Nv=zw[Zk];function Yk(t){let{basename:e,children:n,future:r,window:s}=t,i=O.useRef();i.current==null&&(i.current=tk({window:s,v5Compat:!0}));let o=i.current,[l,c]=O.useState({action:o.action,location:o.location}),{v7_startTransition:d}=r||{},u=O.useCallback(p=>{d&&Nv?Nv(()=>c(p)):c(p)},[c,d]);return O.useLayoutEffect(()=>o.listen(u),[o,u]),O.useEffect(()=>Uk(r),[r]),O.createElement($k,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:o,future:r})}const Jk=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Xk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,rs=O.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:l,target:c,to:d,preventScrollReset:u,viewTransition:p}=e,g=B_(e,Hk),{basename:m}=O.useContext(Sa),j,k=!1;if(typeof d=="string"&&Xk.test(d)&&(j=d,Jk))try{let S=new URL(window.location.href),N=d.startsWith("//")?new URL(S.protocol+d):new URL(d),T=Sl(N.pathname,m);N.origin===S.origin&&T!=null?d=T+N.search+N.hash:k=!0}catch{}let w=Nk(d,{relative:s}),y=e4(d,{replace:o,state:l,target:c,preventScrollReset:u,relative:s,viewTransition:p});function _(S){r&&r(S),S.defaultPrevented||y(S)}return O.createElement("a",_h({},g,{href:j||w,onClick:k||i?r:_,ref:n,target:c}))}),vn=O.forwardRef(function(e,n){let{"aria-current":r="page",caseSensitive:s=!1,className:i="",end:o=!1,style:l,to:c,viewTransition:d,children:u}=e,p=B_(e,Vk),g=Zh(c,{relative:p.relative}),m=mo(),j=O.useContext(I_),{navigator:k,basename:w}=O.useContext(Sa),y=j!=null&&t4(g)&&d===!0,_=k.encodeLocation?k.encodeLocation(g).pathname:g.pathname,S=m.pathname,N=j&&j.navigation&&j.navigation.location?j.navigation.location.pathname:null;s||(S=S.toLowerCase(),N=N?N.toLowerCase():null,_=_.toLowerCase()),N&&w&&(N=Sl(N,w)||N);const T=_!=="/"&&_.endsWith("/")?_.length-1:_.length;let U=S===_||!o&&S.startsWith(_)&&S.charAt(T)==="/",P=N!=null&&(N===_||!o&&N.startsWith(_)&&N.charAt(_.length)==="/"),b={isActive:U,isPending:P,isTransitioning:y},A=U?r:void 0,$;typeof i=="function"?$=i(b):$=[i,U?"active":null,P?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let D=typeof l=="function"?l(b):l;return O.createElement(rs,_h({},p,{"aria-current":A,className:$,ref:n,style:D,to:c,viewTransition:d}),typeof u=="function"?u(b):u)});var Wm;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Wm||(Wm={}));var Cv;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Cv||(Cv={}));function Qk(t){let e=O.useContext(Gh);return e||en(!1),e}function e4(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:l}=e===void 0?{}:e,c=Pl(),d=mo(),u=Zh(t,{relative:o});return O.useCallback(p=>{if(Wk(p,n)){p.preventDefault();let g=r!==void 0?r:bh(d)===bh(u);c(t,{replace:g,state:s,preventScrollReset:i,relative:o,viewTransition:l})}},[d,c,u,r,s,n,t,i,o,l])}function t4(t,e){e===void 0&&(e={});let n=O.useContext(Kk);n==null&&en(!1);let{basename:r}=Qk(Wm.useViewTransitionState),s=Zh(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=Sl(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=Sl(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Um(s.pathname,o)!=null||Um(s.pathname,i)!=null}const n4=[{id:"sp1",name:"Studio A - Main Film Studio",capacity:20,description:"Large film studio with 5m ceiling, green screen wall, and professional lighting grid",department:"Moving Image",equipment_available:"Green screen (6m x 4m), lighting grid, C-stands, sandbags",status:"available",hourly_booking:!0},{id:"sp2",name:"Studio B - Photography Studio",capacity:8,description:"Medium studio with white cyclorama and product photography setup",department:"Moving Image",equipment_available:"White cyclorama, product table, backdrop support",status:"available",hourly_booking:!0},{id:"sp3",name:"Edit Suite 1",capacity:4,description:"Professional editing room with Mac Studio and dual 4K monitors",department:"Moving Image",equipment_available:'Mac Studio (M2 Ultra), 2x LG 32" 4K monitors, DaVinci Resolve, Adobe CC',status:"available",hourly_booking:!0},{id:"sp4",name:"Edit Suite 2",capacity:4,description:"Editing room with color grading setup",department:"Moving Image",equipment_available:"Mac Studio (M2 Max), calibrated monitor, Blackmagic panel",status:"available",hourly_booking:!0},{id:"sp5",name:"Sound Recording Booth",capacity:3,description:"Acoustically treated recording space",department:"Moving Image",equipment_available:"Rode NT1, audio interface, boom arm, acoustic treatment",status:"available",hourly_booking:!0},{id:"sp6",name:"Animation Lab",capacity:12,description:"Stop-motion and digital animation workspace",department:"Moving Image",equipment_available:"Stop-motion rigs, lighting, animation software",status:"available",hourly_booking:!0},{id:"sp7",name:"Design Lab 1",capacity:16,description:"Computer lab with iMac workstations",department:"Graphic Design",equipment_available:'16x iMac 27" (M3), Adobe CC, Figma, Sketch',status:"available",hourly_booking:!0},{id:"sp8",name:"Design Lab 2",capacity:16,description:"Computer lab with PC workstations",department:"Graphic Design",equipment_available:"16x Dell workstations, Adobe CC, Rhino, AutoCAD",status:"available",hourly_booking:!0},{id:"sp9",name:"Print Workshop",capacity:8,description:"Screen printing and risograph studio",department:"Graphic Design",equipment_available:"Risograph, screen printing stations, drying racks",status:"available",hourly_booking:!0},{id:"sp10",name:"Photography Studio GD",capacity:6,description:"Product photography studio for graphic design students",department:"Graphic Design",equipment_available:"Backdrop system, strobes, shooting table",status:"available",hourly_booking:!0},{id:"sp11",name:"Critique Room",capacity:20,description:"Presentation space with projector and pin-up walls",department:"Graphic Design",equipment_available:"4K projector, pin boards, presentation podium",status:"available",hourly_booking:!0},{id:"sp12",name:"Illustration Studio 1",capacity:18,description:"Traditional illustration workspace with natural light",department:"Illustration",equipment_available:"Drawing tables, easels, natural north-facing light",status:"available",hourly_booking:!0},{id:"sp13",name:"Illustration Studio 2",capacity:18,description:"Mixed media workspace",department:"Illustration",equipment_available:"Drawing tables, sink, storage cabinets",status:"available",hourly_booking:!0},{id:"sp14",name:"Digital Illustration Lab",capacity:12,description:"Computer lab with Cintiq displays",department:"Illustration",equipment_available:"12x Wacom Cintiq 22, Adobe CC, Procreate on iPad",status:"available",hourly_booking:!0},{id:"sp15",name:"Life Drawing Studio",capacity:20,description:"Large studio for life drawing sessions",department:"Illustration",equipment_available:"Easels, model platform, adjustable lighting",status:"available",hourly_booking:!0}],r4=[{id:"bk1",user_id:"4",equipment_id:"eq1",start_date:"2025-10-05",end_date:"2025-10-08",status:"pending",purpose:"Final year film project - documentary shoot",created_at:"2025-10-01T10:00:00Z"},{id:"bk2",user_id:"10",equipment_id:"eq3",start_date:"2025-10-06",end_date:"2025-10-09",status:"pending",purpose:"Narrative short film - location filming",created_at:"2025-10-01T11:30:00Z"},{id:"bk3",user_id:"15",equipment_id:"eq49",start_date:"2025-10-07",end_date:"2025-10-10",status:"pending",purpose:"Music video production - studio setup",created_at:"2025-10-01T14:00:00Z"},{id:"bk4",user_id:"20",equipment_id:"eq88",start_date:"2025-10-08",end_date:"2025-10-11",status:"pending",purpose:"Commercial project requiring smooth camera movement",created_at:"2025-10-01T15:45:00Z"},{id:"bk5",user_id:"25",equipment_id:"eq101",start_date:"2025-10-09",end_date:"2025-10-12",status:"pending",purpose:"Video editing for thesis project",created_at:"2025-10-01T16:20:00Z"},{id:"bk6",user_id:"12",equipment_id:"eq4",start_date:"2025-10-03",end_date:"2025-10-06",status:"approved",purpose:"Interview series for documentary",created_at:"2025-09-28T09:00:00Z",approved_by:"2",approved_at:"2025-09-29T10:00:00Z"},{id:"bk7",user_id:"18",equipment_id:"eq12",start_date:"2025-10-04",end_date:"2025-10-07",status:"approved",purpose:"Event coverage - college open day",created_at:"2025-09-29T11:00:00Z",approved_by:"2",approved_at:"2025-09-30T14:00:00Z"},{id:"bk8",user_id:"22",equipment_id:"eq22",start_date:"2025-10-02",end_date:"2025-10-05",status:"approved",purpose:"Action shots for skateboarding documentary",created_at:"2025-09-27T13:00:00Z",approved_by:"2",approved_at:"2025-09-28T09:00:00Z"},{id:"bk9",user_id:"30",equipment_id:"eq31",start_date:"2025-10-05",end_date:"2025-10-08",status:"approved",purpose:"Portrait project using shallow depth of field",created_at:"2025-09-30T10:00:00Z",approved_by:"2",approved_at:"2025-10-01T09:00:00Z"},{id:"bk10",user_id:"35",equipment_id:"eq48",start_date:"2025-10-06",end_date:"2025-10-09",status:"approved",purpose:"Studio lighting for product photography",created_at:"2025-10-01T08:00:00Z",approved_by:"2",approved_at:"2025-10-01T10:30:00Z"},{id:"bk11",user_id:"40",equipment_id:"eq77",start_date:"2025-10-04",end_date:"2025-10-07",status:"approved",purpose:"Podcast recording series",created_at:"2025-09-29T15:00:00Z",approved_by:"5",approved_at:"2025-09-30T11:00:00Z"},{id:"bk12",user_id:"45",equipment_id:"eq102",start_date:"2025-10-03",end_date:"2025-10-10",status:"approved",purpose:"Motion graphics project for client brief",created_at:"2025-09-28T12:00:00Z",approved_by:"5",approved_at:"2025-09-29T09:00:00Z"},{id:"bk13",user_id:"50",equipment_id:"eq110",start_date:"2025-10-05",end_date:"2025-10-08",status:"approved",purpose:"Digital illustration for exhibition",created_at:"2025-09-30T14:00:00Z",approved_by:"5",approved_at:"2025-10-01T08:00:00Z"},{id:"bk14",user_id:"14",equipment_id:"eq5",start_date:"2025-09-20",end_date:"2025-09-23",status:"completed",purpose:"Short film production",created_at:"2025-09-15T10:00:00Z",approved_by:"2",approved_at:"2025-09-16T09:00:00Z",returned_at:"2025-09-23T15:00:00Z"},{id:"bk15",user_id:"19",equipment_id:"eq10",start_date:"2025-09-18",end_date:"2025-09-21",status:"completed",purpose:"Wedding videography practice",created_at:"2025-09-13T11:00:00Z",approved_by:"2",approved_at:"2025-09-14T10:00:00Z",returned_at:"2025-09-21T14:00:00Z"},{id:"bk16",user_id:"26",equipment_id:"eq50",start_date:"2025-09-15",end_date:"2025-09-18",status:"completed",purpose:"Studio portrait lighting",created_at:"2025-09-10T09:00:00Z",approved_by:"2",approved_at:"2025-09-11T08:00:00Z",returned_at:"2025-09-18T16:00:00Z"},{id:"bk17",user_id:"32",equipment_id:"eq75",start_date:"2025-09-22",end_date:"2025-09-25",status:"completed",purpose:"Interview audio recording",created_at:"2025-09-17T12:00:00Z",approved_by:"2",approved_at:"2025-09-18T09:00:00Z",returned_at:"2025-09-25T11:00:00Z"},{id:"bk18",user_id:"42",equipment_id:"eq103",start_date:"2025-09-19",end_date:"2025-09-26",status:"completed",purpose:"Graphic design portfolio work",created_at:"2025-09-14T10:00:00Z",approved_by:"5",approved_at:"2025-09-15T09:00:00Z",returned_at:"2025-09-26T15:00:00Z"},{id:"bk19",user_id:"16",equipment_id:"eq1",start_date:"2025-10-10",end_date:"2025-10-20",status:"denied",purpose:"Personal project",created_at:"2025-09-25T10:00:00Z",approved_by:"2",approved_at:"2025-09-26T09:00:00Z",denial_reason:"Booking period too long. Maximum 7 days for high-value equipment."},{id:"bk20",user_id:"28",equipment_id:"eq49",start_date:"2025-10-12",end_date:"2025-10-15",status:"denied",purpose:"Testing",created_at:"2025-09-27T11:00:00Z",approved_by:"2",approved_at:"2025-09-28T10:00:00Z",denial_reason:"Insufficient justification for professional lighting equipment. Please provide project details."},{id:"bk21",user_id:"24",equipment_id:"eq20",start_date:"2025-09-25",end_date:"2025-09-28",status:"overdue",purpose:"Action camera for sports filming",created_at:"2025-09-20T10:00:00Z",approved_by:"2",approved_at:"2025-09-21T09:00:00Z"},{id:"bk22",user_id:"38",equipment_id:"eq86",start_date:"2025-10-01",end_date:"2025-10-04",status:"cancelled",purpose:"Gimbal test for project",created_at:"2025-09-26T12:00:00Z",approved_by:"2",approved_at:"2025-09-27T10:00:00Z",cancelled_at:"2025-09-30T14:00:00Z"},{id:"bk23",user_id:"70",equipment_id:"eq141",start_date:"2025-10-06",end_date:"2025-10-09",status:"pending",purpose:"Digital painting for illustrated book project",created_at:"2025-10-01T12:00:00Z"},{id:"bk24",user_id:"75",equipment_id:"eq143",start_date:"2025-10-07",end_date:"2025-10-10",status:"pending",purpose:"Character design illustrations",created_at:"2025-10-01T13:30:00Z"},{id:"bk25",user_id:"55",equipment_id:"eq124",start_date:"2025-10-08",end_date:"2025-10-11",status:"pending",purpose:"High-resolution product photography for portfolio",created_at:"2025-10-01T14:45:00Z"}],s4=[{id:"sb1",user_id:"3",space_id:"sp1",booking_date:"2025-10-02",start_time:"09:00",end_time:"13:00",status:"approved",purpose:"Green screen filming for student project",created_at:"2025-09-28T10:00:00Z"},{id:"sb2",user_id:"3",space_id:"sp3",booking_date:"2025-10-03",start_time:"14:00",end_time:"18:00",status:"approved",purpose:"Video editing session",created_at:"2025-09-29T11:00:00Z"},{id:"sb3",user_id:"7",space_id:"sp6",booking_date:"2025-10-04",start_time:"10:00",end_time:"16:00",status:"approved",purpose:"Stop-motion animation workshop",created_at:"2025-09-30T09:00:00Z"},{id:"sb4",user_id:"8",space_id:"sp7",booking_date:"2025-10-05",start_time:"09:00",end_time:"12:00",status:"approved",purpose:"Design critique session with students",created_at:"2025-10-01T08:00:00Z"},{id:"sb5",user_id:"6",space_id:"sp12",booking_date:"2025-10-05",start_time:"13:00",end_time:"17:00",status:"approved",purpose:"Traditional illustration workshop",created_at:"2025-10-01T09:00:00Z"},{id:"sb6",user_id:"12",space_id:"sp2",booking_date:"2025-10-06",start_time:"10:00",end_time:"14:00",status:"pending",purpose:"Product photography shoot",created_at:"2025-10-01T10:00:00Z"},{id:"sb7",user_id:"41",space_id:"sp10",booking_date:"2025-10-06",start_time:"14:00",end_time:"18:00",status:"pending",purpose:"Portfolio photography session",created_at:"2025-10-01T11:00:00Z"},{id:"sb8",user_id:"72",space_id:"sp15",booking_date:"2025-10-07",start_time:"09:00",end_time:"13:00",status:"pending",purpose:"Life drawing practice",created_at:"2025-10-01T12:00:00Z"},{id:"sb9",user_id:"18",space_id:"sp5",booking_date:"2025-10-07",start_time:"15:00",end_time:"17:00",status:"pending",purpose:"Voiceover recording for film",created_at:"2025-10-01T13:00:00Z"},{id:"sb10",user_id:"52",space_id:"sp9",booking_date:"2025-10-08",start_time:"10:00",end_time:"16:00",status:"pending",purpose:"Screen printing posters",created_at:"2025-10-01T14:00:00Z"}],a4=[{id:"ff1",name:"room_booking",enabled:!0,description:"Enable room/space booking for staff",required_role:"staff"},{id:"ff2",name:"analytics_export",enabled:!0,description:"Enable analytics export (CSV/PDF)",required_role:"admin"},{id:"ff3",name:"equipment_notes",enabled:!0,description:"Enable equipment maintenance notes",required_role:"admin"},{id:"ff4",name:"csv_import",enabled:!1,description:"Enable CSV import for users/equipment",required_role:"master_admin"},{id:"ff5",name:"email_notifications",enabled:!1,description:"Enable email notifications via EmailJS",required_role:"admin"}],i4=[{id:"usa1",user_id:"4",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa2",user_id:"10",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa3",user_id:"11",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa4",user_id:"12",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa5",user_id:"13",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa6",user_id:"14",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa7",user_id:"15",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa8",user_id:"16",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa9",user_id:"17",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa10",user_id:"18",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa11",user_id:"19",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa12",user_id:"20",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa13",user_id:"21",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa14",user_id:"22",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa15",user_id:"23",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa16",user_id:"24",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa17",user_id:"25",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa18",user_id:"26",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa19",user_id:"27",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa20",user_id:"28",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa21",user_id:"29",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa22",user_id:"30",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa23",user_id:"31",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa24",user_id:"32",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa25",user_id:"33",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa26",user_id:"34",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa27",user_id:"35",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa28",user_id:"36",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa29",user_id:"37",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa30",user_id:"38",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa31",user_id:"39",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa32",user_id:"40",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa33",user_id:"41",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa34",user_id:"42",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa35",user_id:"43",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa36",user_id:"44",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa37",user_id:"45",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa38",user_id:"46",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa39",user_id:"47",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa40",user_id:"48",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa41",user_id:"49",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa42",user_id:"50",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa43",user_id:"51",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa44",user_id:"52",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa45",user_id:"53",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa46",user_id:"54",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa47",user_id:"55",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa48",user_id:"56",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa49",user_id:"57",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa50",user_id:"58",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa51",user_id:"59",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa52",user_id:"60",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa53",user_id:"61",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa54",user_id:"62",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa55",user_id:"63",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa56",user_id:"64",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa57",user_id:"65",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa58",user_id:"66",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa59",user_id:"67",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa60",user_id:"68",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa61",user_id:"69",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa62",user_id:"70",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa63",user_id:"71",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa64",user_id:"72",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa65",user_id:"73",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa66",user_id:"74",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa67",user_id:"75",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa68",user_id:"76",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa69",user_id:"77",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa70",user_id:"78",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa71",user_id:"79",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa72",user_id:"80",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa73",user_id:"81",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa74",user_id:"82",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa75",user_id:"83",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa76",user_id:"84",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa77",user_id:"85",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa78",user_id:"86",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa79",user_id:"87",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa80",user_id:"88",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa81",user_id:"89",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa82",user_id:"90",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa83",user_id:"91",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa84",user_id:"92",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa85",user_id:"93",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa86",user_id:"94",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa87",user_id:"95",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa88",user_id:"96",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa89",user_id:"97",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa90",user_id:"98",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa91",user_id:"99",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa92",user_id:"100",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa93",user_id:"3",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa94",user_id:"7",sub_area_id:"sa5",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa95",user_id:"8",sub_area_id:"sa7",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"},{id:"usa96",user_id:"6",sub_area_id:"sa4",assigned_at:"2024-09-01T00:00:00Z",assigned_by:"1"}],o4=[{id:"ida1",from_sub_area_id:"sa5",to_sub_area_id:"sa6",granted_by:"1",granted_at:"2024-09-01T00:00:00Z",expires_at:null,is_active:!0,notes:"For collaborative film/photo projects"},{id:"ida2",from_sub_area_id:"sa4",to_sub_area_id:"sa7",granted_by:"1",granted_at:"2024-09-01T00:00:00Z",expires_at:null,is_active:!0,notes:"For digital illustration workflows"},{id:"ida3",from_sub_area_id:"sa2",to_sub_area_id:"sa5",granted_by:"1",granted_at:"2024-09-01T00:00:00Z",expires_at:"2024-12-01T00:00:00Z",is_active:!0,notes:"Semester 1 video art project"},{id:"ida4",from_sub_area_id:"sa1",to_sub_area_id:"sa7",granted_by:"1",granted_at:"2024-09-01T00:00:00Z",expires_at:null,is_active:!0,notes:"Interdisciplinary design projects"},{id:"ida5",from_sub_area_id:"sa1",to_sub_area_id:"sa4",granted_by:"1",granted_at:"2024-09-01T00:00:00Z",expires_at:null,is_active:!0,notes:"Illustration for communication design"}],l4=[{id:"ar1",requesting_admin_id:"2",from_sub_area_id:"sa5",to_sub_area_id:"sa6",status:"pending",reason:"Our students need access to DSLR cameras for film photography projects in Semester 2",requested_at:"2025-09-25T10:00:00Z",reviewed_by:null,reviewed_at:null,notes:null},{id:"ar2",requesting_admin_id:"104",from_sub_area_id:"sa4",to_sub_area_id:"sa7",status:"approved",reason:"Students need access to digital design tools for illustration workflows",requested_at:"2025-09-15T09:30:00Z",reviewed_by:"1",reviewed_at:"2025-09-16T14:20:00Z",notes:"Approved - interdisciplinary access grant created (ida2)"},{id:"ar3",requesting_admin_id:"5",from_sub_area_id:"sa7",to_sub_area_id:"sa2",status:"denied",reason:"Students want to experiment with fine art media for experimental design projects",requested_at:"2025-09-10T11:00:00Z",reviewed_by:"1",reviewed_at:"2025-09-12T10:15:00Z",notes:"Denied - Fine Art equipment is limited and prioritized for Fine Art students. Please submit specific project proposals for case-by-case approval."},{id:"ar4",requesting_admin_id:"103",from_sub_area_id:"sa3",to_sub_area_id:"sa5",status:"pending",reason:"Need video equipment to document sculpture installations and create time-lapse videos",requested_at:"2025-09-28T14:45:00Z",reviewed_by:null,reviewed_at:null,notes:null},{id:"ar5",requesting_admin_id:"101",from_sub_area_id:"sa1",to_sub_area_id:"sa4",status:"approved",reason:"Communication Design students need illustration tablets for visual communication projects",requested_at:"2025-09-01T08:00:00Z",reviewed_by:"1",reviewed_at:"2025-09-02T09:00:00Z",notes:"Approved - interdisciplinary access grant created (ida5)"},{id:"ar6",requesting_admin_id:"105",from_sub_area_id:"sa6",to_sub_area_id:"sa5",status:"pending",reason:"Need access to LED lighting equipment for studio photography sessions",requested_at:"2025-09-30T13:20:00Z",reviewed_by:null,reviewed_at:null,notes:null}],c4=[{key:"cross_department_browsing_enabled",value:!1,description:"Allow students to browse equipment from other departments",modified_by:"1",modified_at:"2024-01-15T10:00:00Z"},{key:"cross_department_booking_enabled",value:!1,description:"Allow students to book equipment from other departments",modified_by:"1",modified_at:"2024-01-15T10:00:00Z"},{key:"cross_department_approval_required",value:!0,description:"Require department admin approval for cross-department bookings",modified_by:"1",modified_at:"2024-01-15T10:00:00Z"},{key:"staff_cross_department_requests_enabled",value:!0,description:"Allow staff to request equipment from other departments",modified_by:"1",modified_at:"2024-01-15T10:00:00Z"},{key:"equipment_kits_enabled",value:!0,description:"Enable equipment kit functionality for department admins",modified_by:"1",modified_at:"2024-01-15T10:00:00Z"},{key:"room_bookings_enabled",value:!0,description:"Master toggle for entire room bookings system",modified_by:"1",modified_at:"2024-01-15T10:00:00Z"},{key:"room_bookings_visible_staff",value:!0,description:"Show room bookings in Staff portal",modified_by:"1",modified_at:"2024-01-15T10:00:00Z"},{key:"room_bookings_visible_dept_admin",value:!0,description:"Show room bookings in Department Admin portal",modified_by:"1",modified_at:"2024-01-15T10:00:00Z"}],d4=[{id:"kit1",name:"Video Production Starter Kit",description:"Complete kit for basic video production - camera, tripod, mic, lighting",department_id:"COMMUNICATION_DESIGN",created_by:"2",created_at:"2024-02-01T14:00:00Z",is_active:!0,equipment_ids:["eq3","eq24","eq30","eq21"],image_url:"https://example.com/video-kit.jpg"},{id:"kit2",name:"Photography Essentials",description:"Essential photography kit - DSLR, tripod, reflector",department_id:"COMMUNICATION_DESIGN",created_by:"2",created_at:"2024-02-01T14:30:00Z",is_active:!0,equipment_ids:["eq4","eq25","eq40"],image_url:"https://example.com/photo-kit.jpg"},{id:"kit3",name:"Illustration Digital Kit",description:"Digital illustration setup - iPad Pro with Apple Pencil",department_id:"COMMUNICATION_DESIGN",created_by:"2",created_at:"2024-02-01T15:00:00Z",is_active:!0,equipment_ids:["eq16","eq17"],image_url:"https://example.com/illustration-kit.jpg"},{id:"kit4",name:"3D Printing Starter Kit",description:"Complete 3D printing setup with laptop and printer",department_id:"PRODUCT_DESIGN",created_by:"3",created_at:"2024-02-02T10:00:00Z",is_active:!0,equipment_ids:["eq41","eq46"],image_url:"https://example.com/3d-print-kit.jpg"},{id:"kit5",name:"VR Development Kit",description:"VR development setup - Quest 3 headset with development laptop",department_id:"PRODUCT_DESIGN",created_by:"3",created_at:"2024-02-02T10:30:00Z",is_active:!0,equipment_ids:["eq50","eq47"],image_url:"https://example.com/vr-kit.jpg"}],u4=[{id:"req1",requesting_user_id:"14",requesting_department_id:"COMMUNICATION_DESIGN",target_department_id:"MEDIA",equipment_type:"Canon 250D DSLR Kit",quantity:6,start_date:"2024-03-15",end_date:"2024-03-20",justification:"Running a 5-day video workshop for Fine Art Media students. Need 6 cameras for hands-on practice. Our department only has 2 available during this period.",status:"pending",created_at:"2024-02-20T09:00:00Z"},{id:"req2",requesting_user_id:"16",requesting_department_id:"PAINTING",target_department_id:"COMMUNICATION_DESIGN",equipment_type:'iPad Pro 12.9" + Apple Pencil',quantity:3,start_date:"2024-03-10",end_date:"2024-03-12",justification:"Digital painting workshop. Need tablets for student demonstrations.",status:"approved",reviewed_by:"2",reviewed_at:"2024-02-21T14:30:00Z",review_notes:"Approved. Equipment available for collection on March 10th at 9 AM from Room 204. Please return by 5 PM on March 12th. Contact me at admin.commdesign@ncad.ie if you need setup assistance.",created_at:"2024-02-20T11:00:00Z"},{id:"req3",requesting_user_id:"19",requesting_department_id:"SCULPTURE_APPLIED_MATERIALS",target_department_id:"PRODUCT_DESIGN",equipment_type:"Prusa i3 MK3S+ 3D Printer",quantity:2,start_date:"2024-03-01",end_date:"2024-03-05",justification:"Sculpture students need to print mold prototypes for ceramics project.",status:"denied",reviewed_by:"3",reviewed_at:"2024-02-21T16:00:00Z",review_notes:"Unfortunately our 3D printers are fully booked for our final year projects during this period. Please try again for a different date or contact Fine Art Media who may have alternative equipment.",created_at:"2024-02-20T15:00:00Z"},{id:"req4",requesting_user_id:"18",requesting_department_id:"MEDIA",target_department_id:"PRODUCT_DESIGN",equipment_type:"Meta Quest 3 VR Headset",quantity:1,start_date:"2024-03-18",end_date:"2024-03-22",justification:"VR installation project for photography student. Need headset for viewer interaction testing.",status:"pending",created_at:"2024-02-22T10:00:00Z"}],h4=[{id:"kitbook1",kit_id:"kit1",booking_ids:["book201","book202","book203","book204"],user_id:"24",start_date:"2024-03-05",end_date:"2024-03-08",status:"approved",created_at:"2024-02-25T11:00:00Z"},{id:"kitbook2",kit_id:"kit3",booking_ids:["book205","book206"],user_id:"25",start_date:"2024-03-10",end_date:"2024-03-12",status:"pending",created_at:"2024-02-26T14:00:00Z"}],f4=[{id:"grant1",requesting_department_id:"COMMUNICATION_DESIGN",lending_department_id:"MEDIA",equipment_type:"Sony A7 III Mirrorless Camera",quantity_available:3,start_date:"2024-03-01",end_date:"2024-06-30",status:"active",approved_by_lending_admin:"6",approved_by_master_admin:"1",collection_instructions:"Equipment available for collection from Media Department (Room 304, 3rd Floor). Collection hours: Mon-Fri 9 AM - 5 PM. Contact Lisa O'Brien at admin.media.photo@ncad.ie to arrange pickup. Please return equipment to the same location by 4 PM on your end date.",terms:"Students must handle equipment with care. Any damage must be reported immediately. Equipment must be returned on time or access will be revoked.",created_at:"2024-02-28T10:00:00Z",approved_at:"2024-02-28T14:30:00Z"},{id:"grant2",requesting_department_id:"PAINTING",lending_department_id:"COMMUNICATION_DESIGN",equipment_type:'iPad Pro 12.9" + Apple Pencil',quantity_available:5,start_date:"2024-03-10",end_date:"2024-04-30",status:"active",approved_by_lending_admin:"2",approved_by_master_admin:"1",collection_instructions:"iPad Pros available from Communication Design Equipment Store (Room 102, Ground Floor). Collection: Mon-Fri 10 AM - 4 PM. Contact Sarah Johnson at admin.commdesign@ncad.ie. Return to same location.",terms:"iPads must be returned fully charged. Do not install personal apps. Report any technical issues immediately.",created_at:"2024-03-08T11:00:00Z",approved_at:"2024-03-09T09:00:00Z"},{id:"grant3",requesting_department_id:"MEDIA",lending_department_id:"PRODUCT_DESIGN",equipment_type:"Meta Quest 3 VR Headset",quantity_available:2,start_date:"2024-03-15",end_date:"2024-05-15",status:"active",approved_by_lending_admin:"3",approved_by_master_admin:"1",collection_instructions:"VR headsets available from Product Design Lab (Room 205, 2nd Floor). Book collection time via admin.product@ncad.ie 24 hours in advance. Return with all accessories (controllers, charging cable, case).",terms:"Handle VR equipment with extreme care. Clean lenses before return. Maximum loan period: 3 days per booking.",created_at:"2024-03-12T14:00:00Z",approved_at:"2024-03-13T10:30:00Z"}],p4=[{id:"sa_comm_design",name:"Communication Design",school:"School of Design",created_at:"2024-01-01"},{id:"sa_product",name:"Product Design",school:"School of Design",created_at:"2024-01-01"},{id:"sa_painting",name:"Painting",school:"School of Fine Art",created_at:"2024-01-01"},{id:"sa_print",name:"Print",school:"School of Fine Art",created_at:"2024-01-01"},{id:"sa_media",name:"Media",school:"School of Fine Art",created_at:"2024-01-01"},{id:"sa_sculpture",name:"Sculpture & Applied Materials",school:"School of Fine Art",created_at:"2024-01-01"},{id:"sa_education",name:"Education",school:"School of Education",created_at:"2024-01-01"},{id:"sa_visual_culture",name:"Visual Culture",school:"School of Visual Culture",created_at:"2024-01-01"},{id:"sa_fy_ground",name:"First Year - Ground Floor",school:"First Year Studies",created_at:"2024-01-01"},{id:"sa_fy_top",name:"First Year - Top Floor",school:"First Year Studies",created_at:"2024-01-01"}],m4=[{id:"1",email:"master@ncad.ie",password:"master123",first_name:"Master",surname:"Admin",full_name:"Master Admin",role:"master_admin",department:"COMMUNICATION_DESIGN",created_at:"2024-01-01"},{id:"201",email:"viewonly@ncad.ie",password:"demo123",first_name:"View",surname:"Only",full_name:"View Only Staff",role:"view_only_staff",department:"COMMUNICATION_DESIGN",created_at:"2024-03-01",view_permissions:{can_view_catalog:!0,can_create_bookings:!1,can_view_history:!0,can_view_analytics:!1}},{id:"202",email:"accounts@ncad.ie",password:"demo123",first_name:"Accounts",surname:"Officer",full_name:"Accounts Officer",role:"accounts_officer",department:"ADMINISTRATION",created_at:"2024-03-01",finance_permissions:{can_view_costs:!0,can_export_finance:!0,can_view_all_depts:!0}},{id:"203",email:"payroll@ncad.ie",password:"demo123",first_name:"Payroll",surname:"Coordinator",full_name:"Payroll Coordinator",role:"payroll_coordinator",department:"ADMINISTRATION",created_at:"2024-03-01",payroll_permissions:{can_view_staff_allocations:!0,can_export_payroll:!0}},{id:"204",email:"it@ncad.ie",password:"demo123",first_name:"IT",surname:"Support",full_name:"IT Support Technician",role:"it_support",department:"ADMINISTRATION",created_at:"2024-03-01",it_permissions:{can_manage_equipment:!0,can_view_logs:!0,can_reset_passwords:!1}},{id:"205",email:"budget@ncad.ie",password:"demo123",first_name:"Budget",surname:"Manager",full_name:"Budget Manager",role:"budget_manager",department:"ADMINISTRATION",created_at:"2024-03-01",budget_permissions:{can_view_budgets:!0,can_forecast_costs:!0,can_export_reports:!0}},{id:"2",email:"admin.commdesign@ncad.ie",password:"admin123",first_name:"Sarah",surname:"Johnson",full_name:"Sarah Johnson",role:"department_admin",managed_department_id:"sa_comm_design",department:"COMMUNICATION_DESIGN",created_at:"2024-01-15"},{id:"3",email:"admin.product@ncad.ie",password:"admin123",first_name:"Mark",surname:"Williams",full_name:"Mark Williams",role:"department_admin",managed_department_id:"sa_product",department:"PRODUCT_DESIGN",created_at:"2024-01-15"},{id:"4",email:"admin.painting@ncad.ie",password:"admin123",first_name:"Emma",surname:"Clarke",full_name:"Emma Clarke",role:"department_admin",managed_department_id:"sa_painting",department:"PAINTING",created_at:"2024-01-15"},{id:"5",email:"admin.print@ncad.ie",password:"admin123",first_name:"Robert",surname:"Taylor",full_name:"Robert Taylor",role:"department_admin",managed_department_id:"sa_print",department:"PRINT",created_at:"2024-01-15"},{id:"6",email:"admin.media.photo@ncad.ie",password:"admin123",first_name:"Lisa",surname:"O'Brien",full_name:"Lisa O'Brien",role:"department_admin",managed_department_id:"sa_media",department:"MEDIA",media_role:"Photography Admin",created_at:"2024-01-15"},{id:"7",email:"admin.media.video@ncad.ie",password:"admin123",first_name:"David",surname:"Murphy",full_name:"David Murphy",role:"department_admin",managed_department_id:"sa_media",department:"MEDIA",media_role:"Video Studio Admin",created_at:"2024-01-15"},{id:"8",email:"admin.media.physcomp@ncad.ie",password:"admin123",first_name:"Jennifer",surname:"Walsh",full_name:"Jennifer Walsh",role:"department_admin",managed_department_id:"sa_media",department:"MEDIA",media_role:"Physical Computing Admin",created_at:"2024-01-15"},{id:"9",email:"admin.sculpture@ncad.ie",password:"admin123",first_name:"Thomas",surname:"Anderson",full_name:"Thomas Anderson",role:"department_admin",managed_department_id:"sa_sculpture",department:"SCULPTURE_APPLIED_MATERIALS",created_at:"2024-01-15"},{id:"10",email:"admin.education@ncad.ie",password:"admin123",first_name:"Patricia",surname:"Moore",full_name:"Patricia Moore",role:"department_admin",managed_department_id:"sa_education",department:"EDUCATION",created_at:"2024-01-15"},{id:"11",email:"admin.visualculture@ncad.ie",password:"admin123",first_name:"Michael",surname:"Brown",full_name:"Michael Brown",role:"department_admin",managed_department_id:"sa_visual_culture",department:"VISUAL_CULTURE",created_at:"2024-01-15"},{id:"12",email:"admin.fy.ground@ncad.ie",password:"admin123",first_name:"Helen",surname:"Ryan",full_name:"Helen Ryan",role:"department_admin",managed_department_id:"sa_fy_ground",department:"FIRST_YEAR_GROUND_FLOOR",created_at:"2024-01-15"},{id:"13",email:"admin.fy.top@ncad.ie",password:"admin123",first_name:"James",surname:"Kelly",full_name:"James Kelly",role:"department_admin",managed_department_id:"sa_fy_top",department:"FIRST_YEAR_TOP_FLOOR",created_at:"2024-01-15"},{id:"14",email:"staff.commdesign@ncad.ie",password:"staff123",first_name:"Anna",surname:"Collins",full_name:"Anna Collins",role:"staff",department:"COMMUNICATION_DESIGN",managed_department_id:"sa_comm_design",created_at:"2024-02-01",view_permissions:{can_view_catalog:!0,can_create_bookings:!0,can_cancel_bookings:!0,can_view_history:!0,can_view_analytics:!0,can_export_data:!0,can_request_access:!0,email_notifications:!0,modified_by:"admin.commdesign@ncad.ie",modified_at:"2024-02-05T14:30:00Z"}},{id:"15",email:"staff.product@ncad.ie",password:"staff123",first_name:"Brian",surname:"Hughes",full_name:"Brian Hughes",role:"staff",department:"PRODUCT_DESIGN",managed_department_id:"sa_product",created_at:"2024-02-01",view_permissions:{can_view_catalog:!0,can_create_bookings:!0,can_cancel_bookings:!0,can_view_history:!0,can_view_analytics:!1,can_export_data:!1,can_request_access:!0,email_notifications:!0,modified_by:"admin.product@ncad.ie",modified_at:"2024-02-05T14:30:00Z"}},{id:"16",email:"staff.painting@ncad.ie",password:"staff123",first_name:"Claire",surname:"Doyle",full_name:"Claire Doyle",role:"staff",department:"PAINTING",managed_department_id:"sa_painting",created_at:"2024-02-01",view_permissions:{can_view_catalog:!0,can_create_bookings:!0,can_cancel_bookings:!1,can_view_history:!0,can_view_analytics:!1,can_export_data:!1,can_request_access:!0,email_notifications:!0,modified_by:"admin.painting@ncad.ie",modified_at:"2024-02-05T14:30:00Z"}},{id:"17",email:"staff.print@ncad.ie",password:"staff123",first_name:"Daniel",surname:"Quinn",full_name:"Daniel Quinn",role:"staff",department:"PRINT",managed_department_id:"sa_print",created_at:"2024-02-01",view_permissions:{can_view_catalog:!0,can_create_bookings:!0,can_cancel_bookings:!0,can_view_history:!0,can_view_analytics:!1,can_export_data:!1,can_request_access:!0,email_notifications:!0,modified_by:"admin.print@ncad.ie",modified_at:"2024-02-05T14:30:00Z"}},{id:"18",email:"staff.media@ncad.ie",password:"staff123",first_name:"Fiona",surname:"McCarthy",full_name:"Fiona McCarthy",role:"staff",department:"MEDIA",managed_department_id:"sa_media",created_at:"2024-02-01",view_permissions:{can_view_catalog:!0,can_create_bookings:!0,can_cancel_bookings:!0,can_view_history:!0,can_view_analytics:!0,can_export_data:!0,can_request_access:!0,email_notifications:!0,modified_by:"admin.media.photo@ncad.ie",modified_at:"2024-02-05T14:30:00Z"}},{id:"19",email:"staff.sculpture@ncad.ie",password:"staff123",first_name:"Gary",surname:"O'Connor",full_name:"Gary O'Connor",role:"staff",department:"SCULPTURE_APPLIED_MATERIALS",managed_department_id:"sa_sculpture",created_at:"2024-02-01",view_permissions:{can_view_catalog:!0,can_create_bookings:!0,can_cancel_bookings:!1,can_view_history:!0,can_view_analytics:!1,can_export_data:!1,can_request_access:!0,email_notifications:!0,modified_by:"admin.sculpture@ncad.ie",modified_at:"2024-02-05T14:30:00Z"}},{id:"20",email:"staff.education@ncad.ie",password:"staff123",first_name:"Hannah",surname:"Byrne",full_name:"Hannah Byrne",role:"staff",department:"EDUCATION",managed_department_id:"sa_education",created_at:"2024-02-01",view_permissions:{can_view_catalog:!0,can_create_bookings:!0,can_cancel_bookings:!0,can_view_history:!0,can_view_analytics:!1,can_export_data:!1,can_request_access:!0,email_notifications:!0,modified_by:"admin.education@ncad.ie",modified_at:"2024-02-05T14:30:00Z"}},{id:"21",email:"staff.visualculture@ncad.ie",password:"staff123",first_name:"Ian",surname:"Brennan",full_name:"Ian Brennan",role:"staff",department:"VISUAL_CULTURE",managed_department_id:"sa_visual_culture",created_at:"2024-02-01",view_permissions:{can_view_catalog:!0,can_create_bookings:!0,can_cancel_bookings:!1,can_view_history:!0,can_view_analytics:!1,can_export_data:!1,can_request_access:!0,email_notifications:!0,modified_by:"admin.visualculture@ncad.ie",modified_at:"2024-02-05T14:30:00Z"}},{id:"22",email:"staff.fy.ground@ncad.ie",password:"staff123",first_name:"Jane",surname:"Keegan",full_name:"Jane Keegan",role:"staff",department:"FIRST_YEAR_GROUND_FLOOR",managed_department_id:"sa_fy_ground",created_at:"2024-02-01",view_permissions:{can_view_catalog:!0,can_create_bookings:!0,can_cancel_bookings:!0,can_view_history:!0,can_view_analytics:!1,can_export_data:!1,can_request_access:!0,email_notifications:!0,modified_by:"admin.fy.ground@ncad.ie",modified_at:"2024-02-05T14:30:00Z"}},{id:"23",email:"staff.fy.top@ncad.ie",password:"staff123",first_name:"Kevin",surname:"Dunne",full_name:"Kevin Dunne",role:"staff",department:"FIRST_YEAR_TOP_FLOOR",managed_department_id:"sa_fy_top",created_at:"2024-02-01",view_permissions:{can_view_catalog:!0,can_create_bookings:!0,can_cancel_bookings:!0,can_view_history:!0,can_view_analytics:!1,can_export_data:!1,can_request_access:!0,email_notifications:!0,modified_by:"admin.fy.top@ncad.ie",modified_at:"2024-02-05T14:30:00Z"}},...Array.from({length:40},(t,e)=>({id:String(24+e),email:`commdesign.student${e+1}@student.ncad.ie`,password:"student123",first_name:"CommDesign",surname:`Student${e+1}`,full_name:`CommDesign Student${e+1}`,role:"student",department:"COMMUNICATION_DESIGN",created_at:"2024-09-01"})),...Array.from({length:20},(t,e)=>({id:String(64+e),email:`product.student${e+1}@student.ncad.ie`,password:"student123",first_name:"Product",surname:`Student${e+1}`,full_name:`Product Student${e+1}`,role:"student",department:"PRODUCT_DESIGN",created_at:"2024-09-01"})),...Array.from({length:12},(t,e)=>({id:String(84+e),email:`painting.student${e+1}@student.ncad.ie`,password:"student123",first_name:"Painting",surname:`Student${e+1}`,full_name:`Painting Student${e+1}`,role:"student",department:"PAINTING",created_at:"2024-09-01"})),...Array.from({length:10},(t,e)=>({id:String(96+e),email:`print.student${e+1}@student.ncad.ie`,password:"student123",first_name:"Print",surname:`Student${e+1}`,full_name:`Print Student${e+1}`,role:"student",department:"PRINT",created_at:"2024-09-01"})),...Array.from({length:25},(t,e)=>({id:String(106+e),email:`media.student${e+1}@student.ncad.ie`,password:"student123",first_name:"Media",surname:`Student${e+1}`,full_name:`Media Student${e+1}`,role:"student",department:"MEDIA",created_at:"2024-09-01"})),...Array.from({length:10},(t,e)=>({id:String(131+e),email:`sculpture.student${e+1}@student.ncad.ie`,password:"student123",first_name:"Sculpture",surname:`Student${e+1}`,full_name:`Sculpture Student${e+1}`,role:"student",department:"SCULPTURE_APPLIED_MATERIALS",created_at:"2024-09-01"})),...Array.from({length:5},(t,e)=>({id:String(141+e),email:`education.student${e+1}@student.ncad.ie`,password:"student123",first_name:"Education",surname:`Student${e+1}`,full_name:`Education Student${e+1}`,role:"student",department:"EDUCATION",created_at:"2024-09-01"})),...Array.from({length:2},(t,e)=>({id:String(146+e),email:`visualculture.student${e+1}@student.ncad.ie`,password:"student123",first_name:"VisualCulture",surname:`Student${e+1}`,full_name:`VisualCulture Student${e+1}`,role:"student",department:"VISUAL_CULTURE",created_at:"2024-09-01"})),{id:"148",email:"fy.ground.student1@student.ncad.ie",password:"student123",first_name:"FYGround",surname:"Student1",full_name:"FYGround Student1",role:"student",department:"FIRST_YEAR_GROUND_FLOOR",created_at:"2024-09-01"},{id:"149",email:"fy.top.student1@student.ncad.ie",password:"student123",first_name:"FYTop",surname:"Student1",full_name:"FYTop Student1",role:"student",department:"FIRST_YEAR_TOP_FLOOR",created_at:"2024-09-01"},{id:"150",email:"demo@ncad.ie",password:"demo123",first_name:"Demo",surname:"Student",full_name:"Demo Student",role:"student",department:"COMMUNICATION_DESIGN",created_at:"2024-01-01"}],g4=[{id:"eq1",product_name:"Canon EOS R5",tracking_number:"CD-CAM-001",category:"Camera",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Mirrorless full-frame camera",link_to_image:"https://example.com/eosr5.jpg",created_at:"2024-01-10"},{id:"eq2",product_name:"Canon EOS R5",tracking_number:"CD-CAM-002",category:"Camera",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Mirrorless full-frame camera",link_to_image:"https://example.com/eosr5.jpg",created_at:"2024-01-10"},{id:"eq3",product_name:"Canon 250D DSLR Kit",tracking_number:"CD-CAM-003",category:"Camera",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"DSLR kit with 18-55mm lens",link_to_image:"https://example.com/250d.jpg",created_at:"2024-01-10"},{id:"eq4",product_name:"Canon 250D DSLR Kit",tracking_number:"CD-CAM-004",category:"Camera",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"DSLR kit with 18-55mm lens",link_to_image:"https://example.com/250d.jpg",created_at:"2024-01-10"},{id:"eq5",product_name:"Canon 250D DSLR Kit",tracking_number:"CD-CAM-005",category:"Camera",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"DSLR kit with 18-55mm lens",link_to_image:"https://example.com/250d.jpg",created_at:"2024-01-10"},{id:"eq6",product_name:"Canon 250D DSLR Kit",tracking_number:"CD-CAM-006",category:"Camera",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"DSLR kit with 18-55mm lens",link_to_image:"https://example.com/250d.jpg",created_at:"2024-01-10"},{id:"eq7",product_name:"Canon 250D DSLR Kit",tracking_number:"CD-CAM-007",category:"Camera",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"DSLR kit with 18-55mm lens",link_to_image:"https://example.com/250d.jpg",created_at:"2024-01-10"},{id:"eq8",product_name:"Canon 250D DSLR Kit",tracking_number:"CD-CAM-008",category:"Camera",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"DSLR kit with 18-55mm lens",link_to_image:"https://example.com/250d.jpg",created_at:"2024-01-10"},{id:"eq9",product_name:'MacBook Pro 16"',tracking_number:"CD-COMP-001",category:"Computer",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Apple Silicon M2 Pro",link_to_image:"https://example.com/macbookpro.jpg",created_at:"2024-01-10"},{id:"eq10",product_name:'MacBook Pro 16"',tracking_number:"CD-COMP-002",category:"Computer",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Apple Silicon M2 Pro",link_to_image:"https://example.com/macbookpro.jpg",created_at:"2024-01-10"},{id:"eq11",product_name:'MacBook Pro 16"',tracking_number:"CD-COMP-003",category:"Computer",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Apple Silicon M2 Pro",link_to_image:"https://example.com/macbookpro.jpg",created_at:"2024-01-10"},{id:"eq12",product_name:'MacBook Pro 16"',tracking_number:"CD-COMP-004",category:"Computer",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Apple Silicon M2 Pro",link_to_image:"https://example.com/macbookpro.jpg",created_at:"2024-01-10"},{id:"eq13",product_name:'MacBook Pro 16"',tracking_number:"CD-COMP-005",category:"Computer",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Apple Silicon M2 Pro",link_to_image:"https://example.com/macbookpro.jpg",created_at:"2024-01-10"},{id:"eq14",product_name:"Wacom Cintiq Pro 24",tracking_number:"CD-TAB-001",category:"Computer",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Pen display tablet",link_to_image:"https://example.com/cintiq.jpg",created_at:"2024-01-10"},{id:"eq15",product_name:"Wacom Cintiq Pro 24",tracking_number:"CD-TAB-002",category:"Computer",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Pen display tablet",link_to_image:"https://example.com/cintiq.jpg",created_at:"2024-01-10"},{id:"eq16",product_name:'iPad Pro 12.9" + Apple Pencil',tracking_number:"CD-TAB-003",category:"Computer",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Tablet for illustration",link_to_image:"https://example.com/ipadpro.jpg",created_at:"2024-01-10"},{id:"eq17",product_name:'iPad Pro 12.9" + Apple Pencil',tracking_number:"CD-TAB-004",category:"Computer",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Tablet for illustration",link_to_image:"https://example.com/ipadpro.jpg",created_at:"2024-01-10"},{id:"eq18",product_name:'iPad Pro 12.9" + Apple Pencil',tracking_number:"CD-TAB-005",category:"Computer",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Tablet for illustration",link_to_image:"https://example.com/ipadpro.jpg",created_at:"2024-01-10"},{id:"eq19",product_name:"Epson SureColor P800",tracking_number:"CD-PRINT-001",category:"Computer",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Professional photo printer",link_to_image:"https://example.com/epsonp800.jpg",created_at:"2024-01-10"},{id:"eq20",product_name:"Epson SureColor P800",tracking_number:"CD-PRINT-002",category:"Computer",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Professional photo printer",link_to_image:"https://example.com/epsonp800.jpg",created_at:"2024-01-10"},{id:"eq21",product_name:"Godox SL-60W LED Light",tracking_number:"CD-LIGHT-001",category:"Lighting",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Continuous LED light",link_to_image:"https://example.com/sl60.jpg",created_at:"2024-01-10"},{id:"eq22",product_name:"Godox SL-60W LED Light",tracking_number:"CD-LIGHT-002",category:"Lighting",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Continuous LED light",link_to_image:"https://example.com/sl60.jpg",created_at:"2024-01-10"},{id:"eq23",product_name:"Godox SL-60W LED Light",tracking_number:"CD-LIGHT-003",category:"Lighting",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Continuous LED light",link_to_image:"https://example.com/sl60.jpg",created_at:"2024-01-10"},{id:"eq24",product_name:"Manfrotto 055 Tripod",tracking_number:"CD-SUPP-001",category:"Support",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Professional aluminum tripod",link_to_image:"https://example.com/manfrotto055.jpg",created_at:"2024-01-10"},{id:"eq25",product_name:"Manfrotto 055 Tripod",tracking_number:"CD-SUPP-002",category:"Support",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Professional aluminum tripod",link_to_image:"https://example.com/manfrotto055.jpg",created_at:"2024-01-10"},{id:"eq26",product_name:"Manfrotto 055 Tripod",tracking_number:"CD-SUPP-003",category:"Support",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Professional aluminum tripod",link_to_image:"https://example.com/manfrotto055.jpg",created_at:"2024-01-10"},{id:"eq27",product_name:"Manfrotto 055 Tripod",tracking_number:"CD-SUPP-004",category:"Support",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Professional aluminum tripod",link_to_image:"https://example.com/manfrotto055.jpg",created_at:"2024-01-10"},{id:"eq28",product_name:"DJI Ronin-SC Gimbal",tracking_number:"CD-SUPP-005",category:"Support",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Handheld stabilizer",link_to_image:"https://example.com/ronin.jpg",created_at:"2024-01-10"},{id:"eq29",product_name:"DJI Ronin-SC Gimbal",tracking_number:"CD-SUPP-006",category:"Support",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Handheld stabilizer",link_to_image:"https://example.com/ronin.jpg",created_at:"2024-01-10"},{id:"eq30",product_name:"Rode VideoMic Pro+",tracking_number:"CD-AUDIO-001",category:"Camera",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"On-camera microphone",link_to_image:"https://example.com/rodemicpro.jpg",created_at:"2024-01-10"},{id:"eq31",product_name:"Rode VideoMic Pro+",tracking_number:"CD-AUDIO-002",category:"Camera",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"On-camera microphone",link_to_image:"https://example.com/rodemicpro.jpg",created_at:"2024-01-10"},{id:"eq32",product_name:"Zoom H6 Audio Recorder",tracking_number:"CD-AUDIO-003",category:"Camera",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Portable audio recorder",link_to_image:"https://example.com/zoomh6.jpg",created_at:"2024-01-10"},{id:"eq33",product_name:"Zoom H6 Audio Recorder",tracking_number:"CD-AUDIO-004",category:"Camera",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Portable audio recorder",link_to_image:"https://example.com/zoomh6.jpg",created_at:"2024-01-10"},{id:"eq34",product_name:"Blackmagic Pocket Cinema 4K",tracking_number:"CD-CAM-009",category:"Camera",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Digital film camera",link_to_image:"https://example.com/bmpcc4k.jpg",created_at:"2024-01-10"},{id:"eq35",product_name:"Blackmagic Pocket Cinema 4K",tracking_number:"CD-CAM-010",category:"Camera",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Digital film camera",link_to_image:"https://example.com/bmpcc4k.jpg",created_at:"2024-01-10"},{id:"eq36",product_name:"Brother P-touch Label Maker",tracking_number:"CD-MISC-001",category:"Computer",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Label printer",link_to_image:"https://example.com/ptouch.jpg",created_at:"2024-01-10"},{id:"eq37",product_name:"Epson FastFoto FF-680W Scanner",tracking_number:"CD-SCAN-001",category:"Computer",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"High-speed photo scanner",link_to_image:"https://example.com/fastfoto.jpg",created_at:"2024-01-10"},{id:"eq38",product_name:"Epson FastFoto FF-680W Scanner",tracking_number:"CD-SCAN-002",category:"Computer",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"High-speed photo scanner",link_to_image:"https://example.com/fastfoto.jpg",created_at:"2024-01-10"},{id:"eq39",product_name:"X-Rite ColorChecker Passport",tracking_number:"CD-COLOR-001",category:"Camera",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"Color calibration tool",link_to_image:"https://example.com/colorchecker.jpg",created_at:"2024-01-10"},{id:"eq40",product_name:"Lastolite Reflector Kit",tracking_number:"CD-LIGHT-004",category:"Lighting",department:"COMMUNICATION_DESIGN",sub_area_id:"sa_comm_design",status:"available",description:"5-in-1 reflector set",link_to_image:"https://example.com/lastolite.jpg",created_at:"2024-01-10"},{id:"eq41",product_name:"Prusa i3 MK3S+ 3D Printer",tracking_number:"PD-3DP-001",category:"Computer",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"FDM 3D printer",link_to_image:"https://example.com/prusa.jpg",created_at:"2024-01-11"},{id:"eq42",product_name:"Prusa i3 MK3S+ 3D Printer",tracking_number:"PD-3DP-002",category:"Computer",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"FDM 3D printer",link_to_image:"https://example.com/prusa.jpg",created_at:"2024-01-11"},{id:"eq43",product_name:"Prusa i3 MK3S+ 3D Printer",tracking_number:"PD-3DP-003",category:"Computer",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"FDM 3D printer",link_to_image:"https://example.com/prusa.jpg",created_at:"2024-01-11"},{id:"eq44",product_name:"Formlabs Form 3+ SLA Printer",tracking_number:"PD-3DP-004",category:"Computer",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"Resin 3D printer",link_to_image:"https://example.com/form3.jpg",created_at:"2024-01-11"},{id:"eq45",product_name:"Formlabs Form 3+ SLA Printer",tracking_number:"PD-3DP-005",category:"Computer",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"Resin 3D printer",link_to_image:"https://example.com/form3.jpg",created_at:"2024-01-11"},{id:"eq46",product_name:"Dell XPS 15 Laptop",tracking_number:"PD-COMP-001",category:"Computer",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"High-performance laptop",link_to_image:"https://example.com/xps15.jpg",created_at:"2024-01-11"},{id:"eq47",product_name:"Dell XPS 15 Laptop",tracking_number:"PD-COMP-002",category:"Computer",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"High-performance laptop",link_to_image:"https://example.com/xps15.jpg",created_at:"2024-01-11"},{id:"eq48",product_name:"Dell XPS 15 Laptop",tracking_number:"PD-COMP-003",category:"Computer",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"High-performance laptop",link_to_image:"https://example.com/xps15.jpg",created_at:"2024-01-11"},{id:"eq49",product_name:"Dell XPS 15 Laptop",tracking_number:"PD-COMP-004",category:"Computer",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"High-performance laptop",link_to_image:"https://example.com/xps15.jpg",created_at:"2024-01-11"},{id:"eq50",product_name:"Meta Quest 3 VR Headset",tracking_number:"PD-VR-001",category:"Computer",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"Virtual reality headset",link_to_image:"https://example.com/quest3.jpg",created_at:"2024-01-11"},{id:"eq51",product_name:"Meta Quest 3 VR Headset",tracking_number:"PD-VR-002",category:"Computer",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"Virtual reality headset",link_to_image:"https://example.com/quest3.jpg",created_at:"2024-01-11"},{id:"eq52",product_name:"Meta Quest 3 VR Headset",tracking_number:"PD-VR-003",category:"Computer",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"Virtual reality headset",link_to_image:"https://example.com/quest3.jpg",created_at:"2024-01-11"},{id:"eq53",product_name:"Arduino Starter Kit",tracking_number:"PD-ELEC-001",category:"Computer",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"Electronics prototyping kit",link_to_image:"https://example.com/arduino.jpg",created_at:"2024-01-11"},{id:"eq54",product_name:"Arduino Starter Kit",tracking_number:"PD-ELEC-002",category:"Computer",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"Electronics prototyping kit",link_to_image:"https://example.com/arduino.jpg",created_at:"2024-01-11"},{id:"eq55",product_name:"Dremel 4300 Rotary Tool",tracking_number:"PD-TOOL-001",category:"Support",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"Multi-purpose rotary tool",link_to_image:"https://example.com/dremel.jpg",created_at:"2024-01-11"},{id:"eq56",product_name:"Dremel 4300 Rotary Tool",tracking_number:"PD-TOOL-002",category:"Support",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"Multi-purpose rotary tool",link_to_image:"https://example.com/dremel.jpg",created_at:"2024-01-11"},{id:"eq57",product_name:"Caliper Digital Measuring Tool",tracking_number:"PD-MEAS-001",category:"Support",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"Precision measurement",link_to_image:"https://example.com/caliper.jpg",created_at:"2024-01-11"},{id:"eq58",product_name:"Hot Glue Gun Set",tracking_number:"PD-TOOL-003",category:"Support",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"Adhesive tool",link_to_image:"https://example.com/gluegun.jpg",created_at:"2024-01-11"},{id:"eq59",product_name:"Canon EOS 90D DSLR",tracking_number:"PD-CAM-001",category:"Camera",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"Product photography camera",link_to_image:"https://example.com/eos90d.jpg",created_at:"2024-01-11"},{id:"eq60",product_name:"Canon EOS 90D DSLR",tracking_number:"PD-CAM-002",category:"Camera",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"Product photography camera",link_to_image:"https://example.com/eos90d.jpg",created_at:"2024-01-11"},{id:"eq61",product_name:"Godox V1 Flash",tracking_number:"PD-LIGHT-001",category:"Lighting",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"Round head flash",link_to_image:"https://example.com/v1flash.jpg",created_at:"2024-01-11"},{id:"eq62",product_name:"Godox V1 Flash",tracking_number:"PD-LIGHT-002",category:"Lighting",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"Round head flash",link_to_image:"https://example.com/v1flash.jpg",created_at:"2024-01-11"},{id:"eq63",product_name:"Manfrotto Tripod",tracking_number:"PD-SUPP-001",category:"Support",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"Aluminum tripod",link_to_image:"https://example.com/manfrotto.jpg",created_at:"2024-01-11"},{id:"eq64",product_name:"Manfrotto Tripod",tracking_number:"PD-SUPP-002",category:"Support",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"Aluminum tripod",link_to_image:"https://example.com/manfrotto.jpg",created_at:"2024-01-11"},{id:"eq65",product_name:"Wacom Intuos Pro Tablet",tracking_number:"PD-TAB-001",category:"Computer",department:"PRODUCT_DESIGN",sub_area_id:"sa_product",status:"available",description:"Drawing tablet",link_to_image:"https://example.com/wacom.jpg",created_at:"2024-01-11"}],vc="ncadbook_demo_data";class v4{constructor(){this.initializeStorage()}initializeStorage(){if(!localStorage.getItem(vc)){const n={users:m4,equipment:g4,sub_areas:p4,system_settings:c4,equipment_kits:d4,cross_department_requests:u4,kit_bookings:h4,department_access_grants:f4,spaces:n4,bookings:r4,spaceBookings:s4,featureFlags:a4,user_sub_areas:i4,interdisciplinary_access:o4,access_requests:l4,currentUser:null};localStorage.setItem(vc,JSON.stringify(n))}}getData(){const e=localStorage.getItem(vc);return e?JSON.parse(e):null}setData(e){localStorage.setItem(vc,JSON.stringify(e))}saveData(e){this.setData(e)}async query(e,n={}){await this.simulateDelay();let s=this.getData()[e]||[];return Object.keys(n).forEach(i=>{s=s.filter(o=>o[i]===n[i])}),s}async findOne(e,n){return(await this.query(e,n))[0]||null}async insert(e,n){await this.simulateDelay();const r=this.getData();return r[e]||(r[e]=[]),r[e].push(n),this.setData(r),n}async update(e,n,r){await this.simulateDelay();const s=this.getData();let i=0;return s[e]=s[e].map(o=>Object.keys(n).every(c=>o[c]===n[c])?(i++,{...o,...r}):o),this.setData(s),i}async delete(e,n){await this.simulateDelay();const r=this.getData(),s=r[e].length;return r[e]=r[e].filter(i=>!Object.keys(n).every(o=>i[o]===n[o])),this.setData(r),s-r[e].length}setCurrentUser(e){const n=this.getData();n.currentUser=e,this.setData(n)}getCurrentUser(){return this.getData().currentUser}clearCurrentUser(){const e=this.getData();e.currentUser=null,this.setData(e)}simulateDelay(){return new Promise(e=>setTimeout(e,100+Math.random()*200))}reset(){localStorage.removeItem(vc),this.initializeStorage()}}const be=new v4,y4="modulepreload",b4=function(t){return"/NCADbook/"+t},Av={},ui=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=b4(c),c in Av)return;Av[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":y4,d||(p.as="script"),p.crossOrigin="",p.href=c,l&&p.setAttribute("nonce",l),document.head.appendChild(p),d)return new Promise((g,m)=>{p.addEventListener("load",g),p.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})},_4=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>ui(async()=>{const{default:r}=await Promise.resolve().then(()=>Ll);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class f0 extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class Ev extends f0{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Dv extends f0{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Pv extends f0{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Hm;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Hm||(Hm={}));var x4=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(p){o(p)}}function c(u){try{d(r.throw(u))}catch(p){o(p)}}function d(u){u.done?i(u.value):s(u.value).then(l,c)}d((r=r.apply(t,e||[])).next())})};class w4{constructor(e,{headers:n={},customFetch:r,region:s=Hm.Any}={}){this.url=e,this.headers=n,this.region=s,this.fetch=_4(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return x4(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:o,signal:l}=n;let c={},{region:d}=n;d||(d=this.region);const u=new URL(`${this.url}/${e}`);d&&d!=="any"&&(c["x-region"]=d,u.searchParams.set("forceFunctionRegion",d));let p;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",p=o):typeof o=="string"?(c["Content-Type"]="text/plain",p=o):typeof FormData<"u"&&o instanceof FormData?p=o:(c["Content-Type"]="application/json",p=JSON.stringify(o)));const g=yield this.fetch(u.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),s),body:p,signal:l}).catch(w=>{throw w.name==="AbortError"?w:new Ev(w)}),m=g.headers.get("x-relay-error");if(m&&m==="true")throw new Dv(g);if(!g.ok)throw new Pv(g);let j=((r=g.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),k;return j==="application/json"?k=yield g.json():j==="application/octet-stream"?k=yield g.blob():j==="text/event-stream"?k=g:j==="multipart/form-data"?k=yield g.formData():k=yield g.text(),{data:k,error:null,response:g}}catch(s){return s instanceof Error&&s.name==="AbortError"?{data:null,error:new Ev(s)}:{data:null,error:s,response:s instanceof Pv||s instanceof Dv?s.context:void 0}}})}}var xr={},p0={},Jh={},vd={},Xh={},Qh={},j4=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},kl=j4();const S4=kl.fetch,U_=kl.fetch.bind(kl),$_=kl.Headers,k4=kl.Request,N4=kl.Response,Ll=Object.freeze(Object.defineProperty({__proto__:null,Headers:$_,Request:k4,Response:N4,default:U_,fetch:S4},Symbol.toStringTag,{value:"Module"})),C4=Cw(Ll);var ef={};Object.defineProperty(ef,"__esModule",{value:!0});let A4=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};ef.default=A4;var z_=as&&as.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Qh,"__esModule",{value:!0});const E4=z_(C4),D4=z_(ef);let P4=class{constructor(e){var n,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(n=e.shouldThrowOnError)!==null&&n!==void 0?n:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=E4.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=new Headers(this.headers),this.headers.set(e,n),this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,l,c,d;let u=null,p=null,g=null,m=i.status,j=i.statusText;if(i.ok){if(this.method!=="HEAD"){const _=await i.text();_===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((o=this.headers.get("Accept"))===null||o===void 0)&&o.includes("application/vnd.pgrst.plan+text"))?p=_:p=JSON.parse(_))}const w=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),y=(c=i.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");w&&y&&y.length>1&&(g=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(p)&&(p.length>1?(u={code:"PGRST116",details:`Results contain ${p.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},p=null,g=null,m=406,j="Not Acceptable"):p.length===1?p=p[0]:p=null)}else{const w=await i.text();try{u=JSON.parse(w),Array.isArray(u)&&i.status===404&&(p=[],u=null,m=200,j="OK")}catch{i.status===404&&w===""?(m=204,j="No Content"):u={message:w}}if(u&&this.isMaybeSingle&&(!((d=u==null?void 0:u.details)===null||d===void 0)&&d.includes("0 rows"))&&(u=null,m=200,j="OK"),u&&this.shouldThrowOnError)throw new D4.default(u)}return{error:u,data:p,count:g,status:m,statusText:j}});return this.shouldThrowOnError||(s=s.catch(i=>{var o,l,c;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,n)}returns(){return this}overrideTypes(){return this}};Qh.default=P4;var L4=as&&as.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Xh,"__esModule",{value:!0});const T4=L4(Qh);let I4=class extends T4.default{select(e){let n=!1;const r=(e??"*").split("").map(s=>/\s/.test(s)&&!n?"":(s==='"'&&(n=!n),s)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:n=!0,nullsFirst:r,foreignTable:s,referencedTable:i=s}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:r=n}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,n,{foreignTable:r,referencedTable:s=r}={}){const i=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:n=!1,settings:r=!1,buffers:s=!1,wal:i=!1,format:o="text"}={}){var l;const c=[e?"analyze":null,n?"verbose":null,r?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${d}"; options=${c};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};Xh.default=I4;var R4=as&&as.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(vd,"__esModule",{value:!0});const q4=R4(Xh);let O4=class extends q4.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const r=Array.from(new Set(n)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:r,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${o}.${n}`),this}match(e){return Object.entries(e).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(e,n,r){return this.url.searchParams.append(e,`not.${n}.${r}`),this}or(e,{foreignTable:n,referencedTable:r=n}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,n,r){return this.url.searchParams.append(e,`${n}.${r}`),this}};vd.default=O4;var F4=as&&as.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Jh,"__esModule",{value:!0});const yc=F4(vd);let M4=class{constructor(e,{headers:n={},schema:r,fetch:s}){this.url=e,this.headers=new Headers(n),this.schema=r,this.fetch=s}select(e,{head:n=!1,count:r}={}){const s=n?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),r&&this.headers.append("Prefer",`count=${r}`),new yc.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:n,defaultToNull:r=!0}={}){var s;const i="POST";if(n&&this.headers.append("Prefer",`count=${n}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new yc.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(e,{onConflict:n,ignoreDuplicates:r=!1,count:s,defaultToNull:i=!0}={}){var o;const l="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),n!==void 0&&this.url.searchParams.set("on_conflict",n),s&&this.headers.append("Prefer",`count=${s}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new yc.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(e,{count:n}={}){var r;const s="PATCH";return n&&this.headers.append("Prefer",`count=${n}`),new yc.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var n;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new yc.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}};Jh.default=M4;var W_=as&&as.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(p0,"__esModule",{value:!0});const B4=W_(Jh),U4=W_(vd);let $4=class H_{constructor(e,{headers:n={},schema:r,fetch:s}={}){this.url=e,this.headers=new Headers(n),this.schemaName=r,this.fetch=s}from(e){const n=new URL(`${this.url}/${e}`);return new B4.default(n,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new H_(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:s=!1,count:i}={}){var o;let l;const c=new URL(`${this.url}/rpc/${e}`);let d;r||s?(l=r?"HEAD":"GET",Object.entries(n).filter(([p,g])=>g!==void 0).map(([p,g])=>[p,Array.isArray(g)?`{${g.join(",")}}`:`${g}`]).forEach(([p,g])=>{c.searchParams.append(p,g)})):(l="POST",d=n);const u=new Headers(this.headers);return i&&u.set("Prefer",`count=${i}`),new U4.default({method:l,url:c,headers:u,schema:this.schemaName,body:d,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};p0.default=$4;var Tl=as&&as.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(xr,"__esModule",{value:!0});xr.PostgrestError=xr.PostgrestBuilder=xr.PostgrestTransformBuilder=xr.PostgrestFilterBuilder=xr.PostgrestQueryBuilder=xr.PostgrestClient=void 0;const V_=Tl(p0);xr.PostgrestClient=V_.default;const G_=Tl(Jh);xr.PostgrestQueryBuilder=G_.default;const K_=Tl(vd);xr.PostgrestFilterBuilder=K_.default;const Z_=Tl(Xh);xr.PostgrestTransformBuilder=Z_.default;const Y_=Tl(Qh);xr.PostgrestBuilder=Y_.default;const J_=Tl(ef);xr.PostgrestError=J_.default;var z4=xr.default={PostgrestClient:V_.default,PostgrestQueryBuilder:G_.default,PostgrestFilterBuilder:K_.default,PostgrestTransformBuilder:Z_.default,PostgrestBuilder:Y_.default,PostgrestError:J_.default};const{PostgrestClient:W4,PostgrestQueryBuilder:dD,PostgrestFilterBuilder:uD,PostgrestTransformBuilder:hD,PostgrestBuilder:fD,PostgrestError:pD}=z4;class H4{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const r=n.node,s=parseInt(r.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const r=this.getWebSocketConstructor();return new r(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const V4="2.15.5",G4=`realtime-js/${V4}`,K4="1.0.0",Vm=1e4,Z4=1e3,Y4=100;var qc;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(qc||(qc={}));var Tn;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Tn||(Tn={}));var _s;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(_s||(_s={}));var Gm;(function(t){t.websocket="websocket"})(Gm||(Gm={}));var Ji;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Ji||(Ji={}));class J4{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const s=n.getUint8(1),i=n.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(e.slice(o,o+s));o=o+s;const c=r.decode(e.slice(o,o+i));o=o+i;const d=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class X_{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var $t;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})($t||($t={}));const Lv=(t,e,n={})=>{var r;const s=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,o)=>(i[o]=X4(o,t,e,s),i),{})},X4=(t,e,n,r)=>{const s=e.find(l=>l.name===t),i=s==null?void 0:s.type,o=n[t];return i&&!r.includes(i)?Q_(i,o):Km(o)},Q_=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return nN(e,n)}switch(t){case $t.bool:return Q4(e);case $t.float4:case $t.float8:case $t.int2:case $t.int4:case $t.int8:case $t.numeric:case $t.oid:return eN(e);case $t.json:case $t.jsonb:return tN(e);case $t.timestamp:return rN(e);case $t.abstime:case $t.date:case $t.daterange:case $t.int4range:case $t.int8range:case $t.money:case $t.reltime:case $t.text:case $t.time:case $t.timestamptz:case $t.timetz:case $t.tsrange:case $t.tstzrange:return Km(e);default:return Km(e)}},Km=t=>t,Q4=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},eN=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},tN=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},nN=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let i;const o=t.slice(1,n);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>Q_(e,l))}return t},rN=t=>typeof t=="string"?t.replace(" ","T"):t,e5=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class hp{constructor(e,n,r={},s=Vm){this.channel=e,this.event=n,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Tv;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Tv||(Tv={}));class Oc{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Oc.syncState(this.state,s,i,o),this.pendingDiffs.forEach(c=>{this.state=Oc.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Oc.syncDiff(this.state,s,i,o),l())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,s){const i=this.cloneDeep(e),o=this.transformState(n),l={},c={};return this.map(i,(d,u)=>{o[d]||(c[d]=u)}),this.map(o,(d,u)=>{const p=i[d];if(p){const g=u.map(w=>w.presence_ref),m=p.map(w=>w.presence_ref),j=u.filter(w=>m.indexOf(w.presence_ref)<0),k=p.filter(w=>g.indexOf(w.presence_ref)<0);j.length>0&&(l[d]=j),k.length>0&&(c[d]=k)}else l[d]=u}),this.syncDiff(i,{joins:l,leaves:c},r,s)}static syncDiff(e,n,r,s){const{joins:i,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(l,c)=>{var d;const u=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),u.length>0){const p=e[l].map(m=>m.presence_ref),g=u.filter(m=>p.indexOf(m.presence_ref)<0);e[l].unshift(...g)}r(l,u,c)}),this.map(o,(l,c)=>{let d=e[l];if(!d)return;const u=c.map(p=>p.presence_ref);d=d.filter(p=>u.indexOf(p.presence_ref)<0),e[l]=d,s(l,d,c),d.length===0&&delete e[l]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const s=e[r];return"metas"in s?n[r]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[r]=s,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Iv;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Iv||(Iv={}));var Fc;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Fc||(Fc={}));var ua;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(ua||(ua={}));class m0{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=Tn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new hp(this,_s.join,this.params,this.timeout),this.rejoinTimer=new X_(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Tn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Tn.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Tn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Tn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Tn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(_s.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Oc(this),this.broadcastEndpointURL=e5(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Tn.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,d=(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(m=>m.filter))!==null&&s!==void 0?s:[],u=!!this.bindings[Fc.PRESENCE]&&this.bindings[Fc.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,p={},g={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(m=>e==null?void 0:e(ua.CHANNEL_ERROR,m)),this._onClose(()=>e==null?void 0:e(ua.CLOSED)),this.updateJoinPayload(Object.assign({config:g},p)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:m})=>{var j;if(this.socket.setAuth(),m===void 0){e==null||e(ua.SUBSCRIBED);return}else{const k=this.bindings.postgres_changes,w=(j=k==null?void 0:k.length)!==null&&j!==void 0?j:0,y=[];for(let _=0;_<w;_++){const S=k[_],{filter:{event:N,schema:T,table:U,filter:P}}=S,b=m&&m[_];if(b&&b.event===N&&b.schema===T&&b.table===U&&b.filter===P)y.push(Object.assign(Object.assign({},S),{id:b.id}));else{this.unsubscribe(),this.state=Tn.errored,e==null||e(ua.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e(ua.SUBSCRIBED);return}}).receive("error",m=>{this.state=Tn.errored,e==null||e(ua.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(ua.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this.state===Tn.joined&&e===Fc.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,n,r)}async send(e,n={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const d=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Tn.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(_s.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new hp(this,_s.leave,{},e),r.receive("ok",()=>{n(),s("ok")}).receive("timeout",()=>{n(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Tn.closed,this.bindings={}}async _fetchWithTimeout(e,n,r){const s=new AbortController,i=setTimeout(()=>s.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:s.signal}));return clearTimeout(i),o}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new hp(this,e,n,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Y4){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var s,i;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=_s;if(r&&[l,c,d,u].indexOf(o)>=0&&r!==this._joinRef())return;let g=this._onMessage(o,n,r);if(n&&!g)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(m=>{var j,k,w;return((j=m.filter)===null||j===void 0?void 0:j.event)==="*"||((w=(k=m.filter)===null||k===void 0?void 0:k.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===o}).map(m=>m.callback(g,r)):(i=this.bindings[o])===null||i===void 0||i.filter(m=>{var j,k,w,y,_,S;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in m){const N=m.id,T=(j=m.filter)===null||j===void 0?void 0:j.event;return N&&((k=n.ids)===null||k===void 0?void 0:k.includes(N))&&(T==="*"||(T==null?void 0:T.toLocaleLowerCase())===((w=n.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const N=(_=(y=m==null?void 0:m.filter)===null||y===void 0?void 0:y.event)===null||_===void 0?void 0:_.toLocaleLowerCase();return N==="*"||N===((S=n==null?void 0:n.event)===null||S===void 0?void 0:S.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===o}).map(m=>{if(typeof g=="object"&&"ids"in g){const j=g.data,{schema:k,table:w,commit_timestamp:y,type:_,errors:S}=j;g=Object.assign(Object.assign({},{schema:k,table:w,commit_timestamp:y,eventType:_,new:{},old:{},errors:S}),this._getPayloadRecords(j))}m.callback(g,r)})}_isClosed(){return this.state===Tn.closed}_isJoined(){return this.state===Tn.joined}_isJoining(){return this.state===Tn.joining}_isLeaving(){return this.state===Tn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const s=e.toLocaleLowerCase(),i={type:s,filter:n,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&m0.isEqual(s.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(_s.close,{},e)}_onError(e){this._on(_s.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Tn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Lv(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Lv(e.columns,e.old_record)),n}}const fp=()=>{},bu={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},sN=[1e3,2e3,5e3,1e4],aN=1e4,iN=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class oN{constructor(e,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Vm,this.transport=null,this.heartbeatIntervalMs=bu.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=fp,this.ref=0,this.reconnectTimer=null,this.logger=fp,this.conn=null,this.sendBuffer=[],this.serializer=new J4,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...o)=>ui(async()=>{const{default:l}=await Promise.resolve().then(()=>Ll);return{default:l}},void 0).then(({default:l})=>l(...o)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...o)=>i(...o)},!(!((r=n==null?void 0:n.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${Gm.websocket}`,this.httpEndpoint=e5(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=H4.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:K4}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case qc.connecting:return Ji.Connecting;case qc.open:return Ji.Open;case qc.closing:return Ji.Closing;default:return Ji.Closed}}isConnected(){return this.connectionState()===Ji.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===r);if(s)return s;{const i=new m0(`realtime:${e}`,n,this);return this.channels.push(i),i}}push(e){const{topic:n,event:r,payload:s,ref:i}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${n} ${r} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Z4,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},bu.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:s,payload:i,ref:o}=n,l=o?`(${o})`:"",c=i.status||"";this.log("receive",`${c} ${r} ${s} ${l}`.trim(),i),this.channels.filter(d=>d._isMember(r)).forEach(d=>d._trigger(s,i,o)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(_s.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(n);return`${e}${r}${s}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([iN],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n;e?n=e:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const s={access_token:n,version:G4};n&&r.updateJoinPayload(s),r.joinedOnce&&r._isJoined()&&r._push(_s.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(n)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new X_(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},bu.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,r,s,i,o,l,c,d,u;if(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:Vm,this.heartbeatIntervalMs=(s=e==null?void 0:e.heartbeatIntervalMs)!==null&&s!==void 0?s:bu.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:fp,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=e==null?void 0:e.reconnectAfterMs)!==null&&c!==void 0?c:p=>sN[p-1]||aN,this.encode=(d=e==null?void 0:e.encode)!==null&&d!==void 0?d:(p,g)=>g(JSON.stringify(p)),this.decode=(u=e==null?void 0:e.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class g0 extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function kn(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class lN extends g0{constructor(e,n,r){super(e),this.name="StorageApiError",this.status=n,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Zm extends g0{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var cN=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(p){o(p)}}function c(u){try{d(r.throw(u))}catch(p){o(p)}}function d(u){u.done?i(u.value):s(u.value).then(l,c)}d((r=r.apply(t,e||[])).next())})};const t5=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>ui(async()=>{const{default:r}=await Promise.resolve().then(()=>Ll);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},dN=()=>cN(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ui(()=>Promise.resolve().then(()=>Ll),void 0)).Response:Response}),Ym=t=>{if(Array.isArray(t))return t.map(n=>Ym(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const s=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=Ym(r)}),e},uN=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var go=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(p){o(p)}}function c(u){try{d(r.throw(u))}catch(p){o(p)}}function d(u){u.done?i(u.value):s(u.value).then(l,c)}d((r=r.apply(t,e||[])).next())})};const pp=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),hN=(t,e,n)=>go(void 0,void 0,void 0,function*(){const r=yield dN();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(s=>{const i=t.status||500,o=(s==null?void 0:s.statusCode)||i+"";e(new lN(pp(s),i,o))}).catch(s=>{e(new Zm(pp(s),s))}):e(new Zm(pp(t),t))}),fN=(t,e,n,r)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!r?s:(uN(r)?(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r)):s.body=r,e!=null&&e.duplex&&(s.duplex=e.duplex),Object.assign(Object.assign({},s),n))};function yd(t,e,n,r,s,i){return go(this,void 0,void 0,function*(){return new Promise((o,l)=>{t(n,fN(e,r,s,i)).then(c=>{if(!c.ok)throw c;return r!=null&&r.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>hN(c,l,r))})})}function xh(t,e,n,r){return go(this,void 0,void 0,function*(){return yd(t,"GET",e,n,r)})}function Bs(t,e,n,r,s){return go(this,void 0,void 0,function*(){return yd(t,"POST",e,r,s,n)})}function Jm(t,e,n,r,s){return go(this,void 0,void 0,function*(){return yd(t,"PUT",e,r,s,n)})}function pN(t,e,n,r){return go(this,void 0,void 0,function*(){return yd(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function n5(t,e,n,r,s){return go(this,void 0,void 0,function*(){return yd(t,"DELETE",e,r,s,n)})}var mN=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(p){o(p)}}function c(u){try{d(r.throw(u))}catch(p){o(p)}}function d(u){u.done?i(u.value):s(u.value).then(l,c)}d((r=r.apply(t,e||[])).next())})};class gN{constructor(e,n){this.downloadFn=e,this.shouldThrowOnError=n}then(e,n){return this.execute().then(e,n)}execute(){return mN(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(kn(e))return{data:null,error:e};throw e}})}}var vN=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(p){o(p)}}function c(u){try{d(r.throw(u))}catch(p){o(p)}}function d(u){u.done?i(u.value):s(u.value).then(l,c)}d((r=r.apply(t,e||[])).next())})};class yN{constructor(e,n){this.downloadFn=e,this.shouldThrowOnError=n}asStream(){return new gN(this.downloadFn,this.shouldThrowOnError)}then(e,n){return this.execute().then(e,n)}execute(){return vN(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(kn(e))return{data:null,error:e};throw e}})}}var br=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(p){o(p)}}function c(u){try{d(r.throw(u))}catch(p){o(p)}}function d(u){u.done?i(u.value):s(u.value).then(l,c)}d((r=r.apply(t,e||[])).next())})};const bN={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Rv={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class _N{constructor(e,n={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=n,this.bucketId=r,this.fetch=t5(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,n,r,s){return br(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Rv),s);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),s!=null&&s.headers&&(l=Object.assign(Object.assign({},l),s.headers));const d=this._removeEmptyFolders(n),u=this._getFinalPath(d),p=yield(e=="PUT"?Jm:Bs)(this.fetch,`${this.url}/object/${u}`,i,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:p.Id,fullPath:p.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(kn(i))return{data:null,error:i};throw i}})}upload(e,n,r){return br(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,s){return br(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",n);try{let c;const d=Object.assign({upsert:Rv.upsert},s),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",d.cacheControl)):(c=r,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const p=yield Jm(this.fetch,l.toString(),c,{headers:u});return{data:{path:i,fullPath:p.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(kn(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,n){return br(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);n!=null&&n.upsert&&(s["x-upsert"]="true");const i=yield Bs(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new g0("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(kn(r))return{data:null,error:r};throw r}})}update(e,n,r){return br(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return br(this,void 0,void 0,function*(){try{return{data:yield Bs(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(kn(s))return{data:null,error:s};throw s}})}copy(e,n,r){return br(this,void 0,void 0,function*(){try{return{data:{path:(yield Bs(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(kn(s))return{data:null,error:s};throw s}})}createSignedUrl(e,n,r){return br(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield Bs(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(kn(s))return{data:null,error:s};throw s}})}createSignedUrls(e,n,r){return br(this,void 0,void 0,function*(){try{const s=yield Bs(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(kn(s))return{data:null,error:s};throw s}})}download(e,n){const s=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=i?`?${i}`:"",l=this._getFinalPath(e),c=()=>xh(this.fetch,`${this.url}/${s}/${l}${o}`,{headers:this.headers,noResolveJson:!0});return new yN(c,this.shouldThrowOnError)}info(e){return br(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield xh(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Ym(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(kn(r))return{data:null,error:r};throw r}})}exists(e){return br(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield pN(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(kn(r)&&r instanceof Zm){const s=r.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),s=[],i=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";i!==""&&s.push(i);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});c!==""&&s.push(c);let d=s.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${d}`)}}}remove(e){return br(this,void 0,void 0,function*(){try{return{data:yield n5(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(kn(n))return{data:null,error:n};throw n}})}list(e,n,r){return br(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},bN),n),{prefix:e||""});return{data:yield Bs(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(kn(s))return{data:null,error:s};throw s}})}listV2(e,n){return br(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield Bs(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(kn(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const xN="2.12.2",wN={"X-Client-Info":`storage-js/${xN}`};var To=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(p){o(p)}}function c(u){try{d(r.throw(u))}catch(p){o(p)}}function d(u){u.done?i(u.value):s(u.value).then(l,c)}d((r=r.apply(t,e||[])).next())})};class jN{constructor(e,n={},r,s){this.shouldThrowOnError=!1;const i=new URL(e);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},wN),n),this.fetch=t5(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return To(this,void 0,void 0,function*(){try{return{data:yield xh(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(kn(e))return{data:null,error:e};throw e}})}getBucket(e){return To(this,void 0,void 0,function*(){try{return{data:yield xh(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(kn(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return To(this,void 0,void 0,function*(){try{return{data:yield Bs(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(kn(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return To(this,void 0,void 0,function*(){try{return{data:yield Jm(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(kn(r))return{data:null,error:r};throw r}})}emptyBucket(e){return To(this,void 0,void 0,function*(){try{return{data:yield Bs(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(kn(n))return{data:null,error:n};throw n}})}deleteBucket(e){return To(this,void 0,void 0,function*(){try{return{data:yield n5(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(kn(n))return{data:null,error:n};throw n}})}}class SN extends jN{constructor(e,n={},r,s){super(e,n,r,s)}from(e){return new _N(this.url,this.headers,e,this.fetch)}}const kN="2.58.0";let Nc="";typeof Deno<"u"?Nc="deno":typeof document<"u"?Nc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Nc="react-native":Nc="node";const NN={"X-Client-Info":`supabase-js-${Nc}/${kN}`},CN={headers:NN},AN={schema:"public"},EN={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},DN={};var PN=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(p){o(p)}}function c(u){try{d(r.throw(u))}catch(p){o(p)}}function d(u){u.done?i(u.value):s(u.value).then(l,c)}d((r=r.apply(t,e||[])).next())})};const LN=t=>{let e;return t?e=t:typeof fetch>"u"?e=U_:e=fetch,(...n)=>e(...n)},TN=()=>typeof Headers>"u"?$_:Headers,IN=(t,e,n)=>{const r=LN(n),s=TN();return(i,o)=>PN(void 0,void 0,void 0,function*(){var l;const c=(l=yield e())!==null&&l!==void 0?l:t;let d=new s(o==null?void 0:o.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),r(i,Object.assign(Object.assign({},o),{headers:d}))})};var RN=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(p){o(p)}}function c(u){try{d(r.throw(u))}catch(p){o(p)}}function d(u){u.done?i(u.value):s(u.value).then(l,c)}d((r=r.apply(t,e||[])).next())})};function qN(t){return t.endsWith("/")?t:t+"/"}function ON(t,e){var n,r;const{db:s,auth:i,realtime:o,global:l}=t,{db:c,auth:d,realtime:u,global:p}=e,g={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},d),i),realtime:Object.assign(Object.assign({},u),o),storage:{},global:Object.assign(Object.assign(Object.assign({},p),l),{headers:Object.assign(Object.assign({},(n=p==null?void 0:p.headers)!==null&&n!==void 0?n:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>RN(this,void 0,void 0,function*(){return""})};return t.accessToken?g.accessToken=t.accessToken:delete g.accessToken,g}function FN(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(qN(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const r5="2.72.0",Uo=30*1e3,Xm=3,mp=Xm*Uo,MN="http://localhost:9999",BN="supabase.auth.token",UN={"X-Client-Info":`gotrue-js/${r5}`},Qm="X-Supabase-Api-Version",s5={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},$N=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,zN=10*60*1e3;class v0 extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function ft(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class WN extends v0{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function HN(t){return ft(t)&&t.name==="AuthApiError"}class a5 extends v0{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class bi extends v0{constructor(e,n,r,s){super(e,r,s),this.name=n,this.status=r}}class Va extends bi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function VN(t){return ft(t)&&t.name==="AuthSessionMissingError"}class bc extends bi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class _u extends bi{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class xu extends bi{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function GN(t){return ft(t)&&t.name==="AuthImplicitGrantRedirectError"}class qv extends bi{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class eg extends bi{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function gp(t){return ft(t)&&t.name==="AuthRetryableFetchError"}class Ov extends bi{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class tg extends bi{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const wh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Fv=` 	
\r=`.split(""),KN=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Fv.length;e+=1)t[Fv[e].charCodeAt(0)]=-2;for(let e=0;e<wh.length;e+=1)t[wh[e].charCodeAt(0)]=e;return t})();function Mv(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(wh[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(wh[r]),e.queuedBits-=6}}function i5(t,e,n){const r=KN[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Bv(t){const e=[],n=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{JN(o,r,n)};for(let o=0;o<t.length;o+=1)i5(t.charCodeAt(o),s,i);return e.join("")}function ZN(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function YN(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|s)+65536,n+=1}ZN(r,e)}}function JN(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function XN(t){const e=[],n={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<t.length;s+=1)i5(t.charCodeAt(s),n,r);return new Uint8Array(e)}function QN(t){const e=[];return YN(t,n=>e.push(n)),new Uint8Array(e)}function e3(t){const e=[],n={queue:0,queuedBits:0},r=s=>{e.push(s)};return t.forEach(s=>Mv(s,n,r)),Mv(null,n,r),e.join("")}function t3(t){return Math.round(Date.now()/1e3)+t}function n3(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Qr=()=>typeof window<"u"&&typeof document<"u",Wi={tested:!1,writable:!1},o5=()=>{if(!Qr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Wi.tested)return Wi.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Wi.tested=!0,Wi.writable=!0}catch{Wi.tested=!0,Wi.writable=!1}return Wi.writable};function r3(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return n.searchParams.forEach((r,s)=>{e[s]=r}),e}const l5=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>ui(async()=>{const{default:r}=await Promise.resolve().then(()=>Ll);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},s3=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",$o=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Hi=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},za=async(t,e)=>{await t.removeItem(e)};class tf{constructor(){this.promise=new tf.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}tf.promiseConstructor=Promise;function vp(t){const e=t.split(".");if(e.length!==3)throw new tg("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!$N.test(e[r]))throw new tg("JWT not in base64url format");return{header:JSON.parse(Bv(e[0])),payload:JSON.parse(Bv(e[1])),signature:XN(e[2]),raw:{header:e[0],payload:e[1]}}}async function a3(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function i3(t,e){return new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){r(o);return}}catch(o){if(!e(i,o)){s(o);return}}})()})}function o3(t){return("0"+t.toString(16)).substr(-2)}function l3(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let s="";for(let i=0;i<56;i++)s+=n.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,o3).join("")}async function c3(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),s=new Uint8Array(r);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function d3(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await c3(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Io(t,e,n=!1){const r=l3();let s=r;n&&(s+="/PASSWORD_RECOVERY"),await $o(t,`${e}-code-verifier`,s);const i=await d3(r);return[i,r===i?"plain":"s256"]}const u3=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function h3(t){const e=t.headers.get(Qm);if(!e||!e.match(u3))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function f3(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function p3(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const m3=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ro(t){if(!m3.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function yp(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Uv(t){return JSON.parse(JSON.stringify(t))}var g3=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};const Zi=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),v3=[502,503,504];async function $v(t){var e;if(!s3(t))throw new eg(Zi(t),0);if(v3.includes(t.status))throw new eg(Zi(t),t.status);let n;try{n=await t.json()}catch(i){throw new a5(Zi(i),i)}let r;const s=h3(t);if(s&&s.getTime()>=s5["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new Ov(Zi(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Va}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Ov(Zi(n),t.status,n.weak_password.reasons);throw new WN(Zi(n),t.status||500,r)}const y3=(t,e,n,r)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),n))};async function gt(t,e,n,r){var s;const i=Object.assign({},r==null?void 0:r.headers);i[Qm]||(i[Qm]=s5["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await b3(t,e,n+l,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(c):{data:Object.assign({},c),error:null}}async function b3(t,e,n,r,s,i){const o=y3(e,r,s,i);let l;try{l=await t(n,Object.assign({},o))}catch(c){throw console.error(c),new eg(Zi(c),0)}if(l.ok||await $v(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(c){await $v(c)}}function Os(t){var e;let n=null;j3(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=t3(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function zv(t){const e=Os(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Ja(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function _3(t){return{data:t,error:null}}function x3(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:s,verification_type:i}=t,o=g3(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:n,hashed_token:r,redirect_to:s,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function w3(t){return t}function j3(t){return t.access_token&&t.refresh_token&&t.expires_in}const bp=["global","local","others"];var S3=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};class k3{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=l5(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=bp[0]){if(bp.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${bp.join(", ")}`);try{return await gt(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ft(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await gt(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Ja})}catch(r){if(ft(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=S3(e,["options"]),s=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await gt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:x3,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(ft(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await gt(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ja})}catch(n){if(ft(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,s,i,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await gt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:w3});if(u.error)throw u.error;const p=await u.json(),g=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,m=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(j=>{const k=parseInt(j.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(j.split(";")[1].split("=")[1]);d[`${w}Page`]=k}),d.total=parseInt(g)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(ft(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Ro(e);try{return await gt(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ja})}catch(n){if(ft(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){Ro(e);try{return await gt(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Ja})}catch(r){if(ft(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){Ro(e);try{return await gt(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Ja})}catch(r){if(ft(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Ro(e.userId);try{const{data:n,error:r}=await gt(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:n,error:r}}catch(n){if(ft(n))return{data:null,error:n};throw n}}async _deleteFactor(e){Ro(e.userId),Ro(e.id);try{return{data:await gt(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(ft(n))return{data:null,error:n};throw n}}}function Wv(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function N3(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const qo={debug:!!(globalThis&&o5()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class c5 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class C3 extends c5{}async function A3(t,e,n){qo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),qo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){qo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await n()}finally{qo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(e===0)throw qo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new C3(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(qo.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function d5(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function E3(t){return parseInt(t,16)}function D3(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,r=>r.toString(16).padStart(2,"0")).join("")}function P3(t){var e;const{chainId:n,domain:r,expirationTime:s,issuedAt:i=new Date,nonce:o,notBefore:l,requestId:c,resources:d,scheme:u,uri:p,version:g}=t;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!p)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(g!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${g}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const m=d5(t.address),j=u?`${u}://${r}`:r,k=t.statement?`${t.statement}
`:"",w=`${j} wants you to sign in with your Ethereum account:
${m}

${k}`;let y=`URI: ${p}
Version: ${g}
Chain ID: ${n}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(s&&(y+=`
Expiration Time: ${s.toISOString()}`),l&&(y+=`
Not Before: ${l.toISOString()}`),c&&(y+=`
Request ID: ${c}`),d){let _=`
Resources:`;for(const S of d){if(!S||typeof S!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${S}`);_+=`
- ${S}`}y+=_}return`${w}
${y}`}N3();const L3={url:MN,storageKey:BN,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:UN,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Hv(t,e,n){return await n()}const Oo={};class od{constructor(e){var n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=od.nextInstanceID,od.nextInstanceID+=1,this.instanceID>0&&Qr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},L3),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new k3({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=l5(s.fetch),this.lock=s.lock||Hv,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Qr()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=A3:this.lock=Hv,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:o5()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Wv(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=Wv(this.memoryStorage)),Qr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,n;return(n=(e=Oo[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){Oo[this.storageKey]=Object.assign(Object.assign({},Oo[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=Oo[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Oo[this.storageKey]=Object.assign(Object.assign({},Oo[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${r5}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=r3(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),Qr()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:i}=await this._getSessionFromURL(n,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),GN(i)){const c=(e=i.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return ft(n)?{error:n}:{error:new a5("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,s;try{const i=await gt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:Os}),{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(ft(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var n,r,s;try{let i;if("email"in e){const{email:u,password:p,options:g}=e;let m=null,j=null;this.flowType==="pkce"&&([m,j]=await Io(this.storage,this.storageKey)),i=await gt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:g==null?void 0:g.emailRedirectTo,body:{email:u,password:p,data:(n=g==null?void 0:g.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:m,code_challenge_method:j},xform:Os})}else if("phone"in e){const{phone:u,password:p,options:g}=e;i=await gt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:p,data:(r=g==null?void 0:g.data)!==null&&r!==void 0?r:{},channel:(s=g==null?void 0:g.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken}},xform:Os})}else throw new _u("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(ft(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let n;if("email"in e){const{email:i,password:o,options:l}=e;n=await gt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:zv})}else if("phone"in e){const{phone:i,password:o,options:l}=e;n=await gt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:zv})}else throw new _u("You must provide either an email or phone number and a password");const{data:r,error:s}=n;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new bc}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(n){if(ft(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;switch(n){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(e){var n,r,s,i,o,l,c,d,u,p,g;let m,j;if("message"in e)m=e.message,j=e.signature;else{const{chain:k,wallet:w,statement:y,options:_}=e;let S;if(Qr())if(typeof w=="object")S=w;else{const A=window;if("ethereum"in A&&typeof A.ethereum=="object"&&"request"in A.ethereum&&typeof A.ethereum.request=="function")S=A.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!(_!=null&&_.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=w}const N=new URL((n=_==null?void 0:_.url)!==null&&n!==void 0?n:window.location.href),T=await S.request({method:"eth_requestAccounts"}).then(A=>A).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!T||T.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const U=d5(T[0]);let P=(r=_==null?void 0:_.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!P){const A=await S.request({method:"eth_chainId"});P=E3(A)}const b={domain:N.host,address:U,statement:y,uri:N.href,version:"1",chainId:P,nonce:(s=_==null?void 0:_.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(o=(i=_==null?void 0:_.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=_==null?void 0:_.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=_==null?void 0:_.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=_==null?void 0:_.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(u=_==null?void 0:_.signInWithEthereum)===null||u===void 0?void 0:u.resources};m=P3(b),j=await S.request({method:"personal_sign",params:[D3(m),U]})}try{const{data:k,error:w}=await gt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:m,signature:j},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(g=e.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:Os});if(w)throw w;return!k||!k.session||!k.user?{data:{user:null,session:null},error:new bc}:(k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("SIGNED_IN",k.session)),{data:Object.assign({},k),error:w})}catch(k){if(ft(k))return{data:{user:null,session:null},error:k};throw k}}async signInWithSolana(e){var n,r,s,i,o,l,c,d,u,p,g,m;let j,k;if("message"in e)j=e.message,k=e.signature;else{const{chain:w,wallet:y,statement:_,options:S}=e;let N;if(Qr())if(typeof y=="object")N=y;else{const U=window;if("solana"in U&&typeof U.solana=="object"&&("signIn"in U.solana&&typeof U.solana.signIn=="function"||"signMessage"in U.solana&&typeof U.solana.signMessage=="function"))N=U.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(S!=null&&S.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");N=y}const T=new URL((n=S==null?void 0:S.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in N&&N.signIn){const U=await N.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},S==null?void 0:S.signInWithSolana),{version:"1",domain:T.host,uri:T.href}),_?{statement:_}:null));let P;if(Array.isArray(U)&&U[0]&&typeof U[0]=="object")P=U[0];else if(U&&typeof U=="object"&&"signedMessage"in U&&"signature"in U)P=U;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in P&&"signature"in P&&(typeof P.signedMessage=="string"||P.signedMessage instanceof Uint8Array)&&P.signature instanceof Uint8Array)j=typeof P.signedMessage=="string"?P.signedMessage:new TextDecoder().decode(P.signedMessage),k=P.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in N)||typeof N.signMessage!="function"||!("publicKey"in N)||typeof N!="object"||!N.publicKey||!("toBase58"in N.publicKey)||typeof N.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");j=[`${T.host} wants you to sign in with your Solana account:`,N.publicKey.toBase58(),..._?["",_,""]:[""],"Version: 1",`URI: ${T.href}`,`Issued At: ${(s=(r=S==null?void 0:S.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=S==null?void 0:S.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${S.signInWithSolana.notBefore}`]:[],...!((o=S==null?void 0:S.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${S.signInWithSolana.expirationTime}`]:[],...!((l=S==null?void 0:S.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${S.signInWithSolana.chainId}`]:[],...!((c=S==null?void 0:S.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${S.signInWithSolana.nonce}`]:[],...!((d=S==null?void 0:S.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${S.signInWithSolana.requestId}`]:[],...!((p=(u=S==null?void 0:S.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||p===void 0)&&p.length?["Resources",...S.signInWithSolana.resources.map(P=>`- ${P}`)]:[]].join(`
`);const U=await N.signMessage(new TextEncoder().encode(j),"utf8");if(!U||!(U instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");k=U}}try{const{data:w,error:y}=await gt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:j,signature:e3(k)},!((g=e.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Os});if(y)throw y;return!w||!w.session||!w.user?{data:{user:null,session:null},error:new bc}:(w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),{data:Object.assign({},w),error:y})}catch(w){if(ft(w))return{data:{user:null,session:null},error:w};throw w}}async _exchangeCodeForSession(e){const n=await Hi(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(n??"").split("/");try{const{data:i,error:o}=await gt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Os});if(await za(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new bc}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(ft(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:n,provider:r,token:s,access_token:i,nonce:o}=e,l=await gt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Os}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new bc}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(n){if(ft(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,s,i,o;try{if("email"in e){const{email:l,options:c}=e;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await Io(this.storage,this.storageKey));const{error:p}=await gt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:p}}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:u}=await gt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u}}throw new _u("You must provide either an email or phone number.")}catch(l){if(ft(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var n,r;try{let s,i;"options"in e&&(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await gt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Os});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(s){if(ft(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var n,r,s;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await Io(this.storage,this.storageKey)),await gt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:_3})}catch(i){if(ft(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new Va;const{error:s}=await gt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(ft(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:i}=e,{error:o}=await gt(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:s,options:i}=e,{data:o,error:l}=await gt(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new _u("You must provide either an email or phone number and a type")}catch(n){if(ft(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Hi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<mp:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await Hi(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=yp()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,d,u)=>(!o&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await gt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ja}):await this._useSession(async n=>{var r,s,i;const{data:o,error:l}=n;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Va}:await gt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Ja})})}catch(n){if(ft(n))return VN(n)&&(await this._removeSession(),await za(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new Va;const o=s.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await Io(this.storage,this.storageKey));const{data:d,error:u}=await gt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:Ja});if(u)throw u;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(ft(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Va;const n=Date.now()/1e3;let r=n,s=!0,i=null;const{payload:o}=vp(e.access_token);if(o.exp&&(r=o.exp,s=r<=n),s){const{session:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(n){if(ft(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:o,error:l}=n;if(l)throw l;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Va;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(ft(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!Qr())throw new xu("No browser detected.");if(e.error||e.error_description||e.error_code)throw new xu(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new qv("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new xu("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new qv("No code detected.");const{data:_,error:S}=await this._exchangeCodeForSession(e.code);if(S)throw S;const N=new URL(window.location.href);return N.searchParams.delete("code"),window.history.replaceState(window.history.state,"",N.toString()),{data:{session:_.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=e;if(!i||!l||!o||!d)throw new xu("No session defined in URL");const u=Math.round(Date.now()/1e3),p=parseInt(l);let g=u+p;c&&(g=parseInt(c));const m=g-u;m*1e3<=Uo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${p}s`);const j=g-p;u-j>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",j,g,u):u-j<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",j,g,u);const{data:k,error:w}=await this._getUser(i);if(w)throw w;const y={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:p,expires_at:g,refresh_token:o,token_type:d,user:k.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:e.type},error:null}}catch(r){if(ft(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Hi(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:s,error:i}=n;if(i)return{error:i};const o=(r=s.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(HN(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await za(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=n3(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,s;try{const{data:{session:i},error:o}=n;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,n={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await Io(this.storage,this.storageKey,!0));try{return await gt(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(ft(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(ft(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:s}=await this._useSession(async i=>{var o,l,c,d,u;const{data:p,error:g}=i;if(g)throw g;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await gt(this.fetch,"GET",m,{headers:this.headers,jwt:(u=(d=p.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return Qr()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(ft(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,s;const{data:i,error:o}=n;if(o)throw o;return await gt(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(n){if(ft(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await i3(async s=>(s>0&&await a3(200*Math.pow(2,s-1)),this._debug(n,"refreshing attempt",s),await gt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Os})),(s,i)=>{const o=200*Math.pow(2,s);return i&&gp(i)&&Date.now()+o-r<Uo})}catch(r){if(this._debug(n,"error",r),ft(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),Qr()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await Hi(this.storage,this.storageKey);if(s&&this.userStorage){let o=await Hi(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await $o(this.userStorage,this.storageKey+"-user",o)),s.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:yp()}else if(s&&!s.user&&!s.user){const o=await Hi(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(s.user=o.user,await za(this.storage,this.storageKey+"-user"),await $o(this.storage,this.storageKey,s)):s.user=yp()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const i=((n=s.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<mp;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${mp}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),gp(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(s.access_token);!l&&(o!=null&&o.user)?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new Va;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new tf;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Va;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(s,"error",i),ft(i)){const o={session:null,error:i};return gp(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,n,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,n)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const n=Object.assign({},e),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await $o(this.userStorage,this.storageKey+"-user",{user:n.user});const s=Object.assign({},n);delete s.user;const i=Uv(s);await $o(this.storage,this.storageKey,i)}else{const s=Uv(n);await $o(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await za(this.storage,this.storageKey),await za(this.storage,this.storageKey+"-code-verifier"),await za(this.storage,this.storageKey+"-user"),this.userStorage&&await za(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Qr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Uo);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/Uo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Uo}ms, refresh threshold is ${Xm} ticks`),s<=Xm&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof c5)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Qr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const s=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await Io(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);s.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;return i?{data:null,error:i}:await gt(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(ft(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,s;const{data:i,error:o}=n;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:d}=await gt(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(n){if(ft(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;if(i)return{data:null,error:i};const{data:o,error:l}=await gt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(n){if(ft(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;return i?{data:null,error:i}:await gt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(ft(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],s=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=vp(s.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((r=(n=s.user.factors)===null||n===void 0?void 0:n.filter(p=>p.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const u=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(l=>l.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+zN>s)return r;const{data:i,error:o}=await gt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,r=i.keys.find(l=>l.kid===e),!r)?null:r}async getClaims(e,n={}){try{let r=e;if(!r){const{data:m,error:j}=await this.getSession();if(j||!m.session)return{data:null,error:j};r=m.session.access_token}const{header:s,payload:i,signature:o,raw:{header:l,payload:c}}=vp(r);n!=null&&n.allowExpired||f3(i.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!d){const{error:m}=await this.getUser(r);if(m)throw m;return{data:{claims:i,header:s,signature:o},error:null}}const u=p3(s.alg),p=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,p,o,QN(`${l}.${c}`)))throw new tg("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(r){if(ft(r))return{data:null,error:r};throw r}}}od.nextInstanceID=0;const T3=od;class I3 extends T3{constructor(e){super(e)}}var R3=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(p){o(p)}}function c(u){try{d(r.throw(u))}catch(p){o(p)}}function d(u){u.done?i(u.value):s(u.value).then(l,c)}d((r=r.apply(t,e||[])).next())})};class q3{constructor(e,n,r){var s,i,o;this.supabaseUrl=e,this.supabaseKey=n;const l=FN(e);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:AN,realtime:DN,auth:Object.assign(Object.assign({},EN),{storageKey:c}),global:CN},u=ON(r??{},d);this.storageKey=(s=u.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(p,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=u.auth)!==null&&o!==void 0?o:{},this.headers,u.global.fetch),this.fetch=IN(n,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new W4(new URL("rest/v1",l).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new SN(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new w4(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return R3(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:s,userStorage:i,storageKey:o,flowType:l,lock:c,debug:d},u,p){const g={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new I3({url:this.authUrl.href,headers:Object.assign(Object.assign({},g),u),storageKey:o,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:s,userStorage:i,flowType:l,lock:c,debug:d,fetch:p,hasCustomAuthorizationHeader:Object.keys(this.headers).some(m=>m.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new oN(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const O3=(t,e,n)=>new q3(t,e,n);function F3(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}F3()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const u5="https://qfbinashpakwprdwamwb.supabase.co",h5="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFmYmluYXNocGFrd3ByZHdhbXdiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk1MjQzNzEsImV4cCI6MjA3NTEwMDM3MX0.OjW9wDMSUdxuS9zME8nF4fXwAMskomC5tddxjvfK-ls";(u5.includes("YOUR_")||h5.includes("YOUR_"))&&(console.error(" SUPABASE NOT CONFIGURED "),console.error("Please update .env.local with your Supabase credentials:"),console.error("1. Go to https://app.supabase.com/project/_/settings/api"),console.error("2. Copy your Project URL and anon key"),console.error("3. Update VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY in .env.local"),console.error("4. Restart the dev server"));O3(u5,h5);const f5=!1;console.log(" Auth Debug:",{VITE_DEMO_MODE:"true",USE_SUPABASE:f5,mode:"Demo Mode"});const ul={async login(t,e){console.log(" Login attempt:",{email:t,USE_SUPABASE:f5});{console.log(" Demo mode - searching for user:",t);const n=await be.findOne("users",{email:t,password:e});if(console.log(" User search result:",n?"Found":"Not found"),!n){const i=await be.query("users");throw console.log(" Available demo users:",i.map(o=>({email:o.email,role:o.role}))),new Error("Invalid email or password")}const{password:r,...s}=n;return be.setCurrentUser(s),console.log(" Demo login successful:",s.email,s.role),s}},async logout(){be.clearCurrentUser()},async getCurrentUser(){return be.getCurrentUser()},async register(t){if(await be.findOne("users",{email:t.email}))throw new Error("User already exists");const n={id:Date.now().toString(),...t,created_at:new Date().toISOString()};await be.insert("users",n);const{password:r,...s}=n;return s},hasPermission(t,e){const n={student:1,staff:2,admin:3,master_admin:4};return n[t==null?void 0:t.role]>=n[e]}},p5=O.createContext(null);function M3({children:t}){const[e,n]=O.useState(null),[r,s]=O.useState(!0);O.useEffect(()=>{(async()=>{try{const d=await ul.getCurrentUser();n(d)}catch(d){console.error("Failed to load user:",d)}finally{s(!1)}})()},[]);const l={user:e,loading:r,login:async(c,d)=>{const u=await ul.login(c,d);return n(u),u},logout:async()=>{await ul.logout(),n(null)},isAuthenticated:!!e};return a.jsx(p5.Provider,{value:l,children:t})}function cn(){const t=O.useContext(p5);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t}const B3=O.createContext();function U3({children:t}){const[e,n]=O.useState(()=>{const i=localStorage.getItem("ncad-theme");return i||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")});O.useEffect(()=>{document.documentElement.setAttribute("data-theme",e),localStorage.setItem("ncad-theme",e)},[e]);const s={theme:e,setTheme:n,toggleTheme:()=>{n(i=>i==="light"?"dark":"light")},isDark:e==="dark"};return a.jsx(B3.Provider,{value:s,children:t})}class $3 extends O.Component{constructor(n){super(n);At(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null}),this.props.onReset&&this.props.onReset()});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(n){return{hasError:!0}}componentDidCatch(n,r){console.error("ErrorBoundary caught an error:",n,r),this.setState({error:n,errorInfo:r})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:a.jsx("div",{className:"error-boundary",role:"alert",children:a.jsxs("div",{className:"error-boundary-content",children:[a.jsx("h2",{children:"Something went wrong"}),a.jsx("p",{children:"We're sorry, but something unexpected happened. Please try refreshing the page."}),!1,a.jsxs("div",{className:"error-actions",children:[a.jsx("button",{onClick:this.handleReset,className:"btn btn-primary","data-testid":"error-reset-btn",children:"Try Again"}),a.jsx("button",{onClick:()=>window.location.href="/",className:"btn btn-secondary","data-testid":"error-home-btn",children:"Go to Home"})]})]})}):this.props.children}}function y0(){const[t,e]=O.useState([]),[n,r]=O.useState(!1),[s,i]=O.useState(0);O.useEffect(()=>{o();const p=setInterval(o,3e4);return()=>clearInterval(p)},[]);const o=async()=>{var g;const p=be.getCurrentUser();if(p)try{const m=be.getData(),j=[];if(p.role==="student")m.bookings.filter(w=>w.user_id===p.id).forEach(w=>{w.status!=="pending"&&j.push({id:`booking-${w.id}`,type:w.status==="approved"?"success":"error",message:`Booking for ${w.equipment_name} has been ${w.status}`,timestamp:w.updated_at||w.created_at,read:!1})});else if(p.role==="department_admin"||p.role==="master_admin"){const k=m.bookings.filter(w=>w.status==="pending");if(k.length>0&&j.push({id:"pending-bookings",type:"info",message:`${k.length} booking${k.length>1?"s":""} awaiting approval`,timestamp:new Date().toISOString(),read:!1}),p.role==="master_admin"){const w=((g=m.access_requests)==null?void 0:g.filter(y=>y.status==="pending"))||[];w.length>0&&j.push({id:"access-requests",type:"info",message:`${w.length} access request${w.length>1?"s":""} pending review`,timestamp:new Date().toISOString(),read:!1})}}j.sort((k,w)=>new Date(w.timestamp)-new Date(k.timestamp)),e(j.slice(0,10)),i(j.filter(k=>!k.read).length)}catch(m){console.error("Failed to load notifications:",m)}},l=p=>{e(g=>g.map(m=>m.id===p?{...m,read:!0}:m)),i(g=>Math.max(0,g-1))},c=()=>{e(p=>p.map(g=>({...g,read:!0}))),i(0)},d=p=>{switch(p){case"success":return"";case"error":return"";case"warning":return"";case"info":default:return""}},u=p=>{const g=new Date(p),j=new Date-g,k=Math.floor(j/6e4),w=Math.floor(j/36e5),y=Math.floor(j/864e5);return k<1?"Just now":k<60?`${k}m ago`:w<24?`${w}h ago`:y<7?`${y}d ago`:g.toLocaleDateString()};return a.jsxs("div",{className:"notification-center",children:[a.jsxs("button",{className:"notification-bell",onClick:()=>r(!n),"aria-label":`Notifications. ${s} unread`,"data-testid":"notification-bell",children:[a.jsx("span",{className:"bell-icon",children:""}),s>0&&a.jsx("span",{className:"notification-badge","data-testid":"notification-count",children:s>9?"9+":s})]}),n&&a.jsxs("div",{className:"notification-dropdown","data-testid":"notification-dropdown",children:[a.jsxs("div",{className:"notification-header",children:[a.jsx("h3",{children:"Notifications"}),s>0&&a.jsx("button",{onClick:c,className:"btn-text","data-testid":"mark-all-read-btn",children:"Mark all as read"})]}),a.jsx("div",{className:"notification-list",children:t.length===0?a.jsx("div",{className:"notification-empty",children:"No notifications"}):t.map(p=>a.jsxs("div",{className:`notification-item ${p.read?"read":"unread"}`,onClick:()=>!p.read&&l(p.id),"data-testid":"notification-item",children:[a.jsx("span",{className:`notification-icon notification-${p.type}`,children:d(p.type)}),a.jsxs("div",{className:"notification-content",children:[a.jsx("p",{className:"notification-message",children:p.message}),a.jsx("span",{className:"notification-time",children:u(p.timestamp)})]}),!p.read&&a.jsx("span",{className:"unread-dot"})]},p.id))})]})]})}function b0(){const t=Pl(),e=mo(),{user:n}=cn();if(!n)return null;const s=(()=>{switch(n.role){case"student":return[{path:"/student/equipment",icon:"",label:"Browse",testId:"nav-browse"},{path:"/student/bookings",icon:"",label:"Bookings",testId:"nav-bookings"},{path:"/student",icon:"",label:"Dashboard",testId:"nav-dashboard"}];case"staff":return[{path:"/staff",icon:"",label:"Dashboard",testId:"nav-dashboard"},{path:"/staff/rooms",icon:"",label:"Rooms",testId:"nav-rooms"},{path:"/staff/equipment",icon:"",label:"Equipment",testId:"nav-equipment"},{path:"/staff/bookings",icon:"",label:"Bookings",testId:"nav-bookings"}];case"department_admin":return[{path:"/admin",icon:"",label:"Dashboard",testId:"nav-dashboard"},{path:"/admin/bookings",icon:"",label:"Approvals",testId:"nav-approvals"},{path:"/admin/equipment",icon:"",label:"Equipment",testId:"nav-equipment"},{path:"/admin/staff",icon:"",label:"Staff",testId:"nav-staff"}];case"master_admin":return[{path:"/admin",icon:"",label:"Dashboard",testId:"nav-dashboard"},{path:"/admin/users",icon:"",label:"Users",testId:"nav-users"},{path:"/admin/analytics",icon:"",label:"Analytics",testId:"nav-analytics"},{path:"/admin/settings",icon:"",label:"Settings",testId:"nav-settings"}];default:return[]}})(),i=l=>!!(l===e.pathname||l!=="/"&&e.pathname.startsWith(l)),o=l=>{t(l)};return a.jsx("nav",{className:"mobile-bottom-nav","data-testid":"mobile-bottom-nav",children:s.map(l=>a.jsxs("button",{className:`nav-item ${i(l.path)?"active":""}`,onClick:()=>o(l.path),"data-testid":l.testId,"aria-label":l.label,"aria-current":i(l.path)?"page":void 0,children:[a.jsx("span",{className:"nav-icon",role:"img","aria-hidden":"true",children:l.icon}),a.jsx("span",{className:"nav-label",children:l.label})]},l.path))})}function Nr(){const[t,e]=O.useState(null),[n,r]=O.useState(!0);return O.useEffect(()=>{(async()=>{try{const l=await ul.getCurrentUser();e(l)}catch(l){console.error("Failed to load user:",l)}finally{r(!1)}})()},[]),{user:t,loading:n,login:async(o,l)=>{const c=await ul.login(o,l);return e(c),c},logout:async()=>{await ul.logout(),e(null)},isAuthenticated:!!t}}const rl={getUserKits(t){const e=localStorage.getItem(`user_kits_${t}`);return e?JSON.parse(e):[]},saveUserKit(t,e){const n=this.getUserKits(t),r={id:Date.now().toString(),name:e.name,equipment_ids:e.equipment_ids,created_at:new Date().toISOString(),type:"user"};return n.push(r),localStorage.setItem(`user_kits_${t}`,JSON.stringify(n)),r},deleteUserKit(t,e){const r=this.getUserKits(t).filter(s=>s.id!==e);localStorage.setItem(`user_kits_${t}`,JSON.stringify(r))},updateUserKit(t,e,n){const s=this.getUserKits(t).map(i=>i.id===e?{...i,...n,updated_at:new Date().toISOString()}:i);localStorage.setItem(`user_kits_${t}`,JSON.stringify(s))},getAdminKits(){const t=localStorage.getItem("admin_kits");return t?JSON.parse(t):[]},saveAdminKit(t){const e=this.getAdminKits(),n={id:Date.now().toString(),name:t.name,description:t.description,equipment_ids:t.equipment_ids,department:t.department||"all",created_at:new Date().toISOString(),type:"admin"};return e.push(n),localStorage.setItem("admin_kits",JSON.stringify(e)),n},deleteAdminKit(t){const n=this.getAdminKits().filter(r=>r.id!==t);localStorage.setItem("admin_kits",JSON.stringify(n))},updateAdminKit(t,e){const r=this.getAdminKits().map(s=>s.id===t?{...s,...e,updated_at:new Date().toISOString()}:s);localStorage.setItem("admin_kits",JSON.stringify(r))},getAllKitsForUser(t,e){const n=this.getUserKits(t),r=this.getAdminKits().filter(s=>s.department==="all"||s.department===e);return[...n,...r]}};function m5({onClose:t,onSuccess:e}){const{user:n}=cn(),[r,s]=O.useState(1),[i,o]=O.useState(""),[l,c]=O.useState(""),[d,u]=O.useState([]),[p,g]=O.useState([]),[m,j]=O.useState(""),[k,w]=O.useState(!1),[y,_]=O.useState(""),[S,N]=O.useState(!1),[T,U]=O.useState("");O.useEffect(()=>{r===2&&i&&l&&P()},[r,i,l]);const P=async()=>{w(!0);try{const L=(await be.query("equipment",{})).filter(I=>I.status==="available");u(L)}catch(F){_("Failed to load available equipment"),console.error(F)}finally{w(!1)}},b=F=>{if(F.preventDefault(),_(""),!i||!l){_("Please select both start and end dates");return}const L=new Date(i),I=new Date(l),X=new Date;if(X.setHours(0,0,0,0),L<X){_("Start date cannot be in the past");return}if(I<L){_("End date must be after start date");return}s(2)},A=F=>{g(L=>L.find(X=>X.id===F.id)?L.filter(X=>X.id!==F.id):[...L,F])},$=async F=>{if(F.preventDefault(),_(""),p.length===0){_("Please select at least one item");return}if(!m.trim()){_("Please provide a purpose for this booking");return}w(!0);try{S&&T.trim()&&rl.saveUserKit(n.id,{name:T,equipment_ids:p.map(L=>L.id)});for(const L of p)await be.insert("bookings",{user_id:n.id,equipment_id:L.id,start_date:i,end_date:l,status:"pending",purpose:m,student_name:n.full_name,student_email:n.email,equipment_name:L.product_name,category:L.category,created_at:new Date().toISOString()});e()}catch(L){_("Failed to create booking: "+L.message),w(!1)}},D=[...new Set(d.map(F=>F.category))];return a.jsx("div",{className:"modal-overlay",onClick:t,children:a.jsxs("div",{className:"modal-content",onClick:F=>F.stopPropagation(),style:{maxWidth:"800px"},children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:"Book Multiple Items"}),a.jsx("button",{onClick:t,className:"modal-close","aria-label":"Close",children:""})]}),a.jsxs("div",{className:"modal-body",children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2rem",position:"relative"},children:[a.jsxs("div",{style:{flex:1,textAlign:"center",zIndex:1},children:[a.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:r>=1?"var(--primary-color)":"var(--border-color)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto",fontWeight:"bold"},children:"1"}),a.jsx("div",{style:{marginTop:"0.5rem",fontSize:"0.875rem",color:r>=1?"var(--primary-color)":"var(--text-secondary)"},children:"Select Dates"})]}),a.jsxs("div",{style:{flex:1,textAlign:"center",zIndex:1},children:[a.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:r>=2?"var(--primary-color)":"var(--border-color)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto",fontWeight:"bold"},children:"2"}),a.jsx("div",{style:{marginTop:"0.5rem",fontSize:"0.875rem",color:r>=2?"var(--primary-color)":"var(--text-secondary)"},children:"Select Equipment"})]}),a.jsxs("div",{style:{flex:1,textAlign:"center",zIndex:1},children:[a.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:r>=3?"var(--primary-color)":"var(--border-color)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto",fontWeight:"bold"},children:"3"}),a.jsx("div",{style:{marginTop:"0.5rem",fontSize:"0.875rem",color:r>=3?"var(--primary-color)":"var(--text-secondary)"},children:"Confirm"})]}),a.jsx("div",{style:{position:"absolute",top:"20px",left:"20%",right:"20%",height:"2px",background:"var(--border-color)",zIndex:0}})]}),y&&a.jsx("div",{className:"error-message",style:{marginBottom:"1rem"},children:y}),r===1&&a.jsxs("form",{onSubmit:b,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Start Date *"}),a.jsx("input",{type:"date",value:i,onChange:F=>o(F.target.value),className:"form-input",required:!0,"data-testid":"start-date-input"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"End Date *"}),a.jsx("input",{type:"date",value:l,onChange:F=>c(F.target.value),className:"form-input",required:!0,"data-testid":"end-date-input"})]}),a.jsxs("div",{className:"modal-actions",children:[a.jsx("button",{type:"button",onClick:t,className:"btn btn-secondary",children:"Cancel"}),a.jsx("button",{type:"submit",className:"btn btn-primary","data-testid":"next-to-equipment-btn",children:"Next: Select Equipment"})]})]}),r===2&&a.jsxs("div",{children:[a.jsxs("div",{style:{background:"var(--surface)",padding:"1rem",borderRadius:"var(--border-radius)",marginBottom:"1.5rem"},children:[a.jsx("h4",{style:{margin:"0 0 0.5rem 0"},children:"Selected Dates"}),a.jsxs("p",{style:{margin:0,color:"var(--text-secondary)"},children:[new Date(i).toLocaleDateString()," - ",new Date(l).toLocaleDateString()]}),p.length>0&&a.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontWeight:"bold",color:"var(--primary-color)"},children:[p.length," item",p.length!==1?"s":""," selected"]})]}),k?a.jsx("div",{style:{textAlign:"center",padding:"2rem"},children:"Loading available equipment..."}):a.jsxs(a.Fragment,{children:[D.map(F=>{const L=d.filter(I=>I.category===F);return L.length===0?null:a.jsxs("div",{style:{marginBottom:"1.5rem"},children:[a.jsx("h4",{style:{marginBottom:"0.75rem",color:"var(--text-primary)"},children:F}),a.jsx("div",{style:{display:"grid",gap:"0.75rem"},children:L.map(I=>{const X=p.find(te=>te.id===I.id);return a.jsxs("div",{onClick:()=>A(I),style:{padding:"1rem",border:`2px solid ${X?"var(--primary-color)":"var(--border-color)"}`,borderRadius:"var(--border-radius)",cursor:"pointer",background:X?"rgba(102, 126, 234, 0.1)":"white",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"1rem"},"data-testid":"equipment-selection-item",children:[a.jsx("input",{type:"checkbox",checked:X,onChange:()=>{},style:{width:"20px",height:"20px"}}),a.jsxs("div",{style:{flex:1},children:[a.jsx("div",{style:{fontWeight:"600",marginBottom:"0.25rem"},children:I.product_name}),a.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:I.description})]}),a.jsx("div",{className:"equipment-category-label",style:{fontSize:"0.875rem"},children:I.category})]},I.id)})})]},F)}),d.length===0&&a.jsx("div",{style:{textAlign:"center",padding:"2rem",color:"var(--text-secondary)"},children:"No equipment available for the selected dates."})]}),a.jsxs("div",{className:"modal-actions",style:{marginTop:"1.5rem"},children:[a.jsx("button",{onClick:()=>s(1),className:"btn btn-secondary",children:"Back"}),a.jsx("button",{onClick:()=>s(3),className:"btn btn-primary",disabled:p.length===0,"data-testid":"next-to-confirm-btn",children:"Next: Confirm Booking"})]})]}),r===3&&a.jsxs("form",{onSubmit:$,children:[a.jsxs("div",{style:{background:"var(--surface)",padding:"1.5rem",borderRadius:"var(--border-radius)",marginBottom:"1.5rem"},children:[a.jsx("h4",{style:{margin:"0 0 1rem 0"},children:"Booking Summary"}),a.jsxs("div",{style:{marginBottom:"1rem"},children:[a.jsx("div",{style:{fontWeight:"600",marginBottom:"0.5rem"},children:"Dates:"}),a.jsxs("div",{style:{color:"var(--text-secondary)"},children:[new Date(i).toLocaleDateString()," - ",new Date(l).toLocaleDateString()]})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{fontWeight:"600",marginBottom:"0.5rem"},children:["Equipment (",p.length," item",p.length!==1?"s":"","):"]}),a.jsx("ul",{style:{margin:0,paddingLeft:"1.5rem",color:"var(--text-secondary)"},children:p.map(F=>a.jsxs("li",{children:[F.product_name," (",F.category,")"]},F.id))})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{children:["Purpose / Justification *",a.jsx("span",{className:"required",children:" Required for booking approval"})]}),a.jsx("textarea",{value:m,onChange:F=>j(F.target.value),placeholder:"Please describe how you plan to use this equipment...",rows:4,required:!0,"data-testid":"booking-purpose"})]}),a.jsxs("div",{style:{background:"rgba(102, 126, 234, 0.1)",padding:"1rem",borderRadius:"var(--border-radius)",border:"1px solid var(--primary-color)",marginBottom:"1rem"},children:[a.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",marginBottom:S?"0.75rem":"0"},children:[a.jsx("input",{type:"checkbox",checked:S,onChange:F=>N(F.target.checked),style:{width:"18px",height:"18px"},"data-testid":"save-as-kit-checkbox"}),a.jsx("span",{style:{fontWeight:"600"},children:"Save this selection as a reusable kit"})]}),S&&a.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[a.jsx("label",{style:{fontSize:"0.875rem",marginBottom:"0.5rem"},children:"Kit Name *"}),a.jsx("input",{type:"text",value:T,onChange:F=>U(F.target.value),placeholder:"e.g., 'Documentary Filming Kit' or 'Studio Photography Setup'",className:"form-input",required:S,"data-testid":"kit-name-input"}),a.jsx("p",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",margin:"0.5rem 0 0 0"},children:"This kit will appear in your dashboard for quick rebooking."})]})]}),a.jsxs("div",{className:"modal-actions",children:[a.jsx("button",{type:"button",onClick:()=>s(2),className:"btn btn-secondary",disabled:k,children:"Back"}),a.jsx("button",{type:"submit",className:"btn btn-primary",disabled:k,"data-testid":"submit-booking-btn",children:k?"Submitting...":"Submit Booking Request"})]})]})]})]})})}function Yn(){const[t,e]=O.useState([]),n=O.useCallback((s,i="success")=>{const o=Date.now();e(l=>[...l,{id:o,message:s,type:i}])},[]),r=O.useCallback(s=>{e(i=>i.filter(o=>o.id!==s))},[]);return{toasts:t,showToast:n,removeToast:r}}function Jn({message:t,type:e="success",onClose:n,duration:r=3e3}){return O.useEffect(()=>{const s=setTimeout(()=>{n()},r);return()=>clearTimeout(s)},[r,n]),a.jsxs("div",{className:`toast toast-${e}`,role:"alert","data-testid":"toast-notification",children:[a.jsxs("div",{className:"toast-content",children:[a.jsxs("span",{className:"toast-icon",children:[e==="success"&&"",e==="error"&&"",e==="info"&&""]}),a.jsx("span",{className:"toast-message",children:t})]}),a.jsx("button",{className:"toast-close",onClick:n,"aria-label":"Close notification",children:""})]})}function z3(){const{user:t}=Nr(),e=Pl(),[n,r]=O.useState([]),[s,i]=O.useState([]),[o,l]=O.useState(!1),[c,d]=O.useState(!1),{toasts:u,showToast:p,removeToast:g}=Yn();O.useEffect(()=>{m()},[t]);const m=async()=>{if(t)try{const _=await be.query("bookings",{user_id:t.id});r(_);const S=rl.getAllKitsForUser(t.id,t.department);i(S)}catch(_){console.error("Failed to load dashboard data:",_)}},j=n.filter(_=>_.status==="approved").length,k=n.filter(_=>_.status==="pending").length,w=n.length,y=()=>{p("Booking created successfully!","success"),d(!1),m()};return a.jsxs("div",{className:"student-dashboard",children:[a.jsxs("div",{className:"student-welcome",children:[a.jsxs("h2",{children:["Welcome, ",t==null?void 0:t.first_name,"! "]}),a.jsx("p",{children:"Your equipment booking dashboard"})]}),a.jsxs("div",{className:"student-dashboard-grid",children:[a.jsxs("div",{className:"student-card student-stat-card",children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"var(--space-2)"},children:[a.jsxs("h3",{children:[a.jsx("span",{className:"student-card-icon",children:""})," Your Stats"]}),a.jsx("button",{onClick:()=>l(!o),className:"btn btn-secondary btn-sm",style:{fontSize:"0.75rem",padding:"0.25rem 0.75rem"},children:o?"Simple":"Detailed"})]}),o?a.jsxs("div",{className:"student-stat-grid",children:[a.jsxs("div",{className:"student-stat-item",children:[a.jsx("strong",{children:w}),a.jsx("span",{children:"Total"})]}),a.jsxs("div",{className:"student-stat-item",children:[a.jsx("strong",{children:j}),a.jsx("span",{children:"Active"})]}),a.jsxs("div",{className:"student-stat-item",children:[a.jsx("strong",{children:k}),a.jsx("span",{children:"Pending"})]}),a.jsxs("div",{className:"student-stat-item",children:[a.jsx("strong",{children:n.filter(_=>_.status==="completed").length}),a.jsx("span",{children:"Completed"})]})]}):a.jsxs("div",{children:[a.jsx("div",{className:"student-stat-number",children:j}),a.jsx("div",{className:"student-stat-label",children:"Active Bookings"}),k>0&&a.jsx("div",{style:{marginTop:"var(--space-2)",padding:"var(--space-2)",background:"var(--theme-warning-bg)",borderRadius:"var(--radius-sm)"},children:a.jsxs("span",{style:{fontSize:"var(--text-sm)",color:"var(--theme-warning-text)",fontWeight:"var(--font-semibold)"},children:[" ",k," pending approval"]})})]})]}),a.jsxs("div",{className:"student-card",children:[a.jsxs("h3",{children:[a.jsx("span",{className:"student-card-icon",children:""})," Recent Activity"]}),n.length===0?a.jsxs("div",{className:"student-empty-state",children:[a.jsx("div",{className:"student-empty-state-icon",children:""}),a.jsx("p",{children:"No recent activity"})]}):a.jsx("div",{className:"student-activity-list",children:n.slice(0,3).map(_=>a.jsxs("div",{className:"student-activity-item",children:[a.jsx("div",{className:"student-activity-title",children:_.equipment_name}),a.jsxs("div",{className:"student-activity-meta",children:[a.jsx("span",{children:new Date(_.start_date).toLocaleDateString()}),a.jsx("span",{className:`student-status-badge ${_.status}`,children:_.status})]})]},_.id))})]}),a.jsxs("div",{className:"student-card",children:[a.jsxs("h3",{children:[a.jsx("span",{className:"student-card-icon",children:""})," Saved Kits (",s.length,")"]}),s.length===0?a.jsxs("div",{className:"student-empty-state",children:[a.jsx("div",{className:"student-empty-state-icon",children:""}),a.jsx("p",{children:"No saved kits yet. Create custom kits when booking equipment!"})]}):a.jsx("div",{className:"student-kit-list",children:s.map(_=>{var S;return a.jsxs("div",{className:`student-kit-item ${_.type==="admin"?"admin-kit":""}`,onClick:()=>{p(`Booking kit: ${_.name}`,"info"),d(!0)},role:"button",tabIndex:0,onKeyPress:N=>{(N.key==="Enter"||N.key===" ")&&(p(`Booking kit: ${_.name}`,"info"),d(!0))},children:[a.jsxs("div",{className:"student-kit-name",children:[_.type==="admin"?"":""," ",_.name]}),a.jsxs("div",{className:"student-kit-meta",children:[((S=_.equipment_ids)==null?void 0:S.length)||0," items",_.type==="admin"&&"  Admin Kit"]})]},_.id)})})]}),a.jsxs("div",{className:"student-card",children:[a.jsxs("h3",{children:[a.jsx("span",{className:"student-card-icon",children:""})," Quick Actions"]}),a.jsxs("div",{className:"student-quick-actions",children:[a.jsx("button",{onClick:()=>d(!0),className:"student-action-btn","data-testid":"quick-book-multiple",children:" Book Multiple Items"}),a.jsx("button",{onClick:()=>e("/student/equipment"),className:"student-action-btn secondary",children:" Browse Equipment"})]})]})]}),c&&a.jsx(m5,{onClose:()=>d(!1),onSuccess:y}),u.map(_=>a.jsx(Jn,{message:_.message,type:_.type,onClose:()=>g(_.id)},_.id))]})}const ng={async createBooking(t){const{equipment_id:e,start_date:n,end_date:r,user_id:s,purpose:i}=t;if((await this.checkConflicts(e,n,r)).length>0)throw new Error("Equipment is already booked for selected dates");if((await be.findOne("equipment",{id:e})).requires_justification&&(!i||i.trim().length<10))throw new Error("This equipment requires a detailed justification (minimum 10 characters)");const c={id:"bk"+Date.now(),user_id:s,equipment_id:e,start_date:n,end_date:r,purpose:i,status:"pending",created_at:new Date().toISOString()};return await be.insert("bookings",c),c},async getUserBookings(t){return await be.query("bookings",{user_id:t})},async getBookingById(t){return await be.findOne("bookings",{id:t})},async cancelBooking(t){await be.update("bookings",{id:t},{status:"cancelled",cancelled_at:new Date().toISOString()})},async checkConflicts(t,e,n){return(await be.query("bookings",{equipment_id:t})).filter(s=>{if(["cancelled","denied","completed"].includes(s.status))return!1;const i=new Date(s.start_date),o=new Date(s.end_date),l=new Date(e),c=new Date(n);return l<=o&&c>=i})},async getBookingsWithEquipment(t){const e=await this.getUserBookings(t);return await Promise.all(e.map(async r=>{const s=await be.findOne("equipment",{id:r.equipment_id});return{...r,equipment:s}}))}};class bd{constructor(e=0,n="Network Error"){this.status=e,this.text=n}}const W3=()=>{if(!(typeof localStorage>"u"))return{get:t=>Promise.resolve(localStorage.getItem(t)),set:(t,e)=>Promise.resolve(localStorage.setItem(t,e)),remove:t=>Promise.resolve(localStorage.removeItem(t))}},Gn={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:W3()},_0=t=>t?typeof t=="string"?{publicKey:t}:t.toString()==="[object Object]"?t:{}:{},H3=(t,e="https://api.emailjs.com")=>{if(!t)return;const n=_0(t);Gn.publicKey=n.publicKey,Gn.blockHeadless=n.blockHeadless,Gn.storageProvider=n.storageProvider,Gn.blockList=n.blockList,Gn.limitRate=n.limitRate,Gn.origin=n.origin||e},g5=async(t,e,n={})=>{const r=await fetch(Gn.origin+t,{method:"POST",headers:n,body:e}),s=await r.text(),i=new bd(r.status,s);if(r.ok)return i;throw i},v5=(t,e,n)=>{if(!t||typeof t!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!e||typeof e!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!n||typeof n!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},V3=t=>{if(t&&t.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},y5=t=>t.webdriver||!t.languages||t.languages.length===0,b5=()=>new bd(451,"Unavailable For Headless Browser"),G3=(t,e)=>{if(!Array.isArray(t))throw"The BlockList list has to be an array";if(typeof e!="string")throw"The BlockList watchVariable has to be a string"},K3=t=>{var e;return!((e=t.list)!=null&&e.length)||!t.watchVariable},Z3=(t,e)=>t instanceof FormData?t.get(e):t[e],_5=(t,e)=>{if(K3(t))return!1;G3(t.list,t.watchVariable);const n=Z3(e,t.watchVariable);return typeof n!="string"?!1:t.list.includes(n)},x5=()=>new bd(403,"Forbidden"),Y3=(t,e)=>{if(typeof t!="number"||t<0)throw"The LimitRate throttle has to be a positive number";if(e&&typeof e!="string")throw"The LimitRate ID has to be a non-empty string"},J3=async(t,e,n)=>{const r=Number(await n.get(t)||0);return e-Date.now()+r},w5=async(t,e,n)=>{if(!e.throttle||!n)return!1;Y3(e.throttle,e.id);const r=e.id||t;return await J3(r,e.throttle,n)>0?!0:(await n.set(r,Date.now().toString()),!1)},j5=()=>new bd(429,"Too Many Requests"),X3=async(t,e,n,r)=>{const s=_0(r),i=s.publicKey||Gn.publicKey,o=s.blockHeadless||Gn.blockHeadless,l=s.storageProvider||Gn.storageProvider,c={...Gn.blockList,...s.blockList},d={...Gn.limitRate,...s.limitRate};return o&&y5(navigator)?Promise.reject(b5()):(v5(i,t,e),V3(n),n&&_5(c,n)?Promise.reject(x5()):await w5(location.pathname,d,l)?Promise.reject(j5()):g5("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:i,service_id:t,template_id:e,template_params:n}),{"Content-type":"application/json"}))},Q3=t=>{if(!t||t.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},eC=t=>typeof t=="string"?document.querySelector(t):t,tC=async(t,e,n,r)=>{const s=_0(r),i=s.publicKey||Gn.publicKey,o=s.blockHeadless||Gn.blockHeadless,l=Gn.storageProvider||s.storageProvider,c={...Gn.blockList,...s.blockList},d={...Gn.limitRate,...s.limitRate};if(o&&y5(navigator))return Promise.reject(b5());const u=eC(n);v5(i,t,e),Q3(u);const p=new FormData(u);return _5(c,p)?Promise.reject(x5()):await w5(location.pathname,d,l)?Promise.reject(j5()):(p.append("lib_version","4.4.1"),p.append("service_id",t),p.append("template_id",e),p.append("user_id",i),g5("/api/v1.0/email/send-form",p))},Vi={init:H3,send:X3,sendForm:tC,EmailJSResponseStatus:bd},gn={serviceId:"YOUR_SERVICE_ID",publicKey:"YOUR_PUBLIC_KEY",templates:{bookingConfirmation:"template_booking_confirm",bookingApproved:"template_booking_approved",bookingDenied:"template_booking_denied",bookingOverdue:"template_booking_overdue",bookingReminder:"template_booking_reminder"}};class nC{constructor(){gn.publicKey!=="YOUR_PUBLIC_KEY"&&Vi.init(gn.publicKey)}isConfigured(){return gn.serviceId!=="YOUR_SERVICE_ID"&&gn.publicKey!=="YOUR_PUBLIC_KEY"}async sendBookingConfirmation(e,n,r){if(!this.isConfigured())return console.warn("EmailJS not configured. Skipping email notification."),{success:!1,error:"EmailJS not configured"};try{const s=r.map(l=>l.product_name).join(", "),i={to_email:n.email,to_name:n.full_name,booking_id:e.id,equipment_list:s,start_date:new Date(e.start_date).toLocaleDateString(),end_date:new Date(e.end_date).toLocaleDateString(),purpose:e.purpose||"N/A",status:e.status},o=await Vi.send(gn.serviceId,gn.templates.bookingConfirmation,i);return console.log("Booking confirmation email sent:",o),{success:!0,response:o}}catch(s){return console.error("Failed to send booking confirmation email:",s),{success:!1,error:s.message}}}async sendBookingApproved(e,n,r,s){if(!this.isConfigured())return console.warn("EmailJS not configured. Skipping email notification."),{success:!1,error:"EmailJS not configured"};try{const i=r.map(c=>c.product_name).join(", "),o={to_email:n.email,to_name:n.full_name,booking_id:e.id,equipment_list:i,start_date:new Date(e.start_date).toLocaleDateString(),end_date:new Date(e.end_date).toLocaleDateString(),approved_by:s.full_name,approved_at:new Date().toLocaleString(),return_instructions:"Please return equipment on time to avoid late fees."},l=await Vi.send(gn.serviceId,gn.templates.bookingApproved,o);return console.log("Booking approval email sent:",l),{success:!0,response:l}}catch(i){return console.error("Failed to send booking approval email:",i),{success:!1,error:i.message}}}async sendBookingDenied(e,n,r,s,i){if(!this.isConfigured())return console.warn("EmailJS not configured. Skipping email notification."),{success:!1,error:"EmailJS not configured"};try{const o=r.map(d=>d.product_name).join(", "),l={to_email:n.email,to_name:n.full_name,booking_id:e.id,equipment_list:o,start_date:new Date(e.start_date).toLocaleDateString(),end_date:new Date(e.end_date).toLocaleDateString(),denied_by:s.full_name,denied_at:new Date().toLocaleString(),denial_reason:i||"No reason provided",support_email:"equipment@ncad.ie"},c=await Vi.send(gn.serviceId,gn.templates.bookingDenied,l);return console.log("Booking denial email sent:",c),{success:!0,response:c}}catch(o){return console.error("Failed to send booking denial email:",o),{success:!1,error:o.message}}}async sendOverdueReminder(e,n,r,s){if(!this.isConfigured())return console.warn("EmailJS not configured. Skipping email notification."),{success:!1,error:"EmailJS not configured"};try{const i=r.map(c=>c.product_name).join(", "),o={to_email:n.email,to_name:n.full_name,booking_id:e.id,equipment_list:i,end_date:new Date(e.end_date).toLocaleDateString(),days_overdue:s,late_fee_warning:s>7?"Late fees may apply.":"",return_location:"Equipment Store, Building A",support_email:"equipment@ncad.ie"},l=await Vi.send(gn.serviceId,gn.templates.bookingOverdue,o);return console.log("Overdue reminder email sent:",l),{success:!0,response:l}}catch(i){return console.error("Failed to send overdue reminder email:",i),{success:!1,error:i.message}}}async sendBookingReminder(e,n,r,s){if(!this.isConfigured())return console.warn("EmailJS not configured. Skipping email notification."),{success:!1,error:"EmailJS not configured"};try{const i=r.map(c=>c.product_name).join(", "),o={to_email:n.email,to_name:n.full_name,booking_id:e.id,equipment_list:i,start_date:new Date(e.start_date).toLocaleDateString(),end_date:new Date(e.end_date).toLocaleDateString(),days_until_pickup:s,pickup_location:"Equipment Store, Building A",pickup_hours:"Mon-Fri: 9am-5pm"},l=await Vi.send(gn.serviceId,gn.templates.bookingReminder,o);return console.log("Booking reminder email sent:",l),{success:!0,response:l}}catch(i){return console.error("Failed to send booking reminder email:",i),{success:!1,error:i.message}}}updateConfig(e){e.serviceId&&(gn.serviceId=e.serviceId),e.publicKey&&(gn.publicKey=e.publicKey,Vi.init(e.publicKey)),e.templates&&(gn.templates={...gn.templates,...e.templates})}getConfig(){return{serviceId:gn.serviceId,publicKey:gn.publicKey,templates:{...gn.templates},isConfigured:this.isConfigured()}}}const Vn=new nC;function rC({equipmentId:t,selectedStartDate:e,selectedEndDate:n}){const[r,s]=O.useState([]),[i,o]=O.useState(new Date);O.useEffect(()=>{t&&l()},[t,i]);const l=async()=>{try{const T=(await be.query("bookings",{equipment_id:t})).filter(U=>U.status==="approved");s(T)}catch(N){console.error("Failed to load bookings:",N)}},c=N=>{const T=N.getFullYear(),U=N.getMonth(),P=new Date(T,U,1),A=new Date(T,U+1,0).getDate(),$=P.getDay();return{daysInMonth:A,startDayOfWeek:$,year:T,month:U}},d=N=>{const T=N.toISOString().split("T")[0];return r.some(U=>{const P=new Date(U.start_date),b=new Date(U.end_date),A=new Date(T);return A>=P&&A<=b})},u=N=>{if(!e||!n)return!1;const T=N.toISOString().split("T")[0],U=new Date(e),P=new Date(n),b=new Date(T);return b>=U&&b<=P},p=N=>{const T=new Date;return T.setHours(0,0,0,0),N<T},{daysInMonth:g,startDayOfWeek:m,year:j,month:k}=c(i),w=()=>{o(new Date(j,k-1))},y=()=>{o(new Date(j,k+1))},_=["January","February","March","April","May","June","July","August","September","October","November","December"],S=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return a.jsxs("div",{className:"booking-conflict-calendar","data-testid":"conflict-calendar",children:[a.jsxs("div",{className:"calendar-header",children:[a.jsx("button",{onClick:w,className:"btn btn-secondary btn-sm","aria-label":"Previous month","data-testid":"prev-month-btn",children:"Previous"}),a.jsxs("h3",{children:[_[k]," ",j]}),a.jsx("button",{onClick:y,className:"btn btn-secondary btn-sm","aria-label":"Next month","data-testid":"next-month-btn",children:"Next"})]}),a.jsxs("div",{className:"calendar-legend",children:[a.jsxs("div",{className:"legend-item",children:[a.jsx("span",{className:"legend-color available"}),a.jsx("span",{children:"Available"})]}),a.jsxs("div",{className:"legend-item",children:[a.jsx("span",{className:"legend-color booked"}),a.jsx("span",{children:"Booked"})]}),a.jsxs("div",{className:"legend-item",children:[a.jsx("span",{className:"legend-color selected"}),a.jsx("span",{children:"Your Selection"})]}),a.jsxs("div",{className:"legend-item",children:[a.jsx("span",{className:"legend-color past"}),a.jsx("span",{children:"Past"})]})]}),a.jsxs("div",{className:"calendar-grid",children:[a.jsx("div",{className:"calendar-days-header",children:S.map(N=>a.jsx("div",{className:"calendar-day-name",children:N},N))}),a.jsxs("div",{className:"calendar-days",children:[Array.from({length:m}).map((N,T)=>a.jsx("div",{className:"calendar-day empty"},`empty-${T}`)),Array.from({length:g}).map((N,T)=>{const U=T+1,P=new Date(j,k,U),b=d(P),A=u(P),$=p(P),D=["calendar-day",b&&"booked",A&&"selected",$&&"past"].filter(Boolean).join(" ");return a.jsx("div",{className:D,"data-testid":`calendar-day-${U}`,"aria-label":`${_[k]} ${U}, ${j}${b?" - Booked":""}${A?" - Selected":""}`,children:U},U)})]})]}),a.jsx("div",{className:"calendar-info",children:a.jsx("p",{children:"This calendar shows when this equipment is already booked. Select dates that are available."})})]})}function sC({selectedStartDate:t,selectedEndDate:e,onStartDateChange:n,onEndDateChange:r,minDate:s=new Date,unavailableDates:i=[],mode:o="range"}){const[l,c]=O.useState(new Date),[d,u]=O.useState(!0),[p,g]=O.useState(!1),[m,j]=O.useState(null),k=O.useRef(null),w=O.useRef(0),y=de=>{const E=de.getFullYear(),H=de.getMonth(),J=new Date(E,H,1),ne=new Date(E,H+1,0).getDate(),le=J.getDay();return{daysInMonth:ne,startingDayOfWeek:le,year:E,month:H}},{daysInMonth:_,startingDayOfWeek:S,year:N,month:T}=y(l),U=()=>{c(new Date(l.getFullYear(),l.getMonth()-1,1))},P=()=>{c(new Date(l.getFullYear(),l.getMonth()+1,1))},b=de=>{w.current=de.touches[0].clientX},A=de=>{const E=de.changedTouches[0].clientX,H=w.current-E;H>50?P():H<-50&&U()},$=de=>i.some(E=>E.toDateString()===de.toDateString()),D=de=>{const E=new Date(s);return E.setHours(0,0,0,0),de.setHours(0,0,0,0),de<E},F=de=>{if(!t)return!1;const E=de.toDateString(),H=t.toDateString();if(o==="single"||!e)return E===H;const J=e.toDateString();return E===H||E===J},L=de=>!t||!e||o==="single"?!1:de>t&&de<e,I=de=>{const E=new Date(N,T,de);if(!(D(E)||$(E))){if(o==="single"){n(E);return}d||!t?(n(E),r(null),u(!1)):(E<t?(r(t),n(E)):r(E),u(!0))}},X=de=>{if(o!=="range")return;const E=new Date(N,T,de);D(E)||$(E)||(g(!0),j(E),n(E),r(null))},te=de=>{if(!p||o!=="range")return;const E=new Date(N,T,de);D(E)||$(E)||(E>m?r(E):(n(E),r(m)))},oe=()=>{g(!1),j(null),u(!0)};O.useEffect(()=>(document.addEventListener("mouseup",oe),()=>document.removeEventListener("mouseup",oe)),[]);const Z=de=>{const E=new Date(N,T,de),H=["calendar-day"];return D(E)&&H.push("disabled"),$(E)&&H.push("unavailable"),F(E)&&H.push("selected"),L(E)&&H.push("in-range"),E.toDateString()===new Date().toDateString()&&H.push("today"),H.join(" ")},ae=()=>{const de=[];for(let E=0;E<S;E++)de.push(a.jsx("div",{className:"calendar-day empty"},`empty-${E}`));for(let E=1;E<=_;E++)de.push(a.jsx("button",{type:"button",className:Z(E),onClick:()=>I(E),onMouseDown:()=>X(E),onMouseEnter:()=>te(E),disabled:D(new Date(N,T,E))||$(new Date(N,T,E)),"data-testid":`calendar-day-${E}`,"aria-label":`${T+1}/${E}/${N}`,children:E},E));return de},ee=["January","February","March","April","May","June","July","August","September","October","November","December"];return a.jsxs("div",{className:"mobile-calendar",ref:k,onTouchStart:b,onTouchEnd:A,"data-testid":"mobile-calendar",children:[a.jsxs("div",{className:"calendar-header",children:[a.jsx("button",{type:"button",className:"calendar-nav-btn",onClick:U,"aria-label":"Previous month","data-testid":"prev-month-btn",children:""}),a.jsxs("h3",{className:"calendar-month-year",children:[ee[T]," ",N]}),a.jsx("button",{type:"button",className:"calendar-nav-btn",onClick:P,"aria-label":"Next month","data-testid":"next-month-btn",children:""})]}),a.jsxs("div",{className:"calendar-weekdays",children:[a.jsx("div",{className:"calendar-weekday",children:"Sun"}),a.jsx("div",{className:"calendar-weekday",children:"Mon"}),a.jsx("div",{className:"calendar-weekday",children:"Tue"}),a.jsx("div",{className:"calendar-weekday",children:"Wed"}),a.jsx("div",{className:"calendar-weekday",children:"Thu"}),a.jsx("div",{className:"calendar-weekday",children:"Fri"}),a.jsx("div",{className:"calendar-weekday",children:"Sat"})]}),a.jsx("div",{className:"calendar-grid","data-testid":"calendar-grid",children:ae()}),o==="range"&&a.jsxs("div",{className:"calendar-hint",children:[d&&!t&&a.jsx("span",{children:"Tap to select start date"}),!d&&t&&!e&&a.jsx("span",{children:"Tap to select end date"}),t&&e&&a.jsx("span",{children:"Drag to select range or tap to change"})]})]})}function S5({equipment:t,onClose:e,onSuccess:n}){const{user:r}=Nr(),[s,i]=O.useState(""),[o,l]=O.useState(""),[c,d]=O.useState(null),[u,p]=O.useState(null),[g,m]=O.useState(""),[j,k]=O.useState(""),[w,y]=O.useState({}),[_,S]=O.useState(!1),[N,T]=O.useState(window.innerWidth<=768),U=()=>{var L;return r?r.role==="student"||r.role==="department_admin"||r.role==="master_admin"?!0:r.role==="staff"?((L=r.view_permissions)==null?void 0:L.can_create_bookings)!==!1:!0:!1},P=()=>{const L={};return s||(L.startDate="Start date is required"),o?s&&o<s&&(L.endDate="End date must be after start date"):L.endDate="End date is required",t.requires_justification&&(!g||g.trim().length<10)&&(L.purpose="Purpose must be at least 10 characters"),L},b=async L=>{L.preventDefault(),k(""),y({});const I=P();if(Object.keys(I).length>0){y(I);return}S(!0);try{const X=await ng.createBooking({equipment_id:t.id,start_date:s,end_date:o,purpose:g,user_id:r.id});try{const te=[t],oe=await Vn.sendBookingConfirmation(X,r,te);!oe.success&&Vn.isConfigured()&&console.warn("Email notification failed, but booking was created:",oe.error)}catch(te){console.error("Failed to send booking confirmation email:",te)}n(X),e()}catch(X){k(X.message)}finally{S(!1)}},A=new Date().toISOString().split("T")[0],$=L=>{d(L),i(F(L))},D=L=>{p(L),L&&l(F(L))},F=L=>{if(!L)return"";const I=L.getFullYear(),X=String(L.getMonth()+1).padStart(2,"0"),te=String(L.getDate()).padStart(2,"0");return`${I}-${X}-${te}`};return U()?a.jsx("div",{className:"modal-overlay",onClick:e,"data-testid":"modal-overlay",children:a.jsxs("div",{className:"modal-content modal",onClick:L=>L.stopPropagation(),"data-testid":"booking-modal",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:"Book Equipment"}),a.jsx("button",{className:"modal-close",onClick:e,"aria-label":"Close",children:""})]}),a.jsxs("div",{className:"modal-body",children:[a.jsxs("div",{className:"equipment-summary",children:[a.jsx("h3",{children:t.product_name}),a.jsxs("p",{children:[t.category," - ",t.department]})]}),t.isCrossDepartment&&a.jsxs("div",{className:"cross-department-notice",style:{marginTop:"1rem",marginBottom:"1.5rem",padding:"1rem",backgroundColor:"#e3f2fd",border:"2px solid #2196f3",borderRadius:"8px"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"0.75rem"},children:[a.jsx("span",{style:{fontSize:"1.5rem",marginRight:"0.5rem"},children:""}),a.jsx("h4",{style:{margin:0,color:"#1976d2",fontSize:"1.1rem"},children:"Cross-Department Equipment"})]}),a.jsxs("p",{style:{margin:"0.5rem 0",color:"#333",fontSize:"0.95rem"},children:[a.jsx("strong",{children:"From:"})," ",t.lendingDepartment]}),a.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",backgroundColor:"#fff",borderRadius:"4px",border:"1px solid #bbdefb"},children:[a.jsx("h5",{style:{margin:"0 0 0.5rem 0",color:"#1976d2",fontSize:"0.9rem"},children:" Collection Instructions"}),a.jsx("p",{style:{margin:0,fontSize:"0.875rem",lineHeight:"1.5",color:"#333",whiteSpace:"pre-wrap"},children:t.collectionInstructions})]}),t.crossDeptTerms&&a.jsxs("div",{style:{marginTop:"0.75rem",padding:"0.75rem",backgroundColor:"#fff8e1",borderRadius:"4px",border:"1px solid #ffe082"},children:[a.jsx("h5",{style:{margin:"0 0 0.5rem 0",color:"#f57c00",fontSize:"0.9rem"},children:" Terms & Conditions"}),a.jsx("p",{style:{margin:0,fontSize:"0.875rem",lineHeight:"1.5",color:"#333",whiteSpace:"pre-wrap"},children:t.crossDeptTerms})]})]}),a.jsxs("form",{onSubmit:b,"data-testid":"booking-form",noValidate:!0,children:[N?a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Select Dates"}),a.jsx(sC,{selectedStartDate:c,selectedEndDate:u,onStartDateChange:$,onEndDateChange:D,minDate:new Date,mode:"range"}),(w.startDate||w.endDate)&&a.jsx("div",{className:"field-error",role:"alert",children:w.startDate||w.endDate})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"start-date",children:"Start Date"}),a.jsx("input",{id:"start-date",name:"startDate",type:"date",value:s,onChange:L=>i(L.target.value),min:A,required:!0,"data-testid":"start-date-input",className:w.startDate?"error":""}),w.startDate&&a.jsx("div",{className:"field-error",role:"alert",children:w.startDate})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"end-date",children:"End Date"}),a.jsx("input",{id:"end-date",name:"endDate",type:"date",value:o,onChange:L=>l(L.target.value),min:s||A,required:!0,"data-testid":"end-date-input",className:w.endDate?"error":""}),w.endDate&&a.jsx("div",{className:"field-error",role:"alert",children:w.endDate})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"purpose",children:["Purpose/Justification",t.requires_justification&&a.jsx("span",{className:"required",children:" *Required (min 10 chars)"})]}),a.jsx("textarea",{id:"purpose",name:"purpose",value:g,onChange:L=>m(L.target.value),placeholder:"Describe how you will use this equipment...",rows:"4",required:t.requires_justification,"data-testid":"purpose-input",className:w.purpose?"error":""}),w.purpose&&a.jsx("div",{className:"field-error",role:"alert",children:w.purpose})]}),s&&o&&a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Booking Availability Calendar"}),a.jsx(rC,{equipmentId:t.id,selectedStartDate:s,selectedEndDate:o})]}),j&&a.jsx("div",{className:"error-message",role:"alert",children:j}),a.jsxs("div",{className:"modal-actions",children:[a.jsx("button",{type:"button",onClick:e,className:"btn btn-secondary","data-testid":"cancel-booking-btn",children:"Cancel"}),a.jsx("button",{type:"submit",className:"btn btn-primary",disabled:_,"data-testid":"submit-booking-btn",children:_?"Creating Booking...":"Create Booking"})]})]})]})]})}):a.jsx("div",{className:"modal-overlay",onClick:e,"data-testid":"modal-overlay",children:a.jsxs("div",{className:"modal-content modal",onClick:L=>L.stopPropagation(),"data-testid":"booking-modal",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:"Access Restricted"}),a.jsx("button",{className:"modal-close",onClick:e,"aria-label":"Close",children:""})]}),a.jsxs("div",{className:"modal-body",children:[a.jsxs("div",{className:"restriction-message",style:{textAlign:"center",padding:"2rem",background:"#fff3cd",border:"2px solid #ffc107",borderRadius:"8px"},children:[a.jsx("h3",{style:{color:"#856404",marginBottom:"1rem"},children:"Cannot Create Booking"}),a.jsx("p",{style:{color:"#856404",marginBottom:"0.5rem"},children:"You do not have permission to create equipment bookings."}),a.jsx("p",{style:{color:"#856404"},children:"Please contact your department admin to request access."})]}),a.jsx("div",{className:"modal-actions",style:{marginTop:"1.5rem",display:"flex",justifyContent:"center"},children:a.jsx("button",{onClick:e,className:"btn btn-secondary",children:"Close"})})]})]})})}const aC={camera:"",lens:"",lighting:"",audio:"",video:"",tripod:"",computer:"",software:"",storage:"",accessory:"",default:""},iC=(t="",e="")=>{const n=`${t} ${e}`.toLowerCase();return n.match(/camera|canon|nikon|sony|dslr|mirrorless/)?"camera":n.match(/lens|mm|f\/|zoom|prime|telephoto|wide/)?"lens":n.match(/light|led|softbox|reflector|flash|strobe/)?"lighting":n.match(/mic|microphone|audio|recorder|sound|boom/)?"audio":n.match(/video|camcorder|recorder/)?"video":n.match(/tripod|stand|mount|rig|gimbal/)?"tripod":n.match(/computer|laptop|mac|pc|imac/)?"computer":n.match(/software|license|adobe|final cut/)?"software":n.match(/sd card|memory|hard drive|ssd|storage/)?"storage":n.match(/cable|adapter|charger|battery|bag|case/)?"accessory":"default"};function k5({equipment:t,size:e="medium",showCategory:n=!1}){const[r,s]=O.useState(!1),[i,o]=O.useState(!0),l=iC(t==null?void 0:t.product_name,t==null?void 0:t.description),c=aC[l],d=(t==null?void 0:t.link_to_image)&&!r,u=()=>{s(!0),o(!1)},p=()=>{o(!1)};return a.jsx("div",{className:`equipment-image equipment-image--${e}`,children:d?a.jsxs(a.Fragment,{children:[i&&a.jsx("div",{className:"equipment-image-skeleton",children:a.jsx("span",{className:"equipment-image-placeholder-icon",children:c})}),a.jsx("img",{src:t.link_to_image,alt:t.product_name,onError:u,onLoad:p,loading:"lazy",className:i?"equipment-image-hidden":"equipment-image-loaded"})]}):a.jsxs("div",{className:"equipment-image-placeholder",children:[a.jsx("span",{className:"equipment-image-placeholder-icon",children:c}),n&&a.jsx("span",{className:"equipment-image-category",children:l})]})})}function oC({equipment:t,onClose:e,onBookClick:n}){return t?a.jsx("div",{className:"modal-overlay",onClick:e,"data-testid":"modal-overlay",children:a.jsxs("div",{className:"modal-content equipment-details",onClick:r=>r.stopPropagation(),"data-testid":"equipment-details",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:t.product_name}),a.jsx("button",{className:"btn-close",onClick:e,"aria-label":"Close details",children:""})]}),a.jsxs("div",{className:"modal-body",children:[a.jsx(k5,{equipment:t,size:"detail",showCategory:!0}),a.jsxs("div",{className:"equipment-details-info",children:[a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"label",children:"Category:"}),a.jsx("span",{className:"value",children:t.category})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"label",children:"Department:"}),a.jsx("span",{className:"value",children:t.department})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"label",children:"Status:"}),a.jsx("span",{className:`status status-${t.status}`,children:t.status})]}),a.jsxs("div",{className:"detail-row detail-description",children:[a.jsx("span",{className:"label",children:"Description:"}),a.jsx("p",{className:"value",children:t.description})]}),t.link_to_image&&a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"label",children:"Manufacturer Link:"}),a.jsx("a",{href:t.link_to_image,target:"_blank",rel:"noopener noreferrer",children:"View Product Info"})]})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{className:"btn btn-secondary",onClick:e,children:"Close"}),t.status==="available"&&n&&a.jsx("button",{className:"btn btn-primary",onClick:()=>{e(),n(t)},"data-testid":"book-from-details-btn",children:"Book Equipment"})]})]})}):null}function nf({onSearch:t,placeholder:e="Search...",debounceMs:n=300,ariaLabel:r="Search"}){const[s,i]=O.useState(""),o=O.useRef(null);O.useEffect(()=>(o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{t(s)},n),()=>{o.current&&clearTimeout(o.current)}),[s,n,t]);const l=()=>{i(""),t("")};return a.jsxs("div",{className:"search-bar",role:"search",children:[a.jsx("label",{htmlFor:"search-input",className:"visually-hidden",children:r}),a.jsx("input",{id:"search-input",type:"text",value:s,onChange:c=>i(c.target.value),placeholder:e,className:"search-input","aria-label":r,"data-testid":"search-input"}),s&&a.jsx("button",{onClick:l,className:"btn-clear-search","aria-label":"Clear search","data-testid":"clear-search-btn",children:"Clear"})]})}function ld({currentPage:t,totalItems:e,itemsPerPage:n=20,onPageChange:r,loading:s=!1}){const i=Math.ceil(e/n);if(i<=1)return null;const o=(t-1)*n+1,l=Math.min(t*n,e),c=()=>{t>1&&r(t-1)},d=()=>{t<i&&r(t+1)},u=g=>{r(g)},p=()=>{const g=[];if(i<=5)for(let j=1;j<=i;j++)g.push(j);else{let j=Math.max(1,t-2),k=Math.min(i,t+2);t<=3?k=5:t>=i-2&&(j=i-5+1),j>1&&(g.push(1),j>2&&g.push("..."));for(let w=j;w<=k;w++)g.push(w);k<i&&(k<i-1&&g.push("..."),g.push(i))}return g};return a.jsxs("div",{className:"pagination",role:"navigation","aria-label":"Pagination",children:[a.jsxs("div",{className:"pagination-info",children:["Showing ",o," to ",l," of ",e," items"]}),a.jsxs("div",{className:"pagination-controls",children:[a.jsx("button",{onClick:c,disabled:t===1||s,className:"btn btn-secondary btn-sm","aria-label":"Previous page","data-testid":"pagination-prev",children:"Previous"}),a.jsx("div",{className:"pagination-pages",children:p().map((g,m)=>g==="..."?a.jsx("span",{className:"pagination-ellipsis",children:"..."},`ellipsis-${m}`):a.jsx("button",{onClick:()=>u(g),disabled:s,className:`btn btn-sm ${t===g?"btn-primary":"btn-secondary"}`,"aria-label":`Page ${g}`,"aria-current":t===g?"page":void 0,"data-testid":`pagination-page-${g}`,children:g},g))}),a.jsx("button",{onClick:d,disabled:t===i||s,className:"btn btn-secondary btn-sm","aria-label":"Next page","data-testid":"pagination-next",children:"Next"})]}),a.jsx("div",{className:"pagination-mobile",children:t<i&&a.jsx("button",{onClick:d,disabled:s,className:"btn btn-primary btn-block","data-testid":"load-more-btn",children:s?"Loading...":"Load More"})})]})}function cd({type:t="card",count:e=3}){const n=()=>{switch(t){case"card":return a.jsxs("div",{className:"skeleton-card",children:[a.jsx("div",{className:"skeleton-image"}),a.jsxs("div",{className:"skeleton-content",children:[a.jsx("div",{className:"skeleton-title"}),a.jsx("div",{className:"skeleton-text"}),a.jsx("div",{className:"skeleton-text",style:{width:"70%"}}),a.jsx("div",{className:"skeleton-button"})]})]});case"table-row":return a.jsxs("tr",{className:"skeleton-row",children:[a.jsx("td",{children:a.jsx("div",{className:"skeleton-text"})}),a.jsx("td",{children:a.jsx("div",{className:"skeleton-text",style:{width:"60%"}})}),a.jsx("td",{children:a.jsx("div",{className:"skeleton-text",style:{width:"80%"}})}),a.jsx("td",{children:a.jsx("div",{className:"skeleton-text",style:{width:"50%"}})}),a.jsx("td",{children:a.jsx("div",{className:"skeleton-button"})})]});case"list-item":return a.jsxs("div",{className:"skeleton-list-item",children:[a.jsx("div",{className:"skeleton-text"}),a.jsx("div",{className:"skeleton-text",style:{width:"80%"}})]});default:return a.jsxs("div",{className:"skeleton-block",children:[a.jsx("div",{className:"skeleton-text"}),a.jsx("div",{className:"skeleton-text",style:{width:"90%"}}),a.jsx("div",{className:"skeleton-text",style:{width:"75%"}})]})}};return a.jsx("div",{className:"loading-skeleton","aria-busy":"true","aria-label":"Loading content",children:Array.from({length:e}).map((r,s)=>a.jsx("div",{children:n()},s))})}function lC({onFilterChange:t}){const[e,n]=O.useState("all"),[r,s]=O.useState(""),i=l=>{n(l),t(l==="custom"&&r?{type:"custom",date:r}:{type:l})},o=l=>{s(l),l&&(n("custom"),t({type:"custom",date:l}))};return a.jsxs("div",{className:"availability-filter",role:"group","aria-label":"Filter by availability",children:[a.jsx("div",{className:"filter-label",children:a.jsx("strong",{children:"Availability:"})}),a.jsxs("div",{className:"filter-options",children:[a.jsx("button",{onClick:()=>i("all"),className:e==="all"?"btn btn-primary btn-sm":"btn btn-secondary btn-sm","data-testid":"filter-all",children:"All Equipment"}),a.jsx("button",{onClick:()=>i("available"),className:e==="available"?"btn btn-primary btn-sm":"btn btn-secondary btn-sm","data-testid":"filter-available-now",children:"Available Now"}),a.jsx("button",{onClick:()=>i("custom"),className:e==="custom"?"btn btn-primary btn-sm":"btn btn-secondary btn-sm","data-testid":"filter-custom-date",children:"Available on Date"})]}),e==="custom"&&a.jsxs("div",{className:"custom-date-picker",children:[a.jsx("label",{htmlFor:"availability-date",className:"visually-hidden",children:"Select date"}),a.jsx("input",{id:"availability-date",type:"date",value:r,onChange:l=>o(l.target.value),min:new Date().toISOString().split("T")[0],className:"date-input","data-testid":"custom-date-input"})]})]})}function x0({onRefresh:t,children:e}){const[n,r]=O.useState(0),[s,i]=O.useState(!1),[o,l]=O.useState(!1),[c,d]=O.useState(0),u=O.useRef(null),p=80,g=120,m=S=>{var T;(((T=u.current)==null?void 0:T.scrollTop)||window.scrollY)===0&&!o&&(d(S.touches[0].clientY),i(!0))},j=S=>{if(!s||o)return;const T=S.touches[0].clientY-c;if(T>0){T>10&&S.preventDefault();const P=Math.min(T*.5,g);r(P)}},k=async()=>{if(s)if(i(!1),n>=p&&!o){l(!0),window.navigator.vibrate&&window.navigator.vibrate(50);try{await t()}catch(S){console.error("Refresh failed:",S)}finally{setTimeout(()=>{l(!1),r(0)},500)}}else r(0)},w=()=>o?360:n/p*180,y=()=>o?1:Math.min(n/p,1),_=()=>o?"Refreshing...":n>=p?"Release to refresh":n>0?"Pull to refresh":"";return a.jsxs("div",{ref:u,className:"pull-to-refresh-container",onTouchStart:m,onTouchMove:j,onTouchEnd:k,"data-testid":"pull-to-refresh-container",children:[a.jsxs("div",{className:`pull-indicator ${o?"refreshing":""}`,style:{transform:`translateY(${n}px)`,opacity:y(),transition:s?"none":"transform 0.3s ease-out, opacity 0.3s ease-out"},"data-testid":"pull-indicator",children:[a.jsx("div",{className:`spinner ${o?"spinning":""}`,style:{transform:`rotate(${w()}deg)`,transition:o?"none":"transform 0.2s ease-out"},children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:a.jsx("circle",{cx:"12",cy:"12",r:"10",strokeWidth:"3",strokeLinecap:"round"})})}),a.jsx("span",{className:"status-message",children:_()})]}),a.jsx("div",{className:"pull-to-refresh-content",style:{transform:`translateY(${n}px)`,transition:s?"none":"transform 0.3s ease-out"},children:e})]})}async function N5(t,e=!0){try{const n=await be.query("equipment_kits",{department_id:t});return e?n.filter(r=>r.is_active):n}catch(n){throw console.error("Error fetching equipment kits:",n),n}}async function w0(t){try{const e=await be.query("equipment_kits",{id:t});if(e.length===0)throw new Error("Kit not found");const n=e[0],r=await be.query("equipment");return n.equipment=n.equipment_ids.map(s=>r.find(i=>i.id===s)).filter(Boolean),n}catch(e){throw console.error("Error fetching kit:",e),e}}async function cC(t){try{const e={id:`kit${Date.now()}`,...t,created_at:new Date().toISOString(),is_active:!0},n=be.getData();return n.equipment_kits=n.equipment_kits||[],n.equipment_kits.push(e),be.saveData(n),e}catch(e){throw console.error("Error creating kit:",e),e}}async function C5(t,e){try{const n=be.getData(),r=n.equipment_kits||[],s=r.findIndex(i=>i.id===t);if(s===-1)throw new Error("Kit not found");return r[s]={...r[s],...e,updated_at:new Date().toISOString()},n.equipment_kits=r,be.saveData(n),r[s]}catch(n){throw console.error("Error updating kit:",n),n}}async function dC(t){try{await C5(t,{is_active:!1})}catch(e){throw console.error("Error deleting kit:",e),e}}async function A5(t,e,n){try{const r=await w0(t),s=await be.query("bookings"),i=[];for(const o of r.equipment_ids){const l=s.filter(c=>{if(c.equipment_id!==o||c.status!=="approved")return!1;const d=new Date(c.start_date),u=new Date(c.end_date),p=new Date(e),g=new Date(n);return p<=u&&g>=d});if(l.length>0){const c=r.equipment.find(d=>d.id===o);i.push({equipment:c,conflictingBookings:l})}}return{available:i.length===0,unavailableItems:i}}catch(r){throw console.error("Error checking kit availability:",r),r}}async function uC(t){const{kitId:e,userId:n,startDate:r,endDate:s,justification:i}=t;try{if(!(await A5(e,r,s)).available)throw new Error("Some equipment in this kit is not available for the selected dates");const l=await w0(e),c=[];for(const p of l.equipment_ids){const g={id:`book${Date.now()}_${p}`,equipment_id:p,user_id:n,start_date:r,end_date:s,status:"pending",justification:i||`Part of kit booking: ${l.name}`,kit_booking_id:`kitbook${Date.now()}`,created_at:new Date().toISOString()},m=be.getData();m.bookings=m.bookings||[],m.bookings.push(g),be.saveData(m),c.push(g.id)}const d={id:`kitbook${Date.now()}`,kit_id:e,booking_ids:c,user_id:n,start_date:r,end_date:s,status:"pending",created_at:new Date().toISOString()},u=be.getData();return u.kit_bookings=u.kit_bookings||[],u.kit_bookings.push(d),be.saveData(u),d}catch(o){throw console.error("Error booking kit:",o),o}}function hC({onBookingSuccess:t}){const{user:e}=cn(),[n,r]=O.useState([]),[s,i]=O.useState(null),[o,l]=O.useState(null),[c,d]=O.useState(!0),[u,p]=O.useState({start:"",end:""}),[g,m]=O.useState(null),[j,k]=O.useState(!1),[w,y]=O.useState(!1),[_,S]=O.useState("");O.useEffect(()=>{N()},[]);const N=async()=>{d(!0);try{const b=await N5(e.department,!0);r(b)}catch(b){console.error("Failed to load kits:",b)}finally{d(!1)}},T=async b=>{i(b),p({start:"",end:""}),m(null),S("");try{const A=await w0(b.id);l(A)}catch(A){console.error("Failed to load kit details:",A)}},U=async()=>{if(!u.start||!u.end){alert("Please select both start and end dates");return}k(!0);try{const b=await A5(s.id,u.start,u.end);m(b)}catch(b){console.error("Failed to check availability:",b),alert("Failed to check availability")}finally{k(!1)}},P=async()=>{if(!g||!g.available){alert("Please check availability first");return}if(_.trim().length<30){alert("Please provide a justification (minimum 30 characters)");return}y(!0);try{await uC({kitId:s.id,userId:e.id,startDate:u.start,endDate:u.end,justification:_.trim()}),alert(`Kit booked successfully! ${o.equipment_ids.length} individual bookings created. Awaiting admin approval.`),i(null),l(null),p({start:"",end:""}),m(null),S(""),t&&t()}catch(b){console.error("Failed to book kit:",b),alert(b.message||"Failed to book kit")}finally{y(!1)}};return c?a.jsx("div",{className:"kit-browser",children:a.jsx("p",{children:"Loading equipment kits..."})}):n.length===0?a.jsx("div",{className:"kit-browser",children:a.jsx("div",{className:"empty-state-small",children:a.jsx("p",{children:"No equipment kits available for your department yet."})})}):a.jsxs("div",{className:"kit-browser",children:[a.jsx("h3",{children:"Equipment Kits"}),a.jsx("p",{className:"kit-browser-subtitle",children:"Book pre-configured equipment bundles for common use cases"}),a.jsx("div",{className:"kits-list",children:n.map(b=>a.jsxs("div",{className:`kit-item ${(s==null?void 0:s.id)===b.id?"selected":""}`,onClick:()=>T(b),children:[b.image_url&&a.jsx("div",{className:"kit-item-image",children:a.jsx("img",{src:b.image_url,alt:b.name})}),a.jsxs("div",{className:"kit-item-info",children:[a.jsx("h4",{children:b.name}),a.jsx("p",{children:b.description}),a.jsxs("small",{children:[b.equipment_ids.length," items in this kit"]})]})]},b.id))}),s&&o&&a.jsxs("div",{className:"kit-details-panel",children:[a.jsxs("h4",{children:["Book: ",s.name]}),a.jsxs("div",{className:"kit-equipment",children:[a.jsx("strong",{children:"Equipment in this kit:"}),a.jsx("ul",{children:o.equipment.map(b=>a.jsxs("li",{children:[b.product_name," (",b.tracking_number,") - ",a.jsx("span",{className:`status-${b.status}`,children:b.status})]},b.id))})]}),a.jsxs("div",{className:"booking-form",children:[a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Start Date"}),a.jsx("input",{type:"date",value:u.start,onChange:b=>p({...u,start:b.target.value}),min:new Date().toISOString().split("T")[0]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"End Date"}),a.jsx("input",{type:"date",value:u.end,onChange:b=>p({...u,end:b.target.value}),min:u.start||new Date().toISOString().split("T")[0]})]})]}),a.jsx("button",{onClick:U,className:"btn btn-secondary btn-sm",disabled:!u.start||!u.end||j,children:j?"Checking...":"Check Availability"}),g&&a.jsx("div",{className:`availability-result ${g.available?"available":"unavailable"}`,children:g.available?a.jsxs("p",{children:[a.jsx("strong",{children:" All equipment available!"})," You can proceed with booking."]}):a.jsxs("div",{children:[a.jsx("p",{children:a.jsx("strong",{children:" Some equipment unavailable"})}),a.jsx("ul",{children:g.unavailableItems.map((b,A)=>a.jsxs("li",{children:[b.equipment.product_name," - Booked ",b.conflictingBookings.length," time(s)"]},A))}),a.jsx("p",{className:"suggestion",children:"Please select different dates or book individual items instead."})]})}),(g==null?void 0:g.available)&&a.jsxs("div",{className:"justification-section",children:[a.jsx("label",{children:"Justification *"}),a.jsx("textarea",{value:_,onChange:b=>S(b.target.value),placeholder:"Explain why you need this equipment kit (minimum 30 characters)...",rows:"3",minLength:"30"}),a.jsxs("small",{className:_.length<30?"text-error":"text-success",children:[_.length," / 30 characters minimum"]})]}),a.jsxs("div",{className:"booking-actions",children:[a.jsx("button",{onClick:()=>{i(null),l(null),m(null)},className:"btn btn-secondary",children:"Cancel"}),(g==null?void 0:g.available)&&a.jsx("button",{onClick:P,className:"btn btn-primary",disabled:w||_.length<30,children:w?"Booking...":`Book Kit (${o.equipment_ids.length} items)`})]})]})]})]})}async function j0(){try{return await be.query("sub_areas")||[]}catch(t){throw console.error("Failed to get departments:",t),t}}async function fC(t,e,n=null,r="",s=null){try{const i={id:`ida${Date.now()}`,from_sub_area_id:t,to_sub_area_id:e,granted_by:s,granted_at:new Date().toISOString(),expires_at:n,is_active:!0,notes:r||""};return await be.insert("interdisciplinary_access",i),i}catch(i){throw console.error("Failed to grant access:",i),i}}async function pC(t,e,n,r){try{const s={id:`ar${Date.now()}`,requesting_admin_id:t,from_sub_area_id:e,to_sub_area_id:n,status:"pending",reason:r||"",requested_at:new Date().toISOString(),reviewed_by:null,reviewed_at:null,notes:null};return await be.insert("access_requests",s),s}catch(s){throw console.error("Failed to create access request:",s),s}}async function mC(t=null){try{let e=await be.query("access_requests");return t&&(e=e.filter(n=>n.status===t)),e}catch(e){throw console.error("Failed to get access requests:",e),e}}async function gC(t){try{return await be.query("access_requests",{requesting_admin_id:t})}catch(e){throw console.error("Failed to get department admin requests:",e),e}}async function vC(t,e,n=null){try{const r=await be.findOne("access_requests",{id:t});if(!r)throw new Error("Access request not found");if(r.status!=="pending")throw new Error("Can only approve pending requests");const s=await fC(r.from_sub_area_id,r.to_sub_area_id,n,`Created from access request ${t}`,e);return await be.update("access_requests",{id:t},{status:"approved",reviewed_by:e,reviewed_at:new Date().toISOString(),notes:`Approved - interdisciplinary access grant created (${s.id})`}),{request:await be.findOne("access_requests",{id:t}),grant:s}}catch(r){throw console.error("Failed to approve access request:",r),r}}async function yC(t,e,n){try{const r=await be.findOne("access_requests",{id:t});if(!r)throw new Error("Access request not found");if(r.status!=="pending")throw new Error("Can only deny pending requests");return await be.update("access_requests",{id:t},{status:"denied",reviewed_by:e,reviewed_at:new Date().toISOString(),notes:n||"Request denied"}),await be.findOne("access_requests",{id:t})}catch(r){throw console.error("Failed to deny access request:",r),r}}async function E5(t){try{const n=(await be.query("system_settings")).find(r=>r.key===t);return n?n.value:null}catch(e){throw console.error("Error fetching system setting:",e),e}}async function bC(){try{return await be.query("system_settings")}catch(t){throw console.error("Error fetching system settings:",t),t}}async function _C(t,e,n){try{const r=await be.query("system_settings"),s=r.findIndex(c=>c.key===t);if(s===-1)throw new Error(`Setting with key '${t}' not found`);const i={...r[s],value:e,modified_by:n,modified_at:new Date().toISOString()},o=await be.query("system_settings");o[s]=i;const l=be.getData();return l.system_settings=o,be.saveData(l),i}catch(r){throw console.error("Error updating system setting:",r),r}}async function xC(){const t=await E5("cross_department_browsing_enabled");return t===!0||t==="true"}async function wC(){const t=await E5("equipment_kits_enabled");return t===!0||t==="true"}function D5(){const{user:t}=cn(),[e,n]=O.useState([]),[r,s]=O.useState([]),[i,o]=O.useState(!0),[l,c]=O.useState("all"),[d,u]=O.useState("large"),[p,g]=O.useState(null),[m,j]=O.useState(!1),[k,w]=O.useState(!1),[y,_]=O.useState(!1),[S,N]=O.useState([]),[T,U]=O.useState("all"),[P,b]=O.useState(""),[A,$]=O.useState(1),D=20,[F,L]=O.useState({type:"all"}),{toasts:I,showToast:X,removeToast:te}=Yn(),[oe,Z]=O.useState(!1),[ae,ee]=O.useState("my_department"),[de,E]=O.useState(!1),H=()=>{var ue;return t?t.role==="student"||t.role==="department_admin"||t.role==="master_admin"?!0:t.role==="staff"?((ue=t.view_permissions)==null?void 0:ue.can_view_catalog)!==!1:!0:!1};O.useEffect(()=>{J()},[]),O.useEffect(()=>{ne(),V()},[l,T,ae]);const J=async()=>{try{const ue=await xC();Z(ue);const Te=await wC();E(Te)}catch(ue){console.error("Failed to check system settings:",ue)}};O.useEffect(()=>{let ue=e;if(P.trim()){const Te=P.toLowerCase();ue=ue.filter(Pe=>Pe.product_name.toLowerCase().includes(Te)||Pe.description.toLowerCase().includes(Te)||Pe.category.toLowerCase().includes(Te))}F.type==="available"?ue=ue.filter(Te=>Te.status==="available"):F.type==="custom"&&F.date&&(ue=ue.filter(async Te=>!(await be.query("bookings",{equipment_id:Te.id})).some(Fe=>{const Ye=new Date(Fe.start_date),Qe=new Date(Fe.end_date),Je=new Date(F.date);return Je>=Ye&&Je<=Qe&&Fe.status==="approved"}))),s(ue),$(1)},[e,P,F]);const V=async()=>{try{const ue=await j0();N(ue)}catch(ue){console.error("Failed to load sub-areas:",ue)}},ne=async()=>{o(!0);try{const ue=be.getCurrentUser();if(ue&&ue.role==="student"){const Te=await be.query("equipment");let Pe=Te.filter(Ye=>Ye.department===ue.department);const Xe=await be.query("department_access_grants",{requesting_department_id:ue.department,status:"active"}),Fe=new Date;for(const Ye of Xe){const Qe=new Date(Ye.start_date),Je=new Date(Ye.end_date);if(Fe>=Qe&&Fe<=Je){const ot=Te.filter(Ue=>Ue.department===Ye.lending_department_id&&Ue.product_name===Ye.equipment_type).slice(0,Ye.quantity_available).map(Ue=>({...Ue,isCrossDepartment:!0,crossDeptGrantId:Ye.id,collectionInstructions:Ye.collection_instructions,crossDeptTerms:Ye.terms,lendingDepartment:Ye.lending_department_id}));Pe=Pe.concat(ot)}}l!=="all"&&(Pe=Pe.filter(Ye=>Ye.category===l)),T!=="all"&&(Pe=Pe.filter(Ye=>Ye.sub_area_id===T)),n(Pe)}else{const Te=l==="all"?{}:{category:l};let Pe=await be.query("equipment",Te);T!=="all"&&(Pe=Pe.filter(Xe=>Xe.sub_area_id===T)),n(Pe)}}catch(ue){console.error("Failed to load equipment:",ue)}finally{o(!1)}},le=ue=>{const Te=S.find(Pe=>Pe.id===ue);return Te?Te.name:""},me=["all","Camera","Computer","Lighting","Support"],re=ue=>{g(ue),_(!0)},fe=ue=>{if(ue.status!=="available"){X("This equipment is not available for booking","error");return}g(ue),j(!0)},_e=()=>{X("Booking created successfully! Awaiting admin approval.","success"),j(!1)},ke=()=>{X("Multiple bookings created successfully! Awaiting admin approval.","success"),w(!1),ne()},Ae=ue=>{b(ue)},ye=ue=>{$(ue),window.scrollTo({top:0,behavior:"smooth"})},Q=async()=>{await ne(),await V()},st=(A-1)*D,nt=st+D,Ve=r.slice(st,nt);return!i&&!H()?a.jsxs("div",{className:"access-restricted",children:[a.jsxs("div",{className:"restriction-message",children:[a.jsx("h2",{children:"Access Restricted"}),a.jsx("p",{children:"You do not have permission to view the equipment catalog."}),a.jsx("p",{children:"Please contact your department admin to request access."})]}),a.jsx("style",{jsx:!0,children:`
          .access-restricted {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 60vh;
            padding: 2rem;
          }
          .restriction-message {
            text-align: center;
            max-width: 500px;
            padding: 2rem;
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
          }
          .restriction-message h2 {
            color: #856404;
            margin-bottom: 1rem;
          }
          .restriction-message p {
            color: #856404;
            margin-bottom: 0.5rem;
          }
        `})]}):a.jsxs("div",{className:"equipment-browse",children:[a.jsxs(x0,{onRefresh:Q,children:[a.jsxs("div",{className:"browse-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"1rem"},children:[a.jsx("h2",{children:"Browse Equipment"}),a.jsx("button",{onClick:()=>w(!0),className:"btn btn-primary","data-testid":"book-multiple-items-btn",style:{whiteSpace:"nowrap"},children:"Book Multiple Items"})]}),a.jsx(nf,{onSearch:Ae,placeholder:"Search equipment by name, description, or category...",ariaLabel:"Search equipment"}),a.jsx(lC,{onFilterChange:L}),t&&t.role==="student"&&de&&a.jsx(hC,{onBookingSuccess:ne}),a.jsxs("div",{className:"filter-controls-compact",style:{display:"grid",gridTemplateColumns:S.length>0&&(t==null?void 0:t.role)!=="student"?"repeat(auto-fit, minmax(200px, 1fr))":"1fr",gap:"1rem",marginTop:"1rem",marginBottom:"1rem",padding:"1rem",backgroundColor:"#f8f9fa",borderRadius:"8px",border:"1px solid #dee2e6"},children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"category-filter",style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",fontSize:"0.875rem"},children:"Category"}),a.jsx("select",{id:"category-filter",value:l,onChange:ue=>c(ue.target.value),style:{width:"100%",padding:"0.5rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"0.95rem",cursor:"pointer",backgroundColor:"white"},children:me.map(ue=>a.jsx("option",{value:ue,children:ue==="all"?"All Categories":ue},ue))})]}),S.length>0&&(t==null?void 0:t.role)!=="student"&&a.jsxs("div",{children:[a.jsx("label",{htmlFor:"department-filter",style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",fontSize:"0.875rem"},children:"Department"}),a.jsxs("select",{id:"department-filter",value:T,onChange:ue=>U(ue.target.value),style:{width:"100%",padding:"0.5rem",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"0.95rem",cursor:"pointer",backgroundColor:"white"},children:[a.jsx("option",{value:"all",children:"All Departments"}),S.map(ue=>a.jsx("option",{value:ue.id,children:ue.name},ue.id))]})]})]}),a.jsxs("div",{className:"view-toggle",children:[a.jsx("button",{className:`btn-view ${d==="large"?"active":""}`,onClick:()=>u("large"),"data-testid":"view-large-btn",children:"Large Details"}),a.jsx("button",{className:`btn-view ${d==="compact"?"active":""}`,onClick:()=>u("compact"),"data-testid":"view-compact-btn",children:"Compact List"})]}),i?d==="large"?a.jsx("div",{className:"equipment-grid",children:a.jsx(cd,{type:"card",count:6})}):a.jsxs("table",{className:"equipment-table-compact",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Equipment"}),a.jsx("th",{children:"Category"}),a.jsx("th",{children:"Department"}),a.jsx("th",{children:"Status"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:a.jsx(cd,{type:"table-row",count:8})})]}):r.length===0?a.jsx("div",{className:"empty-state",children:a.jsx("p",{children:"No equipment found matching your search criteria."})}):d==="large"?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"equipment-grid",children:Ve.map(ue=>a.jsxs("div",{className:"equipment-card","data-testid":"equipment-card",children:[a.jsx("div",{onClick:()=>re(ue),style:{cursor:"pointer"},children:a.jsx(k5,{equipment:ue,size:"medium"})}),a.jsxs("div",{className:"equipment-info",children:[a.jsx("h3",{onClick:()=>re(ue),style:{cursor:"pointer"},children:ue.product_name}),a.jsx("p",{className:"category",children:ue.category}),a.jsx("p",{className:"description",children:ue.description}),a.jsxs("div",{className:"equipment-meta",children:[a.jsx("span",{className:`status status-${ue.status}`,children:ue.status}),a.jsx("span",{className:"department",children:ue.department})]}),ue.isCrossDepartment&&a.jsxs("div",{className:"cross-department-badge",style:{marginTop:"0.5rem",padding:"0.5rem",backgroundColor:"#e3f2fd",border:"1px solid #2196f3",borderRadius:"4px",fontSize:"0.875rem"},children:[a.jsx("strong",{style:{color:"#1976d2"},children:" Cross-Department Access"}),a.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",color:"#666"},children:["From ",ue.lendingDepartment]})]}),ue.isInterdisciplinary&&a.jsxs("div",{className:"interdisciplinary-badge",children:["Available via ",le(ue.fromSubAreaId)]}),a.jsx("button",{className:"btn btn-primary btn-block",onClick:Te=>{Te.stopPropagation(),fe(ue)},disabled:ue.status!=="available","data-testid":"book-equipment-btn",children:ue.status==="available"?"Book Equipment":"Not Available"})]})]},ue.id))}),a.jsx(ld,{currentPage:A,totalItems:r.length,itemsPerPage:D,onPageChange:ye,loading:i})]}):a.jsxs(a.Fragment,{children:[a.jsxs("table",{className:"equipment-table-compact","data-testid":"equipment-table-compact",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Equipment"}),a.jsx("th",{children:"Category"}),a.jsx("th",{children:"Department"}),a.jsx("th",{children:"Status"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:Ve.map(ue=>a.jsxs("tr",{"data-testid":"equipment-row-compact",children:[a.jsx("td",{onClick:()=>re(ue),style:{cursor:"pointer",fontWeight:"600"},children:ue.product_name}),a.jsx("td",{children:ue.category}),a.jsxs("td",{children:[ue.department,ue.isCrossDepartment&&a.jsxs("div",{style:{marginTop:"0.25rem",fontSize:"0.75rem",color:"#1976d2",fontWeight:"600"},children:[" From ",ue.lendingDepartment]}),ue.isInterdisciplinary&&a.jsxs("div",{className:"interdisciplinary-badge",style:{marginTop:"0.25rem"},children:["Via ",le(ue.fromSubAreaId)]})]}),a.jsx("td",{children:a.jsx("span",{className:`status status-${ue.status}`,children:ue.status})}),a.jsx("td",{children:a.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>fe(ue),disabled:ue.status!=="available","data-testid":"book-equipment-btn-compact",children:ue.status==="available"?"Book":"Unavailable"})})]},ue.id))})]}),a.jsx(ld,{currentPage:A,totalItems:r.length,itemsPerPage:D,onPageChange:ye,loading:i})]})]}),y&&p&&a.jsx(oC,{equipment:p,onClose:()=>_(!1),onBookClick:fe}),m&&p&&a.jsx(S5,{equipment:p,onClose:()=>j(!1),onSuccess:_e}),k&&a.jsx(m5,{onClose:()=>w(!1),onSuccess:ke}),I.map(ue=>a.jsx(Jn,{message:ue.message,type:ue.type,onClose:()=>te(ue.id)},ue.id))]})}class jC{exportToCSV(e,n,r=null){if(!e||e.length===0){console.warn("No data to export");return}const s=r||Object.keys(e[0]).map(c=>({key:c,label:c})),i=s.map(c=>this.escapeCSVValue(c.label)).join(","),o=e.map(c=>s.map(d=>{const u=this.getNestedValue(c,d.key);return this.escapeCSVValue(u)}).join(",")),l=[i,...o].join(`
`);this.downloadFile(l,`${n}.csv`,"text/csv;charset=utf-8;")}exportBookingsToCSV(e,n="bookings"){const r=[{key:"equipment.product_name",label:"Equipment"},{key:"equipment.category",label:"Category"},{key:"start_date",label:"Start Date"},{key:"end_date",label:"End Date"},{key:"status",label:"Status"},{key:"purpose",label:"Purpose"},{key:"created_at",label:"Requested Date"}],s=e.map(i=>({...i,start_date:this.formatDate(i.start_date),end_date:this.formatDate(i.end_date),created_at:this.formatDate(i.created_at)}));this.exportToCSV(s,n,r)}exportEquipmentToCSV(e,n="equipment"){const r=[{key:"product_name",label:"Product Name"},{key:"category",label:"Category"},{key:"department",label:"Department"},{key:"status",label:"Status"},{key:"tracking_number",label:"Tracking Number"},{key:"description",label:"Description"}];this.exportToCSV(e,n,r)}exportToPDF(e,n){const r=window.open("","_blank");r.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>${n}</title>
          <style>
            body {
              font-family: Arial, sans-serif;
              padding: 20px;
              max-width: 800px;
              margin: 0 auto;
            }
            table {
              width: 100%;
              border-collapse: collapse;
              margin: 20px 0;
            }
            th, td {
              border: 1px solid #ddd;
              padding: 12px;
              text-align: left;
            }
            th {
              background-color: #f4f4f4;
              font-weight: bold;
            }
            h1 {
              color: #333;
              border-bottom: 2px solid #333;
              padding-bottom: 10px;
            }
            .no-print {
              margin: 20px 0;
            }
            @media print {
              .no-print {
                display: none;
              }
            }
          </style>
        </head>
        <body>
          <div class="no-print">
            <button onclick="window.print()">Print / Save as PDF</button>
            <button onclick="window.close()">Close</button>
          </div>
          ${e}
        </body>
      </html>
    `),r.document.close()}exportBookingsToPDF(e,n="My Bookings Report"){const r=e.map(i=>{var o,l;return`
      <tr>
        <td>${((o=i.equipment)==null?void 0:o.product_name)||"Unknown"}</td>
        <td>${((l=i.equipment)==null?void 0:l.category)||"N/A"}</td>
        <td>${this.formatDate(i.start_date)}</td>
        <td>${this.formatDate(i.end_date)}</td>
        <td><strong>${i.status}</strong></td>
      </tr>
    `}).join(""),s=`
      <h1>${n}</h1>
      <p><strong>Generated:</strong> ${this.formatDate(new Date)}</p>
      <p><strong>Total Bookings:</strong> ${e.length}</p>
      <table>
        <thead>
          <tr>
            <th>Equipment</th>
            <th>Category</th>
            <th>Start Date</th>
            <th>End Date</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          ${r}
        </tbody>
      </table>
    `;this.exportToPDF(s,n.replace(/\s+/g,"_"))}escapeCSVValue(e){if(e==null)return"";const n=String(e);return n.includes(",")||n.includes('"')||n.includes(`
`)?`"${n.replace(/"/g,'""')}"`:n}getNestedValue(e,n){return n.split(".").reduce((r,s)=>r==null?void 0:r[s],e)||""}formatDate(e){return e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):""}downloadFile(e,n,r){const s=new Blob([e],{type:r}),i=URL.createObjectURL(s),o=document.createElement("a");o.href=i,o.download=n,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}}const Vv=new jC;function P5(){const{user:t}=Nr(),[e,n]=O.useState([]),[r,s]=O.useState(!0),[i,o]=O.useState(!1),[l,c]=O.useState(null),{toasts:d,showToast:u,removeToast:p}=Yn(),g=()=>{var b;return t?t.role==="student"||t.role==="department_admin"||t.role==="master_admin"?!0:t.role==="staff"?((b=t.view_permissions)==null?void 0:b.can_view_history)!==!1:!0:!1},m=()=>{var b;return t?t.role==="student"||t.role==="department_admin"||t.role==="master_admin"?!0:t.role==="staff"?((b=t.view_permissions)==null?void 0:b.can_cancel_bookings)!==!1:!0:!1},j=()=>{var b;return t?t.role==="student"||t.role==="department_admin"||t.role==="master_admin"?!0:t.role==="staff"?((b=t.view_permissions)==null?void 0:b.can_export_data)!==!1:!0:!1};O.useEffect(()=>{k()},[t]);const k=async()=>{s(!0);try{const b=await ng.getBookingsWithEquipment(t.id);n(b.sort((A,$)=>new Date($.created_at)-new Date(A.created_at)))}catch(b){console.error("Failed to load bookings:",b)}finally{s(!1)}},w=async b=>{try{await ng.cancelBooking(b),await k(),u("Booking cancelled successfully","success")}catch(A){u("Failed to cancel booking: "+A.message,"error")}},y=b=>({pending:"warning",approved:"success",denied:"error",cancelled:"secondary",active:"primary",completed:"success"})[b]||"secondary",_=b=>new Date(b).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),S=b=>{c(b.equipment),o(!0)},N=()=>{u("Booking created successfully! Awaiting admin approval.","success"),o(!1),c(null),k()},T=()=>{Vv.exportBookingsToCSV(e,`my_bookings_${new Date().toISOString().split("T")[0]}`),u("Bookings exported to CSV","success")},U=()=>{Vv.exportBookingsToPDF(e,"My Bookings Report"),u("Opening PDF export...","success")},P=async()=>{await k()};return r?a.jsx("div",{className:"loading",children:"Loading your bookings..."}):g()?e.length===0?a.jsxs("div",{className:"empty-state","data-testid":"no-bookings",children:[a.jsx("h2",{children:"No Bookings Yet"}),a.jsx("p",{children:"You haven't made any equipment bookings."}),a.jsx(rs,{to:`/${t.role}/equipment`,className:"btn btn-primary",children:"Browse Equipment"})]}):a.jsxs("div",{className:"my-bookings",children:[a.jsxs(x0,{onRefresh:P,children:[a.jsxs("div",{className:"bookings-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[a.jsxs("div",{children:[a.jsx("h2",{children:"My Bookings"}),a.jsxs("p",{className:"subtitle",children:[e.length," total booking(s)"]})]}),j()&&a.jsxs("div",{className:"export-actions",children:[a.jsx("button",{onClick:T,className:"btn btn-secondary btn-sm","data-testid":"export-csv-btn",children:"Export CSV"}),a.jsx("button",{onClick:U,className:"btn btn-secondary btn-sm","data-testid":"export-pdf-btn",children:"Export PDF"})]})]}),a.jsx("div",{className:"bookings-list","data-testid":"bookings-list",children:e.map(b=>{var A,$;return a.jsxs("div",{className:"booking-item booking-card","data-testid":"booking-card",children:[a.jsxs("div",{className:"booking-header",children:[a.jsxs("div",{children:[a.jsx("h3",{children:((A=b.equipment)==null?void 0:A.product_name)||"Unknown Equipment"}),a.jsx("p",{className:"category",children:($=b.equipment)==null?void 0:$.category})]}),a.jsx("span",{className:`status-badge status-${y(b.status)}`,children:b.status})]}),a.jsxs("div",{className:"booking-details",children:[a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"label",children:"Dates:"}),a.jsxs("span",{children:[_(b.start_date)," - ",_(b.end_date)]})]}),b.purpose&&a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"label",children:"Purpose:"}),a.jsx("span",{children:b.purpose})]}),b.denial_reason&&a.jsxs("div",{className:"detail-row error",children:[a.jsx("span",{className:"label",children:"Denial Reason:"}),a.jsx("span",{children:b.denial_reason})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"label",children:"Created:"}),a.jsx("span",{children:_(b.created_at)})]})]}),a.jsxs("div",{className:"booking-actions",children:[b.status==="pending"&&m()&&a.jsx("button",{onClick:()=>w(b.id),className:"btn btn-secondary btn-sm","data-testid":"cancel-booking-btn",children:"Cancel Booking"}),b.status==="pending"&&!m()&&a.jsx("span",{style:{fontSize:"0.85rem",color:"#666",fontStyle:"italic"},children:"Cannot cancel (no permission)"}),(b.status==="completed"||b.status==="denied")&&b.equipment&&a.jsx("button",{onClick:()=>S(b),className:"btn btn-primary btn-sm","data-testid":"rebook-btn",children:"Book Again"})]})]},b.id)})})]}),i&&l&&a.jsx(S5,{equipment:l,onClose:()=>{o(!1),c(null)},onSuccess:N}),d.map(b=>a.jsx(Jn,{message:b.message,type:b.type,onClose:()=>p(b.id)},b.id))]}):a.jsxs("div",{className:"access-restricted",children:[a.jsxs("div",{className:"restriction-message",children:[a.jsx("h2",{children:"Access Restricted"}),a.jsx("p",{children:"You do not have permission to view booking history."}),a.jsx("p",{children:"Please contact your department admin to request access."})]}),a.jsx("style",{jsx:!0,children:`
          .access-restricted {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 60vh;
            padding: 2rem;
          }
          .restriction-message {
            text-align: center;
            max-width: 500px;
            padding: 2rem;
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
          }
          .restriction-message h2 {
            color: #856404;
            margin-bottom: 1rem;
          }
          .restriction-message p {
            color: #856404;
            margin-bottom: 0.5rem;
          }
        `})]})}function SC(){const{user:t,logout:e}=cn();return a.jsxs("div",{className:"student-portal",children:[a.jsx("header",{className:"student-header",children:a.jsxs("div",{className:"student-header-content",children:[a.jsx("h1",{children:" NCADbook"}),a.jsxs("div",{className:"student-header-actions",children:[a.jsx(y0,{}),a.jsx("span",{className:"student-user-info",children:t==null?void 0:t.full_name}),a.jsx("button",{onClick:e,className:"btn btn-secondary btn-sm",children:"Logout"})]})]})}),a.jsxs("nav",{className:"student-nav",children:[a.jsx(vn,{to:"/student",end:!0,className:({isActive:n})=>`student-nav-link ${n?"active":""}`,children:" Dashboard"}),a.jsx(vn,{to:"/student/equipment",className:({isActive:n})=>`student-nav-link ${n?"active":""}`,children:" Browse Equipment"}),a.jsx(vn,{to:"/student/bookings",className:({isActive:n})=>`student-nav-link ${n?"active":""}`,children:" My Bookings"})]}),a.jsx("main",{className:"student-main",children:a.jsxs(Yh,{children:[a.jsx(vt,{index:!0,element:a.jsx(z3,{})}),a.jsx(vt,{path:"equipment",element:a.jsx(D5,{})}),a.jsx(vt,{path:"bookings",element:a.jsx(P5,{})})]})}),a.jsx(b0,{})]})}function kC(){const{user:t}=Nr(),[e,n]=O.useState({myBookings:0,mySpaceBookings:0,availableSpaces:0}),[r,s]=O.useState(!0);O.useEffect(()=>{i()},[t]);const i=async()=>{try{const o=await be.query("bookings",{user_id:t.id}),l=await be.query("spaceBookings",{user_id:t.id}),c=await be.query("spaces");n({myBookings:o.filter(d=>d.status!=="cancelled").length,mySpaceBookings:l.filter(d=>d.status!=="cancelled").length,availableSpaces:c.filter(d=>d.status==="available").length})}catch(o){console.error("Failed to load stats:",o)}finally{s(!1)}};return r?a.jsxs("div",{className:"staff-dashboard",children:[a.jsx("div",{className:"staff-skeleton"}),a.jsx("div",{className:"staff-skeleton"}),a.jsx("div",{className:"staff-skeleton"})]}):a.jsxs("div",{className:"staff-dashboard","data-testid":"staff-dashboard",children:[a.jsxs("div",{className:"staff-welcome",children:[a.jsxs("h2",{children:["Welcome, ",t==null?void 0:t.first_name,"! "]}),a.jsx("p",{children:"Staff Dashboard - Equipment & Space Management"})]}),a.jsxs("div",{className:"staff-stats-grid",children:[a.jsxs("div",{className:"staff-stat-card",children:[a.jsx("div",{className:"staff-stat-icon",children:""}),a.jsx("div",{className:"staff-stat-number",children:e.myBookings}),a.jsx("div",{className:"staff-stat-label",children:"Equipment Bookings"})]}),a.jsxs("div",{className:"staff-stat-card",children:[a.jsx("div",{className:"staff-stat-icon",children:""}),a.jsx("div",{className:"staff-stat-number",children:e.mySpaceBookings}),a.jsx("div",{className:"staff-stat-label",children:"Room Bookings"})]}),a.jsxs("div",{className:"staff-stat-card",children:[a.jsx("div",{className:"staff-stat-icon",children:""}),a.jsx("div",{className:"staff-stat-number",children:e.availableSpaces}),a.jsx("div",{className:"staff-stat-label",children:"Spaces Available"})]})]}),a.jsxs("div",{className:"staff-dashboard-grid",children:[a.jsxs("div",{className:"staff-card",children:[a.jsxs("h3",{children:[a.jsx("span",{className:"staff-card-icon",children:""})," Quick Actions"]}),a.jsxs("div",{className:"staff-quick-actions",children:[a.jsx(rs,{to:"/staff/rooms",className:"staff-action-btn","data-testid":"book-room-link",children:" Book a Room"}),a.jsx(rs,{to:"/staff/equipment",className:"staff-action-btn secondary","data-testid":"browse-equipment-link",children:" Browse Equipment"}),a.jsx(rs,{to:"/staff/bookings",className:"staff-action-btn secondary","data-testid":"view-bookings-link",children:" My Bookings"}),a.jsx(rs,{to:"/staff/cross-department-requests",className:"staff-action-btn secondary",children:" Request Equipment"})]})]}),a.jsxs("div",{className:"staff-card",children:[a.jsxs("h3",{children:[a.jsx("span",{className:"staff-card-icon",children:""})," Staff Features"]}),a.jsxs("ul",{className:"staff-features-list",children:[a.jsx("li",{children:"Book rooms and spaces by the hour"}),a.jsx("li",{children:"Book equipment for projects"}),a.jsx("li",{children:"Manage all bookings in one place"}),a.jsx("li",{children:"Auto-approved room bookings"}),a.jsx("li",{children:"Request cross-department equipment"})]})]})]})]})}const $s={async createSpaceBooking(t){const{space_id:e,booking_date:n,start_time:r,end_time:s,user_id:i,purpose:o}=t;if((await this.checkConflicts(e,n,r,s)).length>0)throw new Error("Space is already booked for selected time slot");const c={id:"sb"+Date.now(),user_id:i,space_id:e,booking_date:n,start_time:r,end_time:s,purpose:o,status:"approved",created_at:new Date().toISOString(),approved_at:new Date().toISOString()};return await be.insert("spaceBookings",c),c},async getUserSpaceBookings(t){return await be.query("spaceBookings",{user_id:t})},async getSpaceBookingById(t){return await be.findOne("spaceBookings",{id:t})},async cancelSpaceBooking(t){await be.update("spaceBookings",{id:t},{status:"cancelled",cancelled_at:new Date().toISOString()})},async checkConflicts(t,e,n,r){return(await be.query("spaceBookings",{space_id:t})).filter(i=>{if(i.status==="cancelled"||i.booking_date!==e)return!1;const o=this.timeToMinutes(i.start_time),l=this.timeToMinutes(i.end_time),c=this.timeToMinutes(n),d=this.timeToMinutes(r);return c<l&&d>o})},async getSpaceBookingsWithDetails(t){const e=await this.getUserSpaceBookings(t);return await Promise.all(e.map(async r=>{const s=await be.findOne("spaces",{id:r.space_id});return{...r,space:s}}))},async getSpaceBookingsForDate(t,e){return(await be.query("spaceBookings",{space_id:t})).filter(r=>r.booking_date===e&&r.status!=="cancelled")},timeToMinutes(t){const[e,n]=t.split(":").map(Number);return e*60+n},minutesToTime(t){const e=Math.floor(t/60),n=t%60;return`${e.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`}};function NC({selectedRoom:t,onDateTimeSelect:e,selectedDates:n=[],recurringPattern:r=null}){var D,F;const[s,i]=O.useState(new Date),[o,l]=O.useState({}),[c,d]=O.useState({}),[u,p]=O.useState(!1),[g,m]=O.useState(!1),[j,k]=O.useState(null);O.useEffect(()=>{t&&w()},[t,s]);const w=async()=>{if(t){p(!0);try{const L=s.getFullYear(),I=s.getMonth(),X=new Date(L,I+1,0).getDate(),te={};for(let oe=1;oe<=X;oe++){const Z=new Date(L,I,oe),ae=Z.toISOString().split("T")[0];if(Z<new Date().setHours(0,0,0,0)){te[ae]={available:!1,isPast:!0};continue}const ee=await $s.getSpaceBookingsForDate(t.id,ae),de=9,E=ee.length,H=de-E;te[ae]={available:H>0,totalSlots:de,bookedSlots:E,availableSlots:H,bookings:ee}}l(te)}catch(L){console.error("Failed to load availability:",L)}finally{p(!1)}}},y=()=>{const L=[];for(let I=9;I<18;I++)L.push({start:`${I.toString().padStart(2,"0")}:00`,end:`${(I+1).toString().padStart(2,"0")}:00`,label:`${I}:00 - ${I+1}:00`});return L},_=(L,I)=>{const X=o[L];return!X||!X.bookings?!1:X.bookings.some(te=>{const oe=$s.timeToMinutes(te.start_time),Z=$s.timeToMinutes(te.end_time),ae=$s.timeToMinutes(I.start),ee=$s.timeToMinutes(I.end);return ae<Z&&ee>oe})},S=L=>{const I=L.toISOString().split("T")[0],X=o[I];!X||!X.available||X.isPast||(k(I),m(!0))},N=L=>{if(!j||_(j,L))return;const X=c[j]||[];if(X.findIndex(oe=>oe.start===L.start)>=0){const oe=X.filter(Z=>Z.start!==L.start);d({...c,[j]:oe})}else d({...c,[j]:[...X,L]})},T=()=>{e&&e(j,c[j]||[]),m(!1)},U=()=>{i(new Date(s.getFullYear(),s.getMonth()-1))},P=()=>{i(new Date(s.getFullYear(),s.getMonth()+1))},b=()=>{var Z;const L=s.getFullYear(),I=s.getMonth(),X=new Date(L,I,1).getDay(),te=new Date(L,I+1,0).getDate(),oe=[];for(let ae=0;ae<X;ae++)oe.push(a.jsx("div",{className:"calendar-day empty"},`empty-${ae}`));for(let ae=1;ae<=te;ae++){const ee=new Date(L,I,ae),de=ee.toISOString().split("T")[0],E=o[de]||{},H=E.isPast,J=de===new Date().toISOString().split("T")[0],V=((Z=c[de])==null?void 0:Z.length)>0;let ne="calendar-day";H?ne+=" past":E.available?V?ne+=" selected":E.availableSlots===E.totalSlots?ne+=" fully-available":E.availableSlots>0&&(ne+=" partially-available"):ne+=" unavailable",J&&(ne+=" today"),oe.push(a.jsxs("div",{className:ne,onClick:()=>S(ee),title:E.available?`${E.availableSlots}/${E.totalSlots} slots available`:"No slots available",children:[a.jsx("div",{className:"day-number",children:ae}),!H&&E.available&&a.jsx("div",{className:"availability-indicator",children:a.jsx("div",{className:"availability-bar",style:{width:`${E.availableSlots/E.totalSlots*100}%`}})}),V&&a.jsx("div",{className:"selected-badge",children:c[de].length})]},ae))}return oe},A=["January","February","March","April","May","June","July","August","September","October","November","December"],$=y();return a.jsxs("div",{className:"room-calendar",children:[a.jsxs("div",{className:"calendar-header",children:[a.jsx("button",{onClick:U,className:"btn-month-nav","aria-label":"Previous month",children:""}),a.jsxs("h3",{className:"calendar-month",children:[A[s.getMonth()]," ",s.getFullYear()]}),a.jsx("button",{onClick:P,className:"btn-month-nav","aria-label":"Next month",children:""})]}),a.jsxs("div",{className:"calendar-legend",children:[a.jsxs("div",{className:"legend-item",children:[a.jsx("div",{className:"legend-color fully-available"}),a.jsx("span",{children:"Fully Available"})]}),a.jsxs("div",{className:"legend-item",children:[a.jsx("div",{className:"legend-color partially-available"}),a.jsx("span",{children:"Partially Available"})]}),a.jsxs("div",{className:"legend-item",children:[a.jsx("div",{className:"legend-color unavailable"}),a.jsx("span",{children:"Unavailable"})]}),a.jsxs("div",{className:"legend-item",children:[a.jsx("div",{className:"legend-color selected"}),a.jsx("span",{children:"Selected"})]})]}),a.jsxs("div",{className:"calendar-weekdays",children:[a.jsx("div",{children:"Sun"}),a.jsx("div",{children:"Mon"}),a.jsx("div",{children:"Tue"}),a.jsx("div",{children:"Wed"}),a.jsx("div",{children:"Thu"}),a.jsx("div",{children:"Fri"}),a.jsx("div",{children:"Sat"})]}),a.jsx("div",{className:"calendar-grid",children:u?a.jsx("div",{className:"calendar-loading",children:"Loading availability..."}):b()}),g&&j&&a.jsx("div",{className:"modal-overlay",onClick:()=>m(!1),children:a.jsxs("div",{className:"modal-content time-modal",onClick:L=>L.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h3",{children:"Select Time Slots"}),a.jsx("button",{className:"btn-close",onClick:()=>m(!1),children:""})]}),a.jsxs("div",{className:"modal-body",children:[a.jsx("p",{className:"time-modal-date",children:new Date(j).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),a.jsx("div",{className:"time-slots-grid",children:$.map(L=>{var oe;const I=_(j,L),X=(oe=c[j])==null?void 0:oe.some(Z=>Z.start===L.start);let te="time-slot";return I?te+=" booked":X&&(te+=" selected"),a.jsxs("button",{className:te,onClick:()=>N(L),disabled:I,children:[L.label,I&&a.jsx("span",{className:"slot-badge",children:"Booked"}),X&&!I&&a.jsx("span",{className:"slot-badge",children:""})]},L.start)})})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{className:"btn btn-secondary",onClick:()=>m(!1),children:"Cancel"}),a.jsxs("button",{className:"btn btn-primary",onClick:T,disabled:!((D=c[j])!=null&&D.length),children:["Confirm (",((F=c[j])==null?void 0:F.length)||0," slots)"]})]})]})})]})}const zt={NONE:"none",DAILY:"daily",WEEKLY:"weekly",BIWEEKLY:"biweekly",MONTHLY:"monthly"},_p=[{value:0,label:"Sun"},{value:1,label:"Mon"},{value:2,label:"Tue"},{value:3,label:"Wed"},{value:4,label:"Thu"},{value:5,label:"Fri"},{value:6,label:"Sat"}];function CC({onPatternChange:t,initialPattern:e=null}){const[n,r]=O.useState((e==null?void 0:e.type)||zt.NONE),[s,i]=O.useState((e==null?void 0:e.days)||[]),[o,l]=O.useState((e==null?void 0:e.weekdaysOnly)||!0),[c,d]=O.useState((e==null?void 0:e.endDate)||""),[u,p]=O.useState((e==null?void 0:e.occurrences)||10),g=S=>{if(r(S),(S===zt.WEEKLY||S===zt.BIWEEKLY)&&s.length===0){const N=new Date().getDay();i([N])}y(S,s,o,c,u)},m=S=>{let N;s.includes(S)?N=s.filter(T=>T!==S):N=[...s,S].sort((T,U)=>T-U),i(N),y(n,N,o,c,u)},j=S=>{l(S),y(n,s,S,c,u)},k=S=>{d(S),y(n,s,o,S,u)},w=S=>{p(S),y(n,s,o,c,S)},y=(S,N,T,U,P)=>{if(S===zt.NONE){t(null);return}const b={type:S,days:S===zt.WEEKLY||S===zt.BIWEEKLY?N:[],weekdaysOnly:S===zt.DAILY?T:!1,endDate:U,occurrences:parseInt(P)||10};t(b)},_=()=>{if(n===zt.NONE)return"No recurrence";let S="";switch(n){case zt.DAILY:S=o?"Every weekday":"Every day";break;case zt.WEEKLY:s.length===0?S="Weekly (select days)":S=`Every ${s.map(T=>_p[T].label).join(", ")}`;break;case zt.BIWEEKLY:s.length===0?S="Bi-weekly (select days)":S=`Every other ${s.map(T=>_p[T].label).join(", ")}`;break;case zt.MONTHLY:S="Monthly on the same day";break}return c?S+=` until ${new Date(c).toLocaleDateString()}`:S+=` for ${u} occurrences`,S};return a.jsxs("div",{className:"recurring-booking-selector",children:[a.jsxs("div",{className:"recurring-header",children:[a.jsx("h4",{children:"Recurring Booking"}),a.jsx("p",{className:"recurring-description",children:_()})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Recurrence Pattern"}),a.jsxs("select",{value:n,onChange:S=>g(S.target.value),className:"select-input",children:[a.jsx("option",{value:zt.NONE,children:"One-time booking"}),a.jsx("option",{value:zt.DAILY,children:"Daily"}),a.jsx("option",{value:zt.WEEKLY,children:"Weekly"}),a.jsx("option",{value:zt.BIWEEKLY,children:"Bi-weekly"}),a.jsx("option",{value:zt.MONTHLY,children:"Monthly"})]})]}),n===zt.DAILY&&a.jsx("div",{className:"form-group",children:a.jsxs("label",{className:"checkbox-label",children:[a.jsx("input",{type:"checkbox",checked:o,onChange:S=>j(S.target.checked)}),a.jsx("span",{children:"Weekdays only (Mon-Fri)"})]})}),(n===zt.WEEKLY||n===zt.BIWEEKLY)&&a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Select Days"}),a.jsx("div",{className:"weekday-selector",children:_p.map(S=>a.jsx("button",{type:"button",className:`weekday-btn ${s.includes(S.value)?"selected":""}`,onClick:()=>m(S.value),children:S.label},S.value))})]}),n!==zt.NONE&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"End Recurrence"}),a.jsxs("div",{className:"recurrence-end-options",children:[a.jsxs("label",{className:"radio-label",children:[a.jsx("input",{type:"radio",name:"end-type",checked:!c,onChange:()=>k("")}),a.jsx("span",{children:"After"}),a.jsx("input",{type:"number",min:"1",max:"52",value:u,onChange:S=>w(S.target.value),disabled:!!c,className:"occurrences-input"}),a.jsx("span",{children:"occurrences"})]}),a.jsxs("label",{className:"radio-label",children:[a.jsx("input",{type:"radio",name:"end-type",checked:!!c,onChange:()=>{const S=new Date;S.setMonth(S.getMonth()+3),k(S.toISOString().split("T")[0])}}),a.jsx("span",{children:"On date"}),a.jsx("input",{type:"date",value:c,onChange:S=>k(S.target.value),disabled:!c,min:new Date().toISOString().split("T")[0],className:"date-input"})]})]})]}),a.jsxs("div",{className:"recurrence-warning",children:[a.jsx("span",{className:"warning-icon",children:""}),a.jsx("p",{children:"Recurring bookings will be created for all available slots matching this pattern. Conflicts will be skipped."})]})]})]})}function AC(t,e){if(!e||e.type===zt.NONE)return[t];const n=[],r=new Date(t);let s=new Date(r),i=0;const o=e.endDate?365:e.occurrences;for(;i<o;){let l=!1;switch(e.type){case zt.DAILY:if(e.weekdaysOnly){const d=s.getDay();l=d>=1&&d<=5}else l=!0;break;case zt.WEEKLY:l=e.days.includes(s.getDay());break;case zt.BIWEEKLY:l=Math.floor((s-r)/(7*24*60*60*1e3))%2===0&&e.days.includes(s.getDay());break;case zt.MONTHLY:l=s.getDate()===r.getDate();break}if(l){const c=s.toISOString().split("T")[0];if(e.endDate&&c>e.endDate)break;n.push(c),i++}if(s.setDate(s.getDate()+1),e.endDate&&s>new Date(e.endDate))break}return n}function EC(){const{user:t}=Nr(),[e,n]=O.useState([]),[r,s]=O.useState(null),[i,o]=O.useState({}),[l,c]=O.useState(null),[d,u]=O.useState(!1),[p,g]=O.useState(""),[m,j]=O.useState(!0),[k,w]=O.useState("calendar"),{toasts:y,showToast:_,removeToast:S}=Yn();O.useEffect(()=>{N()},[]);const N=async()=>{try{const D=await be.query("spaces");n(D),D.length>0&&s(D[0])}catch(D){console.error("Failed to load spaces:",D)}finally{j(!1)}},T=(D,F)=>{if(F.length===0){const{[D]:L,...I}=i;o(I)}else o({...i,[D]:F})},U=D=>{c(D)},P=()=>Object.values(i).reduce((D,F)=>D+F.length,0),b=()=>Object.keys(i).length,A=()=>{if(P()===0){_("Please select at least one date and time slot","error");return}u(!0)},$=async()=>{if(!p.trim()){_("Please provide a purpose for the booking","error");return}try{let D=Object.keys(i);if(l){const te=D[0],oe=i[te],Z=AC(te,l),ae={};Z.forEach(ee=>{ae[ee]=oe}),D=Z,o(ae)}const F=D.map(async te=>{const oe=i[te];if(!oe||oe.length===0)return null;const Z=[...oe].sort((de,E)=>$s.timeToMinutes(de.start)-$s.timeToMinutes(E.start)),ae=Z[0].start,ee=Z[Z.length-1].end;return $s.createSpaceBooking({space_id:r.id,booking_date:te,start_time:ae,end_time:ee,user_id:t.id,purpose:p})}),L=await Promise.allSettled(F),I=L.filter(te=>te.status==="fulfilled").length,X=L.filter(te=>te.status==="rejected").length;u(!1),g(""),o({}),c(null),X===0?_(`Successfully created ${I} booking${I!==1?"s":""}!`,"success"):_(`Created ${I} booking(s), ${X} failed (likely conflicts)`,"warning")}catch(D){_("Failed to create bookings: "+D.message,"error")}};return m?a.jsx("div",{className:"loading",children:"Loading spaces..."}):a.jsxs("div",{className:"room-booking-calendar",children:[a.jsx("h2",{children:"Room & Space Booking"}),a.jsx("p",{className:"subtitle",children:"Select dates and times from the calendar below"}),a.jsxs("div",{className:"booking-controls",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"space-select",children:"Select Space"}),a.jsx("select",{id:"space-select",value:(r==null?void 0:r.id)||"",onChange:D=>{const F=e.find(L=>L.id===D.target.value);s(F),o({})},className:"select-input",children:e.map(D=>a.jsxs("option",{value:D.id,children:[D.name," (Capacity: ",D.capacity,")"]},D.id))})]}),a.jsxs("div",{className:"view-toggle-group",children:[a.jsx("button",{className:`btn ${k==="calendar"?"btn-primary":"btn-secondary"}`,onClick:()=>w("calendar"),children:" Calendar View"}),a.jsx("button",{className:`btn ${k==="legacy"?"btn-primary":"btn-secondary"}`,onClick:()=>w("legacy"),children:" Day View"})]})]}),r&&a.jsxs("div",{className:"space-details",children:[a.jsx("h3",{children:r.name}),a.jsx("p",{children:r.description}),a.jsxs("p",{className:"equipment-list",children:[a.jsx("strong",{children:"Available Equipment:"})," ",r.equipment_available]})]}),k==="calendar"?a.jsxs(a.Fragment,{children:[a.jsx(NC,{selectedRoom:r,onDateTimeSelect:T,selectedDates:Object.keys(i)}),a.jsx(CC,{onPatternChange:U}),P()>0&&a.jsxs("div",{className:"booking-summary-card",children:[a.jsxs("div",{className:"summary-content",children:[a.jsx("h4",{children:"Booking Summary"}),a.jsxs("p",{children:[a.jsxs("strong",{children:[b()," date",b()!==1?"s":""]})," selected with ",a.jsxs("strong",{children:[P()," time slot",P()!==1?"s":""]})]}),l&&l.type!=="none"&&a.jsx("p",{className:"recurring-info",children:" Recurring pattern will be applied"})]}),a.jsx("button",{onClick:A,className:"btn btn-primary btn-lg",children:"Proceed to Book"})]})]}):a.jsx("div",{className:"legacy-view-message",children:a.jsx("p",{children:"Switch to Calendar View to see room availability and book multiple dates"})}),d&&a.jsx("div",{className:"modal-overlay",onClick:()=>u(!1),children:a.jsxs("div",{className:"modal-content booking-modal",onClick:D=>D.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:"Confirm Booking"}),a.jsx("button",{className:"btn-close",onClick:()=>u(!1),children:""})]}),a.jsxs("div",{className:"modal-body",children:[a.jsxs("div",{className:"booking-summary",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Space:"})," ",r.name]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Dates:"})," ",b()," date(s)"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Total Time Slots:"})," ",P()]}),l&&l.type!=="none"&&a.jsxs("div",{className:"recurring-summary",children:[a.jsx("p",{className:"recurring-badge",children:" Recurring Booking"}),a.jsx("p",{children:"Pattern will be applied to generate multiple bookings"})]}),a.jsxs("div",{className:"dates-list",children:[a.jsx("h4",{children:"Selected Dates & Times:"}),Object.entries(i).slice(0,5).map(([D,F])=>{const L=[...F].sort((I,X)=>$s.timeToMinutes(I.start)-$s.timeToMinutes(X.start));return a.jsxs("div",{className:"date-entry",children:[a.jsx("strong",{children:new Date(D).toLocaleDateString()}),a.jsxs("span",{children:[" ",L[0].start," - ",L[L.length-1].end]})]},D)}),Object.keys(i).length>5&&a.jsxs("p",{className:"more-dates",children:["... and ",Object.keys(i).length-5," more"]})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"purpose",children:"Purpose"}),a.jsx("textarea",{id:"purpose",value:p,onChange:D=>g(D.target.value),placeholder:"What will you use this space for?",rows:"3",required:!0})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{onClick:()=>u(!1),className:"btn btn-secondary",children:"Cancel"}),a.jsx("button",{onClick:$,className:"btn btn-primary",children:"Confirm Booking"})]})]})}),y.map(D=>a.jsx(Jn,{message:D.message,type:D.type,onClose:()=>S(D.id)},D.id)),a.jsx("style",{jsx:!0,children:`
        .room-booking-calendar {
          padding: var(--space-4);
        }

        .booking-controls {
          display: flex;
          gap: var(--space-4);
          margin-bottom: var(--space-4);
          flex-wrap: wrap;
          align-items: flex-end;
        }

        .form-group {
          flex: 1;
          min-width: 250px;
        }

        .view-toggle-group {
          display: flex;
          gap: var(--space-2);
        }

        .space-details {
          background: var(--theme-bg-secondary);
          padding: var(--space-4);
          border-radius: var(--radius-lg);
          margin-bottom: var(--space-4);
        }

        .space-details h3 {
          margin: 0 0 var(--space-2) 0;
        }

        .space-details p {
          margin: var(--space-2) 0;
          color: var(--theme-text-secondary);
        }

        .equipment-list {
          font-size: var(--text-sm);
        }

        .booking-summary-card {
          background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
          color: white;
          padding: var(--space-4);
          border-radius: var(--radius-lg);
          margin-top: var(--space-4);
          display: flex;
          justify-content: space-between;
          align-items: center;
          flex-wrap: wrap;
          gap: var(--space-3);
        }

        .summary-content h4 {
          margin: 0 0 var(--space-2) 0;
        }

        .summary-content p {
          margin: var(--space-1) 0;
        }

        .recurring-info {
          font-style: italic;
          opacity: 0.9;
        }

        .btn-lg {
          padding: var(--space-3) var(--space-6);
          font-size: var(--text-lg);
          font-weight: var(--font-semibold);
        }

        .booking-modal {
          max-width: 600px;
        }

        .booking-summary {
          background: var(--theme-bg-secondary);
          padding: var(--space-4);
          border-radius: var(--radius-md);
          margin-bottom: var(--space-4);
        }

        .recurring-summary {
          background: #fef3c7;
          padding: var(--space-3);
          border-radius: var(--radius-sm);
          margin-top: var(--space-3);
        }

        .recurring-badge {
          color: #92400e;
          font-weight: var(--font-semibold);
          margin-bottom: var(--space-1);
        }

        .dates-list {
          margin-top: var(--space-3);
        }

        .dates-list h4 {
          font-size: var(--text-sm);
          margin-bottom: var(--space-2);
          text-transform: uppercase;
          color: var(--theme-text-secondary);
        }

        .date-entry {
          padding: var(--space-2);
          background: var(--theme-bg-tertiary);
          border-radius: var(--radius-sm);
          margin-bottom: var(--space-1);
          display: flex;
          justify-content: space-between;
        }

        .more-dates {
          font-style: italic;
          color: var(--theme-text-secondary);
          text-align: center;
          margin-top: var(--space-2);
        }

        .legacy-view-message {
          text-align: center;
          padding: var(--space-6);
          background: var(--theme-bg-secondary);
          border-radius: var(--radius-lg);
          color: var(--theme-text-secondary);
        }
      `})]})}async function L5(t){try{const e=await be.query("equipment"),n=await be.query("sub_areas"),r=e.filter(i=>i.product_name.toLowerCase().includes(t.toLowerCase())&&i.status==="available"),s={};return r.forEach(i=>{if(!s[i.department]){const o=n.find(l=>l.id===i.sub_area_id);s[i.department]={departmentId:i.department,departmentName:o?o.name:i.department,availableCount:0,equipmentIds:[]}}s[i.department].availableCount++,s[i.department].equipmentIds.push(i.id)}),Object.values(s).sort((i,o)=>o.availableCount-i.availableCount)}catch(e){throw console.error("Error getting equipment availability:",e),e}}async function T5(t,e){try{const n=await L5(t);if(n.length===0)return{routingType:"none",targetDepartments:[],message:`No departments have '${t}' available`};const r=n.find(s=>s.availableCount>=e);return r?{routingType:"single",targetDepartments:[r],message:`Request will be sent to ${r.departmentName} (${r.availableCount} available)`}:{routingType:"broadcast",targetDepartments:n,message:`Request exceeds any single department's capacity. Will be broadcast to all ${n.length} departments with this equipment type.`}}catch(n){throw console.error("Error determining request routing:",n),n}}async function DC(t){const{requestingUserId:e,requestingDepartmentId:n,equipmentType:r,quantity:s,startDate:i,endDate:o,justification:l}=t;try{const c=await T5(r,s);if(c.routingType==="none")throw new Error(c.message);const d=[];if(c.routingType==="single"){const u=c.targetDepartments[0],p={id:`req${Date.now()}`,requesting_user_id:e,requesting_department_id:n,target_department_id:u.departmentId,equipment_type:r,quantity:s,start_date:i,end_date:o,justification:l,status:"pending",routing_type:"single",created_at:new Date().toISOString()},g=be.getData();g.cross_department_requests=g.cross_department_requests||[],g.cross_department_requests.push(p),be.saveData(g),d.push(p)}else for(const u of c.targetDepartments){const p={id:`req${Date.now()}_${u.departmentId}`,requesting_user_id:e,requesting_department_id:n,target_department_id:u.departmentId,equipment_type:r,quantity:s,start_date:i,end_date:o,justification:l,status:"pending",routing_type:"broadcast",broadcast_group_id:`bcast${Date.now()}`,available_at_department:u.availableCount,created_at:new Date().toISOString()},g=be.getData();g.cross_department_requests=g.cross_department_requests||[],g.cross_department_requests.push(p),be.saveData(g),d.push(p)}return{routingType:c.routingType,message:c.message,requests:d}}catch(c){throw console.error("Error creating cross-department request:",c),c}}async function PC(t,e=null){try{let n=await be.query("cross_department_requests",{target_department_id:t});e&&(n=n.filter(s=>s.status===e));const r=await be.query("users");return n=n.map(s=>{const i=r.find(o=>o.id===s.requesting_user_id);return{...s,requesting_user_name:i?i.full_name:"Unknown",requesting_user_email:i?i.email:""}}),n}catch(n){throw console.error("Error fetching department requests:",n),n}}async function LC(t){try{const e=await be.query("cross_department_requests",{requesting_user_id:t}),n=await be.query("sub_areas");return e.map(r=>{const s=n.find(i=>i.id===r.target_department_id);return{...r,target_department_name:s?s.name:r.target_department_id}})}catch(e){throw console.error("Error fetching user requests:",e),e}}async function TC(t,e,n){try{const r=be.getData(),s=r.cross_department_requests||[],i=s.findIndex(o=>o.id===t);if(i===-1)throw new Error("Request not found");return s[i]={...s[i],status:"approved",reviewed_by:e,reviewed_at:new Date().toISOString(),review_notes:n},r.cross_department_requests=s,be.saveData(r),console.log(`Request ${t} approved. Staff will receive notification with instructions.`),s[i]}catch(r){throw console.error("Error approving request:",r),r}}async function IC(t,e,n){try{const r=be.getData(),s=r.cross_department_requests||[],i=s.findIndex(o=>o.id===t);if(i===-1)throw new Error("Request not found");return s[i]={...s[i],status:"denied",reviewed_by:e,reviewed_at:new Date().toISOString(),review_notes:n},r.cross_department_requests=s,be.saveData(r),s[i]}catch(r){throw console.error("Error denying request:",r),r}}async function RC(t){try{const e=be.getData(),n=e.cross_department_requests||[],r=n.findIndex(s=>s.id===t);if(r===-1)throw new Error("Request not found");if(n[r].status!=="pending")throw new Error("Only pending requests can be cancelled");return n[r]={...n[r],status:"cancelled",cancelled_at:new Date().toISOString()},e.cross_department_requests=n,be.saveData(e),n[r]}catch(e){throw console.error("Error cancelling request:",e),e}}function I5(){const t=Pl(),{user:e}=cn(),[n,r]=O.useState(""),[s,i]=O.useState(1),[o,l]=O.useState(""),[c,d]=O.useState(""),[u,p]=O.useState(""),[g,m]=O.useState(null),[j,k]=O.useState(null),[w,y]=O.useState(!1),[_,S]=O.useState(!1),{toasts:N,showToast:T,removeToast:U}=Yn(),[P,b]=O.useState([]);O.useEffect(()=>{A()},[]);const A=async()=>{try{const L=await be.query("equipment"),I=[...new Set(L.map(X=>X.product_name))];b(I.sort())}catch(L){console.error("Failed to load equipment types:",L)}},$=async()=>{if(!n||s<1){T("Please select equipment type and quantity","error");return}S(!0);try{const L=await L5(n);m(L);const I=await T5(n,s);k(I)}catch(L){console.error("Failed to check availability:",L),T("Failed to check availability","error")}finally{S(!1)}},D=async L=>{if(L.preventDefault(),!n||s<1||!o||!c||u.trim().length<50){T("Please fill all required fields. Justification must be at least 50 characters.","error");return}y(!0);try{const I={requestingUserId:e.id,requestingDepartmentId:e.department,equipmentType:n,quantity:s,startDate:o,endDate:c,justification:u},X=await DC(I);T(`Request created successfully! ${X.routingType==="broadcast"?`Sent to ${X.requests.length} departments`:"Sent to 1 department"}`,"success"),setTimeout(()=>{t("/staff/my-cross-department-requests")},1500)}catch(I){console.error("Failed to create request:",I),T(I.message||"Failed to create request","error")}finally{y(!1)}},F=()=>{t("/staff")};return a.jsxs("div",{className:"page-container",style:{maxWidth:"900px",margin:"0 auto",padding:"2rem 1rem"},children:[a.jsxs("div",{className:"page-header",style:{marginBottom:"2rem"},children:[a.jsx("button",{onClick:F,className:"btn btn-secondary btn-sm",style:{marginBottom:"1rem"},children:" Back"}),a.jsx("h2",{children:"Request Equipment from Another Department"}),a.jsx("p",{style:{color:"#666",marginTop:"0.5rem"},children:"Request equipment from other departments when your department doesn't have what you need"})]}),a.jsxs("div",{className:"cross-dept-request-form",children:[a.jsxs("form",{onSubmit:D,children:[a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:"Equipment Details"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"equipment-type",children:"Equipment Type *"}),a.jsxs("select",{id:"equipment-type",value:n,onChange:L=>r(L.target.value),required:!0,children:[a.jsx("option",{value:"",children:"Select equipment type..."}),P.map(L=>a.jsx("option",{value:L,children:L},L))]}),a.jsx("small",{children:"Select the type of equipment you need"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"quantity",children:"Quantity *"}),a.jsx("input",{type:"number",id:"quantity",min:"1",max:"50",value:s,onChange:L=>i(parseInt(L.target.value)),required:!0}),a.jsx("small",{children:"How many items do you need?"})]}),a.jsx("button",{type:"button",onClick:$,className:"btn btn-secondary btn-sm",disabled:!n||s<1||_,style:{marginTop:"0.5rem"},children:_?"Checking...":"Check Availability"})]}),g&&a.jsxs("div",{className:"availability-preview",children:[a.jsx("h4",{children:"Equipment Availability Across Departments"}),g.length===0?a.jsxs("p",{className:"no-availability",children:['No departments have "',n,'" available']}):a.jsxs("table",{className:"availability-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Department"}),a.jsx("th",{children:"Available"})]})}),a.jsx("tbody",{children:g.map(L=>a.jsxs("tr",{children:[a.jsx("td",{children:L.departmentName}),a.jsx("td",{className:"availability-count",children:L.availableCount})]},L.departmentId))})]})]}),j&&a.jsxs("div",{className:`routing-preview routing-${j.routingType}`,children:[a.jsxs("h4",{children:[j.routingType==="single"&&" Single Department Request",j.routingType==="broadcast"&&" Broadcast Request"]}),a.jsx("p",{children:j.message})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:"Booking Dates"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"start-date",children:"Start Date *"}),a.jsx("input",{type:"date",id:"start-date",value:o,onChange:L=>l(L.target.value),min:new Date().toISOString().split("T")[0],required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"end-date",children:"End Date *"}),a.jsx("input",{type:"date",id:"end-date",value:c,onChange:L=>d(L.target.value),min:o||new Date().toISOString().split("T")[0],required:!0})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:"Justification"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"justification",children:"Why do you need this equipment? *"}),a.jsx("textarea",{id:"justification",value:u,onChange:L=>p(L.target.value),rows:"5",placeholder:"Provide a detailed justification for your request (minimum 50 characters)...",required:!0,minLength:"50"}),a.jsxs("small",{className:u.length<50?"text-error":"text-success",children:[u.length," / 50 characters minimum"]})]})]}),a.jsxs("div",{className:"form-actions",style:{display:"flex",gap:"1rem",justifyContent:"flex-end",marginTop:"2rem",paddingTop:"1.5rem",borderTop:"1px solid #dee2e6"},children:[a.jsx("button",{type:"button",onClick:F,className:"btn btn-secondary",disabled:w,children:"Cancel"}),a.jsx("button",{type:"submit",className:"btn btn-primary",disabled:w||j&&j.routingType==="none",children:w?"Submitting...":"Submit Request"})]})]}),N.map(L=>a.jsx(Jn,{message:L.message,type:L.type,onClose:()=>U(L.id)},L.id))]})]})}function qC(){const{user:t}=cn(),[e,n]=O.useState([]),[r,s]=O.useState(!0),[i,o]=O.useState(!1),[l,c]=O.useState("all"),{toasts:d,showToast:u,removeToast:p}=Yn();O.useEffect(()=>{g()},[]);const g=async()=>{s(!0);try{const y=await LC(t.id);n(y)}catch(y){console.error("Failed to load requests:",y),u("Failed to load requests","error")}finally{s(!1)}},m=async y=>{if(confirm("Are you sure you want to cancel this request?"))try{await RC(y),u("Request cancelled successfully","success"),g()}catch(_){console.error("Failed to cancel request:",_),u(_.message||"Failed to cancel request","error")}},j=()=>{g()},k=l==="all"?e:e.filter(y=>y.status===l),w=y=>({pending:"status-pending",approved:"status-approved",denied:"status-denied",cancelled:"status-cancelled"})[y]||"";return r?a.jsxs("div",{className:"my-cross-dept-requests",children:[a.jsx("h2",{children:"My Cross-Department Requests"}),a.jsx("p",{children:"Loading requests..."})]}):a.jsxs("div",{className:"my-cross-dept-requests",children:[a.jsxs("div",{className:"page-header",children:[a.jsx("h2",{children:"My Cross-Department Equipment Requests"}),a.jsx("button",{onClick:()=>o(!0),className:"btn btn-primary",children:"+ New Request"})]}),a.jsxs("div",{className:"filter-tabs",children:[a.jsxs("button",{onClick:()=>c("all"),className:l==="all"?"tab-active":"tab",children:["All (",e.length,")"]}),a.jsxs("button",{onClick:()=>c("pending"),className:l==="pending"?"tab-active":"tab",children:["Pending (",e.filter(y=>y.status==="pending").length,")"]}),a.jsxs("button",{onClick:()=>c("approved"),className:l==="approved"?"tab-active":"tab",children:["Approved (",e.filter(y=>y.status==="approved").length,")"]}),a.jsxs("button",{onClick:()=>c("denied"),className:l==="denied"?"tab-active":"tab",children:["Denied (",e.filter(y=>y.status==="denied").length,")"]})]}),k.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsxs("p",{children:["No ",l!=="all"?l:""," requests found."]}),l==="all"&&a.jsx("button",{onClick:()=>o(!0),className:"btn btn-primary",style:{marginTop:"1rem"},children:"Create Your First Request"})]}):a.jsx("div",{className:"requests-list",children:k.map(y=>a.jsxs("div",{className:"request-card",children:[a.jsxs("div",{className:"request-header",children:[a.jsxs("div",{children:[a.jsx("h3",{children:y.equipment_type}),a.jsx("span",{className:`status-badge ${w(y.status)}`,children:y.status.charAt(0).toUpperCase()+y.status.slice(1)})]}),y.status==="pending"&&a.jsx("button",{onClick:()=>m(y.id),className:"btn btn-secondary btn-sm",children:"Cancel Request"})]}),a.jsxs("div",{className:"request-details",children:[a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"detail-label",children:"Target Department:"}),a.jsx("span",{className:"detail-value",children:y.target_department_name})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"detail-label",children:"Quantity:"}),a.jsx("span",{className:"detail-value",children:y.quantity})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"detail-label",children:"Dates:"}),a.jsxs("span",{className:"detail-value",children:[new Date(y.start_date).toLocaleDateString()," - ",new Date(y.end_date).toLocaleDateString()]})]}),y.routing_type&&a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"detail-label",children:"Request Type:"}),a.jsx("span",{className:"detail-value",children:y.routing_type==="broadcast"?" Broadcast to Multiple Departments":" Single Department"})]})]}),a.jsxs("div",{className:"request-justification",children:[a.jsx("strong",{children:"Justification:"}),a.jsx("p",{children:y.justification})]}),y.status==="approved"&&y.review_notes&&a.jsxs("div",{className:"request-instructions approved",children:[a.jsx("strong",{children:" Approved - Collection Instructions:"}),a.jsx("p",{children:y.review_notes}),a.jsxs("small",{children:["Reviewed: ",new Date(y.reviewed_at).toLocaleString()]})]}),y.status==="denied"&&y.review_notes&&a.jsxs("div",{className:"request-instructions denied",children:[a.jsx("strong",{children:" Denied - Reason:"}),a.jsx("p",{children:y.review_notes}),a.jsxs("small",{children:["Reviewed: ",new Date(y.reviewed_at).toLocaleString()]})]}),a.jsx("div",{className:"request-metadata",children:a.jsxs("small",{children:["Created: ",new Date(y.created_at).toLocaleString()]})})]},y.id))}),i&&a.jsx(I5,{onClose:()=>o(!1),onSuccess:j}),d.map(y=>a.jsx(Jn,{message:y.message,type:y.type,onClose:()=>p(y.id)},y.id)),a.jsx("style",{jsx:!0,children:`
        .my-cross-dept-requests {
          padding: 2rem;
        }

        .page-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 2rem;
        }

        .filter-tabs {
          display: flex;
          gap: 0.5rem;
          margin-bottom: 2rem;
          border-bottom: 2px solid #eee;
        }

        .tab,
        .tab-active {
          padding: 0.75rem 1.5rem;
          border: none;
          background: none;
          cursor: pointer;
          font-weight: 600;
          color: #666;
          border-bottom: 3px solid transparent;
          transition: all 0.2s;
        }

        .tab:hover {
          color: #333;
          background-color: #f5f5f5;
        }

        .tab-active {
          color: #1976d2;
          border-bottom-color: #1976d2;
        }

        .requests-list {
          display: flex;
          flex-direction: column;
          gap: 1.5rem;
        }

        .request-card {
          background: #fff;
          border: 1px solid #ddd;
          border-radius: 8px;
          padding: 1.5rem;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .request-header {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          margin-bottom: 1rem;
        }

        .request-header h3 {
          margin: 0 0 0.5rem 0;
          color: #333;
        }

        .status-badge {
          display: inline-block;
          padding: 0.25rem 0.75rem;
          border-radius: 12px;
          font-size: 0.875rem;
          font-weight: 600;
        }

        .status-pending {
          background-color: #fff3cd;
          color: #856404;
        }

        .status-approved {
          background-color: #d4edda;
          color: #155724;
        }

        .status-denied {
          background-color: #f8d7da;
          color: #721c24;
        }

        .status-cancelled {
          background-color: #e2e3e5;
          color: #383d41;
        }

        .request-details {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
          margin-bottom: 1rem;
        }

        .detail-row {
          display: flex;
          gap: 0.5rem;
        }

        .detail-label {
          font-weight: 600;
          color: #666;
          min-width: 150px;
        }

        .detail-value {
          color: #333;
        }

        .request-justification {
          margin-top: 1rem;
          padding: 1rem;
          background-color: #f5f5f5;
          border-radius: 4px;
        }

        .request-justification strong {
          display: block;
          margin-bottom: 0.5rem;
          color: #333;
        }

        .request-justification p {
          margin: 0;
          color: #555;
          line-height: 1.5;
        }

        .request-instructions {
          margin-top: 1rem;
          padding: 1rem;
          border-radius: 4px;
          border-left: 4px solid;
        }

        .request-instructions.approved {
          background-color: #e8f5e9;
          border-left-color: #4caf50;
        }

        .request-instructions.denied {
          background-color: #ffebee;
          border-left-color: #f44336;
        }

        .request-instructions strong {
          display: block;
          margin-bottom: 0.5rem;
          color: #333;
        }

        .request-instructions p {
          margin: 0 0 0.5rem 0;
          color: #555;
          line-height: 1.5;
        }

        .request-instructions small {
          color: #999;
          font-size: 0.85rem;
        }

        .request-metadata {
          margin-top: 1rem;
          padding-top: 1rem;
          border-top: 1px solid #eee;
        }

        .request-metadata small {
          color: #999;
        }

        .empty-state {
          text-align: center;
          padding: 3rem;
          color: #666;
        }

        @media (max-width: 768px) {
          .my-cross-dept-requests {
            padding: 1rem;
          }

          .page-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 1rem;
          }

          .filter-tabs {
            flex-wrap: wrap;
          }

          .request-header {
            flex-direction: column;
            gap: 1rem;
          }

          .detail-label {
            min-width: 120px;
          }
        }
      `})]})}function OC(){const{user:t,logout:e}=cn();return a.jsxs("div",{className:"staff-portal",children:[a.jsx("header",{className:"staff-header",children:a.jsxs("div",{className:"staff-header-content",children:[a.jsx("h1",{children:" NCADbook Staff"}),a.jsxs("div",{className:"staff-header-actions",children:[a.jsx(y0,{}),a.jsx("span",{className:"staff-user-info",children:t==null?void 0:t.full_name}),a.jsx("button",{onClick:e,className:"btn btn-secondary btn-sm",children:"Logout"})]})]})}),a.jsxs("nav",{className:"staff-nav",children:[a.jsx(vn,{to:"/staff",end:!0,className:({isActive:n})=>`staff-nav-link ${n?"active":""}`,children:" Dashboard"}),a.jsx(vn,{to:"/staff/rooms",className:({isActive:n})=>`staff-nav-link ${n?"active":""}`,children:" Book Rooms"}),a.jsx(vn,{to:"/staff/equipment",className:({isActive:n})=>`staff-nav-link ${n?"active":""}`,children:" Equipment"}),a.jsx(vn,{to:"/staff/bookings",className:({isActive:n})=>`staff-nav-link ${n?"active":""}`,children:" My Bookings"}),a.jsx(vn,{to:"/staff/cross-department-requests",className:({isActive:n})=>`staff-nav-link ${n?"active":""}`,children:" Request Equipment"}),a.jsx(vn,{to:"/staff/my-cross-department-requests",className:({isActive:n})=>`staff-nav-link ${n?"active":""}`,children:" My Requests"})]}),a.jsx("main",{className:"staff-main",children:a.jsxs(Yh,{children:[a.jsx(vt,{index:!0,element:a.jsx(kC,{})}),a.jsx(vt,{path:"rooms",element:a.jsx(EC,{})}),a.jsx(vt,{path:"equipment",element:a.jsx(D5,{})}),a.jsx(vt,{path:"bookings",element:a.jsx(P5,{})}),a.jsx(vt,{path:"cross-department-requests",element:a.jsx(I5,{})}),a.jsx(vt,{path:"my-cross-department-requests",element:a.jsx(qC,{})})]})}),a.jsx(b0,{})]})}function FC(){const{user:t}=Nr(),[e,n]=O.useState({totalBookings:0,pendingBookings:0,approvedBookings:0,totalEquipment:0,availableEquipment:0,totalUsers:0}),[r,s]=O.useState(!0);O.useEffect(()=>{i()},[]);const i=async()=>{try{const o=await be.query("bookings"),l=await be.query("equipment"),c=await be.query("users");n({totalBookings:o.length,pendingBookings:o.filter(d=>d.status==="pending").length,approvedBookings:o.filter(d=>d.status==="approved").length,totalEquipment:l.length,availableEquipment:l.filter(d=>d.status==="available").length,totalUsers:c.filter(d=>d.role==="student").length})}catch(o){console.error("Failed to load stats:",o)}finally{s(!1)}};return r?a.jsx("div",{className:"admin-dashboard",children:a.jsx("div",{className:"admin-stats-grid",children:[1,2,3,4,5].map(o=>a.jsx("div",{className:"admin-skeleton"},o))})}):a.jsxs("div",{className:"admin-dashboard",children:[a.jsxs("div",{className:"admin-welcome",children:[a.jsxs("h2",{children:["Welcome, ",t==null?void 0:t.first_name,"! "]}),a.jsxs("p",{children:[(t==null?void 0:t.role)==="master_admin"?"Master Admin":"Department Admin"," Dashboard Overview"]})]}),a.jsxs("div",{className:"admin-stats-grid",children:[a.jsxs("div",{className:"admin-stat-card",children:[a.jsx("div",{className:"admin-stat-icon",children:""}),a.jsx("div",{className:"admin-stat-number",children:e.totalBookings}),a.jsx("div",{className:"admin-stat-label",children:"Total Bookings"})]}),a.jsxs("div",{className:"admin-stat-card",children:[a.jsx("div",{className:"admin-stat-icon",children:""}),a.jsx("div",{className:"admin-stat-number",children:e.pendingBookings}),a.jsx("div",{className:"admin-stat-label",children:"Pending Approval"})]}),a.jsxs("div",{className:"admin-stat-card",children:[a.jsx("div",{className:"admin-stat-icon",children:""}),a.jsx("div",{className:"admin-stat-number",children:e.approvedBookings}),a.jsx("div",{className:"admin-stat-label",children:"Approved"})]}),a.jsxs("div",{className:"admin-stat-card",children:[a.jsx("div",{className:"admin-stat-icon",children:""}),a.jsxs("div",{className:"admin-stat-number",children:[e.availableEquipment,"/",e.totalEquipment]}),a.jsx("div",{className:"admin-stat-label",children:"Equipment Available"})]}),a.jsxs("div",{className:"admin-stat-card",children:[a.jsx("div",{className:"admin-stat-icon",children:""}),a.jsx("div",{className:"admin-stat-number",children:e.totalUsers}),a.jsx("div",{className:"admin-stat-label",children:"Students"})]})]}),a.jsxs("div",{className:"admin-dashboard-grid",children:[a.jsxs("div",{className:"admin-card",children:[a.jsxs("h3",{children:[a.jsx("span",{className:"admin-card-icon",children:""})," Quick Actions"]}),a.jsxs("div",{className:"admin-quick-actions",children:[a.jsxs("a",{href:"/admin/approvals",className:"admin-action-btn",children:[" Review Pending Bookings (",e.pendingBookings,")"]}),a.jsx("a",{href:"/admin/equipment",className:"admin-action-btn secondary",children:" Manage Equipment"}),(t==null?void 0:t.role)==="master_admin"&&a.jsx("a",{href:"/admin/users",className:"admin-action-btn secondary",children:" Manage Users"})]})]}),a.jsxs("div",{className:"admin-card",children:[a.jsxs("h3",{children:[a.jsx("span",{className:"admin-card-icon",children:""})," Admin Info"]}),a.jsxs("div",{className:"admin-info-content",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Role:"})," ",(t==null?void 0:t.role)==="master_admin"?"Master Admin":"Department Admin"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Department:"})," ",(t==null?void 0:t.department)||"System"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Email:"})," ",t==null?void 0:t.email]})]})]})]})]})}function MC({selectedCount:t,onApproveAll:e,onDenyAll:n,onClearSelection:r,loading:s=!1,actions:i=[]}){if(t===0)return null;const o=[{label:"Approve Selected",onClick:e,className:"btn-success",testId:"bulk-approve-btn"},{label:"Deny Selected",onClick:n,className:"btn-error",testId:"bulk-deny-btn"}],l=i.length>0?i:o;return a.jsxs("div",{className:"bulk-action-bar",role:"toolbar","aria-label":"Bulk actions",children:[a.jsxs("div",{className:"bulk-action-info",children:[a.jsxs("span",{className:"selected-count","data-testid":"selected-count",children:[t," item",t!==1?"s":""," selected"]}),a.jsx("button",{onClick:r,className:"btn-text",disabled:s,"data-testid":"clear-selection-btn",children:"Clear selection"})]}),a.jsx("div",{className:"bulk-action-buttons",children:l.map((c,d)=>a.jsx("button",{onClick:c.onClick,disabled:s,className:`btn btn-sm ${c.className||"btn-primary"}`,"data-testid":c.testId,children:s?"Processing...":c.label},d))})]})}function BC({booking:t,onApprove:e,onDeny:n,onSelectToggle:r,isSelected:s,formatDate:i,getStatusColor:o,children:l}){var A,$,D,F,L,I;const[c,d]=O.useState(0),[u,p]=O.useState(!1),[g,m]=O.useState(0),j=O.useRef(null),k=100,w=X=>{t.status==="pending"&&(m(X.touches[0].clientX),p(!0))},y=X=>{if(!u||t.status!=="pending")return;const oe=X.touches[0].clientX-g,Z=150,ae=Math.max(-Z,Math.min(Z,oe));d(ae)},_=()=>{!u||t.status!=="pending"||(c>k?(e(t.id),window.navigator.vibrate&&window.navigator.vibrate(50)):c<-k&&(n(t),window.navigator.vibrate&&window.navigator.vibrate([50,50])),d(0),p(!1))},S=X=>{t.status==="pending"&&(m(X.clientX),p(!0))},N=X=>{if(!u||t.status!=="pending")return;const oe=X.clientX-g,Z=150,ae=Math.max(-Z,Math.min(Z,oe));d(ae)},T=()=>{!u||t.status!=="pending"||(c>k?e(t.id):c<-k&&n(t),d(0),p(!1))};O.useEffect(()=>{const X=te=>{u&&te.preventDefault()};return document.addEventListener("mousemove",N),document.addEventListener("mouseup",T),document.addEventListener("touchmove",X,{passive:!1}),()=>{document.removeEventListener("mousemove",N),document.removeEventListener("mouseup",T),document.removeEventListener("touchmove",X)}},[u,c]);const P=c>50?"approve":c<-50?"deny":null,b=Math.min(Math.abs(c)/k,1);return a.jsxs("div",{ref:j,className:`swipe-action-card ${u?"dragging":""} ${P?`hint-${P}`:""}`,style:{transform:`translateX(${c}px)`,transition:u?"none":"transform 0.3s ease-out"},onTouchStart:w,onTouchMove:y,onTouchEnd:_,onMouseDown:S,"data-testid":"swipe-action-card",children:[t.status==="pending"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"swipe-action-bg swipe-approve",style:{opacity:c>0?b:0},children:[a.jsx("span",{className:"action-icon",children:""}),a.jsx("span",{className:"action-text",children:"Approve"})]}),a.jsxs("div",{className:"swipe-action-bg swipe-deny",style:{opacity:c<0?b:0},children:[a.jsx("span",{className:"action-icon",children:""}),a.jsx("span",{className:"action-text",children:"Deny"})]})]}),a.jsxs("div",{className:"approval-item","data-testid":"booking-card",children:[a.jsxs("div",{className:"approval-header",children:[a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"1rem"},children:[t.status==="pending"&&r&&a.jsx("input",{type:"checkbox",checked:s,onChange:()=>r(t.id),"data-testid":`select-booking-${t.id}`,"aria-label":`Select booking for ${(A=t.equipment)==null?void 0:A.product_name}`,style:{marginTop:"0.25rem"},onClick:X=>X.stopPropagation()}),a.jsxs("div",{children:[a.jsx("h3",{children:(($=t.equipment)==null?void 0:$.product_name)||"Unknown Equipment"}),a.jsxs("p",{className:"student-name",children:["Requested by: ",((D=t.student)==null?void 0:D.full_name)||"Unknown","(",(F=t.student)==null?void 0:F.department,")"]})]})]}),a.jsx("span",{className:"status-badge status-"+o(t.status),children:t.status})]}),a.jsxs("div",{className:"approval-details",children:[a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"label",children:"Equipment:"}),a.jsxs("span",{children:[(L=t.equipment)==null?void 0:L.category," - ",(I=t.equipment)==null?void 0:I.tracking_number]})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"label",children:"Dates:"}),a.jsxs("span",{children:[i(t.start_date)," - ",i(t.end_date)]})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"label",children:"Purpose:"}),a.jsx("span",{children:t.purpose||"Not provided"})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"label",children:"Requested:"}),a.jsx("span",{children:i(t.created_at)})]}),t.denial_reason&&a.jsxs("div",{className:"detail-row error",children:[a.jsx("span",{className:"label",children:"Denial Reason:"}),a.jsx("span",{children:t.denial_reason})]})]}),l]})]})}function UC(){var me;const{user:t}=Nr(),[e,n]=O.useState([]),[r,s]=O.useState([]),[i,o]=O.useState(!0),[l,c]=O.useState("pending"),[d,u]=O.useState(null),[p,g]=O.useState(!1),[m,j]=O.useState(""),[k,w]=O.useState(""),[y,_]=O.useState(1),S=20,[N,T]=O.useState([]),[U,P]=O.useState(!1),{toasts:b,showToast:A,removeToast:$}=Yn();O.useEffect(()=>{D()},[l]),O.useEffect(()=>{let re=e;if(k.trim()){const fe=k.toLowerCase();re=re.filter(_e=>{var ke,Ae,ye,Q;return((ke=_e.equipment)==null?void 0:ke.product_name.toLowerCase().includes(fe))||((Ae=_e.student)==null?void 0:Ae.full_name.toLowerCase().includes(fe))||((ye=_e.student)==null?void 0:ye.email.toLowerCase().includes(fe))||((Q=_e.purpose)==null?void 0:Q.toLowerCase().includes(fe))})}s(re),_(1)},[e,k]);const D=async()=>{o(!0);try{const re=await be.query("bookings"),fe=await Promise.all(re.map(async ke=>{const Ae=await be.findOne("equipment",{id:ke.equipment_id}),ye=await be.findOne("users",{id:ke.user_id});return{...ke,equipment:Ae,student:ye}})),_e=l==="all"?fe:fe.filter(ke=>ke.status===l);n(_e.sort((ke,Ae)=>new Date(Ae.created_at)-new Date(ke.created_at)))}catch(re){console.error("Failed to load bookings:",re)}finally{o(!1)}},F=async re=>{try{const fe=e.find(_e=>_e.id===re);await be.update("bookings",{id:re},{status:"approved",approved_by:t.id,approved_at:new Date().toISOString()});try{const _e=[fe.equipment],ke=await Vn.sendBookingApproved(fe,fe.student,_e,t);!ke.success&&Vn.isConfigured()&&console.warn("Email notification failed:",ke.error)}catch(_e){console.error("Failed to send approval email:",_e)}await D(),A("Booking approved successfully","success")}catch(fe){A("Failed to approve booking: "+fe.message,"error")}},L=re=>{u(re),g(!0)},I=async()=>{if(!m.trim()){A("Please provide a reason for denial","error");return}try{await be.update("bookings",{id:d.id},{status:"denied",denied_by:t.id,denied_at:new Date().toISOString(),denial_reason:m});try{const re=[d.equipment],fe=await Vn.sendBookingDenied(d,d.student,re,t,m);!fe.success&&Vn.isConfigured()&&console.warn("Email notification failed:",fe.error)}catch(re){console.error("Failed to send denial email:",re)}g(!1),j(""),u(null),await D(),A("Booking denied","success")}catch(re){A("Failed to deny booking: "+re.message,"error")}},X=re=>new Date(re).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),te=re=>({pending:"warning",approved:"success",denied:"error",cancelled:"secondary"})[re]||"secondary",oe=re=>{w(re)},Z=re=>{_(re),window.scrollTo({top:0,behavior:"smooth"})},ae=async()=>{await D()},ee=re=>{T(fe=>fe.includes(re)?fe.filter(_e=>_e!==re):[...fe,re])},de=()=>{N.length===le.length?T([]):T(le.map(re=>re.id))},E=async()=>{P(!0);try{const re=N.map(async fe=>{const _e=e.find(ke=>ke.id===fe);await be.update("bookings",{id:fe},{status:"approved",approved_by:t.id,approved_at:new Date().toISOString()});try{const ke=[_e.equipment];await Vn.sendBookingApproved(_e,_e.student,ke,t)}catch(ke){console.error("Failed to send approval email:",ke)}});await Promise.all(re),await D(),T([]),A(`Successfully approved ${re.length} booking(s)`,"success")}catch(re){A("Failed to approve bookings: "+re.message,"error")}finally{P(!1)}},H=()=>{N.length!==0&&(u(null),g(!0))},J=async()=>{if(!m.trim()){A("Please provide a reason for denial","error");return}P(!0);try{const re=N.map(async fe=>{const _e=e.find(ke=>ke.id===fe);await be.update("bookings",{id:fe},{status:"denied",denied_by:t.id,denied_at:new Date().toISOString(),denial_reason:m});try{const ke=[_e.equipment];await Vn.sendBookingDenied(_e,_e.student,ke,t,m)}catch(ke){console.error("Failed to send denial email:",ke)}});await Promise.all(re),await D(),T([]),g(!1),j(""),A(`Successfully denied ${re.length} booking(s)`,"success")}catch(re){A("Failed to deny bookings: "+re.message,"error")}finally{P(!1)}},V=(y-1)*S,ne=V+S,le=r.slice(V,ne);return a.jsxs("div",{className:"booking-approvals","data-testid":"booking-approvals",children:[a.jsxs(x0,{onRefresh:ae,children:[a.jsxs("div",{className:"approvals-header",children:[a.jsx("h2",{children:"Booking Approvals"}),a.jsx("div",{className:"filter-controls",children:["pending","approved","denied","cancelled","all"].map(re=>a.jsx("button",{onClick:()=>c(re),className:l===re?"btn btn-primary btn-sm":"btn btn-secondary btn-sm","data-testid":`filter-${re}`,children:re.charAt(0).toUpperCase()+re.slice(1)},re))})]}),a.jsx(nf,{onSearch:oe,placeholder:"Search by equipment, student name, or purpose...",ariaLabel:"Search bookings"}),l==="pending"&&le.length>0&&a.jsx(MC,{selectedCount:N.length,onApproveAll:E,onDenyAll:H,onClearSelection:()=>T([]),loading:U}),i?a.jsx("div",{className:"approvals-list",children:a.jsx(cd,{type:"list-item",count:8})}):r.length===0?a.jsx("div",{className:"empty-state","data-testid":"empty-state",children:a.jsxs("p",{children:["No ",l!=="all"?l:""," bookings found",k?" matching your search":""]})}):a.jsxs(a.Fragment,{children:[l==="pending"&&le.length>0&&a.jsx("div",{className:"select-all-container",style:{marginBottom:"1rem"},children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:N.length===le.length&&le.length>0,onChange:de,"data-testid":"select-all-checkbox"}),a.jsx("span",{style:{marginLeft:"0.5rem"},children:"Select All on Page"})]})}),a.jsx("div",{className:"approvals-list","data-testid":"bookings-list",children:le.map(re=>a.jsx(BC,{booking:re,onApprove:F,onDeny:L,onSelectToggle:ee,isSelected:N.includes(re.id),formatDate:X,getStatusColor:te,children:re.status==="pending"&&a.jsxs("div",{className:"approval-actions",children:[a.jsx("button",{onClick:()=>F(re.id),className:"btn btn-primary btn-sm","data-testid":"approve-btn",children:"Approve"}),a.jsx("button",{onClick:()=>{u(re),g(!0)},className:"btn btn-secondary btn-sm","data-testid":"deny-btn",children:"Deny"})]})},re.id))}),a.jsx(ld,{currentPage:y,totalItems:r.length,itemsPerPage:S,onPageChange:Z,loading:i})]})]}),p&&a.jsx("div",{className:"modal-overlay",onClick:()=>g(!1),"data-testid":"modal-overlay",children:a.jsxs("div",{className:"modal-content",onClick:re=>re.stopPropagation(),"data-testid":"deny-modal",children:[a.jsxs("div",{className:"modal-header",children:[a.jsxs("h2",{children:["Deny Booking",N.length>0?"s":""]}),a.jsx("button",{className:"modal-close",onClick:()=>g(!1),children:""})]}),a.jsxs("div",{className:"modal-body",children:[N.length>0?a.jsxs("p",{children:["Deny ",a.jsx("strong",{children:N.length})," selected booking(s)?"]}):d?a.jsxs("p",{children:["Deny booking for ",a.jsx("strong",{children:(me=d.equipment)==null?void 0:me.product_name}),"?"]}):null,a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"deny-reason",children:"Reason for Denial (required)"}),a.jsx("textarea",{id:"deny-reason",value:m,onChange:re=>j(re.target.value),placeholder:"Explain why this booking is being denied...",rows:"4",required:!0,"data-testid":"deny-reason-input"})]}),a.jsxs("div",{className:"modal-actions",children:[a.jsx("button",{onClick:()=>g(!1),className:"btn btn-secondary",children:"Cancel"}),a.jsx("button",{onClick:N.length>0?J:I,className:"btn btn-primary","data-testid":"confirm-deny-btn",disabled:U,children:U?"Processing...":"Deny Booking"})]})]})]})}),b.map(re=>a.jsx(Jn,{message:re.message,type:re.type,onClose:()=>$(re.id)},re.id))]})}function $C({equipmentId:t,equipmentName:e}){const{user:n}=cn(),[r,s]=O.useState([]),[i,o]=O.useState(!1),[l,c]=O.useState({type:"general",content:""}),[d,u]=O.useState(!1);O.useEffect(()=>{p()},[t]);const p=()=>{const k=JSON.parse(localStorage.getItem("ncadbook_demo_data")),_=(k.demoEquipmentNotes||[]).filter(S=>S.equipment_id===t).sort((S,N)=>new Date(N.created_at)-new Date(S.created_at)).map(S=>{const N=k.users.find(T=>T.id===S.created_by);return{...S,creator_name:N?N.full_name:"Unknown"}});s(_)},g=async()=>{if(!l.content.trim()){alert("Please enter a note");return}u(!0);const k=JSON.parse(localStorage.getItem("ncadbook_demo_data")),w={id:`en${Date.now()}`,equipment_id:t,note_type:l.type,note:l.content,created_by:n.id,created_at:new Date().toISOString()};k.demoEquipmentNotes=k.demoEquipmentNotes||[],k.demoEquipmentNotes.push(w),localStorage.setItem("ncadbook_demo_data",JSON.stringify(k)),c({type:"general",content:""}),o(!1),u(!1),p()},m=k=>{const w={maintenance:"#3b82f6",damage:"#ef4444",usage:"#10b981",general:"#64748b"};return w[k]||w.general},j=k=>{const w={maintenance:"M",damage:"D",usage:"U",general:"G"};return w[k]||w.general};return n.role!=="admin"&&n.role!=="master_admin"?null:a.jsxs("div",{className:"equipment-notes-section",children:[a.jsxs("div",{className:"notes-header",children:[a.jsx("h3",{children:"Equipment Notes"}),a.jsx("button",{onClick:()=>o(!0),className:"btn btn-primary btn-sm",children:"+ Add Note"})]}),r.length===0?a.jsx("div",{className:"empty-notes",children:a.jsx("p",{children:"No notes for this equipment yet."})}):a.jsx("div",{className:"notes-list",children:r.map(k=>a.jsxs("div",{className:"note-item",style:{borderLeftColor:m(k.note_type)},children:[a.jsxs("div",{className:"note-header",children:[a.jsxs("div",{className:"note-type",children:[a.jsx("span",{className:"note-icon",children:j(k.note_type)}),a.jsx("span",{className:"note-type-label",children:k.note_type})]}),a.jsxs("div",{className:"note-meta",children:[a.jsx("span",{className:"note-creator",children:k.creator_name}),a.jsx("span",{className:"note-date",children:new Date(k.created_at).toLocaleDateString("en-IE",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),a.jsx("div",{className:"note-content",children:k.note})]},k.id))}),i&&a.jsx("div",{className:"modal-overlay",onClick:()=>o(!1),children:a.jsxs("div",{className:"modal-content",onClick:k=>k.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsxs("h2",{children:["Add Note - ",e]}),a.jsx("button",{className:"modal-close",onClick:()=>o(!1),children:""})]}),a.jsxs("div",{className:"modal-body",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"note-type",children:"Note Type"}),a.jsxs("select",{id:"note-type",value:l.type,onChange:k=>c({...l,type:k.target.value}),className:"select-input",children:[a.jsx("option",{value:"general",children:"General"}),a.jsx("option",{value:"maintenance",children:"Maintenance"}),a.jsx("option",{value:"damage",children:"Damage"}),a.jsx("option",{value:"usage",children:"Usage"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"note-content",children:"Note"}),a.jsx("textarea",{id:"note-content",value:l.content,onChange:k=>c({...l,content:k.target.value}),placeholder:"Enter note details...",rows:"5",className:"form-textarea"})]}),a.jsxs("div",{className:"modal-actions",children:[a.jsx("button",{onClick:()=>o(!1),className:"btn btn-secondary",disabled:d,children:"Cancel"}),a.jsx("button",{onClick:g,className:"btn btn-primary",disabled:d,children:d?"Adding...":"Add Note"})]})]})]})})]})}function zC(){const[t,e]=O.useState([]),[n,r]=O.useState([]),[s,i]=O.useState(!0),[o,l]=O.useState("all"),[c,d]=O.useState(!1),[u,p]=O.useState(null),[g,m]=O.useState(""),[j,k]=O.useState(1),w=20;O.useEffect(()=>{y()},[o]),O.useEffect(()=>{let b=t;if(g.trim()){const A=g.toLowerCase();b=b.filter($=>$.product_name.toLowerCase().includes(A)||$.description.toLowerCase().includes(A)||$.tracking_number.toLowerCase().includes(A)||$.category.toLowerCase().includes(A))}r(b),k(1)},[t,g]);const y=async()=>{i(!0);try{const b=o==="all"?{}:{status:o},A=await be.query("equipment",b);e(A)}catch(b){console.error("Failed to load equipment:",b)}finally{i(!1)}},_=async(b,A)=>{try{await be.update("equipment",{id:b},{status:A}),await y(),alert("Equipment status updated")}catch($){alert("Failed to update status: "+$.message)}},S=b=>{m(b)},N=b=>{k(b),window.scrollTo({top:0,behavior:"smooth"})},T=(j-1)*w,U=T+w,P=n.slice(T,U);return a.jsxs("div",{className:"equipment-management",children:[a.jsx("h2",{children:"Equipment Management"}),a.jsx("p",{className:"subtitle",children:"Manage equipment inventory and status"}),a.jsx(nf,{onSearch:S,placeholder:"Search by name, tracking number, or category...",ariaLabel:"Search equipment"}),a.jsx("div",{className:"management-controls",children:a.jsx("div",{className:"filter-controls",children:["all","available","booked","maintenance"].map(b=>a.jsx("button",{onClick:()=>l(b),className:o===b?"btn btn-primary btn-sm":"btn btn-secondary btn-sm",children:b.charAt(0).toUpperCase()+b.slice(1)},b))})}),s?a.jsx("div",{className:"equipment-table",children:a.jsxs("table",{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Equipment"}),a.jsx("th",{children:"Category"}),a.jsx("th",{children:"Tracking #"}),a.jsx("th",{children:"Department"}),a.jsx("th",{children:"Status"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:a.jsx(cd,{type:"table-row",count:10})})]})}):n.length===0?a.jsx("div",{className:"empty-state",children:a.jsxs("p",{children:["No equipment found",g?" matching your search":""]})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"equipment-table",children:a.jsxs("table",{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Equipment"}),a.jsx("th",{children:"Category"}),a.jsx("th",{children:"Tracking #"}),a.jsx("th",{children:"Department"}),a.jsx("th",{children:"Status"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:P.map(b=>a.jsxs("tr",{children:[a.jsxs("td",{children:[a.jsx("strong",{children:b.product_name}),a.jsx("br",{}),a.jsx("small",{children:b.description})]}),a.jsx("td",{children:b.category}),a.jsx("td",{className:"tracking-number",children:b.tracking_number}),a.jsx("td",{children:b.department}),a.jsx("td",{children:a.jsxs("select",{value:b.status,onChange:A=>_(b.id,A.target.value),className:"status-select",children:[a.jsx("option",{value:"available",children:"Available"}),a.jsx("option",{value:"booked",children:"Booked"}),a.jsx("option",{value:"maintenance",children:"Maintenance"}),a.jsx("option",{value:"out_of_service",children:"Out of Service"})]})}),a.jsx("td",{children:a.jsx("button",{onClick:()=>{p(b),d(!0)},className:"btn btn-secondary btn-sm",children:"View Details"})})]},b.id))})]})}),a.jsx(ld,{currentPage:j,totalItems:n.length,itemsPerPage:w,onPageChange:N,loading:s})]}),c&&u&&a.jsx("div",{className:"modal-overlay",onClick:()=>d(!1),children:a.jsxs("div",{className:"modal-content equipment-detail-modal",onClick:b=>b.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:u.product_name}),a.jsx("button",{className:"modal-close",onClick:()=>d(!1),children:""})]}),a.jsxs("div",{className:"modal-body",children:[a.jsxs("div",{className:"equipment-detail-info",children:[a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"detail-label",children:"Tracking Number:"}),a.jsx("span",{className:"detail-value tracking-number",children:u.tracking_number})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"detail-label",children:"Category:"}),a.jsx("span",{className:"detail-value",children:u.category})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"detail-label",children:"Department:"}),a.jsx("span",{className:"detail-value",children:u.department})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"detail-label",children:"Status:"}),a.jsx("span",{className:`status status-${u.status}`,children:u.status})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"detail-label",children:"Description:"}),a.jsx("span",{className:"detail-value",children:u.description})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("span",{className:"detail-label",children:"Requires Justification:"}),a.jsx("span",{className:"detail-value",children:u.requires_justification?"Yes":"No"})]})]}),a.jsx($C,{equipmentId:u.id,equipmentName:u.product_name})]})]})})]})}function Lt(t){"@babel/helpers - typeof";return Lt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lt(t)}var ks=Uint8Array,Mr=Uint16Array,S0=Int32Array,k0=new ks([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),N0=new ks([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Gv=new ks([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),R5=function(t,e){for(var n=new Mr(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];for(var s=new S0(n[30]),r=1;r<30;++r)for(var i=n[r];i<n[r+1];++i)s[i]=i-n[r]<<5|r;return{b:n,r:s}},q5=R5(k0,2),WC=q5.b,rg=q5.r;WC[28]=258,rg[258]=28;var HC=R5(N0,0),Kv=HC.r,sg=new Mr(32768);for(var Gt=0;Gt<32768;++Gt){var Wa=(Gt&43690)>>1|(Gt&21845)<<1;Wa=(Wa&52428)>>2|(Wa&13107)<<2,Wa=(Wa&61680)>>4|(Wa&3855)<<4,sg[Gt]=((Wa&65280)>>8|(Wa&255)<<8)>>1}var Mc=function(t,e,n){for(var r=t.length,s=0,i=new Mr(e);s<r;++s)t[s]&&++i[t[s]-1];var o=new Mr(e);for(s=1;s<e;++s)o[s]=o[s-1]+i[s-1]<<1;var l;if(n){l=new Mr(1<<e);var c=15-e;for(s=0;s<r;++s)if(t[s])for(var d=s<<4|t[s],u=e-t[s],p=o[t[s]-1]++<<u,g=p|(1<<u)-1;p<=g;++p)l[sg[p]>>c]=d}else for(l=new Mr(r),s=0;s<r;++s)t[s]&&(l[s]=sg[o[t[s]-1]++]>>15-t[s]);return l},uo=new ks(288);for(var Gt=0;Gt<144;++Gt)uo[Gt]=8;for(var Gt=144;Gt<256;++Gt)uo[Gt]=9;for(var Gt=256;Gt<280;++Gt)uo[Gt]=7;for(var Gt=280;Gt<288;++Gt)uo[Gt]=8;var jh=new ks(32);for(var Gt=0;Gt<32;++Gt)jh[Gt]=5;var VC=Mc(uo,9,0),GC=Mc(jh,5,0),O5=function(t){return(t+7)/8|0},KC=function(t,e,n){return(n==null||n>t.length)&&(n=t.length),new ks(t.subarray(e,n))},oa=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8},_c=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8,t[r+2]|=n>>16},xp=function(t,e){for(var n=[],r=0;r<t.length;++r)t[r]&&n.push({s:r,f:t[r]});var s=n.length,i=n.slice();if(!s)return{t:M5,l:0};if(s==1){var o=new ks(n[0].s+1);return o[n[0].s]=1,{t:o,l:1}}n.sort(function(T,U){return T.f-U.f}),n.push({s:-1,f:25001});var l=n[0],c=n[1],d=0,u=1,p=2;for(n[0]={s:-1,f:l.f+c.f,l,r:c};u!=s-1;)l=n[n[d].f<n[p].f?d++:p++],c=n[d!=u&&n[d].f<n[p].f?d++:p++],n[u++]={s:-1,f:l.f+c.f,l,r:c};for(var g=i[0].s,r=1;r<s;++r)i[r].s>g&&(g=i[r].s);var m=new Mr(g+1),j=ag(n[u-1],m,0);if(j>e){var r=0,k=0,w=j-e,y=1<<w;for(i.sort(function(U,P){return m[P.s]-m[U.s]||U.f-P.f});r<s;++r){var _=i[r].s;if(m[_]>e)k+=y-(1<<j-m[_]),m[_]=e;else break}for(k>>=w;k>0;){var S=i[r].s;m[S]<e?k-=1<<e-m[S]++-1:++r}for(;r>=0&&k;--r){var N=i[r].s;m[N]==e&&(--m[N],++k)}j=e}return{t:new ks(m),l:j}},ag=function(t,e,n){return t.s==-1?Math.max(ag(t.l,e,n+1),ag(t.r,e,n+1)):e[t.s]=n},Zv=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new Mr(++e),r=0,s=t[0],i=1,o=function(c){n[r++]=c},l=1;l<=e;++l)if(t[l]==s&&l!=e)++i;else{if(!s&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(s),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(s);i=1,s=t[l]}return{c:n.subarray(0,r),n:e}},xc=function(t,e){for(var n=0,r=0;r<e.length;++r)n+=t[r]*e[r];return n},F5=function(t,e,n){var r=n.length,s=O5(e+2);t[s]=r&255,t[s+1]=r>>8,t[s+2]=t[s]^255,t[s+3]=t[s+1]^255;for(var i=0;i<r;++i)t[s+i+4]=n[i];return(s+4+r)*8},Yv=function(t,e,n,r,s,i,o,l,c,d,u){oa(e,u++,n),++s[256];for(var p=xp(s,15),g=p.t,m=p.l,j=xp(i,15),k=j.t,w=j.l,y=Zv(g),_=y.c,S=y.n,N=Zv(k),T=N.c,U=N.n,P=new Mr(19),b=0;b<_.length;++b)++P[_[b]&31];for(var b=0;b<T.length;++b)++P[T[b]&31];for(var A=xp(P,7),$=A.t,D=A.l,F=19;F>4&&!$[Gv[F-1]];--F);var L=d+5<<3,I=xc(s,uo)+xc(i,jh)+o,X=xc(s,g)+xc(i,k)+o+14+3*F+xc(P,$)+2*P[16]+3*P[17]+7*P[18];if(c>=0&&L<=I&&L<=X)return F5(e,u,t.subarray(c,c+d));var te,oe,Z,ae;if(oa(e,u,1+(X<I)),u+=2,X<I){te=Mc(g,m,0),oe=g,Z=Mc(k,w,0),ae=k;var ee=Mc($,D,0);oa(e,u,S-257),oa(e,u+5,U-1),oa(e,u+10,F-4),u+=14;for(var b=0;b<F;++b)oa(e,u+3*b,$[Gv[b]]);u+=3*F;for(var de=[_,T],E=0;E<2;++E)for(var H=de[E],b=0;b<H.length;++b){var J=H[b]&31;oa(e,u,ee[J]),u+=$[J],J>15&&(oa(e,u,H[b]>>5&127),u+=H[b]>>12)}}else te=VC,oe=uo,Z=GC,ae=jh;for(var b=0;b<l;++b){var V=r[b];if(V>255){var J=V>>18&31;_c(e,u,te[J+257]),u+=oe[J+257],J>7&&(oa(e,u,V>>23&31),u+=k0[J]);var ne=V&31;_c(e,u,Z[ne]),u+=ae[ne],ne>3&&(_c(e,u,V>>5&8191),u+=N0[ne])}else _c(e,u,te[V]),u+=oe[V]}return _c(e,u,te[256]),u+oe[256]},ZC=new S0([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),M5=new ks(0),YC=function(t,e,n,r,s,i){var o=i.z||t.length,l=new ks(r+o+5*(1+Math.ceil(o/7e3))+s),c=l.subarray(r,l.length-s),d=i.l,u=(i.r||0)&7;if(e){u&&(c[0]=i.r>>3);for(var p=ZC[e-1],g=p>>13,m=p&8191,j=(1<<n)-1,k=i.p||new Mr(32768),w=i.h||new Mr(j+1),y=Math.ceil(n/3),_=2*y,S=function(ye){return(t[ye]^t[ye+1]<<y^t[ye+2]<<_)&j},N=new S0(25e3),T=new Mr(288),U=new Mr(32),P=0,b=0,A=i.i||0,$=0,D=i.w||0,F=0;A+2<o;++A){var L=S(A),I=A&32767,X=w[L];if(k[I]=X,w[L]=I,D<=A){var te=o-A;if((P>7e3||$>24576)&&(te>423||!d)){u=Yv(t,c,0,N,T,U,b,$,F,A-F,u),$=P=b=0,F=A;for(var oe=0;oe<286;++oe)T[oe]=0;for(var oe=0;oe<30;++oe)U[oe]=0}var Z=2,ae=0,ee=m,de=I-X&32767;if(te>2&&L==S(A-de))for(var E=Math.min(g,te)-1,H=Math.min(32767,A),J=Math.min(258,te);de<=H&&--ee&&I!=X;){if(t[A+Z]==t[A+Z-de]){for(var V=0;V<J&&t[A+V]==t[A+V-de];++V);if(V>Z){if(Z=V,ae=de,V>E)break;for(var ne=Math.min(de,V-2),le=0,oe=0;oe<ne;++oe){var me=A-de+oe&32767,re=k[me],fe=me-re&32767;fe>le&&(le=fe,X=me)}}}I=X,X=k[I],de+=I-X&32767}if(ae){N[$++]=268435456|rg[Z]<<18|Kv[ae];var _e=rg[Z]&31,ke=Kv[ae]&31;b+=k0[_e]+N0[ke],++T[257+_e],++U[ke],D=A+Z,++P}else N[$++]=t[A],++T[t[A]]}}for(A=Math.max(A,D);A<o;++A)N[$++]=t[A],++T[t[A]];u=Yv(t,c,d,N,T,U,b,$,F,A-F,u),d||(i.r=u&7|c[u/8|0]<<3,u-=7,i.h=w,i.p=k,i.i=A,i.w=D)}else{for(var A=i.w||0;A<o+d;A+=65535){var Ae=A+65535;Ae>=o&&(c[u/8|0]=d,Ae=o),u=F5(c,u+1,t.subarray(A,Ae))}i.i=o}return KC(l,0,r+O5(u)+s)},B5=function(){var t=1,e=0;return{p:function(n){for(var r=t,s=e,i=n.length|0,o=0;o!=i;){for(var l=Math.min(o+2655,i);o<l;++o)s+=r+=n[o];r=(r&65535)+15*(r>>16),s=(s&65535)+15*(s>>16)}t=r,e=s},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},JC=function(t,e,n,r,s){if(!s&&(s={l:1},e.dictionary)){var i=e.dictionary.subarray(-32768),o=new ks(i.length+t.length);o.set(i),o.set(t,i.length),t=o,s.w=i.length}return YC(t,e.level==null?6:e.level,e.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,n,r,s)},U5=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},XC=function(t,e){var n=e.level,r=n==0?0:n<6?1:n==9?3:2;if(t[0]=120,t[1]=r<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var s=B5();s.p(e.dictionary),U5(t,2,s.d())}};function ig(t,e){e||(e={});var n=B5();n.p(t);var r=JC(t,e,e.dictionary?6:2,4);return XC(r,e),U5(r,r.length-4,n.d()),r}var QC=typeof TextDecoder<"u"&&new TextDecoder,e6=0;try{QC.decode(M5,{stream:!0}),e6=1}catch{}function t6(t){if(Array.isArray(t))return t}function n6(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,s,i,o,l=[],c=!0,d=!1;try{if(i=(n=n.call(t)).next,e!==0)for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function Jv(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function r6(t,e){if(t){if(typeof t=="string")return Jv(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jv(t,e):void 0}}function s6(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xv(t,e){return t6(t)||n6(t,e)||r6(t,e)||s6()}function Qv(t,e="utf8"){return new TextDecoder(e).decode(t)}const a6=new TextEncoder;function i6(t){return a6.encode(t)}const o6=1024*8,l6=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),wp={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class C0{constructor(e=o6,n={}){At(this,"buffer");At(this,"byteLength");At(this,"byteOffset");At(this,"length");At(this,"offset");At(this,"lastWrittenByte");At(this,"littleEndian");At(this,"_data");At(this,"_mark");At(this,"_marks");let r=!1;typeof e=="number"?e=new ArrayBuffer(e):(r=!0,this.lastWrittenByte=e.byteLength);const s=n.offset?n.offset>>>0:0,i=e.byteLength-s;let o=s;(ArrayBuffer.isView(e)||e instanceof C0)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+s),e=e.buffer),r?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=e,this.length=i,this.byteLength=i,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,i),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const r=(this.offset+e)*2,s=new Uint8Array(r);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=r,this.byteLength=r,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,n){const r=wp[n].BYTES_PER_ELEMENT*e,s=this.byteOffset+this.offset,i=this.buffer.slice(s,s+r);if(this.littleEndian===l6&&n!=="uint8"&&n!=="int8"){const l=new Uint8Array(this.buffer.slice(s,s+r));l.reverse();const c=new wp[n](l.buffer);return this.offset+=r,c.reverse(),c}const o=new wp[n](i);return this.offset+=r,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let n="";for(let r=0;r<e;r++)n+=this.readChar();return n}readUtf8(e=1){return Qv(this.readBytes(e))}decodeText(e=1,n="utf8"){return Qv(this.readBytes(e),n)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let n=0;n<e.length;n++)this._data.setUint8(this.offset++,e[n]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let n=0;n<e.length;n++)this.writeUint8(e.charCodeAt(n));return this}writeUtf8(e){return this.writeBytes(i6(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Il(t){let e=t.length;for(;--e>=0;)t[e]=0}const c6=3,d6=258,$5=29,u6=256,h6=u6+1+$5,z5=30,f6=512,p6=new Array((h6+2)*2);Il(p6);const m6=new Array(z5*2);Il(m6);const g6=new Array(f6);Il(g6);const v6=new Array(d6-c6+1);Il(v6);const y6=new Array($5);Il(y6);const b6=new Array(z5);Il(b6);const _6=(t,e,n,r)=>{let s=t&65535|0,i=t>>>16&65535|0,o=0;for(;n!==0;){o=n>2e3?2e3:n,n-=o;do s=s+e[r++]|0,i=i+s|0;while(--o);s%=65521,i%=65521}return s|i<<16|0};var og=_6;const x6=()=>{let t,e=[];for(var n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=t&1?3988292384^t>>>1:t>>>1;e[n]=t}return e},w6=new Uint32Array(x6()),j6=(t,e,n,r)=>{const s=w6,i=r+n;t^=-1;for(let o=r;o<i;o++)t=t>>>8^s[(t^e[o])&255];return t^-1};var qs=j6,lg={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},W5={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const S6=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var k6=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const r in n)S6(n,r)&&(t[r]=n[r])}}return t},N6=t=>{let e=0;for(let r=0,s=t.length;r<s;r++)e+=t[r].length;const n=new Uint8Array(e);for(let r=0,s=0,i=t.length;r<i;r++){let o=t[r];n.set(o,s),s+=o.length}return n},H5={assign:k6,flattenChunks:N6};let V5=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{V5=!1}const dd=new Uint8Array(256);for(let t=0;t<256;t++)dd[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;dd[254]=dd[254]=1;var C6=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,n,r,s,i,o=t.length,l=0;for(s=0;s<o;s++)n=t.charCodeAt(s),(n&64512)===55296&&s+1<o&&(r=t.charCodeAt(s+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),s++)),l+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(l),i=0,s=0;i<l;s++)n=t.charCodeAt(s),(n&64512)===55296&&s+1<o&&(r=t.charCodeAt(s+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),s++)),n<128?e[i++]=n:n<2048?(e[i++]=192|n>>>6,e[i++]=128|n&63):n<65536?(e[i++]=224|n>>>12,e[i++]=128|n>>>6&63,e[i++]=128|n&63):(e[i++]=240|n>>>18,e[i++]=128|n>>>12&63,e[i++]=128|n>>>6&63,e[i++]=128|n&63);return e};const A6=(t,e)=>{if(e<65534&&t.subarray&&V5)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let n="";for(let r=0;r<e;r++)n+=String.fromCharCode(t[r]);return n};var E6=(t,e)=>{const n=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let r,s;const i=new Array(n*2);for(s=0,r=0;r<n;){let o=t[r++];if(o<128){i[s++]=o;continue}let l=dd[o];if(l>4){i[s++]=65533,r+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&r<n;)o=o<<6|t[r++]&63,l--;if(l>1){i[s++]=65533;continue}o<65536?i[s++]=o:(o-=65536,i[s++]=55296|o>>10&1023,i[s++]=56320|o&1023)}return A6(i,s)},D6=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let n=e-1;for(;n>=0&&(t[n]&192)===128;)n--;return n<0||n===0?e:n+dd[t[n]]>e?n:e},cg={string2buf:C6,buf2string:E6,utf8border:D6};function P6(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var L6=P6;const wu=16209,T6=16191;var I6=function(e,n){let r,s,i,o,l,c,d,u,p,g,m,j,k,w,y,_,S,N,T,U,P,b,A,$;const D=e.state;r=e.next_in,A=e.input,s=r+(e.avail_in-5),i=e.next_out,$=e.output,o=i-(n-e.avail_out),l=i+(e.avail_out-257),c=D.dmax,d=D.wsize,u=D.whave,p=D.wnext,g=D.window,m=D.hold,j=D.bits,k=D.lencode,w=D.distcode,y=(1<<D.lenbits)-1,_=(1<<D.distbits)-1;e:do{j<15&&(m+=A[r++]<<j,j+=8,m+=A[r++]<<j,j+=8),S=k[m&y];t:for(;;){if(N=S>>>24,m>>>=N,j-=N,N=S>>>16&255,N===0)$[i++]=S&65535;else if(N&16){T=S&65535,N&=15,N&&(j<N&&(m+=A[r++]<<j,j+=8),T+=m&(1<<N)-1,m>>>=N,j-=N),j<15&&(m+=A[r++]<<j,j+=8,m+=A[r++]<<j,j+=8),S=w[m&_];n:for(;;){if(N=S>>>24,m>>>=N,j-=N,N=S>>>16&255,N&16){if(U=S&65535,N&=15,j<N&&(m+=A[r++]<<j,j+=8,j<N&&(m+=A[r++]<<j,j+=8)),U+=m&(1<<N)-1,U>c){e.msg="invalid distance too far back",D.mode=wu;break e}if(m>>>=N,j-=N,N=i-o,U>N){if(N=U-N,N>u&&D.sane){e.msg="invalid distance too far back",D.mode=wu;break e}if(P=0,b=g,p===0){if(P+=d-N,N<T){T-=N;do $[i++]=g[P++];while(--N);P=i-U,b=$}}else if(p<N){if(P+=d+p-N,N-=p,N<T){T-=N;do $[i++]=g[P++];while(--N);if(P=0,p<T){N=p,T-=N;do $[i++]=g[P++];while(--N);P=i-U,b=$}}}else if(P+=p-N,N<T){T-=N;do $[i++]=g[P++];while(--N);P=i-U,b=$}for(;T>2;)$[i++]=b[P++],$[i++]=b[P++],$[i++]=b[P++],T-=3;T&&($[i++]=b[P++],T>1&&($[i++]=b[P++]))}else{P=i-U;do $[i++]=$[P++],$[i++]=$[P++],$[i++]=$[P++],T-=3;while(T>2);T&&($[i++]=$[P++],T>1&&($[i++]=$[P++]))}}else if(N&64){e.msg="invalid distance code",D.mode=wu;break e}else{S=w[(S&65535)+(m&(1<<N)-1)];continue n}break}}else if(N&64)if(N&32){D.mode=T6;break e}else{e.msg="invalid literal/length code",D.mode=wu;break e}else{S=k[(S&65535)+(m&(1<<N)-1)];continue t}break}}while(r<s&&i<l);T=j>>3,r-=T,j-=T<<3,m&=(1<<j)-1,e.next_in=r,e.next_out=i,e.avail_in=r<s?5+(s-r):5-(r-s),e.avail_out=i<l?257+(l-i):257-(i-l),D.hold=m,D.bits=j};const Fo=15,e2=852,t2=592,n2=0,jp=1,r2=2,R6=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),q6=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),O6=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),F6=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),M6=(t,e,n,r,s,i,o,l)=>{const c=l.bits;let d=0,u=0,p=0,g=0,m=0,j=0,k=0,w=0,y=0,_=0,S,N,T,U,P,b=null,A;const $=new Uint16Array(Fo+1),D=new Uint16Array(Fo+1);let F=null,L,I,X;for(d=0;d<=Fo;d++)$[d]=0;for(u=0;u<r;u++)$[e[n+u]]++;for(m=c,g=Fo;g>=1&&$[g]===0;g--);if(m>g&&(m=g),g===0)return s[i++]=1<<24|64<<16|0,s[i++]=1<<24|64<<16|0,l.bits=1,0;for(p=1;p<g&&$[p]===0;p++);for(m<p&&(m=p),w=1,d=1;d<=Fo;d++)if(w<<=1,w-=$[d],w<0)return-1;if(w>0&&(t===n2||g!==1))return-1;for(D[1]=0,d=1;d<Fo;d++)D[d+1]=D[d]+$[d];for(u=0;u<r;u++)e[n+u]!==0&&(o[D[e[n+u]]++]=u);if(t===n2?(b=F=o,A=20):t===jp?(b=R6,F=q6,A=257):(b=O6,F=F6,A=0),_=0,u=0,d=p,P=i,j=m,k=0,T=-1,y=1<<m,U=y-1,t===jp&&y>e2||t===r2&&y>t2)return 1;for(;;){L=d-k,o[u]+1<A?(I=0,X=o[u]):o[u]>=A?(I=F[o[u]-A],X=b[o[u]-A]):(I=96,X=0),S=1<<d-k,N=1<<j,p=N;do N-=S,s[P+(_>>k)+N]=L<<24|I<<16|X|0;while(N!==0);for(S=1<<d-1;_&S;)S>>=1;if(S!==0?(_&=S-1,_+=S):_=0,u++,--$[d]===0){if(d===g)break;d=e[n+o[u]]}if(d>m&&(_&U)!==T){for(k===0&&(k=m),P+=p,j=d-k,w=1<<j;j+k<g&&(w-=$[j+k],!(w<=0));)j++,w<<=1;if(y+=1<<j,t===jp&&y>e2||t===r2&&y>t2)return 1;T=_&U,s[T]=m<<24|j<<16|P-i|0}}return _!==0&&(s[P+_]=d-k<<24|64<<16|0),l.bits=m,0};var Bc=M6;const B6=0,G5=1,K5=2,{Z_FINISH:s2,Z_BLOCK:U6,Z_TREES:ju,Z_OK:ho,Z_STREAM_END:$6,Z_NEED_DICT:z6,Z_STREAM_ERROR:ls,Z_DATA_ERROR:Z5,Z_MEM_ERROR:Y5,Z_BUF_ERROR:W6,Z_DEFLATED:a2}=W5,rf=16180,i2=16181,o2=16182,l2=16183,c2=16184,d2=16185,u2=16186,h2=16187,f2=16188,p2=16189,Sh=16190,la=16191,Sp=16192,m2=16193,kp=16194,g2=16195,v2=16196,y2=16197,b2=16198,Su=16199,ku=16200,_2=16201,x2=16202,w2=16203,j2=16204,S2=16205,Np=16206,k2=16207,N2=16208,Zt=16209,J5=16210,X5=16211,H6=852,V6=592,G6=15,K6=G6,C2=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function Z6(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const vo=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<rf||e.mode>X5?1:0},Q5=t=>{if(vo(t))return ls;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=rf,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(H6),e.distcode=e.distdyn=new Int32Array(V6),e.sane=1,e.back=-1,ho},ex=t=>{if(vo(t))return ls;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Q5(t)},tx=(t,e)=>{let n;if(vo(t))return ls;const r=t.state;return e<0?(n=0,e=-e):(n=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?ls:(r.window!==null&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,ex(t))},nx=(t,e)=>{if(!t)return ls;const n=new Z6;t.state=n,n.strm=t,n.window=null,n.mode=rf;const r=tx(t,e);return r!==ho&&(t.state=null),r},Y6=t=>nx(t,K6);let A2=!0,Cp,Ap;const J6=t=>{if(A2){Cp=new Int32Array(512),Ap=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Bc(G5,t.lens,0,288,Cp,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Bc(K5,t.lens,0,32,Ap,0,t.work,{bits:5}),A2=!1}t.lencode=Cp,t.lenbits=9,t.distcode=Ap,t.distbits=5},rx=(t,e,n,r)=>{let s;const i=t.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),r>=i.wsize?(i.window.set(e.subarray(n-i.wsize,n),0),i.wnext=0,i.whave=i.wsize):(s=i.wsize-i.wnext,s>r&&(s=r),i.window.set(e.subarray(n-r,n-r+s),i.wnext),r-=s,r?(i.window.set(e.subarray(n-r,n),0),i.wnext=r,i.whave=i.wsize):(i.wnext+=s,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=s))),0},X6=(t,e)=>{let n,r,s,i,o,l,c,d,u,p,g,m,j,k,w=0,y,_,S,N,T,U,P,b;const A=new Uint8Array(4);let $,D;const F=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(vo(t)||!t.output||!t.input&&t.avail_in!==0)return ls;n=t.state,n.mode===la&&(n.mode=Sp),o=t.next_out,s=t.output,c=t.avail_out,i=t.next_in,r=t.input,l=t.avail_in,d=n.hold,u=n.bits,p=l,g=c,b=ho;e:for(;;)switch(n.mode){case rf:if(n.wrap===0){n.mode=Sp;break}for(;u<16;){if(l===0)break e;l--,d+=r[i++]<<u,u+=8}if(n.wrap&2&&d===35615){n.wbits===0&&(n.wbits=15),n.check=0,A[0]=d&255,A[1]=d>>>8&255,n.check=qs(n.check,A,2,0),d=0,u=0,n.mode=i2;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((d&255)<<8)+(d>>8))%31){t.msg="incorrect header check",n.mode=Zt;break}if((d&15)!==a2){t.msg="unknown compression method",n.mode=Zt;break}if(d>>>=4,u-=4,P=(d&15)+8,n.wbits===0&&(n.wbits=P),P>15||P>n.wbits){t.msg="invalid window size",n.mode=Zt;break}n.dmax=1<<n.wbits,n.flags=0,t.adler=n.check=1,n.mode=d&512?p2:la,d=0,u=0;break;case i2:for(;u<16;){if(l===0)break e;l--,d+=r[i++]<<u,u+=8}if(n.flags=d,(n.flags&255)!==a2){t.msg="unknown compression method",n.mode=Zt;break}if(n.flags&57344){t.msg="unknown header flags set",n.mode=Zt;break}n.head&&(n.head.text=d>>8&1),n.flags&512&&n.wrap&4&&(A[0]=d&255,A[1]=d>>>8&255,n.check=qs(n.check,A,2,0)),d=0,u=0,n.mode=o2;case o2:for(;u<32;){if(l===0)break e;l--,d+=r[i++]<<u,u+=8}n.head&&(n.head.time=d),n.flags&512&&n.wrap&4&&(A[0]=d&255,A[1]=d>>>8&255,A[2]=d>>>16&255,A[3]=d>>>24&255,n.check=qs(n.check,A,4,0)),d=0,u=0,n.mode=l2;case l2:for(;u<16;){if(l===0)break e;l--,d+=r[i++]<<u,u+=8}n.head&&(n.head.xflags=d&255,n.head.os=d>>8),n.flags&512&&n.wrap&4&&(A[0]=d&255,A[1]=d>>>8&255,n.check=qs(n.check,A,2,0)),d=0,u=0,n.mode=c2;case c2:if(n.flags&1024){for(;u<16;){if(l===0)break e;l--,d+=r[i++]<<u,u+=8}n.length=d,n.head&&(n.head.extra_len=d),n.flags&512&&n.wrap&4&&(A[0]=d&255,A[1]=d>>>8&255,n.check=qs(n.check,A,2,0)),d=0,u=0}else n.head&&(n.head.extra=null);n.mode=d2;case d2:if(n.flags&1024&&(m=n.length,m>l&&(m=l),m&&(n.head&&(P=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(i,i+m),P)),n.flags&512&&n.wrap&4&&(n.check=qs(n.check,r,m,i)),l-=m,i+=m,n.length-=m),n.length))break e;n.length=0,n.mode=u2;case u2:if(n.flags&2048){if(l===0)break e;m=0;do P=r[i+m++],n.head&&P&&n.length<65536&&(n.head.name+=String.fromCharCode(P));while(P&&m<l);if(n.flags&512&&n.wrap&4&&(n.check=qs(n.check,r,m,i)),l-=m,i+=m,P)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=h2;case h2:if(n.flags&4096){if(l===0)break e;m=0;do P=r[i+m++],n.head&&P&&n.length<65536&&(n.head.comment+=String.fromCharCode(P));while(P&&m<l);if(n.flags&512&&n.wrap&4&&(n.check=qs(n.check,r,m,i)),l-=m,i+=m,P)break e}else n.head&&(n.head.comment=null);n.mode=f2;case f2:if(n.flags&512){for(;u<16;){if(l===0)break e;l--,d+=r[i++]<<u,u+=8}if(n.wrap&4&&d!==(n.check&65535)){t.msg="header crc mismatch",n.mode=Zt;break}d=0,u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=la;break;case p2:for(;u<32;){if(l===0)break e;l--,d+=r[i++]<<u,u+=8}t.adler=n.check=C2(d),d=0,u=0,n.mode=Sh;case Sh:if(n.havedict===0)return t.next_out=o,t.avail_out=c,t.next_in=i,t.avail_in=l,n.hold=d,n.bits=u,z6;t.adler=n.check=1,n.mode=la;case la:if(e===U6||e===ju)break e;case Sp:if(n.last){d>>>=u&7,u-=u&7,n.mode=Np;break}for(;u<3;){if(l===0)break e;l--,d+=r[i++]<<u,u+=8}switch(n.last=d&1,d>>>=1,u-=1,d&3){case 0:n.mode=m2;break;case 1:if(J6(n),n.mode=Su,e===ju){d>>>=2,u-=2;break e}break;case 2:n.mode=v2;break;case 3:t.msg="invalid block type",n.mode=Zt}d>>>=2,u-=2;break;case m2:for(d>>>=u&7,u-=u&7;u<32;){if(l===0)break e;l--,d+=r[i++]<<u,u+=8}if((d&65535)!==(d>>>16^65535)){t.msg="invalid stored block lengths",n.mode=Zt;break}if(n.length=d&65535,d=0,u=0,n.mode=kp,e===ju)break e;case kp:n.mode=g2;case g2:if(m=n.length,m){if(m>l&&(m=l),m>c&&(m=c),m===0)break e;s.set(r.subarray(i,i+m),o),l-=m,i+=m,c-=m,o+=m,n.length-=m;break}n.mode=la;break;case v2:for(;u<14;){if(l===0)break e;l--,d+=r[i++]<<u,u+=8}if(n.nlen=(d&31)+257,d>>>=5,u-=5,n.ndist=(d&31)+1,d>>>=5,u-=5,n.ncode=(d&15)+4,d>>>=4,u-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=Zt;break}n.have=0,n.mode=y2;case y2:for(;n.have<n.ncode;){for(;u<3;){if(l===0)break e;l--,d+=r[i++]<<u,u+=8}n.lens[F[n.have++]]=d&7,d>>>=3,u-=3}for(;n.have<19;)n.lens[F[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,$={bits:n.lenbits},b=Bc(B6,n.lens,0,19,n.lencode,0,n.work,$),n.lenbits=$.bits,b){t.msg="invalid code lengths set",n.mode=Zt;break}n.have=0,n.mode=b2;case b2:for(;n.have<n.nlen+n.ndist;){for(;w=n.lencode[d&(1<<n.lenbits)-1],y=w>>>24,_=w>>>16&255,S=w&65535,!(y<=u);){if(l===0)break e;l--,d+=r[i++]<<u,u+=8}if(S<16)d>>>=y,u-=y,n.lens[n.have++]=S;else{if(S===16){for(D=y+2;u<D;){if(l===0)break e;l--,d+=r[i++]<<u,u+=8}if(d>>>=y,u-=y,n.have===0){t.msg="invalid bit length repeat",n.mode=Zt;break}P=n.lens[n.have-1],m=3+(d&3),d>>>=2,u-=2}else if(S===17){for(D=y+3;u<D;){if(l===0)break e;l--,d+=r[i++]<<u,u+=8}d>>>=y,u-=y,P=0,m=3+(d&7),d>>>=3,u-=3}else{for(D=y+7;u<D;){if(l===0)break e;l--,d+=r[i++]<<u,u+=8}d>>>=y,u-=y,P=0,m=11+(d&127),d>>>=7,u-=7}if(n.have+m>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=Zt;break}for(;m--;)n.lens[n.have++]=P}}if(n.mode===Zt)break;if(n.lens[256]===0){t.msg="invalid code -- missing end-of-block",n.mode=Zt;break}if(n.lenbits=9,$={bits:n.lenbits},b=Bc(G5,n.lens,0,n.nlen,n.lencode,0,n.work,$),n.lenbits=$.bits,b){t.msg="invalid literal/lengths set",n.mode=Zt;break}if(n.distbits=6,n.distcode=n.distdyn,$={bits:n.distbits},b=Bc(K5,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,$),n.distbits=$.bits,b){t.msg="invalid distances set",n.mode=Zt;break}if(n.mode=Su,e===ju)break e;case Su:n.mode=ku;case ku:if(l>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=i,t.avail_in=l,n.hold=d,n.bits=u,I6(t,g),o=t.next_out,s=t.output,c=t.avail_out,i=t.next_in,r=t.input,l=t.avail_in,d=n.hold,u=n.bits,n.mode===la&&(n.back=-1);break}for(n.back=0;w=n.lencode[d&(1<<n.lenbits)-1],y=w>>>24,_=w>>>16&255,S=w&65535,!(y<=u);){if(l===0)break e;l--,d+=r[i++]<<u,u+=8}if(_&&!(_&240)){for(N=y,T=_,U=S;w=n.lencode[U+((d&(1<<N+T)-1)>>N)],y=w>>>24,_=w>>>16&255,S=w&65535,!(N+y<=u);){if(l===0)break e;l--,d+=r[i++]<<u,u+=8}d>>>=N,u-=N,n.back+=N}if(d>>>=y,u-=y,n.back+=y,n.length=S,_===0){n.mode=S2;break}if(_&32){n.back=-1,n.mode=la;break}if(_&64){t.msg="invalid literal/length code",n.mode=Zt;break}n.extra=_&15,n.mode=_2;case _2:if(n.extra){for(D=n.extra;u<D;){if(l===0)break e;l--,d+=r[i++]<<u,u+=8}n.length+=d&(1<<n.extra)-1,d>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=x2;case x2:for(;w=n.distcode[d&(1<<n.distbits)-1],y=w>>>24,_=w>>>16&255,S=w&65535,!(y<=u);){if(l===0)break e;l--,d+=r[i++]<<u,u+=8}if(!(_&240)){for(N=y,T=_,U=S;w=n.distcode[U+((d&(1<<N+T)-1)>>N)],y=w>>>24,_=w>>>16&255,S=w&65535,!(N+y<=u);){if(l===0)break e;l--,d+=r[i++]<<u,u+=8}d>>>=N,u-=N,n.back+=N}if(d>>>=y,u-=y,n.back+=y,_&64){t.msg="invalid distance code",n.mode=Zt;break}n.offset=S,n.extra=_&15,n.mode=w2;case w2:if(n.extra){for(D=n.extra;u<D;){if(l===0)break e;l--,d+=r[i++]<<u,u+=8}n.offset+=d&(1<<n.extra)-1,d>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=Zt;break}n.mode=j2;case j2:if(c===0)break e;if(m=g-c,n.offset>m){if(m=n.offset-m,m>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=Zt;break}m>n.wnext?(m-=n.wnext,j=n.wsize-m):j=n.wnext-m,m>n.length&&(m=n.length),k=n.window}else k=s,j=o-n.offset,m=n.length;m>c&&(m=c),c-=m,n.length-=m;do s[o++]=k[j++];while(--m);n.length===0&&(n.mode=ku);break;case S2:if(c===0)break e;s[o++]=n.length,c--,n.mode=ku;break;case Np:if(n.wrap){for(;u<32;){if(l===0)break e;l--,d|=r[i++]<<u,u+=8}if(g-=c,t.total_out+=g,n.total+=g,n.wrap&4&&g&&(t.adler=n.check=n.flags?qs(n.check,s,g,o-g):og(n.check,s,g,o-g)),g=c,n.wrap&4&&(n.flags?d:C2(d))!==n.check){t.msg="incorrect data check",n.mode=Zt;break}d=0,u=0}n.mode=k2;case k2:if(n.wrap&&n.flags){for(;u<32;){if(l===0)break e;l--,d+=r[i++]<<u,u+=8}if(n.wrap&4&&d!==(n.total&4294967295)){t.msg="incorrect length check",n.mode=Zt;break}d=0,u=0}n.mode=N2;case N2:b=$6;break e;case Zt:b=Z5;break e;case J5:return Y5;case X5:default:return ls}return t.next_out=o,t.avail_out=c,t.next_in=i,t.avail_in=l,n.hold=d,n.bits=u,(n.wsize||g!==t.avail_out&&n.mode<Zt&&(n.mode<Np||e!==s2))&&rx(t,t.output,t.next_out,g-t.avail_out),p-=t.avail_in,g-=t.avail_out,t.total_in+=p,t.total_out+=g,n.total+=g,n.wrap&4&&g&&(t.adler=n.check=n.flags?qs(n.check,s,g,t.next_out-g):og(n.check,s,g,t.next_out-g)),t.data_type=n.bits+(n.last?64:0)+(n.mode===la?128:0)+(n.mode===Su||n.mode===kp?256:0),(p===0&&g===0||e===s2)&&b===ho&&(b=W6),b},Q6=t=>{if(vo(t))return ls;let e=t.state;return e.window&&(e.window=null),t.state=null,ho},eA=(t,e)=>{if(vo(t))return ls;const n=t.state;return n.wrap&2?(n.head=e,e.done=!1,ho):ls},tA=(t,e)=>{const n=e.length;let r,s,i;return vo(t)||(r=t.state,r.wrap!==0&&r.mode!==Sh)?ls:r.mode===Sh&&(s=1,s=og(s,e,n,0),s!==r.check)?Z5:(i=rx(t,e,n,n),i?(r.mode=J5,Y5):(r.havedict=1,ho))};var nA=ex,rA=tx,sA=Q5,aA=Y6,iA=nx,oA=X6,lA=Q6,cA=eA,dA=tA,uA="pako inflate (from Nodeca project)",fa={inflateReset:nA,inflateReset2:rA,inflateResetKeep:sA,inflateInit:aA,inflateInit2:iA,inflate:oA,inflateEnd:lA,inflateGetHeader:cA,inflateSetDictionary:dA,inflateInfo:uA};function hA(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var fA=hA;const sx=Object.prototype.toString,{Z_NO_FLUSH:pA,Z_FINISH:mA,Z_OK:ud,Z_STREAM_END:Ep,Z_NEED_DICT:Dp,Z_STREAM_ERROR:gA,Z_DATA_ERROR:E2,Z_MEM_ERROR:vA}=W5;function _d(t){this.options=H5.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new L6,this.strm.avail_out=0;let n=fa.inflateInit2(this.strm,e.windowBits);if(n!==ud)throw new Error(lg[n]);if(this.header=new fA,fa.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=cg.string2buf(e.dictionary):sx.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=fa.inflateSetDictionary(this.strm,e.dictionary),n!==ud)))throw new Error(lg[n])}_d.prototype.push=function(t,e){const n=this.strm,r=this.options.chunkSize,s=this.options.dictionary;let i,o,l;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?mA:pA,sx.call(t)==="[object ArrayBuffer]"?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),i=fa.inflate(n,o),i===Dp&&s&&(i=fa.inflateSetDictionary(n,s),i===ud?i=fa.inflate(n,o):i===E2&&(i=Dp));n.avail_in>0&&i===Ep&&n.state.wrap>0&&t[n.next_in]!==0;)fa.inflateReset(n),i=fa.inflate(n,o);switch(i){case gA:case E2:case Dp:case vA:return this.onEnd(i),this.ended=!0,!1}if(l=n.avail_out,n.next_out&&(n.avail_out===0||i===Ep))if(this.options.to==="string"){let c=cg.utf8border(n.output,n.next_out),d=n.next_out-c,u=cg.buf2string(n.output,c);n.next_out=d,n.avail_out=r-d,d&&n.output.set(n.output.subarray(c,c+d),0),this.onData(u)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(i===ud&&l===0)){if(i===Ep)return i=fa.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};_d.prototype.onData=function(t){this.chunks.push(t)};_d.prototype.onEnd=function(t){t===ud&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=H5.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function yA(t,e){const n=new _d(e);if(n.push(t),n.err)throw n.msg||lg[n.err];return n.result}var bA=_d,_A=yA,xA={Inflate:bA,inflate:_A};const{Inflate:wA,inflate:jA}=xA;var D2=wA,SA=jA;const ax=[];for(let t=0;t<256;t++){let e=t;for(let n=0;n<8;n++)e&1?e=3988292384^e>>>1:e=e>>>1;ax[t]=e}const P2=4294967295;function kA(t,e,n){let r=t;for(let s=0;s<n;s++)r=ax[(r^e[s])&255]^r>>>8;return r}function NA(t,e){return(kA(P2,t,e)^P2)>>>0}function L2(t,e,n){const r=t.readUint32(),s=NA(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(s!==r)throw new Error(`CRC mismatch for chunk ${n}. Expected ${r}, found ${s}`)}function ix(t,e,n){for(let r=0;r<n;r++)e[r]=t[r]}function ox(t,e,n,r){let s=0;for(;s<r;s++)e[s]=t[s];for(;s<n;s++)e[s]=t[s]+e[s-r]&255}function lx(t,e,n,r){let s=0;if(n.length===0)for(;s<r;s++)e[s]=t[s];else for(;s<r;s++)e[s]=t[s]+n[s]&255}function cx(t,e,n,r,s){let i=0;if(n.length===0){for(;i<s;i++)e[i]=t[i];for(;i<r;i++)e[i]=t[i]+(e[i-s]>>1)&255}else{for(;i<s;i++)e[i]=t[i]+(n[i]>>1)&255;for(;i<r;i++)e[i]=t[i]+(e[i-s]+n[i]>>1)&255}}function dx(t,e,n,r,s){let i=0;if(n.length===0){for(;i<s;i++)e[i]=t[i];for(;i<r;i++)e[i]=t[i]+e[i-s]&255}else{for(;i<s;i++)e[i]=t[i]+n[i]&255;for(;i<r;i++)e[i]=t[i]+CA(e[i-s],n[i],n[i-s])&255}}function CA(t,e,n){const r=t+e-n,s=Math.abs(r-t),i=Math.abs(r-e),o=Math.abs(r-n);return s<=i&&s<=o?t:i<=o?e:n}function AA(t,e,n,r,s,i){switch(t){case 0:ix(e,n,s);break;case 1:ox(e,n,s,i);break;case 2:lx(e,n,r,s);break;case 3:cx(e,n,r,s,i);break;case 4:dx(e,n,r,s,i);break;default:throw new Error(`Unsupported filter: ${t}`)}}const EA=new Uint16Array([255]),DA=new Uint8Array(EA.buffer),PA=DA[0]===255;function LA(t){const{data:e,width:n,height:r,channels:s,depth:i}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(i/8)*s,c=new Uint8Array(r*n*l);let d=0;for(let u=0;u<7;u++){const p=o[u],g=Math.ceil((n-p.x)/p.xStep),m=Math.ceil((r-p.y)/p.yStep);if(g<=0||m<=0)continue;const j=g*l,k=new Uint8Array(j);for(let w=0;w<m;w++){const y=e[d++],_=e.subarray(d,d+j);d+=j;const S=new Uint8Array(j);AA(y,_,S,k,j,l),k.set(S);for(let N=0;N<g;N++){const T=p.x+N*p.xStep,U=p.y+w*p.yStep;if(!(T>=n||U>=r))for(let P=0;P<l;P++)c[(U*n+T)*l+P]=S[N*l+P]}}}if(i===16){const u=new Uint16Array(c.buffer);if(PA)for(let p=0;p<u.length;p++)u[p]=TA(u[p]);return u}else return c}function TA(t){return(t&255)<<8|t>>8&255}const IA=new Uint16Array([255]),RA=new Uint8Array(IA.buffer),qA=RA[0]===255,OA=new Uint8Array(0);function T2(t){const{data:e,width:n,height:r,channels:s,depth:i}=t,o=Math.ceil(i/8)*s,l=Math.ceil(i/8*s*n),c=new Uint8Array(r*l);let d=OA,u=0,p,g;for(let m=0;m<r;m++){switch(p=e.subarray(u+1,u+1+l),g=c.subarray(m*l,(m+1)*l),e[u]){case 0:ix(p,g,l);break;case 1:ox(p,g,l,o);break;case 2:lx(p,g,d,l);break;case 3:cx(p,g,d,l,o);break;case 4:dx(p,g,d,l,o);break;default:throw new Error(`Unsupported filter: ${e[u]}`)}d=g,u+=l+1}if(i===16){const m=new Uint16Array(c.buffer);if(qA)for(let j=0;j<m.length;j++)m[j]=FA(m[j]);return m}else return c}function FA(t){return(t&255)<<8|t>>8&255}const zu=Uint8Array.of(137,80,78,71,13,10,26,10);function I2(t){if(!MA(t.readBytes(zu.length)))throw new Error("wrong PNG signature")}function MA(t){if(t.length<zu.length)return!1;for(let e=0;e<zu.length;e++)if(t[e]!==zu[e])return!1;return!0}const BA="tEXt",UA=0,ux=new TextDecoder("latin1");function $A(t){if(WA(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const zA=/^[\u0000-\u00FF]*$/;function WA(t){if(!zA.test(t))throw new Error("invalid latin1 text")}function HA(t,e,n){const r=hx(e);t[r]=VA(e,n-r.length-1)}function hx(t){for(t.mark();t.readByte()!==UA;);const e=t.offset;t.reset();const n=ux.decode(t.readBytes(e-t.offset-1));return t.skip(1),$A(n),n}function VA(t,e){return ux.decode(t.readBytes(e))}const qr={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Pp={UNKNOWN:-1,DEFLATE:0},R2={UNKNOWN:-1,ADAPTIVE:0},Lp={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Nu={NONE:0,BACKGROUND:1,PREVIOUS:2},Tp={SOURCE:0,OVER:1};class GA extends C0{constructor(n,r={}){super(n);At(this,"_checkCrc");At(this,"_inflator");At(this,"_png");At(this,"_apng");At(this,"_end");At(this,"_hasPalette");At(this,"_palette");At(this,"_hasTransparency");At(this,"_transparency");At(this,"_compressionMethod");At(this,"_filterMethod");At(this,"_interlaceMethod");At(this,"_colorType");At(this,"_isAnimated");At(this,"_numberOfFrames");At(this,"_numberOfPlays");At(this,"_frames");At(this,"_writingDataChunks");const{checkCrc:s=!1}=r;this._checkCrc=s,this._inflator=new D2,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Pp.UNKNOWN,this._filterMethod=R2.UNKNOWN,this._interlaceMethod=Lp.UNKNOWN,this._colorType=qr.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(I2(this);!this._end;){const n=this.readUint32(),r=this.readChars(4);this.decodeChunk(n,r)}return this.decodeImage(),this._png}decodeApng(){for(I2(this);!this._end;){const n=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(n,r)}return this.decodeApngImage(),this._apng}decodeChunk(n,r){const s=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(n);break;case"IDAT":this.decodeIDAT(n);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(n);break;case"iCCP":this.decodeiCCP(n);break;case BA:HA(this._png.text,this,n);break;case"pHYs":this.decodepHYs();break;default:this.skip(n);break}if(this.offset-s!==n)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?L2(this,n+4,r):this.skip(4)}decodeApngChunk(n,r){const s=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(n);break;default:this.decodeChunk(n,r),this.offset=s+n;break}if(this.offset-s!==n)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?L2(this,n+4,r):this.skip(4)}decodeIHDR(){const n=this._png;n.width=this.readUint32(),n.height=this.readUint32(),n.depth=KA(this.readUint8());const r=this.readUint8();this._colorType=r;let s;switch(r){case qr.GREYSCALE:s=1;break;case qr.TRUECOLOUR:s=3;break;case qr.INDEXED_COLOUR:s=1;break;case qr.GREYSCALE_ALPHA:s=2;break;case qr.TRUECOLOUR_ALPHA:s=4;break;case qr.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==Pp.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const n={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(n)}decodePLTE(n){if(n%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${n}`);const r=n/3;this._hasPalette=!0;const s=[];this._palette=s;for(let i=0;i<r;i++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(n){this._writingDataChunks=!0;const r=n,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodeFDAT(n){this._writingDataChunks=!0;let r=n,s=this.offset+this.byteOffset;if(s+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,s,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodetRNS(n){switch(this._colorType){case qr.GREYSCALE:case qr.TRUECOLOUR:{if(n%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${n}`);if(n/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${n/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(n/2);for(let r=0;r<n/2;r++)this._transparency[r]=this.readUint16();break}case qr.INDEXED_COLOUR:{if(n>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${n} vs ${this._palette.length})`);let r=0;for(;r<n;r++){const s=this.readByte();this._palette[r].push(s)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case qr.UNKNOWN:case qr.GREYSCALE_ALPHA:case qr.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(n){const r=hx(this),s=this.readUint8();if(s!==Pp.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const i=this.readBytes(n-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:SA(i)}}decodepHYs(){const n=this.readUint32(),r=this.readUint32(),s=this.readByte();this._png.resolution={x:n,y:r,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let n=0;n<this._numberOfFrames;n++){const r={sequenceNumber:this._frames[n].sequenceNumber,delayNumber:this._frames[n].delayNumber,delayDenominator:this._frames[n].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(n);if(s){if(s.data=T2({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),n===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)r.data=s.data;else{const i=this._apng.frames.at(n-1);this.disposeFrame(s,i,r),this.addFrameDataToCanvas(r,s)}this._apng.frames.push(r)}}return this._apng}disposeFrame(n,r,s){switch(n.disposeOp){case Nu.NONE:break;case Nu.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let o=0;o<this._png.width;o++){const l=(i*n.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)s.data[l+c]=0}break;case Nu.PREVIOUS:s.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(n,r){const s=1<<this._png.depth,i=(o,l)=>{const c=((o+r.yOffset)*this._png.width+r.xOffset+l)*this._png.channels,d=(o*r.width+l)*this._png.channels;return{index:c,frameIndex:d}};switch(r.blendOp){case Tp.SOURCE:for(let o=0;o<r.height;o++)for(let l=0;l<r.width;l++){const{index:c,frameIndex:d}=i(o,l);for(let u=0;u<this._png.channels;u++)n.data[c+u]=r.data[d+u]}break;case Tp.OVER:for(let o=0;o<r.height;o++)for(let l=0;l<r.width;l++){const{index:c,frameIndex:d}=i(o,l);for(let u=0;u<this._png.channels;u++){const p=r.data[d+this._png.channels-1]/s,g=u%(this._png.channels-1)===0?1:r.data[d+u],m=Math.floor(p*g+(1-p)*n.data[c+u]);n.data[c+u]+=m}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var r;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const n=this._isAnimated?((r=this._frames)==null?void 0:r.at(0)).data:this._inflator.result;if(this._filterMethod!==R2.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Lp.NO_INTERLACE)this._png.data=T2({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Lp.ADAM7)this._png.data=LA({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const n=this._inflator.result,r=this._frames.at(-1);r?r.data=n:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Nu.NONE,blendOp:Tp.SOURCE,data:n}),this._inflator=new D2,this._writingDataChunks=!1}}function KA(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var q2;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(q2||(q2={}));function ZA(t,e){return new GA(t,e).decode()}var tt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Ip(){tt.console&&typeof tt.console.log=="function"&&tt.console.log.apply(tt.console,arguments)}var Ft={log:Ip,warn:function(t){tt.console&&(typeof tt.console.warn=="function"?tt.console.warn.apply(tt.console,arguments):Ip.call(null,arguments))},error:function(t){tt.console&&(typeof tt.console.error=="function"?tt.console.error.apply(tt.console,arguments):Ip(t))}};function Rp(t,e,n){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){Yi(r.response,e,n)},r.onerror=function(){Ft.error("could not download file")},r.send()}function O2(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Cu(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var Yi=tt.saveAs||((typeof window>"u"?"undefined":Lt(window))!=="object"||window!==tt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,n){var r=tt.URL||tt.webkitURL,s=document.createElement("a");e=e||t.name||"download",s.download=e,s.rel="noopener",typeof t=="string"?(s.href=t,s.origin!==location.origin?O2(s.href)?Rp(t,e,n):Cu(s,s.target="_blank"):Cu(s)):(s.href=r.createObjectURL(t),setTimeout(function(){r.revokeObjectURL(s.href)},4e4),setTimeout(function(){Cu(s)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,n){if(e=e||t.name||"download",typeof t=="string")if(O2(t))Rp(t,e,n);else{var r=document.createElement("a");r.href=t,r.target="_blank",setTimeout(function(){Cu(r)})}else navigator.msSaveOrOpenBlob(function(s,i){return i===void 0?i={autoBom:!1}:Lt(i)!=="object"&&(Ft.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}(t,n),e)}:function(t,e,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof t=="string")return Rp(t,e,n);var s=t.type==="application/octet-stream",i=/constructor/i.test(tt.HTMLElement)||tt.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||s&&i)&&(typeof FileReader>"u"?"undefined":Lt(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var u=l.result;u=o?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=u:location=u,r=null},l.readAsDataURL(t)}else{var c=tt.URL||tt.webkitURL,d=c.createObjectURL(t);r?r.location=d:location.href=d,r=null,setTimeout(function(){c.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function fx(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],r=0;r<n.length;r++){var s=n[r].re,i=n[r].process,o=s.exec(t);o&&(e=i(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),d=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),"#"+l+c+d}}var Wu=tt.atob.bind(tt),F2=tt.btoa.bind(tt);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function qp(t,e){var n=t[0],r=t[1],s=t[2],i=t[3];n=rr(n,r,s,i,e[0],7,-680876936),i=rr(i,n,r,s,e[1],12,-389564586),s=rr(s,i,n,r,e[2],17,606105819),r=rr(r,s,i,n,e[3],22,-1044525330),n=rr(n,r,s,i,e[4],7,-176418897),i=rr(i,n,r,s,e[5],12,1200080426),s=rr(s,i,n,r,e[6],17,-1473231341),r=rr(r,s,i,n,e[7],22,-45705983),n=rr(n,r,s,i,e[8],7,1770035416),i=rr(i,n,r,s,e[9],12,-1958414417),s=rr(s,i,n,r,e[10],17,-42063),r=rr(r,s,i,n,e[11],22,-1990404162),n=rr(n,r,s,i,e[12],7,1804603682),i=rr(i,n,r,s,e[13],12,-40341101),s=rr(s,i,n,r,e[14],17,-1502002290),n=sr(n,r=rr(r,s,i,n,e[15],22,1236535329),s,i,e[1],5,-165796510),i=sr(i,n,r,s,e[6],9,-1069501632),s=sr(s,i,n,r,e[11],14,643717713),r=sr(r,s,i,n,e[0],20,-373897302),n=sr(n,r,s,i,e[5],5,-701558691),i=sr(i,n,r,s,e[10],9,38016083),s=sr(s,i,n,r,e[15],14,-660478335),r=sr(r,s,i,n,e[4],20,-405537848),n=sr(n,r,s,i,e[9],5,568446438),i=sr(i,n,r,s,e[14],9,-1019803690),s=sr(s,i,n,r,e[3],14,-187363961),r=sr(r,s,i,n,e[8],20,1163531501),n=sr(n,r,s,i,e[13],5,-1444681467),i=sr(i,n,r,s,e[2],9,-51403784),s=sr(s,i,n,r,e[7],14,1735328473),n=ar(n,r=sr(r,s,i,n,e[12],20,-1926607734),s,i,e[5],4,-378558),i=ar(i,n,r,s,e[8],11,-2022574463),s=ar(s,i,n,r,e[11],16,1839030562),r=ar(r,s,i,n,e[14],23,-35309556),n=ar(n,r,s,i,e[1],4,-1530992060),i=ar(i,n,r,s,e[4],11,1272893353),s=ar(s,i,n,r,e[7],16,-155497632),r=ar(r,s,i,n,e[10],23,-1094730640),n=ar(n,r,s,i,e[13],4,681279174),i=ar(i,n,r,s,e[0],11,-358537222),s=ar(s,i,n,r,e[3],16,-722521979),r=ar(r,s,i,n,e[6],23,76029189),n=ar(n,r,s,i,e[9],4,-640364487),i=ar(i,n,r,s,e[12],11,-421815835),s=ar(s,i,n,r,e[15],16,530742520),n=ir(n,r=ar(r,s,i,n,e[2],23,-995338651),s,i,e[0],6,-198630844),i=ir(i,n,r,s,e[7],10,1126891415),s=ir(s,i,n,r,e[14],15,-1416354905),r=ir(r,s,i,n,e[5],21,-57434055),n=ir(n,r,s,i,e[12],6,1700485571),i=ir(i,n,r,s,e[3],10,-1894986606),s=ir(s,i,n,r,e[10],15,-1051523),r=ir(r,s,i,n,e[1],21,-2054922799),n=ir(n,r,s,i,e[8],6,1873313359),i=ir(i,n,r,s,e[15],10,-30611744),s=ir(s,i,n,r,e[6],15,-1560198380),r=ir(r,s,i,n,e[13],21,1309151649),n=ir(n,r,s,i,e[4],6,-145523070),i=ir(i,n,r,s,e[11],10,-1120210379),s=ir(s,i,n,r,e[2],15,718787259),r=ir(r,s,i,n,e[9],21,-343485551),t[0]=ti(n,t[0]),t[1]=ti(r,t[1]),t[2]=ti(s,t[2]),t[3]=ti(i,t[3])}function sf(t,e,n,r,s,i){return e=ti(ti(e,t),ti(r,i)),ti(e<<s|e>>>32-s,n)}function rr(t,e,n,r,s,i,o){return sf(e&n|~e&r,t,e,s,i,o)}function sr(t,e,n,r,s,i,o){return sf(e&r|n&~r,t,e,s,i,o)}function ar(t,e,n,r,s,i,o){return sf(e^n^r,t,e,s,i,o)}function ir(t,e,n,r,s,i,o){return sf(n^(e|~r),t,e,s,i,o)}function px(t){var e,n=t.length,r=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)qp(r,YA(t.substring(e-64,e)));t=t.substring(e-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)s[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(qp(r,s),e=0;e<16;e++)s[e]=0;return s[14]=8*n,qp(r,s),r}function YA(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}var M2="0123456789abcdef".split("");function JA(t){for(var e="",n=0;n<4;n++)e+=M2[t>>8*n+4&15]+M2[t>>8*n&15];return e}function XA(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function dg(t){return px(t).map(XA).join("")}var QA=function(t){for(var e=0;e<t.length;e++)t[e]=JA(t[e]);return t.join("")}(px("hello"))!="5d41402abc4b2a76b9719d911017c592";function ti(t,e){if(QA){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function ug(t,e){var n,r,s,i;if(t!==n){for(var o=(s=t,i=1+(256/t.length|0),new Array(i+1).join(s)),l=[],c=0;c<256;c++)l[c]=c;var d=0;for(c=0;c<256;c++){var u=l[c];d=(d+u+o.charCodeAt(c))%256,l[c]=l[d],l[d]=u}n=t,r=l}else l=r;var p=e.length,g=0,m=0,j="";for(c=0;c<p;c++)m=(m+(u=l[g=(g+1)%256]))%256,l[g]=l[m],l[m]=u,o=l[(l[g]+l[m])%256],j+=String.fromCharCode(e.charCodeAt(c)^o);return j}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var B2={print:4,modify:8,copy:16,"annot-forms":32};function zo(t,e,n,r){this.v=1,this.r=2;var s=192;t.forEach(function(l){if(B2.perm!==void 0)throw new Error("Invalid permission: "+l);s+=B2[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(e+this.padding).substr(0,32),o=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,o),this.P=-(1+(255^s)),this.encryptionKey=dg(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=ug(this.encryptionKey,this.padding)}function Wo(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",n=t.length,r=0;r<n;r++){var s=t.charCodeAt(r);e+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):t[r]}return e}function U2(t){if(Lt(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(n,r,s){if(s=s||!1,typeof n!="string"||typeof r!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(n)||(e[n]={});var i=Math.random().toString(35);return e[n][i]=[r,!!s],i},this.unsubscribe=function(n){for(var r in e)if(e[r][n])return delete e[r][n],Object.keys(e[r]).length===0&&delete e[r],!0;return!1},this.publish=function(n){if(e.hasOwnProperty(n)){var r=Array.prototype.slice.call(arguments,1),s=[];for(var i in e[n]){var o=e[n][i];try{o[0].apply(t,r)}catch(l){tt.console&&Ft.error("jsPDF PubSub Error",l.message,l)}o[1]&&s.push(i)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function kh(t){if(!(this instanceof kh))return new kh(t);var e="opacity,stroke-opacity".split(",");for(var n in t)t.hasOwnProperty(n)&&e.indexOf(n)>=0&&(this[n]=t[n]);this.id="",this.objectNumber=-1}function mx(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Xi(t,e,n,r,s){if(!(this instanceof Xi))return new Xi(t,e,n,r,s);this.type=t==="axial"?2:3,this.coords=e,this.colors=n,mx.call(this,r,s)}function sl(t,e,n,r,s){if(!(this instanceof sl))return new sl(t,e,n,r,s);this.boundingBox=t,this.xStep=e,this.yStep=n,this.stream="",this.cloneIndex=0,mx.call(this,r,s)}function He(t){var e,n=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],s=arguments[2],i=arguments[3],o=[],l=1,c=16,d="S",u=null;Lt(t=t||{})==="object"&&(n=t.orientation,r=t.unit||r,s=t.format||s,i=t.compress||t.compressPdf||i,(u=t.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),d=t.defaultPathOperation||"S"),o=t.filters||(i===!0?["FlateEncode"]:o),r=r||"mm",n=(""+(n||"P")).toLowerCase();var p=t.putOnlyUsedFonts||!1,g={},m={internal:{},__private__:{}};m.__private__.PubSub=U2;var j="1.3",k=m.__private__.getPdfVersion=function(){return j};m.__private__.setPdfVersion=function(v){j=v};var w={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return w};var y=m.__private__.getPageFormat=function(v){return w[v]};s=s||"a4";var _="compat",S="advanced",N=_;function T(){this.saveGraphicsState(),Q(new Ze(et,0,0,-et,0,Li()*et).toString()+" cm"),this.setFontSize(this.getFontSize()/et),d="n",N=S}function U(){this.restoreGraphicsState(),d="S",N=_}var P=m.__private__.combineFontStyleAndFontWeight=function(v,R){if(v=="bold"&&R=="normal"||v=="bold"&&R==400||v=="normal"&&R=="italic"||v=="bold"&&R=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return R&&(v=R==400||R==="normal"?v==="italic"?"italic":"normal":R!=700&&R!=="bold"||v!=="normal"?(R==700?"bold":R)+""+v:"bold"),v};m.advancedAPI=function(v){var R=N===_;return R&&T.call(this),typeof v!="function"||(v(this),R&&U.call(this)),this},m.compatAPI=function(v){var R=N===S;return R&&U.call(this),typeof v!="function"||(v(this),R&&T.call(this)),this},m.isAdvancedAPI=function(){return N===S};var b,A=function(v){if(N!==S)throw new Error(v+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},$=m.roundToPrecision=m.__private__.roundToPrecision=function(v,R){var Y=e||R;if(isNaN(v)||isNaN(Y))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return v.toFixed(Y).replace(/0+$/,"")};b=m.hpf=m.__private__.hpf=typeof c=="number"?function(v){if(isNaN(v))throw new Error("Invalid argument passed to jsPDF.hpf");return $(v,c)}:c==="smart"?function(v){if(isNaN(v))throw new Error("Invalid argument passed to jsPDF.hpf");return $(v,v>-1&&v<1?16:5)}:function(v){if(isNaN(v))throw new Error("Invalid argument passed to jsPDF.hpf");return $(v,16)};var D=m.f2=m.__private__.f2=function(v){if(isNaN(v))throw new Error("Invalid argument passed to jsPDF.f2");return $(v,2)},F=m.__private__.f3=function(v){if(isNaN(v))throw new Error("Invalid argument passed to jsPDF.f3");return $(v,3)},L=m.scale=m.__private__.scale=function(v){if(isNaN(v))throw new Error("Invalid argument passed to jsPDF.scale");return N===_?v*et:N===S?v:void 0},I=function(v){return L(function(R){return N===_?Li()-R:N===S?R:void 0}(v))};m.__private__.setPrecision=m.setPrecision=function(v){typeof parseInt(v,10)=="number"&&(e=parseInt(v,10))};var X,te="00000000000000000000000000000000",oe=m.__private__.getFileId=function(){return te},Z=m.__private__.setFileId=function(v){return te=v!==void 0&&/^[a-fA-F0-9]{32}$/.test(v)?v.toUpperCase():te.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(un=new zo(u.userPermissions,u.userPassword,u.ownerPassword,te)),te};m.setFileId=function(v){return Z(v),this},m.getFileId=function(){return oe()};var ae=m.__private__.convertDateToPDFDate=function(v){var R=v.getTimezoneOffset(),Y=R<0?"+":"-",se=Math.floor(Math.abs(R/60)),he=Math.abs(R%60),je=[Y,J(se),"'",J(he),"'"].join("");return["D:",v.getFullYear(),J(v.getMonth()+1),J(v.getDate()),J(v.getHours()),J(v.getMinutes()),J(v.getSeconds()),je].join("")},ee=m.__private__.convertPDFDateToDate=function(v){var R=parseInt(v.substr(2,4),10),Y=parseInt(v.substr(6,2),10)-1,se=parseInt(v.substr(8,2),10),he=parseInt(v.substr(10,2),10),je=parseInt(v.substr(12,2),10),Ce=parseInt(v.substr(14,2),10);return new Date(R,Y,se,he,je,Ce,0)},de=m.__private__.setCreationDate=function(v){var R;if(v===void 0&&(v=new Date),v instanceof Date)R=ae(v);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(v))throw new Error("Invalid argument passed to jsPDF.setCreationDate");R=v}return X=R},E=m.__private__.getCreationDate=function(v){var R=X;return v==="jsDate"&&(R=ee(X)),R};m.setCreationDate=function(v){return de(v),this},m.getCreationDate=function(v){return E(v)};var H,J=m.__private__.padd2=function(v){return("0"+parseInt(v)).slice(-2)},V=m.__private__.padd2Hex=function(v){return("00"+(v=v.toString())).substr(v.length)},ne=0,le=[],me=[],re=0,fe=[],_e=[],ke=!1,Ae=me;m.__private__.setCustomOutputDestination=function(v){ke=!0,Ae=v};var ye=function(v){ke||(Ae=v)};m.__private__.resetCustomOutputDestination=function(){ke=!1,Ae=me};var Q=m.__private__.out=function(v){return v=v.toString(),re+=v.length+1,Ae.push(v),Ae},st=m.__private__.write=function(v){return Q(arguments.length===1?v.toString():Array.prototype.join.call(arguments," "))},nt=m.__private__.getArrayBuffer=function(v){for(var R=v.length,Y=new ArrayBuffer(R),se=new Uint8Array(Y);R--;)se[R]=v.charCodeAt(R);return Y},Ve=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return Ve};var ue=t.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(v){return ue=N===S?v/et:v,this};var Te,Pe=m.__private__.getFontSize=m.getFontSize=function(){return N===_?ue:ue*et},Xe=t.R2L||!1;m.__private__.setR2L=m.setR2L=function(v){return Xe=v,this},m.__private__.getR2L=m.getR2L=function(){return Xe};var Fe,Ye=m.__private__.setZoomMode=function(v){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(v))Te=v;else if(isNaN(v)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(v)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+v+'" is not recognized.');Te=v}else Te=parseInt(v,10)};m.__private__.getZoomMode=function(){return Te};var Qe,Je=m.__private__.setPageMode=function(v){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(v)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+v+'" is not recognized.');Fe=v};m.__private__.getPageMode=function(){return Fe};var Et=m.__private__.setLayoutMode=function(v){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(v)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+v+'" is not recognized.');Qe=v};m.__private__.getLayoutMode=function(){return Qe},m.__private__.setDisplayMode=m.setDisplayMode=function(v,R,Y){return Ye(v),Et(R),Je(Y),this};var ot={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(v){if(Object.keys(ot).indexOf(v)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ot[v]},m.__private__.getDocumentProperties=function(){return ot},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(v){for(var R in ot)ot.hasOwnProperty(R)&&v[R]&&(ot[R]=v[R]);return this},m.__private__.setDocumentProperty=function(v,R){if(Object.keys(ot).indexOf(v)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ot[v]=R};var Ue,et,Ge,Mt,St,ze={},dt={},It=[],Ke={},bt={},ut={},dn={},Cn=null,Rt=0,at=[],Nt=new U2(m),_i=t.hotfixes||[],Xn={},Gs={},As=[],Ze=function v(R,Y,se,he,je,Ce){if(!(this instanceof v))return new v(R,Y,se,he,je,Ce);isNaN(R)&&(R=1),isNaN(Y)&&(Y=0),isNaN(se)&&(se=0),isNaN(he)&&(he=1),isNaN(je)&&(je=0),isNaN(Ce)&&(Ce=0),this._matrix=[R,Y,se,he,je,Ce]};Object.defineProperty(Ze.prototype,"sx",{get:function(){return this._matrix[0]},set:function(v){this._matrix[0]=v}}),Object.defineProperty(Ze.prototype,"shy",{get:function(){return this._matrix[1]},set:function(v){this._matrix[1]=v}}),Object.defineProperty(Ze.prototype,"shx",{get:function(){return this._matrix[2]},set:function(v){this._matrix[2]=v}}),Object.defineProperty(Ze.prototype,"sy",{get:function(){return this._matrix[3]},set:function(v){this._matrix[3]=v}}),Object.defineProperty(Ze.prototype,"tx",{get:function(){return this._matrix[4]},set:function(v){this._matrix[4]=v}}),Object.defineProperty(Ze.prototype,"ty",{get:function(){return this._matrix[5]},set:function(v){this._matrix[5]=v}}),Object.defineProperty(Ze.prototype,"a",{get:function(){return this._matrix[0]},set:function(v){this._matrix[0]=v}}),Object.defineProperty(Ze.prototype,"b",{get:function(){return this._matrix[1]},set:function(v){this._matrix[1]=v}}),Object.defineProperty(Ze.prototype,"c",{get:function(){return this._matrix[2]},set:function(v){this._matrix[2]=v}}),Object.defineProperty(Ze.prototype,"d",{get:function(){return this._matrix[3]},set:function(v){this._matrix[3]=v}}),Object.defineProperty(Ze.prototype,"e",{get:function(){return this._matrix[4]},set:function(v){this._matrix[4]=v}}),Object.defineProperty(Ze.prototype,"f",{get:function(){return this._matrix[5]},set:function(v){this._matrix[5]=v}}),Object.defineProperty(Ze.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Ze.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Ze.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Ze.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Ze.prototype.join=function(v){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(b).join(v)},Ze.prototype.multiply=function(v){var R=v.sx*this.sx+v.shy*this.shx,Y=v.sx*this.shy+v.shy*this.sy,se=v.shx*this.sx+v.sy*this.shx,he=v.shx*this.shy+v.sy*this.sy,je=v.tx*this.sx+v.ty*this.shx+this.tx,Ce=v.tx*this.shy+v.ty*this.sy+this.ty;return new Ze(R,Y,se,he,je,Ce)},Ze.prototype.decompose=function(){var v=this.sx,R=this.shy,Y=this.shx,se=this.sy,he=this.tx,je=this.ty,Ce=Math.sqrt(v*v+R*R),Oe=(v/=Ce)*Y+(R/=Ce)*se;Y-=v*Oe,se-=R*Oe;var $e=Math.sqrt(Y*Y+se*se);return Oe/=$e,v*(se/=$e)<R*(Y/=$e)&&(v=-v,R=-R,Oe=-Oe,Ce=-Ce),{scale:new Ze(Ce,0,0,$e,0,0),translate:new Ze(1,0,0,1,he,je),rotate:new Ze(v,R,-R,v,0,0),skew:new Ze(1,0,Oe,1,0,0)}},Ze.prototype.toString=function(v){return this.join(" ")},Ze.prototype.inversed=function(){var v=this.sx,R=this.shy,Y=this.shx,se=this.sy,he=this.tx,je=this.ty,Ce=1/(v*se-R*Y),Oe=se*Ce,$e=-R*Ce,rt=-Y*Ce,lt=v*Ce;return new Ze(Oe,$e,rt,lt,-Oe*he-rt*je,-$e*he-lt*je)},Ze.prototype.applyToPoint=function(v){var R=v.x*this.sx+v.y*this.shx+this.tx,Y=v.x*this.shy+v.y*this.sy+this.ty;return new Di(R,Y)},Ze.prototype.applyToRectangle=function(v){var R=this.applyToPoint(v),Y=this.applyToPoint(new Di(v.x+v.w,v.y+v.h));return new Hl(R.x,R.y,Y.x-R.x,Y.y-R.y)},Ze.prototype.clone=function(){var v=this.sx,R=this.shy,Y=this.shx,se=this.sy,he=this.tx,je=this.ty;return new Ze(v,R,Y,se,he,je)},m.Matrix=Ze;var Ks=m.matrixMult=function(v,R){return R.multiply(v)},Zs=new Ze(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=Zs;var Wr=function(v,R){if(!bt[v]){var Y=(R instanceof Xi?"Sh":"P")+(Object.keys(Ke).length+1).toString(10);R.id=Y,bt[v]=Y,Ke[Y]=R,Nt.publish("addPattern",R)}};m.ShadingPattern=Xi,m.TilingPattern=sl,m.addShadingPattern=function(v,R){return A("addShadingPattern()"),Wr(v,R),this},m.beginTilingPattern=function(v){A("beginTilingPattern()"),Vl(v.boundingBox[0],v.boundingBox[1],v.boundingBox[2]-v.boundingBox[0],v.boundingBox[3]-v.boundingBox[1],v.matrix)},m.endTilingPattern=function(v,R){A("endTilingPattern()"),R.stream=_e[H].join(`
`),Wr(v,R),Nt.publish("endTilingPattern",R),As.pop().restore()};var Hr,nn=m.__private__.newObject=function(){var v=qn();return Bn(v,!0),v},qn=m.__private__.newObjectDeferred=function(){return ne++,le[ne]=function(){return re},ne},Bn=function(v,R){return R=typeof R=="boolean"&&R,le[v]=re,R&&Q(v+" 0 obj"),v},xi=m.__private__.newAdditionalObject=function(){var v={objId:qn(),content:""};return fe.push(v),v},ka=qn(),cs=qn(),Es=m.__private__.decodeColorString=function(v){var R=v.split(" ");if(R.length!==2||R[1]!=="g"&&R[1]!=="G")R.length!==5||R[4]!=="k"&&R[4]!=="K"||(R=[(1-R[0])*(1-R[3]),(1-R[1])*(1-R[3]),(1-R[2])*(1-R[3]),"r"]);else{var Y=parseFloat(R[0]);R=[Y,Y,Y,"r"]}for(var se="#",he=0;he<3;he++)se+=("0"+Math.floor(255*parseFloat(R[he])).toString(16)).slice(-2);return se},ds=m.__private__.encodeColorString=function(v){var R;typeof v=="string"&&(v={ch1:v});var Y=v.ch1,se=v.ch2,he=v.ch3,je=v.ch4,Ce=v.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Y=="string"&&Y.charAt(0)!=="#"){var Oe=new fx(Y);if(Oe.ok)Y=Oe.toHex();else if(!/^\d*\.?\d*$/.test(Y))throw new Error('Invalid color "'+Y+'" passed to jsPDF.encodeColorString.')}if(typeof Y=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Y)&&(Y="#"+Y[1]+Y[1]+Y[2]+Y[2]+Y[3]+Y[3]),typeof Y=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Y)){var $e=parseInt(Y.substr(1),16);Y=$e>>16&255,se=$e>>8&255,he=255&$e}if(se===void 0||je===void 0&&Y===se&&se===he)R=typeof Y=="string"?Y+" "+Ce[0]:v.precision===2?D(Y/255)+" "+Ce[0]:F(Y/255)+" "+Ce[0];else if(je===void 0||Lt(je)==="object"){if(je&&!isNaN(je.a)&&je.a===0)return["1.","1.","1.",Ce[1]].join(" ");R=typeof Y=="string"?[Y,se,he,Ce[1]].join(" "):v.precision===2?[D(Y/255),D(se/255),D(he/255),Ce[1]].join(" "):[F(Y/255),F(se/255),F(he/255),Ce[1]].join(" ")}else R=typeof Y=="string"?[Y,se,he,je,Ce[2]].join(" "):v.precision===2?[D(Y),D(se),D(he),D(je),Ce[2]].join(" "):[F(Y),F(se),F(he),F(je),Ce[2]].join(" ");return R},us=m.__private__.getFilters=function(){return o},Vr=m.__private__.putStream=function(v){var R=(v=v||{}).data||"",Y=v.filters||us(),se=v.alreadyAppliedFilters||[],he=v.addLength1||!1,je=R.length,Ce=v.objectId,Oe=function(An){return An};if(u!==null&&Ce===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(Oe=un.encryptor(Ce,0));var $e={};Y===!0&&(Y=["FlateEncode"]);var rt=v.additionalKeyValues||[],lt=($e=He.API.processDataByFilters!==void 0?He.API.processDataByFilters(R,Y):{data:R,reverseChain:[]}).reverseChain+(Array.isArray(se)?se.join(" "):se.toString());if($e.data.length!==0&&(rt.push({key:"Length",value:$e.data.length}),he===!0&&rt.push({key:"Length1",value:je})),lt.length!=0)if(lt.split("/").length-1==1)rt.push({key:"Filter",value:lt});else{rt.push({key:"Filter",value:"["+lt+"]"});for(var kt=0;kt<rt.length;kt+=1)if(rt[kt].key==="DecodeParms"){for(var Jt=[],jn=0;jn<$e.reverseChain.split("/").length-1;jn+=1)Jt.push("null");Jt.push(rt[kt].value),rt[kt].value="["+Jt.join(" ")+"]"}}Q("<<");for(var Bt=0;Bt<rt.length;Bt++)Q("/"+rt[Bt].key+" "+rt[Bt].value);Q(">>"),$e.data.length!==0&&(Q("stream"),Q(Oe($e.data)),Q("endstream"))},wi=m.__private__.putPage=function(v){var R=v.number,Y=v.data,se=v.objId,he=v.contentsObjId;Bn(se,!0),Q("<</Type /Page"),Q("/Parent "+v.rootDictionaryObjId+" 0 R"),Q("/Resources "+v.resourceDictionaryObjId+" 0 R"),Q("/MediaBox ["+parseFloat(b(v.mediaBox.bottomLeftX))+" "+parseFloat(b(v.mediaBox.bottomLeftY))+" "+b(v.mediaBox.topRightX)+" "+b(v.mediaBox.topRightY)+"]"),v.cropBox!==null&&Q("/CropBox ["+b(v.cropBox.bottomLeftX)+" "+b(v.cropBox.bottomLeftY)+" "+b(v.cropBox.topRightX)+" "+b(v.cropBox.topRightY)+"]"),v.bleedBox!==null&&Q("/BleedBox ["+b(v.bleedBox.bottomLeftX)+" "+b(v.bleedBox.bottomLeftY)+" "+b(v.bleedBox.topRightX)+" "+b(v.bleedBox.topRightY)+"]"),v.trimBox!==null&&Q("/TrimBox ["+b(v.trimBox.bottomLeftX)+" "+b(v.trimBox.bottomLeftY)+" "+b(v.trimBox.topRightX)+" "+b(v.trimBox.topRightY)+"]"),v.artBox!==null&&Q("/ArtBox ["+b(v.artBox.bottomLeftX)+" "+b(v.artBox.bottomLeftY)+" "+b(v.artBox.topRightX)+" "+b(v.artBox.topRightY)+"]"),typeof v.userUnit=="number"&&v.userUnit!==1&&Q("/UserUnit "+v.userUnit),Nt.publish("putPage",{objId:se,pageContext:at[R],pageNumber:R,page:Y}),Q("/Contents "+he+" 0 R"),Q(">>"),Q("endobj");var je=Y.join(`
`);return N===S&&(je+=`
Q`),Bn(he,!0),Vr({data:je,filters:us(),objectId:he}),Q("endobj"),se},Ds=m.__private__.putPages=function(){var v,R,Y=[];for(v=1;v<=Rt;v++)at[v].objId=qn(),at[v].contentsObjId=qn();for(v=1;v<=Rt;v++)Y.push(wi({number:v,data:_e[v],objId:at[v].objId,contentsObjId:at[v].contentsObjId,mediaBox:at[v].mediaBox,cropBox:at[v].cropBox,bleedBox:at[v].bleedBox,trimBox:at[v].trimBox,artBox:at[v].artBox,userUnit:at[v].userUnit,rootDictionaryObjId:ka,resourceDictionaryObjId:cs}));Bn(ka,!0),Q("<</Type /Pages");var se="/Kids [";for(R=0;R<Rt;R++)se+=Y[R]+" 0 R ";Q(se+"]"),Q("/Count "+Rt),Q(">>"),Q("endobj"),Nt.publish("postPutPages")},ji=function(v){Nt.publish("putFont",{font:v,out:Q,newObject:nn,putStream:Vr}),v.isAlreadyPutted!==!0&&(v.objectNumber=nn(),Q("<<"),Q("/Type /Font"),Q("/BaseFont /"+Wo(v.postScriptName)),Q("/Subtype /Type1"),typeof v.encoding=="string"&&Q("/Encoding /"+v.encoding),Q("/FirstChar 32"),Q("/LastChar 255"),Q(">>"),Q("endobj"))},bo=function(v){v.objectNumber=nn();var R=[];R.push({key:"Type",value:"/XObject"}),R.push({key:"Subtype",value:"/Form"}),R.push({key:"BBox",value:"["+[b(v.x),b(v.y),b(v.x+v.width),b(v.y+v.height)].join(" ")+"]"}),R.push({key:"Matrix",value:"["+v.matrix.toString()+"]"});var Y=v.pages[1].join(`
`);Vr({data:Y,additionalKeyValues:R,objectId:v.objectNumber}),Q("endobj")},_o=function(v,R){R||(R=21);var Y=nn(),se=function(Ce,Oe){var $e,rt=[],lt=1/(Oe-1);for($e=0;$e<1;$e+=lt)rt.push($e);if(rt.push(1),Ce[0].offset!=0){var kt={offset:0,color:Ce[0].color};Ce.unshift(kt)}if(Ce[Ce.length-1].offset!=1){var Jt={offset:1,color:Ce[Ce.length-1].color};Ce.push(Jt)}for(var jn="",Bt=0,An=0;An<rt.length;An++){for($e=rt[An];$e>Ce[Bt+1].offset;)Bt++;var Sn=Ce[Bt].offset,Un=($e-Sn)/(Ce[Bt+1].offset-Sn),Kr=Ce[Bt].color,gr=Ce[Bt+1].color;jn+=V(Math.round((1-Un)*Kr[0]+Un*gr[0]).toString(16))+V(Math.round((1-Un)*Kr[1]+Un*gr[1]).toString(16))+V(Math.round((1-Un)*Kr[2]+Un*gr[2]).toString(16))}return jn.trim()}(v.colors,R),he=[];he.push({key:"FunctionType",value:"0"}),he.push({key:"Domain",value:"[0.0 1.0]"}),he.push({key:"Size",value:"["+R+"]"}),he.push({key:"BitsPerSample",value:"8"}),he.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),he.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Vr({data:se,additionalKeyValues:he,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Y}),Q("endobj"),v.objectNumber=nn(),Q("<< /ShadingType "+v.type),Q("/ColorSpace /DeviceRGB");var je="/Coords ["+b(parseFloat(v.coords[0]))+" "+b(parseFloat(v.coords[1]))+" ";v.type===2?je+=b(parseFloat(v.coords[2]))+" "+b(parseFloat(v.coords[3])):je+=b(parseFloat(v.coords[2]))+" "+b(parseFloat(v.coords[3]))+" "+b(parseFloat(v.coords[4]))+" "+b(parseFloat(v.coords[5])),Q(je+="]"),v.matrix&&Q("/Matrix ["+v.matrix.toString()+"]"),Q("/Function "+Y+" 0 R"),Q("/Extend [true true]"),Q(">>"),Q("endobj")},xo=function(v,R){var Y=qn(),se=nn();R.push({resourcesOid:Y,objectOid:se}),v.objectNumber=se;var he=[];he.push({key:"Type",value:"/Pattern"}),he.push({key:"PatternType",value:"1"}),he.push({key:"PaintType",value:"1"}),he.push({key:"TilingType",value:"1"}),he.push({key:"BBox",value:"["+v.boundingBox.map(b).join(" ")+"]"}),he.push({key:"XStep",value:b(v.xStep)}),he.push({key:"YStep",value:b(v.yStep)}),he.push({key:"Resources",value:Y+" 0 R"}),v.matrix&&he.push({key:"Matrix",value:"["+v.matrix.toString()+"]"}),Vr({data:v.stream,additionalKeyValues:he,objectId:v.objectNumber}),Q("endobj")},of=function(v){for(var R in v.objectNumber=nn(),Q("<<"),v)switch(R){case"opacity":Q("/ca "+D(v[R]));break;case"stroke-opacity":Q("/CA "+D(v[R]))}Q(">>"),Q("endobj")},Rl=function(v){Bn(v.resourcesOid,!0),Q("<<"),Q("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var R in Q("/Font <<"),ze)ze.hasOwnProperty(R)&&(p===!1||p===!0&&g.hasOwnProperty(R))&&Q("/"+R+" "+ze[R].objectNumber+" 0 R");Q(">>")}(),function(){if(Object.keys(Ke).length>0){for(var R in Q("/Shading <<"),Ke)Ke.hasOwnProperty(R)&&Ke[R]instanceof Xi&&Ke[R].objectNumber>=0&&Q("/"+R+" "+Ke[R].objectNumber+" 0 R");Nt.publish("putShadingPatternDict"),Q(">>")}}(),function(R){if(Object.keys(Ke).length>0){for(var Y in Q("/Pattern <<"),Ke)Ke.hasOwnProperty(Y)&&Ke[Y]instanceof m.TilingPattern&&Ke[Y].objectNumber>=0&&Ke[Y].objectNumber<R&&Q("/"+Y+" "+Ke[Y].objectNumber+" 0 R");Nt.publish("putTilingPatternDict"),Q(">>")}}(v.objectOid),function(){if(Object.keys(ut).length>0){var R;for(R in Q("/ExtGState <<"),ut)ut.hasOwnProperty(R)&&ut[R].objectNumber>=0&&Q("/"+R+" "+ut[R].objectNumber+" 0 R");Nt.publish("putGStateDict"),Q(">>")}}(),function(){for(var R in Q("/XObject <<"),Xn)Xn.hasOwnProperty(R)&&Xn[R].objectNumber>=0&&Q("/"+R+" "+Xn[R].objectNumber+" 0 R");Nt.publish("putXobjectDict"),Q(">>")}(),Q(">>"),Q("endobj")},xd=function(v){dt[v.fontName]=dt[v.fontName]||{},dt[v.fontName][v.fontStyle]=v.id},wd=function(v,R,Y,se,he){var je={id:"F"+(Object.keys(ze).length+1).toString(10),postScriptName:v,fontName:R,fontStyle:Y,encoding:se,isStandardFont:he||!1,metadata:{}};return Nt.publish("addFont",{font:je,instance:this}),ze[je.id]=je,xd(je),je.id},Gr=m.__private__.pdfEscape=m.pdfEscape=function(v,R){return function(Y,se){var he,je,Ce,Oe,$e,rt,lt,kt,Jt;if(Ce=(se=se||{}).sourceEncoding||"Unicode",$e=se.outputEncoding,(se.autoencode||$e)&&ze[Ue].metadata&&ze[Ue].metadata[Ce]&&ze[Ue].metadata[Ce].encoding&&(Oe=ze[Ue].metadata[Ce].encoding,!$e&&ze[Ue].encoding&&($e=ze[Ue].encoding),!$e&&Oe.codePages&&($e=Oe.codePages[0]),typeof $e=="string"&&($e=Oe[$e]),$e)){for(lt=!1,rt=[],he=0,je=Y.length;he<je;he++)(kt=$e[Y.charCodeAt(he)])?rt.push(String.fromCharCode(kt)):rt.push(Y[he]),rt[he].charCodeAt(0)>>8&&(lt=!0);Y=rt.join("")}for(he=Y.length;lt===void 0&&he!==0;)Y.charCodeAt(he-1)>>8&&(lt=!0),he--;if(!lt)return Y;for(rt=se.noBOM?[]:[254,255],he=0,je=Y.length;he<je;he++){if((Jt=(kt=Y.charCodeAt(he))>>8)>>8)throw new Error("Character at position "+he+" of string '"+Y+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");rt.push(Jt),rt.push(kt-(Jt<<8))}return String.fromCharCode.apply(void 0,rt)}(v,R).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ql=m.__private__.beginPage=function(v){_e[++Rt]=[],at[Rt]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(v[0]),topRightY:Number(v[1])}},Sd(Rt),ye(_e[H])},jd=function(v,R){var Y,se,he;switch(n=R||n,typeof v=="string"&&(Y=y(v.toLowerCase()),Array.isArray(Y)&&(se=Y[0],he=Y[1])),Array.isArray(v)&&(se=v[0]*et,he=v[1]*et),isNaN(se)&&(se=s[0],he=s[1]),(se>14400||he>14400)&&(Ft.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),se=Math.min(14400,se),he=Math.min(14400,he)),s=[se,he],n.substr(0,1)){case"l":he>se&&(s=[he,se]);break;case"p":se>he&&(s=[he,se])}ql(s),gf(Ul),Q(jo),zl!==0&&Q(zl+" J"),Wl!==0&&Q(Wl+" j"),Nt.publish("addPage",{pageNumber:Rt})},Ol=function(v){v>0&&v<=Rt&&(_e.splice(v,1),at.splice(v,1),Rt--,H>Rt&&(H=Rt),this.setPage(H))},Sd=function(v){v>0&&v<=Rt&&(H=v)},kd=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return _e.length-1},Nd=function(v,R,Y){var se,he=void 0;return Y=Y||{},v=v!==void 0?v:ze[Ue].fontName,R=R!==void 0?R:ze[Ue].fontStyle,se=v.toLowerCase(),dt[se]!==void 0&&dt[se][R]!==void 0?he=dt[se][R]:dt[v]!==void 0&&dt[v][R]!==void 0?he=dt[v][R]:Y.disableWarning===!1&&Ft.warn("Unable to look up font label for font '"+v+"', '"+R+"'. Refer to getFontList() for available fonts."),he||Y.noFallback||(he=dt.times[R])==null&&(he=dt.times.normal),he},wo=m.__private__.putInfo=function(){var v=nn(),R=function(se){return se};for(var Y in u!==null&&(R=un.encryptor(v,0)),Q("<<"),Q("/Producer ("+Gr(R("jsPDF "+He.version))+")"),ot)ot.hasOwnProperty(Y)&&ot[Y]&&Q("/"+Y.substr(0,1).toUpperCase()+Y.substr(1)+" ("+Gr(R(ot[Y]))+")");Q("/CreationDate ("+Gr(R(X))+")"),Q(">>"),Q("endobj")},lf=m.__private__.putCatalog=function(v){var R=(v=v||{}).rootDictionaryObjId||ka;switch(nn(),Q("<<"),Q("/Type /Catalog"),Q("/Pages "+R+" 0 R"),Te||(Te="fullwidth"),Te){case"fullwidth":Q("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Q("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Q("/OpenAction [3 0 R /Fit]");break;case"original":Q("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Y=""+Te;Y.substr(Y.length-1)==="%"&&(Te=parseInt(Te)/100),typeof Te=="number"&&Q("/OpenAction [3 0 R /XYZ null null "+D(Te)+"]")}switch(Qe||(Qe="continuous"),Qe){case"continuous":Q("/PageLayout /OneColumn");break;case"single":Q("/PageLayout /SinglePage");break;case"two":case"twoleft":Q("/PageLayout /TwoColumnLeft");break;case"tworight":Q("/PageLayout /TwoColumnRight")}Fe&&Q("/PageMode /"+Fe),Nt.publish("putCatalog"),Q(">>"),Q("endobj")},wn=m.__private__.putTrailer=function(){Q("trailer"),Q("<<"),Q("/Size "+(ne+1)),Q("/Root "+ne+" 0 R"),Q("/Info "+(ne-1)+" 0 R"),u!==null&&Q("/Encrypt "+un.oid+" 0 R"),Q("/ID [ <"+te+"> <"+te+"> ]"),Q(">>")},Cd=m.__private__.putHeader=function(){Q("%PDF-"+j),Q("%")},Ad=m.__private__.putXRef=function(){var v="0000000000";Q("xref"),Q("0 "+(ne+1)),Q("0000000000 65535 f ");for(var R=1;R<=ne;R++)typeof le[R]=="function"?Q((v+le[R]()).slice(-10)+" 00000 n "):le[R]!==void 0?Q((v+le[R]).slice(-10)+" 00000 n "):Q("0000000000 00000 n ")},Ys=m.__private__.buildDocument=function(){var v;ne=0,re=0,me=[],le=[],fe=[],ka=qn(),cs=qn(),ye(me),Nt.publish("buildDocument"),Cd(),Ds(),function(){Nt.publish("putAdditionalObjects");for(var Y=0;Y<fe.length;Y++){var se=fe[Y];Bn(se.objId,!0),Q(se.content),Q("endobj")}Nt.publish("postPutAdditionalObjects")}(),v=[],function(){for(var Y in ze)ze.hasOwnProperty(Y)&&(p===!1||p===!0&&g.hasOwnProperty(Y))&&ji(ze[Y])}(),function(){var Y;for(Y in ut)ut.hasOwnProperty(Y)&&of(ut[Y])}(),function(){for(var Y in Xn)Xn.hasOwnProperty(Y)&&bo(Xn[Y])}(),function(Y){var se;for(se in Ke)Ke.hasOwnProperty(se)&&(Ke[se]instanceof Xi?_o(Ke[se]):Ke[se]instanceof sl&&xo(Ke[se],Y))}(v),Nt.publish("putResources"),v.forEach(Rl),Rl({resourcesOid:cs,objectOid:Number.MAX_SAFE_INTEGER}),Nt.publish("postPutResources"),u!==null&&(un.oid=nn(),Q("<<"),Q("/Filter /Standard"),Q("/V "+un.v),Q("/R "+un.r),Q("/U <"+un.toHexString(un.U)+">"),Q("/O <"+un.toHexString(un.O)+">"),Q("/P "+un.P),Q(">>"),Q("endobj")),wo(),lf();var R=re;return Ad(),wn(),Q("startxref"),Q(""+R),Q("%%EOF"),ye(_e[H]),me.join(`
`)},Si=m.__private__.getBlob=function(v){return new Blob([nt(v)],{type:"application/pdf"})},hs=m.output=m.__private__.output=(Hr=function(v,R){switch(typeof(R=R||{})=="string"?R={filename:R}:R.filename=R.filename||"generated.pdf",v){case void 0:return Ys();case"save":m.save(R.filename);break;case"arraybuffer":return nt(Ys());case"blob":return Si(Ys());case"bloburi":case"bloburl":if(tt.URL!==void 0&&typeof tt.URL.createObjectURL=="function")return tt.URL&&tt.URL.createObjectURL(Si(Ys()))||void 0;Ft.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Y="",se=Ys();try{Y=F2(se)}catch{Y=F2(unescape(encodeURIComponent(se)))}return"data:application/pdf;filename="+R.filename+";base64,"+Y;case"pdfobjectnewwindow":if(Object.prototype.toString.call(tt)==="[object Window]"){var he="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",je=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';R.pdfObjectUrl&&(he=R.pdfObjectUrl,je="");var Ce='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+he+'"'+je+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(R)+");<\/script></body></html>",Oe=tt.open();return Oe!==null&&Oe.document.write(Ce),Oe}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(tt)==="[object Window]"){var $e='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(R.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+R.filename+'" width="500px" height="400px" /></body></html>',rt=tt.open();if(rt!==null){rt.document.write($e);var lt=this;rt.document.documentElement.querySelector("#pdfViewer").onload=function(){rt.document.title=R.filename,rt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(lt.output("bloburl"))}}return rt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(tt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var kt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",R)+'"></iframe></body></html>',Jt=tt.open();if(Jt!==null&&(Jt.document.write(kt),Jt.document.title=R.filename),Jt||typeof safari>"u")return Jt;break;case"datauri":case"dataurl":return tt.document.location.href=this.output("datauristring",R);default:return null}},Hr.foo=function(){try{return Hr.apply(this,arguments)}catch(Y){var v=Y.stack||"";~v.indexOf(" at ")&&(v=v.split(" at ")[1]);var R="Error in function "+v.split(`
`)[0].split("<")[0]+": "+Y.message;if(!tt.console)throw new Error(R);tt.console.error(R,Y),tt.alert&&alert(R)}},Hr.foo.bar=Hr,Hr.foo),ki=function(v){return Array.isArray(_i)===!0&&_i.indexOf(v)>-1};switch(r){case"pt":et=1;break;case"mm":et=72/25.4;break;case"cm":et=72/2.54;break;case"in":et=72;break;case"px":et=ki("px_scaling")==1?.75:96/72;break;case"pc":case"em":et=12;break;case"ex":et=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);et=r}var un=null;de(),Z();var Fl=m.__private__.getPageInfo=m.getPageInfo=function(v){if(isNaN(v)||v%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:at[v].objId,pageNumber:v,pageContext:at[v]}},cf=m.__private__.getPageInfoByObjId=function(v){if(isNaN(v)||v%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var R in at)if(at[R].objId===v)break;return Fl(R)},df=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:at[H].objId,pageNumber:H,pageContext:at[H]}};m.addPage=function(){return jd.apply(this,arguments),this},m.setPage=function(){return Sd.apply(this,arguments),ye.call(this,_e[H]),this},m.insertPage=function(v){return this.addPage(),this.movePage(H,v),this},m.movePage=function(v,R){var Y,se;if(v>R){Y=_e[v],se=at[v];for(var he=v;he>R;he--)_e[he]=_e[he-1],at[he]=at[he-1];_e[R]=Y,at[R]=se,this.setPage(R)}else if(v<R){Y=_e[v],se=at[v];for(var je=v;je<R;je++)_e[je]=_e[je+1],at[je]=at[je+1];_e[R]=Y,at[R]=se,this.setPage(R)}return this},m.deletePage=function(){return Ol.apply(this,arguments),this},m.__private__.text=m.text=function(v,R,Y,se,he){var je,Ce,Oe,$e,rt,lt,kt,Jt,jn,Bt=(se=se||{}).scope||this;if(typeof v=="number"&&typeof R=="number"&&(typeof Y=="string"||Array.isArray(Y))){var An=Y;Y=R,R=v,v=An}if(arguments[3]instanceof Ze==0?(Oe=arguments[4],$e=arguments[5],Lt(kt=arguments[3])==="object"&&kt!==null||(typeof Oe=="string"&&($e=Oe,Oe=null),typeof kt=="string"&&($e=kt,kt=null),typeof kt=="number"&&(Oe=kt,kt=null),se={flags:kt,angle:Oe,align:$e})):(A("The transform parameter of text() with a Matrix value"),jn=he),isNaN(R)||isNaN(Y)||v==null)throw new Error("Invalid arguments passed to jsPDF.text");if(v.length===0)return Bt;var Sn,Un="",Kr=typeof se.lineHeightFactor=="number"?se.lineHeightFactor:Ci,gr=Bt.internal.scaleFactor;function qd(Ct){return Ct=Ct.split("	").join(Array(se.TabLen||9).join(" ")),Gr(Ct,kt)}function Co(Ct){for(var qt,fn=Ct.concat(),En=[],ra=fn.length;ra--;)typeof(qt=fn.shift())=="string"?En.push(qt):Array.isArray(Ct)&&(qt.length===1||qt[1]===void 0&&qt[2]===void 0)?En.push(qt[0]):En.push([qt[0],qt[1],qt[2]]);return En}function Ti(Ct,qt){var fn;if(typeof Ct=="string")fn=qt(Ct)[0];else if(Array.isArray(Ct)){for(var En,ra,nc=Ct.concat(),Do=[],Md=nc.length;Md--;)typeof(En=nc.shift())=="string"?Do.push(qt(En)[0]):Array.isArray(En)&&typeof En[0]=="string"&&(ra=qt(En[0],En[1],En[2]),Do.push([ra[0],ra[1],ra[2]]));fn=Do}return fn}var Aa=!1,Ii=!0;if(typeof v=="string")Aa=!0;else if(Array.isArray(v)){var Ri=v.concat();Ce=[];for(var qi,Qn=Ri.length;Qn--;)(typeof(qi=Ri.shift())!="string"||Array.isArray(qi)&&typeof qi[0]!="string")&&(Ii=!1);Aa=Ii}if(Aa===!1)throw new Error('Type of text must be string or Array. "'+v+'" is not recognized.');typeof v=="string"&&(v=v.match(/[\r?\n]/)?v.split(/\r\n|\r|\n/g):[v]);var Oi=ue/Bt.internal.scaleFactor,Fi=Oi*(Kr-1);switch(se.baseline){case"bottom":Y-=Fi;break;case"top":Y+=Oi-Fi;break;case"hanging":Y+=Oi-2*Fi;break;case"middle":Y+=Oi/2-Fi}if((lt=se.maxWidth||0)>0&&(typeof v=="string"?v=Bt.splitTextToSize(v,lt):Object.prototype.toString.call(v)==="[object Array]"&&(v=v.reduce(function(Ct,qt){return Ct.concat(Bt.splitTextToSize(qt,lt))},[]))),je={text:v,x:R,y:Y,options:se,mutex:{pdfEscape:Gr,activeFontKey:Ue,fonts:ze,activeFontSize:ue}},Nt.publish("preProcessText",je),v=je.text,Oe=(se=je.options).angle,jn instanceof Ze==0&&Oe&&typeof Oe=="number"){Oe*=Math.PI/180,se.rotationDirection===0&&(Oe=-Oe),N===S&&(Oe=-Oe);var Gl=Math.cos(Oe),Kl=Math.sin(Oe);jn=new Ze(Gl,Kl,-Kl,Gl,0,0)}else Oe&&Oe instanceof Ze&&(jn=Oe);N!==S||jn||(jn=Zs),(rt=se.charSpace||ko)!==void 0&&(Un+=b(L(rt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Jt=se.horizontalScale)!==void 0&&(Un+=b(100*Jt)+` Tz
`),se.lang;var rn=-1,ta=se.renderingMode!==void 0?se.renderingMode:se.stroke,Ao=Bt.internal.getCurrentPageInfo().pageContext;switch(ta){case 0:case!1:case"fill":rn=0;break;case 1:case!0:case"stroke":rn=1;break;case 2:case"fillThenStroke":rn=2;break;case 3:case"invisible":rn=3;break;case 4:case"fillAndAddForClipping":rn=4;break;case 5:case"strokeAndAddPathForClipping":rn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":rn=6;break;case 7:case"addToPathForClipping":rn=7}var Od=Ao.usedRenderingMode!==void 0?Ao.usedRenderingMode:-1;rn!==-1?Un+=rn+` Tr
`:Od!==-1&&(Un+=`0 Tr
`),rn!==-1&&(Ao.usedRenderingMode=rn),$e=se.align||"left";var Zr,Mi=ue*Kr,Zl=Bt.internal.pageSize.getWidth(),Yl=ze[Ue];rt=se.charSpace||ko,lt=se.maxWidth||0,kt=Object.assign({autoencode:!0,noBOM:!0},se.flags);var Ea=[],Bi=function(Ct){return Bt.getStringUnitWidth(Ct,{font:Yl,charSpace:rt,fontSize:ue,doKerning:!1})*ue/gr};if(Object.prototype.toString.call(v)==="[object Array]"){var Ar;Ce=Co(v),$e!=="left"&&(Zr=Ce.map(Bi));var Er,Da=0;if($e==="right"){R-=Zr[0],v=[],Qn=Ce.length;for(var na=0;na<Qn;na++)na===0?(Er=Js(R),Ar=Xs(Y)):(Er=L(Da-Zr[na]),Ar=-Mi),v.push([Ce[na],Er,Ar]),Da=Zr[na]}else if($e==="center"){R-=Zr[0]/2,v=[],Qn=Ce.length;for(var Pa=0;Pa<Qn;Pa++)Pa===0?(Er=Js(R),Ar=Xs(Y)):(Er=L((Da-Zr[Pa])/2),Ar=-Mi),v.push([Ce[Pa],Er,Ar]),Da=Zr[Pa]}else if($e==="left"){v=[],Qn=Ce.length;for(var Jl=0;Jl<Qn;Jl++)v.push(Ce[Jl])}else if($e==="justify"&&Yl.encoding==="Identity-H"){v=[],Qn=Ce.length,lt=lt!==0?lt:Zl;for(var Eo=0,hn=0;hn<Qn;hn++)if(Ar=hn===0?Xs(Y):-Mi,Er=hn===0?Js(R):Eo,hn<Qn-1){var Fd=L((lt-Zr[hn])/(Ce[hn].split(" ").length-1)),Ls=Ce[hn].split(" ");v.push([Ls[0]+" ",Er,Ar]),Eo=0;for(var Ts=1;Ts<Ls.length;Ts++){var Xl=(Bi(Ls[Ts-1]+" "+Ls[Ts])-Bi(Ls[Ts]))*gr+Fd;Ts==Ls.length-1?v.push([Ls[Ts],Xl,0]):v.push([Ls[Ts]+" ",Xl,0]),Eo-=Xl}}else v.push([Ce[hn],Er,Ar]);v.push(["",Eo,0])}else{if($e!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(v=[],Qn=Ce.length,lt=lt!==0?lt:Zl,hn=0;hn<Qn;hn++){Ar=hn===0?Xs(Y):-Mi,Er=hn===0?Js(R):0;var Ql=Ce[hn].split(" ").length-1,ec=Ql>0?(lt-Zr[hn])/Ql:0;hn<Qn-1?Ea.push(b(L(ec))):Ea.push(0),v.push([Ce[hn],Er,Ar])}}}(typeof se.R2L=="boolean"?se.R2L:Xe)===!0&&(v=Ti(v,function(Ct,qt,fn){return[Ct.split("").reverse().join(""),qt,fn]})),je={text:v,x:R,y:Y,options:se,mutex:{pdfEscape:Gr,activeFontKey:Ue,fonts:ze,activeFontSize:ue}},Nt.publish("postProcessText",je),v=je.text,Sn=je.mutex.isHex||!1;var tc=ze[Ue].encoding;tc!=="WinAnsiEncoding"&&tc!=="StandardEncoding"||(v=Ti(v,function(Ct,qt,fn){return[qd(Ct),qt,fn]})),Ce=Co(v),v=[];for(var La,Ta,Ia,Ui=Array.isArray(Ce[0])?1:0,Ra="",$i=function(Ct,qt,fn){var En="";return fn instanceof Ze?(fn=typeof se.angle=="number"?Ks(fn,new Ze(1,0,0,1,Ct,qt)):Ks(new Ze(1,0,0,1,Ct,qt),fn),N===S&&(fn=Ks(new Ze(1,0,0,-1,0,0),fn)),En=fn.join(" ")+` Tm
`):En=b(Ct)+" "+b(qt)+` Td
`,En},Yr=0;Yr<Ce.length;Yr++){switch(Ra="",Ui){case 1:Ia=(Sn?"<":"(")+Ce[Yr][0]+(Sn?">":")"),La=parseFloat(Ce[Yr][1]),Ta=parseFloat(Ce[Yr][2]);break;case 0:Ia=(Sn?"<":"(")+Ce[Yr]+(Sn?">":")"),La=Js(R),Ta=Xs(Y)}Ea!==void 0&&Ea[Yr]!==void 0&&(Ra=Ea[Yr]+` Tw
`),Yr===0?v.push(Ra+$i(La,Ta,jn)+Ia):Ui===0?v.push(Ra+Ia):Ui===1&&v.push(Ra+$i(La,Ta,jn)+Ia)}v=Ui===0?v.join(` Tj
T* `):v.join(` Tj
`),v+=` Tj
`;var Is=`BT
/`;return Is+=Ue+" "+ue+` Tf
`,Is+=b(ue*Kr)+` TL
`,Is+=Ai+`
`,Is+=Un,Is+=v,Q(Is+="ET"),g[Ue]=!0,Bt};var uf=m.__private__.clip=m.clip=function(v){return Q(v==="evenodd"?"W*":"W"),this};m.clipEvenOdd=function(){return uf("evenodd")},m.__private__.discardPath=m.discardPath=function(){return Q("n"),this};var Ps=m.__private__.isValidStyle=function(v){var R=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(v)!==-1&&(R=!0),R};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(v){return Ps(v)&&(d=v),this};var Ed=m.__private__.getStyle=m.getStyle=function(v){var R=d;switch(v){case"D":case"S":R="S";break;case"F":R="f";break;case"FD":case"DF":R="B";break;case"f":case"f*":case"B":case"B*":R=v}return R},Dd=m.close=function(){return Q("h"),this};m.stroke=function(){return Q("S"),this},m.fill=function(v){return Na("f",v),this},m.fillEvenOdd=function(v){return Na("f*",v),this},m.fillStroke=function(v){return Na("B",v),this},m.fillStrokeEvenOdd=function(v){return Na("B*",v),this};var Na=function(v,R){Lt(R)==="object"?ff(R,v):Q(v)},Ml=function(v){v===null||N===S&&v===void 0||(v=Ed(v),Q(v))};function hf(v,R,Y,se,he){var je=new sl(R||this.boundingBox,Y||this.xStep,se||this.yStep,this.gState,he||this.matrix);je.stream=this.stream;var Ce=v+"$$"+this.cloneIndex+++"$$";return Wr(Ce,je),je}var ff=function(v,R){var Y=bt[v.key],se=Ke[Y];if(se instanceof Xi)Q("q"),Q(pf(R)),se.gState&&m.setGState(se.gState),Q(v.matrix.toString()+" cm"),Q("/"+Y+" sh"),Q("Q");else if(se instanceof sl){var he=new Ze(1,0,0,-1,0,Li());v.matrix&&(he=he.multiply(v.matrix||Zs),Y=hf.call(se,v.key,v.boundingBox,v.xStep,v.yStep,he).id),Q("q"),Q("/Pattern cs"),Q("/"+Y+" scn"),se.gState&&m.setGState(se.gState),Q(R),Q("Q")}},pf=function(v){switch(v){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Bl=m.moveTo=function(v,R){return Q(b(L(v))+" "+b(I(R))+" m"),this},Ni=m.lineTo=function(v,R){return Q(b(L(v))+" "+b(I(R))+" l"),this},Ca=m.curveTo=function(v,R,Y,se,he,je){return Q([b(L(v)),b(I(R)),b(L(Y)),b(I(se)),b(L(he)),b(I(je)),"c"].join(" ")),this};m.__private__.line=m.line=function(v,R,Y,se,he){if(isNaN(v)||isNaN(R)||isNaN(Y)||isNaN(se)||!Ps(he))throw new Error("Invalid arguments passed to jsPDF.line");return N===_?this.lines([[Y-v,se-R]],v,R,[1,1],he||"S"):this.lines([[Y-v,se-R]],v,R,[1,1]).stroke()},m.__private__.lines=m.lines=function(v,R,Y,se,he,je){var Ce,Oe,$e,rt,lt,kt,Jt,jn,Bt,An,Sn,Un;if(typeof v=="number"&&(Un=Y,Y=R,R=v,v=Un),se=se||[1,1],je=je||!1,isNaN(R)||isNaN(Y)||!Array.isArray(v)||!Array.isArray(se)||!Ps(he)||typeof je!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Bl(R,Y),Ce=se[0],Oe=se[1],rt=v.length,An=R,Sn=Y,$e=0;$e<rt;$e++)(lt=v[$e]).length===2?(An=lt[0]*Ce+An,Sn=lt[1]*Oe+Sn,Ni(An,Sn)):(kt=lt[0]*Ce+An,Jt=lt[1]*Oe+Sn,jn=lt[2]*Ce+An,Bt=lt[3]*Oe+Sn,An=lt[4]*Ce+An,Sn=lt[5]*Oe+Sn,Ca(kt,Jt,jn,Bt,An,Sn));return je&&Dd(),Ml(he),this},m.path=function(v){for(var R=0;R<v.length;R++){var Y=v[R],se=Y.c;switch(Y.op){case"m":Bl(se[0],se[1]);break;case"l":Ni(se[0],se[1]);break;case"c":Ca.apply(this,se);break;case"h":Dd()}}return this},m.__private__.rect=m.rect=function(v,R,Y,se,he){if(isNaN(v)||isNaN(R)||isNaN(Y)||isNaN(se)||!Ps(he))throw new Error("Invalid arguments passed to jsPDF.rect");return N===_&&(se=-se),Q([b(L(v)),b(I(R)),b(L(Y)),b(L(se)),"re"].join(" ")),Ml(he),this},m.__private__.triangle=m.triangle=function(v,R,Y,se,he,je,Ce){if(isNaN(v)||isNaN(R)||isNaN(Y)||isNaN(se)||isNaN(he)||isNaN(je)||!Ps(Ce))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Y-v,se-R],[he-Y,je-se],[v-he,R-je]],v,R,[1,1],Ce,!0),this},m.__private__.roundedRect=m.roundedRect=function(v,R,Y,se,he,je,Ce){if(isNaN(v)||isNaN(R)||isNaN(Y)||isNaN(se)||isNaN(he)||isNaN(je)||!Ps(Ce))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Oe=4/3*(Math.SQRT2-1);return he=Math.min(he,.5*Y),je=Math.min(je,.5*se),this.lines([[Y-2*he,0],[he*Oe,0,he,je-je*Oe,he,je],[0,se-2*je],[0,je*Oe,-he*Oe,je,-he,je],[2*he-Y,0],[-he*Oe,0,-he,-je*Oe,-he,-je],[0,2*je-se],[0,-je*Oe,he*Oe,-je,he,-je]],v+he,R,[1,1],Ce,!0),this},m.__private__.ellipse=m.ellipse=function(v,R,Y,se,he){if(isNaN(v)||isNaN(R)||isNaN(Y)||isNaN(se)||!Ps(he))throw new Error("Invalid arguments passed to jsPDF.ellipse");var je=4/3*(Math.SQRT2-1)*Y,Ce=4/3*(Math.SQRT2-1)*se;return Bl(v+Y,R),Ca(v+Y,R-Ce,v+je,R-se,v,R-se),Ca(v-je,R-se,v-Y,R-Ce,v-Y,R),Ca(v-Y,R+Ce,v-je,R+se,v,R+se),Ca(v+je,R+se,v+Y,R+Ce,v+Y,R),Ml(he),this},m.__private__.circle=m.circle=function(v,R,Y,se){if(isNaN(v)||isNaN(R)||isNaN(Y)||!Ps(se))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(v,R,Y,Y,se)},m.setFont=function(v,R,Y){return Y&&(R=P(R,Y)),Ue=Nd(v,R,{disableWarning:!1}),this};var mf=m.__private__.getFont=m.getFont=function(){return ze[Nd.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var v,R,Y={};for(v in dt)if(dt.hasOwnProperty(v))for(R in Y[v]=[],dt[v])dt[v].hasOwnProperty(R)&&Y[v].push(R);return Y},m.addFont=function(v,R,Y,se,he){var je=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&je.indexOf(arguments[3])!==-1?he=arguments[3]:arguments[3]&&je.indexOf(arguments[3])==-1&&(Y=P(Y,se)),wd.call(this,v,R,Y,he=he||"Identity-H")};var Ci,Ul=t.lineWidth||.200025,it=m.__private__.getLineWidth=m.getLineWidth=function(){return Ul},gf=m.__private__.setLineWidth=m.setLineWidth=function(v){return Ul=v,Q(b(L(v))+" w"),this};m.__private__.setLineDash=He.API.setLineDash=He.API.setLineDashPattern=function(v,R){if(v=v||[],R=R||0,isNaN(R)||!Array.isArray(v))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return v=v.map(function(Y){return b(L(Y))}).join(" "),R=b(L(R)),Q("["+v+"] "+R+" d"),this};var vf=m.__private__.getLineHeight=m.getLineHeight=function(){return ue*Ci};m.__private__.getLineHeight=m.getLineHeight=function(){return ue*Ci};var yf=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(v){return typeof(v=v||1.15)=="number"&&(Ci=v),this},bf=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return Ci};yf(t.lineHeight);var Js=m.__private__.getHorizontalCoordinate=function(v){return L(v)},Xs=m.__private__.getVerticalCoordinate=function(v){return N===S?v:at[H].mediaBox.topRightY-at[H].mediaBox.bottomLeftY-L(v)},_f=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(v){return b(Js(v))},xf=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(v){return b(Xs(v))},jo=t.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return Es(jo)},m.__private__.setStrokeColor=m.setDrawColor=function(v,R,Y,se){return jo=ds({ch1:v,ch2:R,ch3:Y,ch4:se,pdfColorType:"draw",precision:2}),Q(jo),this};var $l=t.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return Es($l)},m.__private__.setFillColor=m.setFillColor=function(v,R,Y,se){return $l=ds({ch1:v,ch2:R,ch3:Y,ch4:se,pdfColorType:"fill",precision:2}),Q($l),this};var Ai=t.textColor||"0 g",So=m.__private__.getTextColor=m.getTextColor=function(){return Es(Ai)};m.__private__.setTextColor=m.setTextColor=function(v,R,Y,se){return Ai=ds({ch1:v,ch2:R,ch3:Y,ch4:se,pdfColorType:"text",precision:3}),this};var ko=t.charSpace,wf=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(ko||0)};m.__private__.setCharSpace=m.setCharSpace=function(v){if(isNaN(v))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ko=v,this};var zl=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(v){var R=m.CapJoinStyles[v];if(R===void 0)throw new Error("Line cap style of '"+v+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return zl=R,Q(R+" J"),this};var Wl=0;m.__private__.setLineJoin=m.setLineJoin=function(v){var R=m.CapJoinStyles[v];if(R===void 0)throw new Error("Line join style of '"+v+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Wl=R,Q(R+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(v){if(v=v||0,isNaN(v))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Q(b(L(v))+" M"),this},m.GState=kh,m.setGState=function(v){(v=typeof v=="string"?ut[dn[v]]:Ei(null,v)).equals(Cn)||(Q("/"+v.id+" gs"),Cn=v)};var Ei=function(v,R){if(!v||!dn[v]){var Y=!1;for(var se in ut)if(ut.hasOwnProperty(se)&&ut[se].equals(R)){Y=!0;break}if(Y)R=ut[se];else{var he="GS"+(Object.keys(ut).length+1).toString(10);ut[he]=R,R.id=he}return v&&(dn[v]=R.id),Nt.publish("addGState",R),R}};m.addGState=function(v,R){return Ei(v,R),this},m.saveGraphicsState=function(){return Q("q"),It.push({key:Ue,size:ue,color:Ai}),this},m.restoreGraphicsState=function(){Q("Q");var v=It.pop();return Ue=v.key,ue=v.size,Ai=v.color,Cn=null,this},m.setCurrentTransformationMatrix=function(v){return Q(v.toString()+" cm"),this},m.comment=function(v){return Q("#"+v),this};var Di=function(v,R){var Y=v||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Y},set:function(je){isNaN(je)||(Y=parseFloat(je))}});var se=R||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return se},set:function(je){isNaN(je)||(se=parseFloat(je))}});var he="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return he},set:function(je){he=je.toString()}}),this},Hl=function(v,R,Y,se){Di.call(this,v,R),this.type="rect";var he=Y||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return he},set:function(Ce){isNaN(Ce)||(he=parseFloat(Ce))}});var je=se||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return je},set:function(Ce){isNaN(Ce)||(je=parseFloat(Ce))}}),this},No=function(){this.page=Rt,this.currentPage=H,this.pages=_e.slice(0),this.pagesContext=at.slice(0),this.x=Ge,this.y=Mt,this.matrix=St,this.width=Pd(H),this.height=Qs(H),this.outputDestination=Ae,this.id="",this.objectNumber=-1};No.prototype.restore=function(){Rt=this.page,H=this.currentPage,at=this.pagesContext,_e=this.pages,Ge=this.x,Mt=this.y,St=this.matrix,Ld(H,this.width),ea(H,this.height),Ae=this.outputDestination};var Vl=function(v,R,Y,se,he){As.push(new No),Rt=H=0,_e=[],Ge=v,Mt=R,St=he,ql([Y,se])};for(var Pi in m.beginFormObject=function(v,R,Y,se,he){return Vl(v,R,Y,se,he),this},m.endFormObject=function(v){return function(R){if(Gs[R])As.pop().restore();else{var Y=new No,se="Xo"+(Object.keys(Xn).length+1).toString(10);Y.id=se,Gs[R]=se,Xn[se]=Y,Nt.publish("addFormObject",Y),As.pop().restore()}}(v),this},m.doFormObject=function(v,R){var Y=Xn[Gs[v]];return Q("q"),Q(R.toString()+" cm"),Q("/"+Y.id+" Do"),Q("Q"),this},m.getFormObject=function(v){var R=Xn[Gs[v]];return{x:R.x,y:R.y,width:R.width,height:R.height,matrix:R.matrix}},m.save=function(v,R){return v=v||"generated.pdf",(R=R||{}).returnPromise=R.returnPromise||!1,R.returnPromise===!1?(Yi(Si(Ys()),v),typeof Yi.unload=="function"&&tt.setTimeout&&setTimeout(Yi.unload,911),this):new Promise(function(Y,se){try{var he=Yi(Si(Ys()),v);typeof Yi.unload=="function"&&tt.setTimeout&&setTimeout(Yi.unload,911),Y(he)}catch(je){se(je.message)}})},He.API)He.API.hasOwnProperty(Pi)&&(Pi==="events"&&He.API.events.length?function(v,R){var Y,se,he;for(he=R.length-1;he!==-1;he--)Y=R[he][0],se=R[he][1],v.subscribe.apply(v,[Y].concat(typeof se=="function"?[se]:se))}(Nt,He.API.events):m[Pi]=He.API[Pi]);function Pd(v){return at[v].mediaBox.topRightX-at[v].mediaBox.bottomLeftX}function Ld(v,R){at[v].mediaBox.topRightX=R+at[v].mediaBox.bottomLeftX}function Qs(v){return at[v].mediaBox.topRightY-at[v].mediaBox.bottomLeftY}function ea(v,R){at[v].mediaBox.topRightY=R+at[v].mediaBox.bottomLeftY}var Td=m.getPageWidth=function(v){return Pd(v=v||H)/et},Id=m.setPageWidth=function(v,R){Ld(v,R*et)},Li=m.getPageHeight=function(v){return Qs(v=v||H)/et},Rd=m.setPageHeight=function(v,R){ea(v,R*et)};return m.internal={pdfEscape:Gr,getStyle:Ed,getFont:mf,getFontSize:Pe,getCharSpace:wf,getTextColor:So,getLineHeight:vf,getLineHeightFactor:bf,getLineWidth:it,write:st,getHorizontalCoordinate:Js,getVerticalCoordinate:Xs,getCoordinateString:_f,getVerticalCoordinateString:xf,collections:{},newObject:nn,newAdditionalObject:xi,newObjectDeferred:qn,newObjectDeferredBegin:Bn,getFilters:us,putStream:Vr,events:Nt,scaleFactor:et,pageSize:{getWidth:function(){return Td(H)},setWidth:function(v){Id(H,v)},getHeight:function(){return Li(H)},setHeight:function(v){Rd(H,v)}},encryptionOptions:u,encryption:un,getEncryptor:function(v){return u!==null?un.encryptor(v,0):function(R){return R}},output:hs,getNumberOfPages:kd,pages:_e,out:Q,f2:D,f3:F,getPageInfo:Fl,getPageInfoByObjId:cf,getCurrentPageInfo:df,getPDFVersion:k,Point:Di,Rectangle:Hl,Matrix:Ze,hasHotfix:ki},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return Td(H)},set:function(v){Id(H,v)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return Li(H)},set:function(v){Rd(H,v)},enumerable:!0,configurable:!0}),(function(v){for(var R=0,Y=Ve.length;R<Y;R++){var se=wd.call(this,v[R][0],v[R][1],v[R][2],Ve[R][3],!0);p===!1&&(g[se]=!0);var he=v[R][0].split("-");xd({id:se,fontName:he[0],fontStyle:he[1]||""})}Nt.publish("addFonts",{fonts:ze,dictionary:dt})}).call(m,Ve),Ue="F1",jd(s,n),Nt.publish("initialized"),m}zo.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},zo.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},zo.prototype.hexToBytes=function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(String.fromCharCode(parseInt(t.substr(n,2),16)));return e.join("")},zo.prototype.processOwnerPassword=function(t,e){return ug(dg(e).substr(0,5),t)},zo.prototype.encryptor=function(t,e){var n=dg(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(r){return ug(n,r)}},kh.prototype.equals=function(t){var e,n="id,objectNumber,equals";if(!t||Lt(t)!==Lt(this))return!1;var r=0;for(e in this)if(!(n.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;r++}for(e in t)t.hasOwnProperty(e)&&n.indexOf(e)<0&&r--;return r===0},He.API={events:[]},He.version="3.0.3";var on=He.API,A0=1,yo=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Mo=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},ct=function(t){return t.toFixed(2)},Ha=function(t){return t.toFixed(5)};on.__acroform__={};var Cr=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},$2=function(t){return t*A0},Fs=function(t){var e=new vx,n=qe.internal.getHeight(t)||0,r=qe.internal.getWidth(t)||0;return e.BBox=[0,0,Number(ct(r)),Number(ct(n))],e},e8=on.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},t8=on.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},n8=on.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},bn=on.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return n8(t,e-1)},_n=on.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return e8(t,e-1)},xn=on.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return t8(t,e-1)},r8=on.__acroform__.calculateCoordinates=function(t,e){var n=e.internal.getHorizontalCoordinate,r=e.internal.getVerticalCoordinate,s=t[0],i=t[1],o=t[2],l=t[3],c={};return c.lowerLeft_X=n(s)||0,c.lowerLeft_Y=r(i+l)||0,c.upperRight_X=n(s+o)||0,c.upperRight_Y=r(i)||0,[Number(ct(c.lowerLeft_X)),Number(ct(c.lowerLeft_Y)),Number(ct(c.upperRight_X)),Number(ct(c.upperRight_Y))]},s8=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],n=t._V||t.DV,r=hg(t,n),s=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+s+" "+ct(r.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC");var i=Fs(t);return i.scope=t.scope,i.stream=e.join(`
`),i}},hg=function(t,e){var n=t.fontSize===0?t.maxFontSize:t.fontSize,r={text:"",fontSize:""},s=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");s=t.multiline?s.map(function(D){return D.split(`
`)}):s.map(function(D){return[D]});var i=n,o=qe.internal.getHeight(t)||0;o=o<0?-o:o;var l=qe.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(D,F,L){if(D+1<s.length){var I=F+" "+s[D+1][0];return Au(I,t,L).width<=l-4}return!1};i++;e:for(;i>0;){e="",i--;var d,u,p=Au("3",t,i).height,g=t.multiline?o-i:(o-p)/2,m=g+=2,j=0,k=0,w=0;if(i<=0){e=`(...) Tj
`,e+="% Width of Text: "+Au(e,t,i=12).width+", FieldWidth:"+l+`
`;break}for(var y="",_=0,S=0;S<s.length;S++)if(s.hasOwnProperty(S)){var N=!1;if(s[S].length!==1&&w!==s[S].length-1){if((p+2)*(_+2)+2>o)continue e;y+=s[S][w],N=!0,k=S,S--}else{y=(y+=s[S][w]+" ").substr(y.length-1)==" "?y.substr(0,y.length-1):y;var T=parseInt(S),U=c(T,y,i),P=S>=s.length-1;if(U&&!P){y+=" ",w=0;continue}if(U||P){if(P)k=T;else if(t.multiline&&(p+2)*(_+2)+2>o)continue e}else{if(!t.multiline||(p+2)*(_+2)+2>o)continue e;k=T}}for(var b="",A=j;A<=k;A++){var $=s[A];if(t.multiline){if(A===k){b+=$[w]+" ",w=(w+1)%$.length;continue}if(A===j){b+=$[$.length-1]+" ";continue}}b+=$[0]+" "}switch(b=b.substr(b.length-1)==" "?b.substr(0,b.length-1):b,u=Au(b,t,i).width,t.textAlign){case"right":d=l-u-2;break;case"center":d=(l-u)/2;break;default:d=2}e+=ct(d)+" "+ct(m)+` Td
`,e+="("+yo(b)+`) Tj
`,e+=-ct(d)+` 0 Td
`,m=-(i+2),u=0,j=N?k:k+1,_++,y=""}break}return r.text=e,r.fontSize=i,r},Au=function(t,e,n){var r=e.scope.internal.getFont(e.fontName,e.fontStyle),s=e.scope.getStringUnitWidth(t,{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:e.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:s}},a8={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},i8=function(t,e){var n={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(r){return r.type===n.type&&r.object===n.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(n)},o8=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Ns.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(a8)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");A0=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new yx,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in r)if(r.hasOwnProperty(s)){var i=r[s];i.objId=void 0,i.hasAnnotation&&i8(i,n)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(n){(function(r,s){var i=!r;for(var o in r||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(o)){var l=r[o],c=[],d=l.Rect;if(l.Rect&&(l.Rect=r8(l.Rect,s)),s.internal.newObjectDeferredBegin(l.objId,!0),l.DA=qe.createDefaultAppearanceStream(l),Lt(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=d,l.hasAppearanceStream&&!l.appearanceStreamContent){var u=s8(l);c.push({key:"AP",value:"<</N "+u+">>"}),s.internal.acroformPlugin.xForms.push(u)}if(l.appearanceStreamContent){var p="";for(var g in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(g)){var m=l.appearanceStreamContent[g];if(p+="/"+g+" ",p+="<<",Object.keys(m).length>=1||Array.isArray(m)){for(var o in m)if(m.hasOwnProperty(o)){var j=m[o];typeof j=="function"&&(j=j.call(s,l)),p+="/"+o+" "+j+" ",s.internal.acroformPlugin.xForms.indexOf(j)>=0||s.internal.acroformPlugin.xForms.push(j)}}else typeof(j=m)=="function"&&(j=j.call(s,l)),p+="/"+o+" "+j,s.internal.acroformPlugin.xForms.indexOf(j)>=0||s.internal.acroformPlugin.xForms.push(j);p+=">>"}c.push({key:"AP",value:`<<
`+p+">>"})}s.internal.putStream({additionalKeyValues:c,objectId:l.objId}),s.internal.out("endobj")}i&&function(k,w){for(var y in k)if(k.hasOwnProperty(y)){var _=y,S=k[y];w.internal.newObjectDeferredBegin(S.objId,!0),Lt(S)==="object"&&typeof S.putStream=="function"&&S.putStream(),delete k[_]}}(s.internal.acroformPlugin.xForms,s)})(n,t)}),t.internal.acroformPlugin.isInitialized=!0}},gx=on.__acroform__.arrayToPdfArray=function(t,e,n){var r=function(o){return o};if(Array.isArray(t)){for(var s="[",i=0;i<t.length;i++)switch(i!==0&&(s+=" "),Lt(t[i])){case"boolean":case"number":case"object":s+=t[i].toString();break;case"string":t[i].substr(0,1)!=="/"?(e!==void 0&&n&&(r=n.internal.getEncryptor(e)),s+="("+yo(r(t[i].toString()))+")"):s+=t[i].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Op=function(t,e,n){var r=function(s){return s};return e!==void 0&&n&&(r=n.internal.getEncryptor(e)),(t=t||"").toString(),"("+yo(r(t))+")"},zs=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};zs.prototype.toString=function(){return this.objId+" 0 R"},zs.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},zs.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var n in e)if(Object.getOwnPropertyDescriptor(this,e[n]).configurable===!1){var r=e[n],s=this[r];s&&(Array.isArray(s)?t.push({key:r,value:gx(s,this.objId,this.scope)}):s instanceof zs?(s.scope=this.scope,t.push({key:r,value:s.objId+" 0 R"})):typeof s!="function"&&t.push({key:r,value:s}))}return t};var vx=function(){zs.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){t=n.trim()},get:function(){return t||null}})};Cr(vx,zs);var yx=function(){zs.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var n=function(r){return r};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+yo(n(t))+")"}},set:function(n){t=n}})};Cr(yx,zs);var Ns=function t(){zs.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute F supplied.');e=y}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!bn(e,3)},set:function(y){y?this.F=_n(e,3):this.F=xn(e,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute Ff supplied.');n=y}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(y){r=y!==void 0?y:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(y){r[0]=y}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(y){r[1]=y}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(y){r[2]=y}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(y){r[3]=y}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(y){switch(y){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=y;break;default:throw new Error('Invalid value "'+y+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof Nh)return;i="FieldObject"+t.FieldNum++}var y=function(_){return _};return this.scope&&(y=this.scope.internal.getEncryptor(this.objId)),"("+yo(y(i))+")"},set:function(y){i=y.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(y){i=y}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(y){o=y}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(y){l=y}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(y){c=y}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/A0:d},set:function(y){d=y}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(y){u=y}});var p="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!p||this instanceof Nh||this instanceof so))return Op(p,this.objId,this.scope)},set:function(y){y=y.toString(),p=y}});var g=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof Fn==0?Op(g,this.objId,this.scope):g},set:function(y){y=y.toString(),g=this instanceof Fn==0?y.substr(0,1)==="("?Mo(y.substr(1,y.length-2)):Mo(y):y}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Fn==1?Mo(g.substr(1,g.length-1)):g},set:function(y){y=y.toString(),g=this instanceof Fn==1?"/"+y:y}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(y){this.V=y}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof Fn==0?Op(m,this.objId,this.scope):m},set:function(y){y=y.toString(),m=this instanceof Fn==0?y.substr(0,1)==="("?Mo(y.substr(1,y.length-2)):Mo(y):y}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Fn==1?Mo(m.substr(1,m.length-1)):m},set:function(y){y=y.toString(),m=this instanceof Fn==1?"/"+y:y}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var j,k=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return k},set:function(y){y=!!y,k=y}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(j)return j},set:function(y){j=y}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,1)},set:function(y){y?this.Ff=_n(this.Ff,1):this.Ff=xn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,2)},set:function(y){y?this.Ff=_n(this.Ff,2):this.Ff=xn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,3)},set:function(y){y?this.Ff=_n(this.Ff,3):this.Ff=xn(this.Ff,3)}});var w=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(w!==null)return w},set:function(y){if([0,1,2].indexOf(y)===-1)throw new Error('Invalid value "'+y+'" for attribute Q supplied.');w=y}}),Object.defineProperty(this,"textAlign",{get:function(){var y;switch(w){case 0:default:y="left";break;case 1:y="center";break;case 2:y="right"}return y},configurable:!0,enumerable:!0,set:function(y){switch(y){case"right":case 2:w=2;break;case"center":case 1:w=1;break;default:w=0}}})};Cr(Ns,zs);var hl=function(){Ns.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(n){t=n}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return gx(e,this.objId,this.scope)},set:function(n){var r,s;s=[],typeof(r=n)=="string"&&(s=function(i,o,l){l||(l=1);for(var c,d=[];c=o.exec(i);)d.push(c[l]);return d}(r,/\((.*?)\)/g)),e=s}}),this.getOptions=function(){return e},this.setOptions=function(n){e=n,this.sort&&e.sort()},this.addOption=function(n){n=(n=n||"").toString(),e.push(n),this.sort&&e.sort()},this.removeOption=function(n,r){for(r=r||!1,n=(n=n||"").toString();e.indexOf(n)!==-1&&(e.splice(e.indexOf(n),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,18)},set:function(n){n?this.Ff=_n(this.Ff,18):this.Ff=xn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=_n(this.Ff,19):this.Ff=xn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,20)},set:function(n){n?(this.Ff=_n(this.Ff,20),e.sort()):this.Ff=xn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,22)},set:function(n){n?this.Ff=_n(this.Ff,22):this.Ff=xn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,23)},set:function(n){n?this.Ff=_n(this.Ff,23):this.Ff=xn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,27)},set:function(n){n?this.Ff=_n(this.Ff,27):this.Ff=xn(this.Ff,27)}}),this.hasAppearanceStream=!1};Cr(hl,Ns);var fl=function(){hl.call(this),this.fontName="helvetica",this.combo=!1};Cr(fl,hl);var pl=function(){fl.call(this),this.combo=!0};Cr(pl,fl);var Hu=function(){pl.call(this),this.edit=!0};Cr(Hu,pl);var Fn=function(){Ns.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,15)},set:function(n){n?this.Ff=_n(this.Ff,15):this.Ff=xn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,16)},set:function(n){n?this.Ff=_n(this.Ff,16):this.Ff=xn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,17)},set:function(n){n?this.Ff=_n(this.Ff,17):this.Ff=xn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,26)},set:function(n){n?this.Ff=_n(this.Ff,26):this.Ff=xn(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(i){return i};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var r,s=[];for(r in s.push("<<"),e)s.push("/"+r+" ("+yo(n(e[r]))+")");return s.push(">>"),s.join(`
`)}},set:function(n){Lt(n)==="object"&&(e=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(n){typeof n=="string"&&(e.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(n){t="/"+n}})};Cr(Fn,Ns);var Vu=function(){Fn.call(this),this.pushButton=!0};Cr(Vu,Fn);var ml=function(){Fn.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Cr(ml,Fn);var Nh=function(){var t,e;Ns.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(s){t=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(s){e=s}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(l){return l};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var i,o=[];for(i in o.push("<<"),r)o.push("/"+i+" ("+yo(s(r[i]))+")");return o.push(">>"),o.join(`
`)},set:function(s){Lt(s)==="object"&&(r=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(s){typeof s=="string"&&(r.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(s){n=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(s){n="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=qe.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Cr(Nh,Ns),ml.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var n=this.Kids[e];n.appearanceStreamContent=t.createAppearanceStream(n.optionName),n.caption=t.getCA()}},ml.prototype.createOption=function(t){var e=new Nh;return e.Parent=this,e.optionName=t,this.Kids.push(e),l8.call(this.scope,e),e};var Gu=function(){Fn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=qe.CheckBox.createAppearanceStream()};Cr(Gu,Fn);var so=function(){Ns.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,13)},set:function(e){e?this.Ff=_n(this.Ff,13):this.Ff=xn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,21)},set:function(e){e?this.Ff=_n(this.Ff,21):this.Ff=xn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,23)},set:function(e){e?this.Ff=_n(this.Ff,23):this.Ff=xn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,24)},set:function(e){e?this.Ff=_n(this.Ff,24):this.Ff=xn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,25)},set:function(e){e?this.Ff=_n(this.Ff,25):this.Ff=xn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,26)},set:function(e){e?this.Ff=_n(this.Ff,26):this.Ff=xn(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Cr(so,Ns);var Ku=function(){so.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,14)},set:function(t){t?this.Ff=_n(this.Ff,14):this.Ff=xn(this.Ff,14)}}),this.password=!0};Cr(Ku,so);var qe={CheckBox:{createAppearanceStream:function(){return{N:{On:qe.CheckBox.YesNormal},D:{On:qe.CheckBox.YesPushDown,Off:qe.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Fs(t);e.scope=t.scope;var n=[],r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,s=t.scope.__private__.encodeColorString(t.color),i=hg(t,t.caption);return n.push("0.749023 g"),n.push("0 0 "+ct(qe.internal.getWidth(t))+" "+ct(qe.internal.getHeight(t))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+r+" "+ct(i.fontSize)+" Tf "+s),n.push("BT"),n.push(i.text),n.push("ET"),n.push("Q"),n.push("EMC"),e.stream=n.join(`
`),e},YesNormal:function(t){var e=Fs(t);e.scope=t.scope;var n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color),s=[],i=qe.internal.getHeight(t),o=qe.internal.getWidth(t),l=hg(t,t.caption);return s.push("1 g"),s.push("0 0 "+ct(o)+" "+ct(i)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+ct(o-1)+" "+ct(i-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+n+" "+ct(l.fontSize)+" Tf "+r),s.push(l.text),s.push("ET"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(t){var e=Fs(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+ct(qe.internal.getWidth(t))+" "+ct(qe.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:qe.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=qe.RadioButton.Circle.YesNormal,e.D[t]=qe.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Fs(t);e.scope=t.scope;var n=[],r=qe.internal.getWidth(t)<=qe.internal.getHeight(t)?qe.internal.getWidth(t)/4:qe.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var s=qe.internal.Bezier_C,i=Number((r*s).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+Ha(qe.internal.getWidth(t)/2)+" "+Ha(qe.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+i+" "+i+" "+r+" 0 "+r+" c"),n.push("-"+i+" "+r+" -"+r+" "+i+" -"+r+" 0 c"),n.push("-"+r+" -"+i+" -"+i+" -"+r+" 0 -"+r+" c"),n.push(i+" -"+r+" "+r+" -"+i+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=Fs(t);e.scope=t.scope;var n=[],r=qe.internal.getWidth(t)<=qe.internal.getHeight(t)?qe.internal.getWidth(t)/4:qe.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var s=Number((2*r).toFixed(5)),i=Number((s*qe.internal.Bezier_C).toFixed(5)),o=Number((r*qe.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Ha(qe.internal.getWidth(t)/2)+" "+Ha(qe.internal.getHeight(t)/2)+" cm"),n.push(s+" 0 m"),n.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),n.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),n.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),n.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+Ha(qe.internal.getWidth(t)/2)+" "+Ha(qe.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),n.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),n.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),n.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Fs(t);e.scope=t.scope;var n=[],r=qe.internal.getWidth(t)<=qe.internal.getHeight(t)?qe.internal.getWidth(t)/4:qe.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var s=Number((2*r).toFixed(5)),i=Number((s*qe.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Ha(qe.internal.getWidth(t)/2)+" "+Ha(qe.internal.getHeight(t)/2)+" cm"),n.push(s+" 0 m"),n.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),n.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),n.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),n.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:qe.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=qe.RadioButton.Cross.YesNormal,e.D[t]=qe.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Fs(t);e.scope=t.scope;var n=[],r=qe.internal.calculateCross(t);return n.push("q"),n.push("1 1 "+ct(qe.internal.getWidth(t)-2)+" "+ct(qe.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(ct(r.x1.x)+" "+ct(r.x1.y)+" m"),n.push(ct(r.x2.x)+" "+ct(r.x2.y)+" l"),n.push(ct(r.x4.x)+" "+ct(r.x4.y)+" m"),n.push(ct(r.x3.x)+" "+ct(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=Fs(t);e.scope=t.scope;var n=qe.internal.calculateCross(t),r=[];return r.push("0.749023 g"),r.push("0 0 "+ct(qe.internal.getWidth(t))+" "+ct(qe.internal.getHeight(t))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+ct(qe.internal.getWidth(t)-2)+" "+ct(qe.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(ct(n.x1.x)+" "+ct(n.x1.y)+" m"),r.push(ct(n.x2.x)+" "+ct(n.x2.y)+" l"),r.push(ct(n.x4.x)+" "+ct(n.x4.y)+" m"),r.push(ct(n.x3.x)+" "+ct(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Fs(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+ct(qe.internal.getWidth(t))+" "+ct(qe.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+n}};qe.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=qe.internal.getWidth(t),n=qe.internal.getHeight(t),r=Math.min(e,n);return{x1:{x:(e-r)/2,y:(n-r)/2+r},x2:{x:(e-r)/2+r,y:(n-r)/2},x3:{x:(e-r)/2,y:(n-r)/2},x4:{x:(e-r)/2+r,y:(n-r)/2+r}}}},qe.internal.getWidth=function(t){var e=0;return Lt(t)==="object"&&(e=$2(t.Rect[2])),e},qe.internal.getHeight=function(t){var e=0;return Lt(t)==="object"&&(e=$2(t.Rect[3])),e};var l8=on.addField=function(t){if(o8(this,t),!(t instanceof Ns))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};on.AcroFormChoiceField=hl,on.AcroFormListBox=fl,on.AcroFormComboBox=pl,on.AcroFormEditBox=Hu,on.AcroFormButton=Fn,on.AcroFormPushButton=Vu,on.AcroFormRadioButton=ml,on.AcroFormCheckBox=Gu,on.AcroFormTextField=so,on.AcroFormPasswordField=Ku,on.AcroFormAppearance=qe,on.AcroForm={ChoiceField:hl,ListBox:fl,ComboBox:pl,EditBox:Hu,Button:Fn,PushButton:Vu,RadioButton:ml,CheckBox:Gu,TextField:so,PasswordField:Ku,Appearance:qe},He.AcroForm={ChoiceField:hl,ListBox:fl,ComboBox:pl,EditBox:Hu,Button:Fn,PushButton:Vu,RadioButton:ml,CheckBox:Gu,TextField:so,PasswordField:Ku,Appearance:qe};He.AcroForm;function bx(t){return t.reduce(function(e,n,r){return e[n]=r,e},{})}(function(t){var e="addImage_";t.__addimage__={};var n="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=t.__addimage__.getImageFileTypeByImageData=function(D,F){var L,I,X,te,oe,Z=n;if((F=F||n)==="RGBA"||D.data!==void 0&&D.data instanceof Uint8ClampedArray&&"height"in D&&"width"in D)return"RGBA";if(U(D))for(oe in r)for(X=r[oe],L=0;L<X.length;L+=1){for(te=!0,I=0;I<X[L].length;I+=1)if(X[L][I]!==void 0&&X[L][I]!==D[I]){te=!1;break}if(te===!0){Z=oe;break}}else for(oe in r)for(X=r[oe],L=0;L<X.length;L+=1){for(te=!0,I=0;I<X[L].length;I+=1)if(X[L][I]!==void 0&&X[L][I]!==D.charCodeAt(I)){te=!1;break}if(te===!0){Z=oe;break}}return Z===n&&F!==n&&(Z=F),Z},i=function D(F){for(var L=this.internal.write,I=this.internal.putStream,X=(0,this.internal.getFilters)();X.indexOf("FlateEncode")!==-1;)X.splice(X.indexOf("FlateEncode"),1);F.objectId=this.internal.newObject();var te=[];if(te.push({key:"Type",value:"/XObject"}),te.push({key:"Subtype",value:"/Image"}),te.push({key:"Width",value:F.width}),te.push({key:"Height",value:F.height}),F.colorSpace===y.INDEXED?te.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(F.palette.length/3-1)+" "+("sMask"in F&&F.sMask!==void 0?F.objectId+2:F.objectId+1)+" 0 R]"}):(te.push({key:"ColorSpace",value:"/"+F.colorSpace}),F.colorSpace===y.DEVICE_CMYK&&te.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),te.push({key:"BitsPerComponent",value:F.bitsPerComponent}),"decodeParameters"in F&&F.decodeParameters!==void 0&&te.push({key:"DecodeParms",value:"<<"+F.decodeParameters+">>"}),"transparency"in F&&Array.isArray(F.transparency)&&F.transparency.length>0){for(var oe="",Z=0,ae=F.transparency.length;Z<ae;Z++)oe+=F.transparency[Z]+" "+F.transparency[Z]+" ";te.push({key:"Mask",value:"["+oe+"]"})}F.sMask!==void 0&&te.push({key:"SMask",value:F.objectId+1+" 0 R"});var ee=F.filter!==void 0?["/"+F.filter]:void 0;if(I({data:F.data,additionalKeyValues:te,alreadyAppliedFilters:ee,objectId:F.objectId}),L("endobj"),"sMask"in F&&F.sMask!==void 0){var de,E=(de=F.sMaskBitsPerComponent)!==null&&de!==void 0?de:F.bitsPerComponent,H={width:F.width,height:F.height,colorSpace:"DeviceGray",bitsPerComponent:E,data:F.sMask};"filter"in F&&(H.decodeParameters="/Predictor ".concat(F.predictor," /Colors 1 /BitsPerComponent ").concat(E," /Columns ").concat(F.width),H.filter=F.filter),D.call(this,H)}if(F.colorSpace===y.INDEXED){var J=this.internal.newObject();I({data:b(new Uint8Array(F.palette)),objectId:J}),L("endobj")}},o=function(){var D=this.internal.collections[e+"images"];for(var F in D)i.call(this,D[F])},l=function(){var D,F=this.internal.collections[e+"images"],L=this.internal.write;for(var I in F)L("/I"+(D=F[I]).index,D.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},d=function(){var D=this.internal.collections[e+"images"];return c.call(this),D},u=function(){return Object.keys(this.internal.collections[e+"images"]).length},p=function(D){return typeof t["process"+D.toUpperCase()]=="function"},g=function(D){return Lt(D)==="object"&&D.nodeType===1},m=function(D,F){if(D.nodeName==="IMG"&&D.hasAttribute("src")){var L=""+D.getAttribute("src");if(L.indexOf("data:image/")===0)return Wu(unescape(L).split("base64,").pop());var I=t.loadFile(L,!0);if(I!==void 0)return I}if(D.nodeName==="CANVAS"){if(D.width===0||D.height===0)throw new Error("Given canvas must have data. Canvas width: "+D.width+", height: "+D.height);var X;switch(F){case"PNG":X="image/png";break;case"WEBP":X="image/webp";break;default:X="image/jpeg"}return Wu(D.toDataURL(X,1).split("base64,").pop())}},j=function(D){var F=this.internal.collections[e+"images"];if(F){for(var L in F)if(D===F[L].alias)return F[L]}},k=function(D,F,L){return D||F||(D=-96,F=-96),D<0&&(D=-1*L.width*72/D/this.internal.scaleFactor),F<0&&(F=-1*L.height*72/F/this.internal.scaleFactor),D===0&&(D=F*L.width/L.height),F===0&&(F=D*L.height/L.width),[D,F]},w=function(D,F,L,I,X,te){var oe=k.call(this,L,I,X),Z=this.internal.getCoordinateString,ae=this.internal.getVerticalCoordinateString,ee=d.call(this);if(L=oe[0],I=oe[1],ee[X.index]=X,te){te*=Math.PI/180;var de=Math.cos(te),E=Math.sin(te),H=function(V){return V.toFixed(4)},J=[H(de),H(E),H(-1*E),H(de),0,0,"cm"]}this.internal.write("q"),te?(this.internal.write([1,"0","0",1,Z(D),ae(F+I),"cm"].join(" ")),this.internal.write(J.join(" ")),this.internal.write([Z(L),"0","0",Z(I),"0","0","cm"].join(" "))):this.internal.write([Z(L),"0","0",Z(I),Z(D),ae(F+I),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+X.index+" Do"),this.internal.write("Q")},y=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var _=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},S=t.__addimage__.sHashCode=function(D){var F,L,I=0;if(typeof D=="string")for(L=D.length,F=0;F<L;F++)I=(I<<5)-I+D.charCodeAt(F),I|=0;else if(U(D))for(L=D.byteLength/2,F=0;F<L;F++)I=(I<<5)-I+D[F],I|=0;return I},N=t.__addimage__.validateStringAsBase64=function(D){(D=D||"").toString().trim();var F=!0;return D.length===0&&(F=!1),D.length%4!=0&&(F=!1),/^[A-Za-z0-9+/]+$/.test(D.substr(0,D.length-2))===!1&&(F=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(D.substr(-2))===!1&&(F=!1),F},T=t.__addimage__.extractImageFromDataUrl=function(D){if(D==null||!(D=D.trim()).startsWith("data:"))return null;var F=D.indexOf(",");return F<0?null:D.substring(0,F).trim().endsWith("base64")?D.substring(F+1):null};t.__addimage__.isArrayBuffer=function(D){return D instanceof ArrayBuffer};var U=t.__addimage__.isArrayBufferView=function(D){return D instanceof Int8Array||D instanceof Uint8Array||D instanceof Uint8ClampedArray||D instanceof Int16Array||D instanceof Uint16Array||D instanceof Int32Array||D instanceof Uint32Array||D instanceof Float32Array||D instanceof Float64Array},P=t.__addimage__.binaryStringToUint8Array=function(D){for(var F=D.length,L=new Uint8Array(F),I=0;I<F;I++)L[I]=D.charCodeAt(I);return L},b=t.__addimage__.arrayBufferToBinaryString=function(D){for(var F="",L=U(D)?D:new Uint8Array(D),I=0;I<L.length;I+=8192)F+=String.fromCharCode.apply(null,L.subarray(I,I+8192));return F};t.addImage=function(){var D,F,L,I,X,te,oe,Z,ae;if(typeof arguments[1]=="number"?(F=n,L=arguments[1],I=arguments[2],X=arguments[3],te=arguments[4],oe=arguments[5],Z=arguments[6],ae=arguments[7]):(F=arguments[1],L=arguments[2],I=arguments[3],X=arguments[4],te=arguments[5],oe=arguments[6],Z=arguments[7],ae=arguments[8]),Lt(D=arguments[0])==="object"&&!g(D)&&"imageData"in D){var ee=D;D=ee.imageData,F=ee.format||F||n,L=ee.x||L||0,I=ee.y||I||0,X=ee.w||ee.width||X,te=ee.h||ee.height||te,oe=ee.alias||oe,Z=ee.compression||Z,ae=ee.rotation||ee.angle||ae}var de=this.internal.getFilters();if(Z===void 0&&de.indexOf("FlateEncode")!==-1&&(Z="SLOW"),isNaN(L)||isNaN(I))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var E=A.call(this,D,F,oe,Z);return w.call(this,L,I,X,te,E,ae),this};var A=function(D,F,L,I){var X,te,oe;if(typeof D=="string"&&s(D)===n){D=unescape(D);var Z=$(D,!1);(Z!==""||(Z=t.loadFile(D,!0))!==void 0)&&(D=Z)}if(g(D)&&(D=m(D,F)),F=s(D,F),!p(F))throw new Error("addImage does not support files of type '"+F+"', please ensure that a plugin for '"+F+"' support is added.");if(((oe=L)==null||oe.length===0)&&(L=function(ae){return typeof ae=="string"||U(ae)?S(ae):U(ae.data)?S(ae.data):null}(D)),(X=j.call(this,L))||(D instanceof Uint8Array||F==="RGBA"||(te=D,D=P(D)),X=this["process"+F.toUpperCase()](D,u.call(this),L,function(ae){return ae&&typeof ae=="string"&&(ae=ae.toUpperCase()),ae in t.image_compression?ae:_.NONE}(I),te)),!X)throw new Error("An unknown error occurred whilst processing the image.");return X},$=t.__addimage__.convertBase64ToBinaryString=function(D,F){F=typeof F!="boolean"||F;var L,I="";if(typeof D=="string"){var X;L=(X=T(D))!==null&&X!==void 0?X:D;try{I=Wu(L)}catch(te){if(F)throw N(L)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+te.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return I};t.getImageProperties=function(D){var F,L,I="";if(g(D)&&(D=m(D)),typeof D=="string"&&s(D)===n&&((I=$(D,!1))===""&&(I=t.loadFile(D)||""),D=I),L=s(D),!p(L))throw new Error("addImage does not support files of type '"+L+"', please ensure that a plugin for '"+L+"' support is added.");if(D instanceof Uint8Array||(D=P(D)),!(F=this["process"+L.toUpperCase()](D)))throw new Error("An unknown error occurred whilst processing the image");return F.fileType=L,F}})(He.API),function(t){var e=function(n){if(n!==void 0&&n!="")return!0};He.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(n){for(var r,s,i,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(n.objId),d=n.pageContext.annotations,u=!1,p=0;p<d.length&&!u;p++)switch((r=d[p]).type){case"link":(e(r.options.url)||e(r.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var g=0;g<d.length;g++){r=d[g];var m=this.internal.pdfEscape,j=this.internal.getEncryptor(n.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var k=this.internal.newAdditionalObject(),w=this.internal.newAdditionalObject(),y=this.internal.getEncryptor(k.objId),_=r.title||"Note";i="<</Type /Annot /Subtype /Text "+(s="/Rect ["+o(r.bounds.x)+" "+l(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w)+" "+l(r.bounds.y)+"] ")+"/Contents ("+m(y(r.contents))+")",i+=" /Popup "+w.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+m(y(_))+") >>",k.content=i;var S=k.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+o(r.bounds.x+30)+" "+l(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w+30)+" "+l(r.bounds.y)+"] ")+" /Parent "+S,r.open&&(i+=" /Open true"),i+=" >>",w.content=i,this.internal.write(k.objId,"0 R",w.objId,"0 R");break;case"freetext":s="/Rect ["+o(r.bounds.x)+" "+l(r.bounds.y)+" "+o(r.bounds.x+r.bounds.w)+" "+l(r.bounds.y+r.bounds.h)+"] ";var N=r.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+m(j(r.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+N+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(r.options.name){var T=this.annotations._nameMap[r.options.name];r.options.pageNumber=T.page,r.options.top=T.y}else r.options.top||(r.options.top=0);if(s="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",i="",r.options.url)i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+m(j(r.options.url))+") >>";else if(r.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,i+=" /FitV "+r.options.left+"]";break;default:var U=l(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),i+=" /XYZ "+r.options.left+" "+U+" "+r.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),t.createAnnotation=function(n){var r=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":r.pageContext.annotations.push(n)}},t.link=function(n,r,s,i,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(n),y:d(r),w:c(n+s),h:d(r+i)},options:o,type:"link"})},t.textWithLink=function(n,r,s,i){var o,l,c=this.getTextWidth(n),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){l=i.maxWidth;var u=this.splitTextToSize(n,l).length;o=Math.ceil(d*u)}else l=c,o=d;return this.text(n,r,s,i),s+=.2*d,i.align==="center"&&(r-=c/2),i.align==="right"&&(r-=c),this.link(r,s-d,l,o,i),c},t.getTextWidth=function(n){var r=this.internal.getFontSize();return this.getStringUnitWidth(n)*r/this.internal.scaleFactor}}(He.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];t.__arabicParser__={};var i=t.__arabicParser__.isInArabicSubstitutionA=function(k){return e[k.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(k){return typeof k=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(k)},l=t.__arabicParser__.isArabicEndLetter=function(k){return o(k)&&i(k)&&e[k.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(k){return o(k)&&s.indexOf(k.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(k){return o(k)&&i(k)&&e[k.charCodeAt(0)].length>=1};var d=t.__arabicParser__.arabicLetterHasFinalForm=function(k){return o(k)&&i(k)&&e[k.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(k){return o(k)&&i(k)&&e[k.charCodeAt(0)].length>=3};var u=t.__arabicParser__.arabicLetterHasMedialForm=function(k){return o(k)&&i(k)&&e[k.charCodeAt(0)].length==4},p=t.__arabicParser__.resolveLigatures=function(k){var w=0,y=n,_="",S=0;for(w=0;w<k.length;w+=1)y[k.charCodeAt(w)]!==void 0?(S++,typeof(y=y[k.charCodeAt(w)])=="number"&&(_+=String.fromCharCode(y),y=n,S=0),w===k.length-1&&(y=n,_+=k.charAt(w-(S-1)),w-=S-1,S=0)):(y=n,_+=k.charAt(w-S),w-=S,S=0);return _};t.__arabicParser__.isArabicDiacritic=function(k){return k!==void 0&&r[k.charCodeAt(0)]!==void 0};var g=t.__arabicParser__.getCorrectForm=function(k,w,y){return o(k)?i(k)===!1?-1:!d(k)||!o(w)&&!o(y)||!o(y)&&l(w)||l(k)&&!o(w)||l(k)&&c(w)||l(k)&&l(w)?0:u(k)&&o(w)&&!l(w)&&o(y)&&d(y)?3:l(k)||!o(y)?1:2:-1},m=function(k){var w=0,y=0,_=0,S="",N="",T="",U=(k=k||"").split("\\s+"),P=[];for(w=0;w<U.length;w+=1){for(P.push(""),y=0;y<U[w].length;y+=1)S=U[w][y],N=U[w][y-1],T=U[w][y+1],o(S)?(_=g(S,N,T),P[w]+=_!==-1?String.fromCharCode(e[S.charCodeAt(0)][_]):S):P[w]+=S;P[w]=p(P[w])}return P.join(" ")},j=t.__arabicParser__.processArabic=t.processArabic=function(){var k,w=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,y=[];if(Array.isArray(w)){var _=0;for(y=[],_=0;_<w.length;_+=1)Array.isArray(w[_])?y.push([m(w[_][0]),w[_][1],w[_][2]]):y.push([m(w[_])]);k=y}else k=m(w);return typeof arguments[0]=="string"?k:(arguments[0].text=k,arguments[0])};t.events.push(["preProcessText",j])}(He.API),He.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},function(t){var e=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(l){n=l}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(l){r=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(l){s=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(l){i=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(n,r){var s;if((n=n||"2d")!=="2d")return null;for(s in r)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=r[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(He.API),function(t){var e={left:0,top:0,bottom:0,right:0},n=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(k){c=k}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(k){d=k}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(k){u=k}});var p=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return p},set:function(k){p=k}});var g=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return g},set:function(k){g=k}});var m=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return m},set:function(k){m=k}});var j=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return j},set:function(k){j=k}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return r.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,d){r.call(this);var u=(d=d||{}).fontSize||this.getFontSize(),p=d.font||this.getFont(),g=d.scaleFactor||this.internal.scaleFactor,m=0,j=0,k=0,w=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var y=d.maxWidth;y>0?typeof c=="string"?c=this.splitTextToSize(c,y):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(S,N){return S.concat(w.splitTextToSize(N,y))},[])):c=Array.isArray(c)?c:[c];for(var _=0;_<c.length;_++)m<(k=this.getStringUnitWidth(c[_],{font:p})*u)&&(m=k);return m!==0&&(j=c.length),{w:m/=g,h:Math.max((j*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/g,0)}},t.cellAddPage=function(){r.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var d=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,p=this.internal.__cell__.margins||e,g=this.internal.__cell__.tableHeaderRow,m=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===c.lineNumber?(c.x=(d.x||0)+(d.width||0),c.y=d.y||0):d.y+d.height+c.height+p.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=p.top,m&&g&&(this.printHeaderRow(c.lineNumber,!0),c.y+=g[0].height)):c.y=d.y+d.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,n===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};t.table=function(c,d,u,p,g){if(r.call(this),!u)throw new Error("No data for PDF table.");var m,j,k,w,y=[],_=[],S=[],N={},T={},U=[],P=[],b=(g=g||{}).autoSize||!1,A=g.printHeaders!==!1,$=g.css&&g.css["font-size"]!==void 0?16*g.css["font-size"]:g.fontSize||12,D=g.margins||Object.assign({width:this.getPageWidth()},e),F=typeof g.padding=="number"?g.padding:3,L=g.headerBackgroundColor||"#c8c8c8",I=g.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=A,this.internal.__cell__.margins=D,this.internal.__cell__.table_font_size=$,this.internal.__cell__.padding=F,this.internal.__cell__.headerBackgroundColor=L,this.internal.__cell__.headerTextColor=I,this.setFontSize($),p==null)_=y=Object.keys(u[0]),S=y.map(function(){return"left"});else if(Array.isArray(p)&&Lt(p[0])==="object")for(y=p.map(function(ee){return ee.name}),_=p.map(function(ee){return ee.prompt||ee.name||""}),S=p.map(function(ee){return ee.align||"left"}),m=0;m<p.length;m+=1)T[p[m].name]=.7499990551181103*p[m].width;else Array.isArray(p)&&typeof p[0]=="string"&&(_=y=p,S=y.map(function(){return"left"}));if(b||Array.isArray(p)&&typeof p[0]=="string")for(m=0;m<y.length;m+=1){for(N[w=y[m]]=u.map(function(ee){return ee[w]}),this.setFont(void 0,"bold"),U.push(this.getTextDimensions(_[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),j=N[w],this.setFont(void 0,"normal"),k=0;k<j.length;k+=1)U.push(this.getTextDimensions(j[k],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);T[w]=Math.max.apply(null,U)+F+F,U=[]}if(A){var X={};for(m=0;m<y.length;m+=1)X[y[m]]={},X[y[m]].text=_[m],X[y[m]].align=S[m];var te=l.call(this,X,T);P=y.map(function(ee){return new i(c,d,T[ee],te,X[ee].text,void 0,X[ee].align)}),this.setTableHeaderRow(P),this.printHeaderRow(1,!1)}var oe=p.reduce(function(ee,de){return ee[de.name]=de.align,ee},{});for(m=0;m<u.length;m+=1){"rowStart"in g&&g.rowStart instanceof Function&&g.rowStart({row:m,data:u[m]},this);var Z=l.call(this,u[m],T);for(k=0;k<y.length;k+=1){var ae=u[m][y[k]];"cellStart"in g&&g.cellStart instanceof Function&&g.cellStart({row:m,col:k,data:ae},this),o.call(this,new i(c,d,T[y[k]],Z,ae,m+2,oe[y[k]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=d,this};var l=function(c,d){var u=this.internal.__cell__.padding,p=this.internal.__cell__.table_font_size,g=this.internal.scaleFactor;return Object.keys(c).map(function(m){var j=c[m];return this.splitTextToSize(j.hasOwnProperty("text")?j.text:j,d[m]-u-u)},this).map(function(m){return this.getLineHeightFactor()*m.length*p/g+u+u},this).reduce(function(m,j){return Math.max(m,j)},0)};t.setTableHeaderRow=function(c){r.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,d){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var p=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(p[0],p[1],p[2],p[3],void 0,-1)}this.setFont(void 0,"bold");for(var g=[],m=0;m<this.internal.__cell__.tableHeaderRow.length;m+=1){u=this.internal.__cell__.tableHeaderRow[m].clone(),d&&(u.y=this.internal.__cell__.margins.top||0,g.push(u)),u.lineNumber=c;var j=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,u),this.setTextColor(j)}g.length>0&&this.setTableHeaderRow(g),this.setFont(void 0,"normal"),n=!1}}(He.API);var _x={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},xx=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],fg=bx(xx),wx=[100,200,300,400,500,600,700,800,900],c8=bx(wx);function Fp(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),n=function(i){return _x[i=i||"normal"]?i:"normal"}(t.style),r=function(i){return i?typeof i=="number"?i>=100&&i<=900&&i%100==0?i:400:/^\d00$/.test(i)?parseInt(i):i==="bold"?700:400:400}(t.weight),s=function(i){return typeof fg[i=i||"normal"]=="number"?i:"normal"}(t.stretch);return{family:e,style:n,weight:r,stretch:s,src:t.src||[],ref:t.ref||{name:e,style:[s,n,r].join(" ")}}}function z2(t,e,n,r){var s;for(s=n;s>=0&&s<e.length;s+=r)if(t[e[s]])return t[e[s]];for(s=n;s>=0&&s<e.length;s-=r)if(t[e[s]])return t[e[s]]}var d8={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},W2={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function H2(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function V2(t){return t.trimLeft()}function u8(t,e){for(var n=0;n<t.length;){if(t.charAt(n)===e)return[t.substring(0,n),t.substring(n+1)];n+=1}return null}function h8(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var Eu,G2,K2,Bo,Du,Z2,Y2,J2,Mp=["times"];function X2(t,e,n,r,s){var i=4,o=ey;switch(s){case He.API.image_compression.FAST:i=1,o=Q2;break;case He.API.image_compression.MEDIUM:i=6,o=ty;break;case He.API.image_compression.SLOW:i=9,o=ny}t=function(c,d,u,p){for(var g,m=c.length/d,j=new Uint8Array(c.length+m),k=[f8,Q2,ey,ty,ny],w=0;w<m;w+=1){var y=w*d,_=c.subarray(y,y+d);if(p)j.set(p(_,u,g),y+w);else{for(var S=k.length,N=[],T=0;T<S;T+=1)N[T]=k[T](_,u,g);var U=m8(N.concat());j.set(N[U],y+w)}g=_}return j}(t,e,Math.ceil(n*r/8),o);var l=ig(t,{level:i});return He.API.__addimage__.arrayBufferToBinaryString(l)}function f8(t){var e=Array.apply([],t);return e.unshift(0),e}function Q2(t,e){var n=t.length,r=[];r[0]=1;for(var s=0;s<n;s+=1){var i=t[s-e]||0;r[s+1]=t[s]-i+256&255}return r}function ey(t,e,n){var r=t.length,s=[];s[0]=2;for(var i=0;i<r;i+=1){var o=n&&n[i]||0;s[i+1]=t[i]-o+256&255}return s}function ty(t,e,n){var r=t.length,s=[];s[0]=3;for(var i=0;i<r;i+=1){var o=t[i-e]||0,l=n&&n[i]||0;s[i+1]=t[i]+256-(o+l>>>1)&255}return s}function ny(t,e,n){var r=t.length,s=[];s[0]=4;for(var i=0;i<r;i+=1){var o=p8(t[i-e]||0,n&&n[i]||0,n&&n[i-e]||0);s[i+1]=t[i]-o+256&255}return s}function p8(t,e,n){if(t===e&&e===n)return t;var r=Math.abs(e-n),s=Math.abs(t-n),i=Math.abs(t+e-n-n);return r<=s&&r<=i?t:s<=i?e:n}function m8(t){var e=t.map(function(n){return n.reduce(function(r,s){return r+Math.abs(s)},0)});return e.indexOf(Math.min.apply(null,e))}function Bp(t,e,n){var r=e*n,s=Math.floor(r/8),i=16-(r-8*s+n),o=(1<<n)-1;return jx(t,s)>>i&o}function ry(t,e,n,r){var s=n*r,i=Math.floor(s/8),o=16-(s-8*i+r),l=(1<<r)-1,c=(e&l)<<o;(function(d,u,p){if(u+1<d.byteLength)d.setUint16(u,p,!1);else{var g=p>>8&255;d.setUint8(u,g)}})(t,i,jx(t,i)&~(l<<o)&65535|c)}function jx(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function g8(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=t[e++]|t[e++]<<8,r=t[e++]|t[e++]<<8,s=t[e++],i=s>>7,o=1<<1+(7&s);t[e++],t[e++];var l=null,c=null;i&&(l=e,c=o,e+=3*o);var d=!0,u=[],p=0,g=null,m=0,j=null;for(this.width=n,this.height=r;d&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,j=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((D=t[e++])>=0))throw Error("Invalid block size");if(D===0)break;e+=D}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var k=t[e++];p=t[e++]|t[e++]<<8,g=t[e++],1&k||(g=null),m=k>>2&7,e++;break;case 254:for(;;){if(!((D=t[e++])>=0))throw Error("Invalid block size");if(D===0)break;e+=D}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var w=t[e++]|t[e++]<<8,y=t[e++]|t[e++]<<8,_=t[e++]|t[e++]<<8,S=t[e++]|t[e++]<<8,N=t[e++],T=N>>6&1,U=1<<1+(7&N),P=l,b=c,A=!1;N>>7&&(A=!0,P=e,b=U,e+=3*U);var $=e;for(e++;;){var D;if(!((D=t[e++])>=0))throw Error("Invalid block size");if(D===0)break;e+=D}u.push({x:w,y,width:_,height:S,has_local_palette:A,palette_offset:P,palette_size:b,data_offset:$,data_length:e-$,transparent_index:g,interlaced:!!T,delay:p,disposal:m});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return j},this.frameInfo=function(F){if(F<0||F>=u.length)throw new Error("Frame index out of range.");return u[F]},this.decodeAndBlitFrameBGRA=function(F,L){var I=this.frameInfo(F),X=I.width*I.height,te=new Uint8Array(X);sy(t,I.data_offset,te,X);var oe=I.palette_offset,Z=I.transparent_index;Z===null&&(Z=256);var ae=I.width,ee=n-ae,de=ae,E=4*(I.y*n+I.x),H=4*((I.y+I.height)*n+I.x),J=E,V=4*ee;I.interlaced===!0&&(V+=4*n*7);for(var ne=8,le=0,me=te.length;le<me;++le){var re=te[le];if(de===0&&(de=ae,(J+=V)>=H&&(V=4*ee+4*n*(ne-1),J=E+(ae+ee)*(ne<<1),ne>>=1)),re===Z)J+=4;else{var fe=t[oe+3*re],_e=t[oe+3*re+1],ke=t[oe+3*re+2];L[J++]=ke,L[J++]=_e,L[J++]=fe,L[J++]=255}--de}},this.decodeAndBlitFrameRGBA=function(F,L){var I=this.frameInfo(F),X=I.width*I.height,te=new Uint8Array(X);sy(t,I.data_offset,te,X);var oe=I.palette_offset,Z=I.transparent_index;Z===null&&(Z=256);var ae=I.width,ee=n-ae,de=ae,E=4*(I.y*n+I.x),H=4*((I.y+I.height)*n+I.x),J=E,V=4*ee;I.interlaced===!0&&(V+=4*n*7);for(var ne=8,le=0,me=te.length;le<me;++le){var re=te[le];if(de===0&&(de=ae,(J+=V)>=H&&(V=4*ee+4*n*(ne-1),J=E+(ae+ee)*(ne<<1),ne>>=1)),re===Z)J+=4;else{var fe=t[oe+3*re],_e=t[oe+3*re+1],ke=t[oe+3*re+2];L[J++]=fe,L[J++]=_e,L[J++]=ke,L[J++]=255}--de}}}function sy(t,e,n,r){for(var s=t[e++],i=1<<s,o=i+1,l=o+1,c=s+1,d=(1<<c)-1,u=0,p=0,g=0,m=t[e++],j=new Int32Array(4096),k=null;;){for(;u<16&&m!==0;)p|=t[e++]<<u,u+=8,m===1?m=t[e++]:--m;if(u<c)break;var w=p&d;if(p>>=c,u-=c,w!==i){if(w===o)break;for(var y=w<l?w:k,_=0,S=y;S>i;)S=j[S]>>8,++_;var N=S;if(g+_+(y!==w?1:0)>r)return void Ft.log("Warning, gif stream longer than expected.");n[g++]=N;var T=g+=_;for(y!==w&&(n[g++]=N),S=y;_--;)S=j[S],n[--T]=255&S,S>>=8;k!==null&&l<4096&&(j[l++]=k<<8|N,l>=d+1&&c<12&&(++c,d=d<<1|1)),k=w}else l=o+1,d=(1<<(c=s+1))-1,k=null}return g!==r&&Ft.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Up(t){var e,n,r,s,i,o=Math.floor,l=new Array(64),c=new Array(64),d=new Array(64),u=new Array(64),p=new Array(65535),g=new Array(65535),m=new Array(64),j=new Array(64),k=[],w=0,y=7,_=new Array(64),S=new Array(64),N=new Array(64),T=new Array(256),U=new Array(2048),P=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],b=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],A=[0,1,2,3,4,5,6,7,8,9,10,11],$=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],D=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],F=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],L=[0,1,2,3,4,5,6,7,8,9,10,11],I=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],X=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function te(E,H){for(var J=0,V=0,ne=new Array,le=1;le<=16;le++){for(var me=1;me<=E[le];me++)ne[H[V]]=[],ne[H[V]][0]=J,ne[H[V]][1]=le,V++,J++;J*=2}return ne}function oe(E){for(var H=E[0],J=E[1]-1;J>=0;)H&1<<J&&(w|=1<<y),J--,--y<0&&(w==255?(Z(255),Z(0)):Z(w),y=7,w=0)}function Z(E){k.push(E)}function ae(E){Z(E>>8&255),Z(255&E)}function ee(E,H,J,V,ne){for(var le,me=ne[0],re=ne[240],fe=function(ue,Te){var Pe,Xe,Fe,Ye,Qe,Je,Et,ot,Ue,et,Ge=0;for(Ue=0;Ue<8;++Ue){Pe=ue[Ge],Xe=ue[Ge+1],Fe=ue[Ge+2],Ye=ue[Ge+3],Qe=ue[Ge+4],Je=ue[Ge+5],Et=ue[Ge+6];var Mt=Pe+(ot=ue[Ge+7]),St=Pe-ot,ze=Xe+Et,dt=Xe-Et,It=Fe+Je,Ke=Fe-Je,bt=Ye+Qe,ut=Ye-Qe,dn=Mt+bt,Cn=Mt-bt,Rt=ze+It,at=ze-It;ue[Ge]=dn+Rt,ue[Ge+4]=dn-Rt;var Nt=.707106781*(at+Cn);ue[Ge+2]=Cn+Nt,ue[Ge+6]=Cn-Nt;var _i=.382683433*((dn=ut+Ke)-(at=dt+St)),Xn=.5411961*dn+_i,Gs=1.306562965*at+_i,As=.707106781*(Rt=Ke+dt),Ze=St+As,Ks=St-As;ue[Ge+5]=Ks+Xn,ue[Ge+3]=Ks-Xn,ue[Ge+1]=Ze+Gs,ue[Ge+7]=Ze-Gs,Ge+=8}for(Ge=0,Ue=0;Ue<8;++Ue){Pe=ue[Ge],Xe=ue[Ge+8],Fe=ue[Ge+16],Ye=ue[Ge+24],Qe=ue[Ge+32],Je=ue[Ge+40],Et=ue[Ge+48];var Zs=Pe+(ot=ue[Ge+56]),Wr=Pe-ot,Hr=Xe+Et,nn=Xe-Et,qn=Fe+Je,Bn=Fe-Je,xi=Ye+Qe,ka=Ye-Qe,cs=Zs+xi,Es=Zs-xi,ds=Hr+qn,us=Hr-qn;ue[Ge]=cs+ds,ue[Ge+32]=cs-ds;var Vr=.707106781*(us+Es);ue[Ge+16]=Es+Vr,ue[Ge+48]=Es-Vr;var wi=.382683433*((cs=ka+Bn)-(us=nn+Wr)),Ds=.5411961*cs+wi,ji=1.306562965*us+wi,bo=.707106781*(ds=Bn+nn),_o=Wr+bo,xo=Wr-bo;ue[Ge+40]=xo+Ds,ue[Ge+24]=xo-Ds,ue[Ge+8]=_o+ji,ue[Ge+56]=_o-ji,Ge++}for(Ue=0;Ue<64;++Ue)et=ue[Ue]*Te[Ue],m[Ue]=et>0?et+.5|0:et-.5|0;return m}(E,H),_e=0;_e<64;++_e)j[P[_e]]=fe[_e];var ke=j[0]-J;J=j[0],ke==0?oe(V[0]):(oe(V[g[le=32767+ke]]),oe(p[le]));for(var Ae=63;Ae>0&&j[Ae]==0;)Ae--;if(Ae==0)return oe(me),J;for(var ye,Q=1;Q<=Ae;){for(var st=Q;j[Q]==0&&Q<=Ae;)++Q;var nt=Q-st;if(nt>=16){ye=nt>>4;for(var Ve=1;Ve<=ye;++Ve)oe(re);nt&=15}le=32767+j[Q],oe(ne[(nt<<4)+g[le]]),oe(p[le]),Q++}return Ae!=63&&oe(me),J}function de(E){E=Math.min(Math.max(E,1),100),i!=E&&(function(H){for(var J=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],V=0;V<64;V++){var ne=o((J[V]*H+50)/100);ne=Math.min(Math.max(ne,1),255),l[P[V]]=ne}for(var le=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],me=0;me<64;me++){var re=o((le[me]*H+50)/100);re=Math.min(Math.max(re,1),255),c[P[me]]=re}for(var fe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],_e=0,ke=0;ke<8;ke++)for(var Ae=0;Ae<8;Ae++)d[_e]=1/(l[P[_e]]*fe[ke]*fe[Ae]*8),u[_e]=1/(c[P[_e]]*fe[ke]*fe[Ae]*8),_e++}(E<50?Math.floor(5e3/E):Math.floor(200-2*E)),i=E)}this.encode=function(E,H){H&&de(H),k=new Array,w=0,y=7,ae(65496),ae(65504),ae(16),Z(74),Z(70),Z(73),Z(70),Z(0),Z(1),Z(1),Z(0),ae(1),ae(1),Z(0),Z(0),function(){ae(65499),ae(132),Z(0);for(var Xe=0;Xe<64;Xe++)Z(l[Xe]);Z(1);for(var Fe=0;Fe<64;Fe++)Z(c[Fe])}(),function(Xe,Fe){ae(65472),ae(17),Z(8),ae(Fe),ae(Xe),Z(3),Z(1),Z(17),Z(0),Z(2),Z(17),Z(1),Z(3),Z(17),Z(1)}(E.width,E.height),function(){ae(65476),ae(418),Z(0);for(var Xe=0;Xe<16;Xe++)Z(b[Xe+1]);for(var Fe=0;Fe<=11;Fe++)Z(A[Fe]);Z(16);for(var Ye=0;Ye<16;Ye++)Z($[Ye+1]);for(var Qe=0;Qe<=161;Qe++)Z(D[Qe]);Z(1);for(var Je=0;Je<16;Je++)Z(F[Je+1]);for(var Et=0;Et<=11;Et++)Z(L[Et]);Z(17);for(var ot=0;ot<16;ot++)Z(I[ot+1]);for(var Ue=0;Ue<=161;Ue++)Z(X[Ue])}(),ae(65498),ae(12),Z(3),Z(1),Z(0),Z(2),Z(17),Z(3),Z(17),Z(0),Z(63),Z(0);var J=0,V=0,ne=0;w=0,y=7,this.encode.displayName="_encode_";for(var le,me,re,fe,_e,ke,Ae,ye,Q,st=E.data,nt=E.width,Ve=E.height,ue=4*nt,Te=0;Te<Ve;){for(le=0;le<ue;){for(_e=ue*Te+le,Ae=-1,ye=0,Q=0;Q<64;Q++)ke=_e+(ye=Q>>3)*ue+(Ae=4*(7&Q)),Te+ye>=Ve&&(ke-=ue*(Te+1+ye-Ve)),le+Ae>=ue&&(ke-=le+Ae-ue+4),me=st[ke++],re=st[ke++],fe=st[ke++],_[Q]=(U[me]+U[re+256|0]+U[fe+512|0]>>16)-128,S[Q]=(U[me+768|0]+U[re+1024|0]+U[fe+1280|0]>>16)-128,N[Q]=(U[me+1280|0]+U[re+1536|0]+U[fe+1792|0]>>16)-128;J=ee(_,d,J,e,r),V=ee(S,u,V,n,s),ne=ee(N,u,ne,n,s),le+=32}Te+=8}if(y>=0){var Pe=[];Pe[1]=y+1,Pe[0]=(1<<y+1)-1,oe(Pe)}return ae(65497),new Uint8Array(k)},t=t||50,function(){for(var E=String.fromCharCode,H=0;H<256;H++)T[H]=E(H)}(),e=te(b,A),n=te(F,L),r=te($,D),s=te(I,X),function(){for(var E=1,H=2,J=1;J<=15;J++){for(var V=E;V<H;V++)g[32767+V]=J,p[32767+V]=[],p[32767+V][1]=J,p[32767+V][0]=V;for(var ne=-(H-1);ne<=-E;ne++)g[32767+ne]=J,p[32767+ne]=[],p[32767+ne][1]=J,p[32767+ne][0]=H-1+ne;E<<=1,H<<=1}}(),function(){for(var E=0;E<256;E++)U[E]=19595*E,U[E+256|0]=38470*E,U[E+512|0]=7471*E+32768,U[E+768|0]=-11059*E,U[E+1024|0]=-21709*E,U[E+1280|0]=32768*E+8421375,U[E+1536|0]=-27439*E,U[E+1792|0]=-5329*E}(),de(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function vs(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function ay(t){function e(A){if(!A)throw Error("assert :P")}function n(A,$,D){for(var F=0;4>F;F++)if(A[$+F]!=D.charCodeAt(F))return!0;return!1}function r(A,$,D,F,L){for(var I=0;I<L;I++)A[$+I]=D[F+I]}function s(A,$,D,F){for(var L=0;L<F;L++)A[$+L]=D}function i(A){return new Int32Array(A)}function o(A,$){for(var D=[],F=0;F<A;F++)D.push(new $);return D}function l(A,$){var D=[];return function F(L,I,X){for(var te=X[I],oe=0;oe<te&&(L.push(X.length>I+1?[]:new $),!(X.length<I+1));oe++)F(L[oe],I+1,X)}(D,0,A),D}var c=function(){var A=this;function $(h,f){for(var x=1<<f-1>>>0;h&x;)x>>>=1;return x?(h&x-1)+x:h}function D(h,f,x,C,q){e(!(C%x));do h[f+(C-=x)]=q;while(0<C)}function F(h,f,x,C,q){if(e(2328>=q),512>=q)var M=i(512);else if((M=i(q))==null)return 0;return function(B,z,W,G,ie,ve){var K,ce,pe=z,xe=1<<W,ge=i(16),we=i(16);for(e(ie!=0),e(G!=null),e(B!=null),e(0<W),ce=0;ce<ie;++ce){if(15<G[ce])return 0;++ge[G[ce]]}if(ge[0]==ie)return 0;for(we[1]=0,K=1;15>K;++K){if(ge[K]>1<<K)return 0;we[K+1]=we[K]+ge[K]}for(ce=0;ce<ie;++ce)K=G[ce],0<G[ce]&&(ve[we[K]++]=ce);if(we[15]==1)return(G=new L).g=0,G.value=ve[0],D(B,pe,1,xe,G),xe;var Se,Ee=-1,Ne=xe-1,We=0,Re=1,pt=1,Me=1<<W;for(ce=0,K=1,ie=2;K<=W;++K,ie<<=1){if(Re+=pt<<=1,0>(pt-=ge[K]))return 0;for(;0<ge[K];--ge[K])(G=new L).g=K,G.value=ve[ce++],D(B,pe+We,ie,Me,G),We=$(We,K)}for(K=W+1,ie=2;15>=K;++K,ie<<=1){if(Re+=pt<<=1,0>(pt-=ge[K]))return 0;for(;0<ge[K];--ge[K]){if(G=new L,(We&Ne)!=Ee){for(pe+=Me,Se=1<<(Ee=K)-W;15>Ee&&!(0>=(Se-=ge[Ee]));)++Ee,Se<<=1;xe+=Me=1<<(Se=Ee-W),B[z+(Ee=We&Ne)].g=Se+W,B[z+Ee].value=pe-z-Ee}G.g=K-W,G.value=ve[ce++],D(B,pe+(We>>W),ie,Me,G),We=$(We,K)}}return Re!=2*we[15]-1?0:xe}(h,f,x,C,q,M)}function L(){this.value=this.g=0}function I(){this.value=this.g=0}function X(){this.G=o(5,L),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Bi,I)}function te(h,f,x,C){e(h!=null),e(f!=null),e(2147483648>C),h.Ca=254,h.I=0,h.b=-8,h.Ka=0,h.oa=f,h.pa=x,h.Jd=f,h.Yc=x+C,h.Zc=4<=C?x+C-4+1:x,me(h)}function oe(h,f){for(var x=0;0<f--;)x|=fe(h,128)<<f;return x}function Z(h,f){var x=oe(h,f);return re(h)?-x:x}function ae(h,f,x,C){var q,M=0;for(e(h!=null),e(f!=null),e(4294967288>C),h.Sb=C,h.Ra=0,h.u=0,h.h=0,4<C&&(C=4),q=0;q<C;++q)M+=f[x+q]<<8*q;h.Ra=M,h.bb=C,h.oa=f,h.pa=x}function ee(h){for(;8<=h.u&&h.bb<h.Sb;)h.Ra>>>=8,h.Ra+=h.oa[h.pa+h.bb]<<Da-8>>>0,++h.bb,h.u-=8;V(h)&&(h.h=1,h.u=0)}function de(h,f){if(e(0<=f),!h.h&&f<=Er){var x=J(h)&Ar[f];return h.u+=f,ee(h),x}return h.h=1,h.u=0}function E(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function H(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function J(h){return h.Ra>>>(h.u&Da-1)>>>0}function V(h){return e(h.bb<=h.Sb),h.h||h.bb==h.Sb&&h.u>Da}function ne(h,f){h.u=f,h.h=V(h)}function le(h){h.u>=na&&(e(h.u>=na),ee(h))}function me(h){e(h!=null&&h.oa!=null),h.pa<h.Zc?(h.I=(h.oa[h.pa++]|h.I<<8)>>>0,h.b+=8):(e(h!=null&&h.oa!=null),h.pa<h.Yc?(h.b+=8,h.I=h.oa[h.pa++]|h.I<<8):h.Ka?h.b=0:(h.I<<=8,h.b+=8,h.Ka=1))}function re(h){return oe(h,1)}function fe(h,f){var x=h.Ca;0>h.b&&me(h);var C=h.b,q=x*f>>>8,M=(h.I>>>C>q)+0;for(M?(x-=q,h.I-=q+1<<C>>>0):x=q+1,C=x,q=0;256<=C;)q+=8,C>>=8;return C=7^q+Pa[C],h.b-=C,h.Ca=(x<<C)-1,M}function _e(h,f,x){h[f+0]=x>>24&255,h[f+1]=x>>16&255,h[f+2]=x>>8&255,h[f+3]=255&x}function ke(h,f){return h[f+0]|h[f+1]<<8}function Ae(h,f){return ke(h,f)|h[f+2]<<16}function ye(h,f){return ke(h,f)|ke(h,f+2)<<16}function Q(h,f){var x=1<<f;return e(h!=null),e(0<f),h.X=i(x),h.X==null?0:(h.Mb=32-f,h.Xa=f,1)}function st(h,f){e(h!=null),e(f!=null),e(h.Xa==f.Xa),r(f.X,0,h.X,0,1<<f.Xa)}function nt(){this.X=[],this.Xa=this.Mb=0}function Ve(h,f,x,C){e(x!=null),e(C!=null);var q=x[0],M=C[0];return q==0&&(q=(h*M+f/2)/f),M==0&&(M=(f*q+h/2)/h),0>=q||0>=M?0:(x[0]=q,C[0]=M,1)}function ue(h,f){return h+(1<<f)-1>>>f}function Te(h,f){return((4278255360&h)+(4278255360&f)>>>0&4278255360)+((16711935&h)+(16711935&f)>>>0&16711935)>>>0}function Pe(h,f){A[f]=function(x,C,q,M,B,z,W){var G;for(G=0;G<B;++G){var ie=A[h](z[W+G-1],q,M+G);z[W+G]=Te(x[C+G],ie)}}}function Xe(){this.ud=this.hd=this.jd=0}function Fe(h,f){return((4278124286&(h^f))>>>1)+(h&f)>>>0}function Ye(h){return 0<=h&&256>h?h:0>h?0:255<h?255:void 0}function Qe(h,f){return Ye(h+(h-f+.5>>1))}function Je(h,f,x){return Math.abs(f-x)-Math.abs(h-x)}function Et(h,f,x,C,q,M,B){for(C=M[B-1],x=0;x<q;++x)M[B+x]=C=Te(h[f+x],C)}function ot(h,f,x,C,q){var M;for(M=0;M<x;++M){var B=h[f+M],z=B>>8&255,W=16711935&(W=(W=16711935&B)+((z<<16)+z));C[q+M]=(4278255360&B)+W>>>0}}function Ue(h,f){f.jd=255&h,f.hd=h>>8&255,f.ud=h>>16&255}function et(h,f,x,C,q,M){var B;for(B=0;B<C;++B){var z=f[x+B],W=z>>>8,G=z,ie=255&(ie=(ie=z>>>16)+((h.jd<<24>>24)*(W<<24>>24)>>>5));G=255&(G=(G+=(h.hd<<24>>24)*(W<<24>>24)>>>5)+((h.ud<<24>>24)*(ie<<24>>24)>>>5)),q[M+B]=(4278255360&z)+(ie<<16)+G}}function Ge(h,f,x,C,q){A[f]=function(M,B,z,W,G,ie,ve,K,ce){for(W=ve;W<K;++W)for(ve=0;ve<ce;++ve)G[ie++]=q(z[C(M[B++])])},A[h]=function(M,B,z,W,G,ie,ve){var K=8>>M.b,ce=M.Ea,pe=M.K[0],xe=M.w;if(8>K)for(M=(1<<M.b)-1,xe=(1<<K)-1;B<z;++B){var ge,we=0;for(ge=0;ge<ce;++ge)ge&M||(we=C(W[G++])),ie[ve++]=q(pe[we&xe]),we>>=K}else A["VP8LMapColor"+x](W,G,pe,xe,ie,ve,B,z,ce)}}function Mt(h,f,x,C,q){for(x=f+x;f<x;){var M=h[f++];C[q++]=M>>16&255,C[q++]=M>>8&255,C[q++]=255&M}}function St(h,f,x,C,q){for(x=f+x;f<x;){var M=h[f++];C[q++]=M>>16&255,C[q++]=M>>8&255,C[q++]=255&M,C[q++]=M>>24&255}}function ze(h,f,x,C,q){for(x=f+x;f<x;){var M=(B=h[f++])>>16&240|B>>12&15,B=240&B|B>>28&15;C[q++]=M,C[q++]=B}}function dt(h,f,x,C,q){for(x=f+x;f<x;){var M=(B=h[f++])>>16&248|B>>13&7,B=B>>5&224|B>>3&31;C[q++]=M,C[q++]=B}}function It(h,f,x,C,q){for(x=f+x;f<x;){var M=h[f++];C[q++]=255&M,C[q++]=M>>8&255,C[q++]=M>>16&255}}function Ke(h,f,x,C,q,M){if(M==0)for(x=f+x;f<x;)_e(C,((M=h[f++])[0]>>24|M[1]>>8&65280|M[2]<<8&16711680|M[3]<<24)>>>0),q+=32;else r(C,q,h,f,x)}function bt(h,f){A[f][0]=A[h+"0"],A[f][1]=A[h+"1"],A[f][2]=A[h+"2"],A[f][3]=A[h+"3"],A[f][4]=A[h+"4"],A[f][5]=A[h+"5"],A[f][6]=A[h+"6"],A[f][7]=A[h+"7"],A[f][8]=A[h+"8"],A[f][9]=A[h+"9"],A[f][10]=A[h+"10"],A[f][11]=A[h+"11"],A[f][12]=A[h+"12"],A[f][13]=A[h+"13"],A[f][14]=A[h+"0"],A[f][15]=A[h+"0"]}function ut(h){return h==kf||h==Nf||h==Hd||h==Cf}function dn(){this.eb=[],this.size=this.A=this.fb=0}function Cn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Rt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new dn,this.f.kb=new Cn,this.sd=null}function at(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Nt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function _i(h){return alert("todo:WebPSamplerProcessPlane"),h.T}function Xn(h,f){var x=h.T,C=f.ba.f.RGBA,q=C.eb,M=C.fb+h.ka*C.A,B=Xr[f.ba.S],z=h.y,W=h.O,G=h.f,ie=h.N,ve=h.ea,K=h.W,ce=f.cc,pe=f.dc,xe=f.Mc,ge=f.Nc,we=h.ka,Se=h.ka+h.T,Ee=h.U,Ne=Ee+1>>1;for(we==0?B(z,W,null,null,G,ie,ve,K,G,ie,ve,K,q,M,null,null,Ee):(B(f.ec,f.fc,z,W,ce,pe,xe,ge,G,ie,ve,K,q,M-C.A,q,M,Ee),++x);we+2<Se;we+=2)ce=G,pe=ie,xe=ve,ge=K,ie+=h.Rc,K+=h.Rc,M+=2*C.A,B(z,(W+=2*h.fa)-h.fa,z,W,ce,pe,xe,ge,G,ie,ve,K,q,M-C.A,q,M,Ee);return W+=h.fa,h.j+Se<h.o?(r(f.ec,f.fc,z,W,Ee),r(f.cc,f.dc,G,ie,Ne),r(f.Mc,f.Nc,ve,K,Ne),x--):1&Se||B(z,W,null,null,G,ie,ve,K,G,ie,ve,K,q,M+C.A,null,null,Ee),x}function Gs(h,f,x){var C=h.F,q=[h.J];if(C!=null){var M=h.U,B=f.ba.S,z=B==Wd||B==Hd;f=f.ba.f.RGBA;var W=[0],G=h.ka;W[0]=h.T,h.Kb&&(G==0?--W[0]:(--G,q[0]-=h.width),h.j+h.ka+h.T==h.o&&(W[0]=h.o-h.j-G));var ie=f.eb;G=f.fb+G*f.A,h=q0(C,q[0],h.width,M,W,ie,G+(z?0:3),f.A),e(x==W),h&&ut(B)&&rc(ie,G,z,M,W,f.A)}return 0}function As(h){var f=h.ma,x=f.ba.S,C=11>x,q=x==$d||x==zd||x==Wd||x==Sf||x==12||ut(x);if(f.memory=null,f.Ib=null,f.Jb=null,f.Nd=null,!Zl(f.Oa,h,q?11:12))return 0;if(q&&ut(x)&&qd(),h.da)alert("todo:use_scaling");else{if(C){if(f.Ib=_i,h.Kb){if(x=h.U+1>>1,f.memory=i(h.U+2*x),f.memory==null)return 0;f.ec=f.memory,f.fc=0,f.cc=f.ec,f.dc=f.fc+h.U,f.Mc=f.cc,f.Nc=f.dc+x,f.Ib=Xn,qd()}}else alert("todo:EmitYUV");q&&(f.Jb=Gs,C&&Kr())}if(C&&!X0){for(h=0;256>h;++h)sw[h]=89858*(h-128)+Gd>>Vd,ow[h]=-22014*(h-128)+Gd,iw[h]=-45773*(h-128),aw[h]=113618*(h-128)+Gd>>Vd;for(h=ac;h<Df;++h)f=76283*(h-16)+Gd>>Vd,lw[h-ac]=rn(f,255),cw[h-ac]=rn(f+8>>4,15);X0=1}return 1}function Ze(h){var f=h.ma,x=h.U,C=h.T;return e(!(1&h.ka)),0>=x||0>=C?0:(x=f.Ib(h,f),f.Jb!=null&&f.Jb(h,f,x),f.Dc+=x,1)}function Ks(h){h.ma.memory=null}function Zs(h,f,x,C){return de(h,8)!=47?0:(f[0]=de(h,14)+1,x[0]=de(h,14)+1,C[0]=de(h,1),de(h,3)!=0?0:!h.h)}function Wr(h,f){if(4>h)return h+1;var x=h-2>>1;return(2+(1&h)<<x)+de(f,x)+1}function Hr(h,f){return 120<f?f-120:1<=(x=((x=Wx[f-1])>>4)*h+(8-(15&x)))?x:1;var x}function nn(h,f,x){var C=J(x),q=h[f+=255&C].g-8;return 0<q&&(ne(x,x.u+8),C=J(x),f+=h[f].value,f+=C&(1<<q)-1),ne(x,x.u+h[f].g),h[f].value}function qn(h,f,x){return x.g+=h.g,x.value+=h.value<<f>>>0,e(8>=x.g),h.g}function Bn(h,f,x){var C=h.xc;return e((f=C==0?0:h.vc[h.md*(x>>C)+(f>>C)])<h.Wb),h.Ya[f]}function xi(h,f,x,C){var q=h.ab,M=h.c*f,B=h.C;f=B+f;var z=x,W=C;for(C=h.Ta,x=h.Ua;0<q--;){var G=h.gc[q],ie=B,ve=f,K=z,ce=W,pe=(W=C,z=x,G.Ea);switch(e(ie<ve),e(ve<=G.nc),G.hc){case 2:hn(K,ce,(ve-ie)*pe,W,z);break;case 0:var xe=ie,ge=ve,we=W,Se=z,Ee=(Me=G).Ea;xe==0&&(Jl(K,ce,null,null,1,we,Se),Et(K,ce+1,0,0,Ee-1,we,Se+1),ce+=Ee,Se+=Ee,++xe);for(var Ne=1<<Me.b,We=Ne-1,Re=ue(Ee,Me.b),pt=Me.K,Me=Me.w+(xe>>Me.b)*Re;xe<ge;){var _t=pt,Dn=Me,mt=1;for(Eo(K,ce,we,Se-Ee,1,we,Se);mt<Ee;){var Be=(mt&~We)+Ne;Be>Ee&&(Be=Ee),(0,Ql[_t[Dn++]>>8&15])(K,ce+ +mt,we,Se+mt-Ee,Be-mt,we,Se+mt),mt=Be}ce+=Ee,Se+=Ee,++xe&We||(Me+=Re)}ve!=G.nc&&r(W,z-pe,W,z+(ve-ie-1)*pe,pe);break;case 1:for(pe=K,ge=ce,Ee=(K=G.Ea)-(Se=K&~(we=(ce=1<<G.b)-1)),xe=ue(K,G.b),Ne=G.K,G=G.w+(ie>>G.b)*xe;ie<ve;){for(We=Ne,Re=G,pt=new Xe,Me=ge+Se,_t=ge+K;ge<Me;)Ue(We[Re++],pt),ec(pt,pe,ge,ce,W,z),ge+=ce,z+=ce;ge<_t&&(Ue(We[Re++],pt),ec(pt,pe,ge,Ee,W,z),ge+=Ee,z+=Ee),++ie&we||(G+=xe)}break;case 3:if(K==W&&ce==z&&0<G.b){for(ge=W,K=pe=z+(ve-ie)*pe-(Se=(ve-ie)*ue(G.Ea,G.b)),ce=W,we=z,xe=[],Se=(Ee=Se)-1;0<=Se;--Se)xe[Se]=ce[we+Se];for(Se=Ee-1;0<=Se;--Se)ge[K+Se]=xe[Se];Fd(G,ie,ve,W,pe,W,z)}else Fd(G,ie,ve,K,ce,W,z)}z=C,W=x}W!=x&&r(C,x,z,W,M)}function ka(h,f){var x=h.V,C=h.Ba+h.c*h.C,q=f-h.C;if(e(f<=h.l.o),e(16>=q),0<q){var M=h.l,B=h.Ta,z=h.Ua,W=M.width;if(xi(h,q,x,C),q=z=[z],e((x=h.C)<(C=f)),e(M.v<M.va),C>M.o&&(C=M.o),x<M.j){var G=M.j-x;x=M.j,q[0]+=G*W}if(x>=C?x=0:(q[0]+=4*M.v,M.ka=x-M.j,M.U=M.va-M.v,M.T=C-x,x=1),x){if(z=z[0],11>(x=h.ca).S){var ie=x.f.RGBA,ve=(C=x.S,q=M.U,M=M.T,G=ie.eb,ie.A),K=M;for(ie=ie.fb+h.Ma*ie.A;0<K--;){var ce=B,pe=z,xe=q,ge=G,we=ie;switch(C){case Ud:tc(ce,pe,xe,ge,we);break;case $d:La(ce,pe,xe,ge,we);break;case kf:La(ce,pe,xe,ge,we),rc(ge,we,0,xe,1,0);break;case z0:Ui(ce,pe,xe,ge,we);break;case zd:Ke(ce,pe,xe,ge,we,1);break;case Nf:Ke(ce,pe,xe,ge,we,1),rc(ge,we,0,xe,1,0);break;case Wd:Ke(ce,pe,xe,ge,we,0);break;case Hd:Ke(ce,pe,xe,ge,we,0),rc(ge,we,1,xe,1,0);break;case Sf:Ta(ce,pe,xe,ge,we);break;case Cf:Ta(ce,pe,xe,ge,we),R0(ge,we,xe,1,0);break;case W0:Ia(ce,pe,xe,ge,we);break;default:e(0)}z+=W,ie+=ve}h.Ma+=M}else alert("todo:EmitRescaledRowsYUVA");e(h.Ma<=x.height)}}h.C=f,e(h.C<=h.i)}function cs(h){var f;if(0<h.ua)return 0;for(f=0;f<h.Wb;++f){var x=h.Ya[f].G,C=h.Ya[f].H;if(0<x[1][C[1]+0].g||0<x[2][C[2]+0].g||0<x[3][C[3]+0].g)return 0}return 1}function Es(h,f,x,C,q,M){if(h.Z!=0){var B=h.qd,z=h.rd;for(e(Oa[h.Z]!=null);f<x;++f)Oa[h.Z](B,z,C,q,C,q,M),B=C,z=q,q+=M;h.qd=B,h.rd=z}}function ds(h,f){var x=h.l.ma,C=x.Z==0||x.Z==1?h.l.j:h.C;if(C=h.C<C?C:h.C,e(f<=h.l.o),f>C){var q=h.l.width,M=x.ca,B=x.tb+q*C,z=h.V,W=h.Ba+h.c*C,G=h.gc;e(h.ab==1),e(G[0].hc==3),Ts(G[0],C,f,z,W,M,B),Es(x,C,f,M,B,q)}h.C=h.Ma=f}function us(h,f,x,C,q,M,B){var z=h.$/C,W=h.$%C,G=h.m,ie=h.s,ve=x+h.$,K=ve;q=x+C*q;var ce=x+C*M,pe=280+ie.ua,xe=h.Pb?z:16777216,ge=0<ie.ua?ie.Wa:null,we=ie.wc,Se=ve<ce?Bn(ie,W,z):null;e(h.C<M),e(ce<=q);var Ee=!1;e:for(;;){for(;Ee||ve<ce;){var Ne=0;if(z>=xe){var We=ve-x;e((xe=h).Pb),xe.wd=xe.m,xe.xd=We,0<xe.s.ua&&st(xe.s.Wa,xe.s.vb),xe=z+Vx}if(W&we||(Se=Bn(ie,W,z)),e(Se!=null),Se.Qb&&(f[ve]=Se.qb,Ee=!0),!Ee)if(le(G),Se.jc){Ne=G,We=f;var Re=ve,pt=Se.pd[J(Ne)&Bi-1];e(Se.jc),256>pt.g?(ne(Ne,Ne.u+pt.g),We[Re]=pt.value,Ne=0):(ne(Ne,Ne.u+pt.g-256),e(256<=pt.value),Ne=pt.value),Ne==0&&(Ee=!0)}else Ne=nn(Se.G[0],Se.H[0],G);if(G.h)break;if(Ee||256>Ne){if(!Ee)if(Se.nd)f[ve]=(Se.qb|Ne<<8)>>>0;else{if(le(G),Ee=nn(Se.G[1],Se.H[1],G),le(G),We=nn(Se.G[2],Se.H[2],G),Re=nn(Se.G[3],Se.H[3],G),G.h)break;f[ve]=(Re<<24|Ee<<16|Ne<<8|We)>>>0}if(Ee=!1,++ve,++W>=C&&(W=0,++z,B!=null&&z<=M&&!(z%16)&&B(h,z),ge!=null))for(;K<ve;)Ne=f[K++],ge.X[(506832829*Ne&4294967295)>>>ge.Mb]=Ne}else if(280>Ne){if(Ne=Wr(Ne-256,G),We=nn(Se.G[4],Se.H[4],G),le(G),We=Hr(C,We=Wr(We,G)),G.h)break;if(ve-x<We||q-ve<Ne)break e;for(Re=0;Re<Ne;++Re)f[ve+Re]=f[ve+Re-We];for(ve+=Ne,W+=Ne;W>=C;)W-=C,++z,B!=null&&z<=M&&!(z%16)&&B(h,z);if(e(ve<=q),W&we&&(Se=Bn(ie,W,z)),ge!=null)for(;K<ve;)Ne=f[K++],ge.X[(506832829*Ne&4294967295)>>>ge.Mb]=Ne}else{if(!(Ne<pe))break e;for(Ee=Ne-280,e(ge!=null);K<ve;)Ne=f[K++],ge.X[(506832829*Ne&4294967295)>>>ge.Mb]=Ne;Ne=ve,e(!(Ee>>>(We=ge).Xa)),f[Ne]=We.X[Ee],Ee=!0}Ee||e(G.h==V(G))}if(h.Pb&&G.h&&ve<q)e(h.m.h),h.a=5,h.m=h.wd,h.$=h.xd,0<h.s.ua&&st(h.s.vb,h.s.Wa);else{if(G.h)break e;B!=null&&B(h,z>M?M:z),h.a=0,h.$=ve-x}return 1}return h.a=3,0}function Vr(h){e(h!=null),h.vc=null,h.yc=null,h.Ya=null;var f=h.Wa;f!=null&&(f.X=null),h.vb=null,e(h!=null)}function wi(){var h=new $e;return h==null?null:(h.a=0,h.xb=G0,bt("Predictor","VP8LPredictors"),bt("Predictor","VP8LPredictors_C"),bt("PredictorAdd","VP8LPredictorsAdd"),bt("PredictorAdd","VP8LPredictorsAdd_C"),hn=ot,ec=et,tc=Mt,La=St,Ta=ze,Ia=dt,Ui=It,A.VP8LMapColor32b=Ls,A.VP8LMapColor8b=Xl,h)}function Ds(h,f,x,C,q){var M=1,B=[h],z=[f],W=C.m,G=C.s,ie=null,ve=0;e:for(;;){if(x)for(;M&&de(W,1);){var K=B,ce=z,pe=C,xe=1,ge=pe.m,we=pe.gc[pe.ab],Se=de(ge,2);if(pe.Oc&1<<Se)M=0;else{switch(pe.Oc|=1<<Se,we.hc=Se,we.Ea=K[0],we.nc=ce[0],we.K=[null],++pe.ab,e(4>=pe.ab),Se){case 0:case 1:we.b=de(ge,3)+2,xe=Ds(ue(we.Ea,we.b),ue(we.nc,we.b),0,pe,we.K),we.K=we.K[0];break;case 3:var Ee,Ne=de(ge,8)+1,We=16<Ne?0:4<Ne?1:2<Ne?2:3;if(K[0]=ue(we.Ea,We),we.b=We,Ee=xe=Ds(Ne,1,0,pe,we.K)){var Re,pt=Ne,Me=we,_t=1<<(8>>Me.b),Dn=i(_t);if(Dn==null)Ee=0;else{var mt=Me.K[0],Be=Me.w;for(Dn[0]=Me.K[0][0],Re=1;Re<1*pt;++Re)Dn[Re]=Te(mt[Be+Re],Dn[Re-1]);for(;Re<4*_t;++Re)Dn[Re]=0;Me.K[0]=null,Me.K[0]=Dn,Ee=1}}xe=Ee;break;case 2:break;default:e(0)}M=xe}}if(B=B[0],z=z[0],M&&de(W,1)&&!(M=1<=(ve=de(W,4))&&11>=ve)){C.a=3;break e}var Le;if(Le=M)t:{var pn,ht,xt,Ht=C,$n=B,cr=z,sn=ve,er=x,dr=Ht.m,Pn=Ht.s,wt=[null],Dt=1,an=0,Pt=Hx[sn];n:for(;;){if(er&&de(dr,1)){var zn=de(dr,3)+2,ps=ue($n,zn),mn=ue(cr,zn),vr=ps*mn;if(!Ds(ps,mn,0,Ht,wt))break n;for(wt=wt[0],Pn.xc=zn,pn=0;pn<vr;++pn){var Ot=wt[pn]>>8&65535;wt[pn]=Ot,Ot>=Dt&&(Dt=Ot+1)}}if(dr.h)break n;for(ht=0;5>ht;++ht){var Ln=H0[ht];!ht&&0<sn&&(Ln+=1<<sn),an<Ln&&(an=Ln)}var Pr=o(Dt*Pt,L),ur=Dt,Lr=o(ur,X);if(Lr==null)var Tr=null;else e(65536>=ur),Tr=Lr;var yr=i(an);if(Tr==null||yr==null||Pr==null){Ht.a=1;break n}var Ir=Pr;for(pn=xt=0;pn<Dt;++pn){var Ut=Tr[pn],Rr=Ut.G,ms=Ut.H,zi=0,aa=1,Wn=0;for(ht=0;5>ht;++ht){Ln=H0[ht],Rr[ht]=Ir,ms[ht]=xt,!ht&&0<sn&&(Ln+=1<<sn);s:{var Zd,Pf=Ln,Yd=Ht,ic=yr,hw=Ir,fw=xt,Lf=0,Fa=Yd.m,pw=de(Fa,1);if(s(ic,0,0,Pf),pw){var mw=de(Fa,1)+1,gw=de(Fa,1),t1=de(Fa,gw==0?1:8);ic[t1]=1,mw==2&&(ic[t1=de(Fa,8)]=1);var Jd=1}else{var n1=i(19),r1=de(Fa,4)+4;if(19<r1){Yd.a=3;var Xd=0;break s}for(Zd=0;Zd<r1;++Zd)n1[zx[Zd]]=de(Fa,3);var Tf=void 0,oc=void 0,s1=Yd,vw=n1,Qd=Pf,a1=ic,If=0,Ma=s1.m,i1=8,o1=o(128,L);r:for(;F(o1,0,7,vw,19);){if(de(Ma,1)){var yw=2+2*de(Ma,3);if((Tf=2+de(Ma,yw))>Qd)break r}else Tf=Qd;for(oc=0;oc<Qd&&Tf--;){le(Ma);var l1=o1[0+(127&J(Ma))];ne(Ma,Ma.u+l1.g);var Po=l1.value;if(16>Po)a1[oc++]=Po,Po!=0&&(i1=Po);else{var bw=Po==16,c1=Po-16,_w=Ux[c1],d1=de(Ma,Bx[c1])+_w;if(oc+d1>Qd)break r;for(var xw=bw?i1:0;0<d1--;)a1[oc++]=xw}}If=1;break r}If||(s1.a=3),Jd=If}(Jd=Jd&&!Fa.h)&&(Lf=F(hw,fw,8,ic,Pf)),Jd&&Lf!=0?Xd=Lf:(Yd.a=3,Xd=0)}if(Xd==0)break n;if(aa&&$x[ht]==1&&(aa=Ir[xt].g==0),zi+=Ir[xt].g,xt+=Xd,3>=ht){var lc,Rf=yr[0];for(lc=1;lc<Ln;++lc)yr[lc]>Rf&&(Rf=yr[lc]);Wn+=Rf}}if(Ut.nd=aa,Ut.Qb=0,aa&&(Ut.qb=(Rr[3][ms[3]+0].value<<24|Rr[1][ms[1]+0].value<<16|Rr[2][ms[2]+0].value)>>>0,zi==0&&256>Rr[0][ms[0]+0].value&&(Ut.Qb=1,Ut.qb+=Rr[0][ms[0]+0].value<<8)),Ut.jc=!Ut.Qb&&6>Wn,Ut.jc){var eu,ia=Ut;for(eu=0;eu<Bi;++eu){var Ba=eu,Ua=ia.pd[Ba],tu=ia.G[0][ia.H[0]+Ba];256<=tu.value?(Ua.g=tu.g+256,Ua.value=tu.value):(Ua.g=0,Ua.value=0,Ba>>=qn(tu,8,Ua),Ba>>=qn(ia.G[1][ia.H[1]+Ba],16,Ua),Ba>>=qn(ia.G[2][ia.H[2]+Ba],0,Ua),qn(ia.G[3][ia.H[3]+Ba],24,Ua))}}}Pn.vc=wt,Pn.Wb=Dt,Pn.Ya=Tr,Pn.yc=Pr,Le=1;break t}Le=0}if(!(M=Le)){C.a=3;break e}if(0<ve){if(G.ua=1<<ve,!Q(G.Wa,ve)){C.a=1,M=0;break e}}else G.ua=0;var qf=C,u1=B,ww=z,Of=qf.s,Ff=Of.xc;if(qf.c=u1,qf.i=ww,Of.md=ue(u1,Ff),Of.wc=Ff==0?-1:(1<<Ff)-1,x){C.xb=Qx;break e}if((ie=i(B*z))==null){C.a=1,M=0;break e}M=(M=us(C,ie,0,B,z,z,null))&&!W.h;break e}return M?(q!=null?q[0]=ie:(e(ie==null),e(x)),C.$=0,x||Vr(G)):Vr(G),M}function ji(h,f){var x=h.c*h.i,C=x+f+16*f;return e(h.c<=f),h.V=i(C),h.V==null?(h.Ta=null,h.Ua=0,h.a=1,0):(h.Ta=h.V,h.Ua=h.Ba+x+f,1)}function bo(h,f){var x=h.C,C=f-x,q=h.V,M=h.Ba+h.c*x;for(e(f<=h.l.o);0<C;){var B=16<C?16:C,z=h.l.ma,W=h.l.width,G=W*B,ie=z.ca,ve=z.tb+W*x,K=h.Ta,ce=h.Ua;xi(h,B,q,M),O0(K,ce,ie,ve,G),Es(z,x,x+B,ie,ve,W),C-=B,q+=B*h.c,x+=B}e(x==f),h.C=h.Ma=f}function _o(){this.ub=this.yd=this.td=this.Rb=0}function xo(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function of(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function Rl(){this.Yb=function(){var h=[];return function f(x,C,q){for(var M=q[C],B=0;B<M&&(x.push(q.length>C+1?[]:0),!(q.length<C+1));B++)f(x[B],C+1,q)}(h,0,[3,11]),h}()}function xd(){this.jb=i(3),this.Wc=l([4,8],Rl),this.Xc=l([4,17],Rl)}function wd(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function Gr(){this.ld=this.La=this.dd=this.tc=0}function ql(){this.Na=this.la=0}function jd(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ol(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Sd(){this.uc=this.M=this.Nb=0,this.wa=Array(new Gr),this.Y=0,this.ya=Array(new Ol),this.aa=0,this.l=new wo}function kd(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Nd(){this.cb=this.a=0,this.sc="",this.m=new E,this.Od=new _o,this.Kc=new xo,this.ed=new wd,this.Qa=new of,this.Ic=this.$c=this.Aa=0,this.D=new Sd,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,E),this.ia=0,this.pb=o(4,jd),this.Pa=new xd,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new kd),this.Hd=0,this.rb=Array(new ql),this.sb=0,this.wa=Array(new Gr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ol),this.L=this.aa=0,this.gd=l([4,2],Gr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function wo(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function lf(){var h=new Nd;return h!=null&&(h.a=0,h.sc="OK",h.cb=0,h.Xb=0,sc||(sc=Ys)),h}function wn(h,f,x){return h.a==0&&(h.a=f,h.sc=x,h.cb=0),0}function Cd(h,f,x){return 3<=x&&h[f+0]==157&&h[f+1]==1&&h[f+2]==42}function Ad(h,f){if(h==null)return 0;if(h.a=0,h.sc="OK",f==null)return wn(h,2,"null VP8Io passed to VP8GetHeaders()");var x=f.data,C=f.w,q=f.ha;if(4>q)return wn(h,7,"Truncated header.");var M=x[C+0]|x[C+1]<<8|x[C+2]<<16,B=h.Od;if(B.Rb=!(1&M),B.td=M>>1&7,B.yd=M>>4&1,B.ub=M>>5,3<B.td)return wn(h,3,"Incorrect keyframe parameters.");if(!B.yd)return wn(h,4,"Frame not displayable.");C+=3,q-=3;var z=h.Kc;if(B.Rb){if(7>q)return wn(h,7,"cannot parse picture header");if(!Cd(x,C,q))return wn(h,3,"Bad code word");z.c=16383&(x[C+4]<<8|x[C+3]),z.Td=x[C+4]>>6,z.i=16383&(x[C+6]<<8|x[C+5]),z.Ud=x[C+6]>>6,C+=7,q-=7,h.za=z.c+15>>4,h.Ub=z.i+15>>4,f.width=z.c,f.height=z.i,f.Da=0,f.j=0,f.v=0,f.va=f.width,f.o=f.height,f.da=0,f.ib=f.width,f.hb=f.height,f.U=f.width,f.T=f.height,s((M=h.Pa).jb,0,255,M.jb.length),e((M=h.Qa)!=null),M.Cb=0,M.Bb=0,M.Fb=1,s(M.Zb,0,0,M.Zb.length),s(M.Lb,0,0,M.Lb)}if(B.ub>q)return wn(h,7,"bad partition length");te(M=h.m,x,C,B.ub),C+=B.ub,q-=B.ub,B.Rb&&(z.Ld=re(M),z.Kd=re(M)),z=h.Qa;var W,G=h.Pa;if(e(M!=null),e(z!=null),z.Cb=re(M),z.Cb){if(z.Bb=re(M),re(M)){for(z.Fb=re(M),W=0;4>W;++W)z.Zb[W]=re(M)?Z(M,7):0;for(W=0;4>W;++W)z.Lb[W]=re(M)?Z(M,6):0}if(z.Bb)for(W=0;3>W;++W)G.jb[W]=re(M)?oe(M,8):255}else z.Bb=0;if(M.Ka)return wn(h,3,"cannot parse segment header");if((z=h.ed).zd=re(M),z.Tb=oe(M,6),z.wb=oe(M,3),z.Pc=re(M),z.Pc&&re(M)){for(G=0;4>G;++G)re(M)&&(z.vd[G]=Z(M,6));for(G=0;4>G;++G)re(M)&&(z.od[G]=Z(M,6))}if(h.L=z.Tb==0?0:z.zd?1:2,M.Ka)return wn(h,3,"cannot parse filter header");var ie=q;if(q=W=C,C=W+ie,z=ie,h.Xb=(1<<oe(h.m,2))-1,ie<3*(G=h.Xb))x=7;else{for(W+=3*G,z-=3*G,ie=0;ie<G;++ie){var ve=x[q+0]|x[q+1]<<8|x[q+2]<<16;ve>z&&(ve=z),te(h.Jc[+ie],x,W,ve),W+=ve,z-=ve,q+=3}te(h.Jc[+G],x,W,z),x=W<C?0:5}if(x!=0)return wn(h,x,"cannot parse partitions");for(x=oe(W=h.m,7),q=re(W)?Z(W,4):0,C=re(W)?Z(W,4):0,z=re(W)?Z(W,4):0,G=re(W)?Z(W,4):0,W=re(W)?Z(W,4):0,ie=h.Qa,ve=0;4>ve;++ve){if(ie.Cb){var K=ie.Zb[ve];ie.Fb||(K+=x)}else{if(0<ve){h.pb[ve]=h.pb[0];continue}K=x}var ce=h.pb[ve];ce.Sc[0]=Af[rn(K+q,127)],ce.Sc[1]=Ef[rn(K+0,127)],ce.Eb[0]=2*Af[rn(K+C,127)],ce.Eb[1]=101581*Ef[rn(K+z,127)]>>16,8>ce.Eb[1]&&(ce.Eb[1]=8),ce.Qc[0]=Af[rn(K+G,117)],ce.Qc[1]=Ef[rn(K+W,127)],ce.lc=K+W}if(!B.Rb)return wn(h,4,"Not a key frame.");for(re(M),B=h.Pa,x=0;4>x;++x){for(q=0;8>q;++q)for(C=0;3>C;++C)for(z=0;11>z;++z)G=fe(M,Jx[x][q][C][z])?oe(M,8):Zx[x][q][C][z],B.Wc[x][q].Yb[C][z]=G;for(q=0;17>q;++q)B.Xc[x][q]=B.Wc[x][Xx[q]]}return h.kc=re(M),h.kc&&(h.Bd=oe(M,8)),h.cb=1}function Ys(h,f,x,C,q,M,B){var z=f[q].Yb[x];for(x=0;16>q;++q){if(!fe(h,z[x+0]))return q;for(;!fe(h,z[x+1]);)if(z=f[++q].Yb[0],x=0,q==16)return 16;var W=f[q+1].Yb;if(fe(h,z[x+2])){var G=h,ie=0;if(fe(G,(K=z)[(ve=x)+3]))if(fe(G,K[ve+6])){for(z=0,ve=2*(ie=fe(G,K[ve+8]))+(K=fe(G,K[ve+9+ie])),ie=0,K=Gx[ve];K[z];++z)ie+=ie+fe(G,K[z]);ie+=3+(8<<ve)}else fe(G,K[ve+7])?(ie=7+2*fe(G,165),ie+=fe(G,145)):ie=5+fe(G,159);else ie=fe(G,K[ve+4])?3+fe(G,K[ve+5]):2;z=W[2]}else ie=1,z=W[1];W=B+Kx[q],0>(G=h).b&&me(G);var ve,K=G.b,ce=(ve=G.Ca>>1)-(G.I>>K)>>31;--G.b,G.Ca+=ce,G.Ca|=1,G.I-=(ve+1&ce)<<K,M[W]=((ie^ce)-ce)*C[(0<q)+0]}return 16}function Si(h){var f=h.rb[h.sb-1];f.la=0,f.Na=0,s(h.zc,0,0,h.zc.length),h.ja=0}function hs(h,f,x,C,q){q=h[f+x+32*C]+(q>>3),h[f+x+32*C]=-256&q?0>q?0:255:q}function ki(h,f,x,C,q,M){hs(h,f,0,x,C+q),hs(h,f,1,x,C+M),hs(h,f,2,x,C-M),hs(h,f,3,x,C-q)}function un(h){return(20091*h>>16)+h}function Fl(h,f,x,C){var q,M=0,B=i(16);for(q=0;4>q;++q){var z=h[f+0]+h[f+8],W=h[f+0]-h[f+8],G=(35468*h[f+4]>>16)-un(h[f+12]),ie=un(h[f+4])+(35468*h[f+12]>>16);B[M+0]=z+ie,B[M+1]=W+G,B[M+2]=W-G,B[M+3]=z-ie,M+=4,f++}for(q=M=0;4>q;++q)z=(h=B[M+0]+4)+B[M+8],W=h-B[M+8],G=(35468*B[M+4]>>16)-un(B[M+12]),hs(x,C,0,0,z+(ie=un(B[M+4])+(35468*B[M+12]>>16))),hs(x,C,1,0,W+G),hs(x,C,2,0,W-G),hs(x,C,3,0,z-ie),M++,C+=32}function cf(h,f,x,C){var q=h[f+0]+4,M=35468*h[f+4]>>16,B=un(h[f+4]),z=35468*h[f+1]>>16;ki(x,C,0,q+B,h=un(h[f+1]),z),ki(x,C,1,q+M,h,z),ki(x,C,2,q-M,h,z),ki(x,C,3,q-B,h,z)}function df(h,f,x,C,q){Fl(h,f,x,C),q&&Fl(h,f+16,x,C+4)}function uf(h,f,x,C){$i(h,f+0,x,C,1),$i(h,f+32,x,C+128,1)}function Ps(h,f,x,C){var q;for(h=h[f+0]+4,q=0;4>q;++q)for(f=0;4>f;++f)hs(x,C,f,q,h)}function Ed(h,f,x,C){h[f+0]&&Ct(h,f+0,x,C),h[f+16]&&Ct(h,f+16,x,C+4),h[f+32]&&Ct(h,f+32,x,C+128),h[f+48]&&Ct(h,f+48,x,C+128+4)}function Dd(h,f,x,C){var q,M=i(16);for(q=0;4>q;++q){var B=h[f+0+q]+h[f+12+q],z=h[f+4+q]+h[f+8+q],W=h[f+4+q]-h[f+8+q],G=h[f+0+q]-h[f+12+q];M[0+q]=B+z,M[8+q]=B-z,M[4+q]=G+W,M[12+q]=G-W}for(q=0;4>q;++q)B=(h=M[0+4*q]+3)+M[3+4*q],z=M[1+4*q]+M[2+4*q],W=M[1+4*q]-M[2+4*q],G=h-M[3+4*q],x[C+0]=B+z>>3,x[C+16]=G+W>>3,x[C+32]=B-z>>3,x[C+48]=G-W>>3,C+=64}function Na(h,f,x){var C,q=f-32,M=Dr,B=255-h[q-1];for(C=0;C<x;++C){var z,W=M,G=B+h[f-1];for(z=0;z<x;++z)h[f+z]=W[G+h[q+z]];f+=32}}function Ml(h,f){Na(h,f,4)}function hf(h,f){Na(h,f,8)}function ff(h,f){Na(h,f,16)}function pf(h,f){var x;for(x=0;16>x;++x)r(h,f+32*x,h,f-32,16)}function Bl(h,f){var x;for(x=16;0<x;--x)s(h,f,h[f-1],16),f+=32}function Ni(h,f,x){var C;for(C=0;16>C;++C)s(f,x+32*C,h,16)}function Ca(h,f){var x,C=16;for(x=0;16>x;++x)C+=h[f-1+32*x]+h[f+x-32];Ni(C>>5,h,f)}function mf(h,f){var x,C=8;for(x=0;16>x;++x)C+=h[f-1+32*x];Ni(C>>4,h,f)}function Ci(h,f){var x,C=8;for(x=0;16>x;++x)C+=h[f+x-32];Ni(C>>4,h,f)}function Ul(h,f){Ni(128,h,f)}function it(h,f,x){return h+2*f+x+2>>2}function gf(h,f){var x,C=f-32;for(C=new Uint8Array([it(h[C-1],h[C+0],h[C+1]),it(h[C+0],h[C+1],h[C+2]),it(h[C+1],h[C+2],h[C+3]),it(h[C+2],h[C+3],h[C+4])]),x=0;4>x;++x)r(h,f+32*x,C,0,C.length)}function vf(h,f){var x=h[f-1],C=h[f-1+32],q=h[f-1+64],M=h[f-1+96];_e(h,f+0,16843009*it(h[f-1-32],x,C)),_e(h,f+32,16843009*it(x,C,q)),_e(h,f+64,16843009*it(C,q,M)),_e(h,f+96,16843009*it(q,M,M))}function yf(h,f){var x,C=4;for(x=0;4>x;++x)C+=h[f+x-32]+h[f-1+32*x];for(C>>=3,x=0;4>x;++x)s(h,f+32*x,C,4)}function bf(h,f){var x=h[f-1+0],C=h[f-1+32],q=h[f-1+64],M=h[f-1-32],B=h[f+0-32],z=h[f+1-32],W=h[f+2-32],G=h[f+3-32];h[f+0+96]=it(C,q,h[f-1+96]),h[f+1+96]=h[f+0+64]=it(x,C,q),h[f+2+96]=h[f+1+64]=h[f+0+32]=it(M,x,C),h[f+3+96]=h[f+2+64]=h[f+1+32]=h[f+0+0]=it(B,M,x),h[f+3+64]=h[f+2+32]=h[f+1+0]=it(z,B,M),h[f+3+32]=h[f+2+0]=it(W,z,B),h[f+3+0]=it(G,W,z)}function Js(h,f){var x=h[f+1-32],C=h[f+2-32],q=h[f+3-32],M=h[f+4-32],B=h[f+5-32],z=h[f+6-32],W=h[f+7-32];h[f+0+0]=it(h[f+0-32],x,C),h[f+1+0]=h[f+0+32]=it(x,C,q),h[f+2+0]=h[f+1+32]=h[f+0+64]=it(C,q,M),h[f+3+0]=h[f+2+32]=h[f+1+64]=h[f+0+96]=it(q,M,B),h[f+3+32]=h[f+2+64]=h[f+1+96]=it(M,B,z),h[f+3+64]=h[f+2+96]=it(B,z,W),h[f+3+96]=it(z,W,W)}function Xs(h,f){var x=h[f-1+0],C=h[f-1+32],q=h[f-1+64],M=h[f-1-32],B=h[f+0-32],z=h[f+1-32],W=h[f+2-32],G=h[f+3-32];h[f+0+0]=h[f+1+64]=M+B+1>>1,h[f+1+0]=h[f+2+64]=B+z+1>>1,h[f+2+0]=h[f+3+64]=z+W+1>>1,h[f+3+0]=W+G+1>>1,h[f+0+96]=it(q,C,x),h[f+0+64]=it(C,x,M),h[f+0+32]=h[f+1+96]=it(x,M,B),h[f+1+32]=h[f+2+96]=it(M,B,z),h[f+2+32]=h[f+3+96]=it(B,z,W),h[f+3+32]=it(z,W,G)}function _f(h,f){var x=h[f+0-32],C=h[f+1-32],q=h[f+2-32],M=h[f+3-32],B=h[f+4-32],z=h[f+5-32],W=h[f+6-32],G=h[f+7-32];h[f+0+0]=x+C+1>>1,h[f+1+0]=h[f+0+64]=C+q+1>>1,h[f+2+0]=h[f+1+64]=q+M+1>>1,h[f+3+0]=h[f+2+64]=M+B+1>>1,h[f+0+32]=it(x,C,q),h[f+1+32]=h[f+0+96]=it(C,q,M),h[f+2+32]=h[f+1+96]=it(q,M,B),h[f+3+32]=h[f+2+96]=it(M,B,z),h[f+3+64]=it(B,z,W),h[f+3+96]=it(z,W,G)}function xf(h,f){var x=h[f-1+0],C=h[f-1+32],q=h[f-1+64],M=h[f-1+96];h[f+0+0]=x+C+1>>1,h[f+2+0]=h[f+0+32]=C+q+1>>1,h[f+2+32]=h[f+0+64]=q+M+1>>1,h[f+1+0]=it(x,C,q),h[f+3+0]=h[f+1+32]=it(C,q,M),h[f+3+32]=h[f+1+64]=it(q,M,M),h[f+3+64]=h[f+2+64]=h[f+0+96]=h[f+1+96]=h[f+2+96]=h[f+3+96]=M}function jo(h,f){var x=h[f-1+0],C=h[f-1+32],q=h[f-1+64],M=h[f-1+96],B=h[f-1-32],z=h[f+0-32],W=h[f+1-32],G=h[f+2-32];h[f+0+0]=h[f+2+32]=x+B+1>>1,h[f+0+32]=h[f+2+64]=C+x+1>>1,h[f+0+64]=h[f+2+96]=q+C+1>>1,h[f+0+96]=M+q+1>>1,h[f+3+0]=it(z,W,G),h[f+2+0]=it(B,z,W),h[f+1+0]=h[f+3+32]=it(x,B,z),h[f+1+32]=h[f+3+64]=it(C,x,B),h[f+1+64]=h[f+3+96]=it(q,C,x),h[f+1+96]=it(M,q,C)}function $l(h,f){var x;for(x=0;8>x;++x)r(h,f+32*x,h,f-32,8)}function Ai(h,f){var x;for(x=0;8>x;++x)s(h,f,h[f-1],8),f+=32}function So(h,f,x){var C;for(C=0;8>C;++C)s(f,x+32*C,h,8)}function ko(h,f){var x,C=8;for(x=0;8>x;++x)C+=h[f+x-32]+h[f-1+32*x];So(C>>4,h,f)}function wf(h,f){var x,C=4;for(x=0;8>x;++x)C+=h[f+x-32];So(C>>3,h,f)}function zl(h,f){var x,C=4;for(x=0;8>x;++x)C+=h[f-1+32*x];So(C>>3,h,f)}function Wl(h,f){So(128,h,f)}function Ei(h,f,x){var C=h[f-x],q=h[f+0],M=3*(q-C)+jf[1020+h[f-2*x]-h[f+x]],B=Bd[112+(M+4>>3)];h[f-x]=Dr[255+C+Bd[112+(M+3>>3)]],h[f+0]=Dr[255+q-B]}function Di(h,f,x,C){var q=h[f+0],M=h[f+x];return Jr[255+h[f-2*x]-h[f-x]]>C||Jr[255+M-q]>C}function Hl(h,f,x,C){return 4*Jr[255+h[f-x]-h[f+0]]+Jr[255+h[f-2*x]-h[f+x]]<=C}function No(h,f,x,C,q){var M=h[f-3*x],B=h[f-2*x],z=h[f-x],W=h[f+0],G=h[f+x],ie=h[f+2*x],ve=h[f+3*x];return 4*Jr[255+z-W]+Jr[255+B-G]>C?0:Jr[255+h[f-4*x]-M]<=q&&Jr[255+M-B]<=q&&Jr[255+B-z]<=q&&Jr[255+ve-ie]<=q&&Jr[255+ie-G]<=q&&Jr[255+G-W]<=q}function Vl(h,f,x,C){var q=2*C+1;for(C=0;16>C;++C)Hl(h,f+C,x,q)&&Ei(h,f+C,x)}function Pi(h,f,x,C){var q=2*C+1;for(C=0;16>C;++C)Hl(h,f+C*x,1,q)&&Ei(h,f+C*x,1)}function Pd(h,f,x,C){var q;for(q=3;0<q;--q)Vl(h,f+=4*x,x,C)}function Ld(h,f,x,C){var q;for(q=3;0<q;--q)Pi(h,f+=4,x,C)}function Qs(h,f,x,C,q,M,B,z){for(M=2*M+1;0<q--;){if(No(h,f,x,M,B))if(Di(h,f,x,z))Ei(h,f,x);else{var W=h,G=f,ie=x,ve=W[G-2*ie],K=W[G-ie],ce=W[G+0],pe=W[G+ie],xe=W[G+2*ie],ge=27*(Se=jf[1020+3*(ce-K)+jf[1020+ve-pe]])+63>>7,we=18*Se+63>>7,Se=9*Se+63>>7;W[G-3*ie]=Dr[255+W[G-3*ie]+Se],W[G-2*ie]=Dr[255+ve+we],W[G-ie]=Dr[255+K+ge],W[G+0]=Dr[255+ce-ge],W[G+ie]=Dr[255+pe-we],W[G+2*ie]=Dr[255+xe-Se]}f+=C}}function ea(h,f,x,C,q,M,B,z){for(M=2*M+1;0<q--;){if(No(h,f,x,M,B))if(Di(h,f,x,z))Ei(h,f,x);else{var W=h,G=f,ie=x,ve=W[G-ie],K=W[G+0],ce=W[G+ie],pe=Bd[112+(4+(xe=3*(K-ve))>>3)],xe=Bd[112+(xe+3>>3)],ge=pe+1>>1;W[G-2*ie]=Dr[255+W[G-2*ie]+ge],W[G-ie]=Dr[255+ve+xe],W[G+0]=Dr[255+K-pe],W[G+ie]=Dr[255+ce-ge]}f+=C}}function Td(h,f,x,C,q,M){Qs(h,f,x,1,16,C,q,M)}function Id(h,f,x,C,q,M){Qs(h,f,1,x,16,C,q,M)}function Li(h,f,x,C,q,M){var B;for(B=3;0<B;--B)ea(h,f+=4*x,x,1,16,C,q,M)}function Rd(h,f,x,C,q,M){var B;for(B=3;0<B;--B)ea(h,f+=4,1,x,16,C,q,M)}function v(h,f,x,C,q,M,B,z){Qs(h,f,q,1,8,M,B,z),Qs(x,C,q,1,8,M,B,z)}function R(h,f,x,C,q,M,B,z){Qs(h,f,1,q,8,M,B,z),Qs(x,C,1,q,8,M,B,z)}function Y(h,f,x,C,q,M,B,z){ea(h,f+4*q,q,1,8,M,B,z),ea(x,C+4*q,q,1,8,M,B,z)}function se(h,f,x,C,q,M,B,z){ea(h,f+4,1,q,8,M,B,z),ea(x,C+4,1,q,8,M,B,z)}function he(){this.ba=new Rt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Nt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function je(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ce(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Oe(){this.ua=0,this.Wa=new nt,this.vb=new nt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new X,this.yc=new L}function $e(){this.xb=this.a=0,this.l=new wo,this.ca=new Rt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new H,this.Pb=0,this.wd=new H,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Oe,this.ab=0,this.gc=o(4,Ce),this.Oc=0}function rt(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new wo,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function lt(h,f,x,C,q,M,B){for(h=h==null?0:h[f+0],f=0;f<B;++f)q[M+f]=h+x[C+f]&255,h=q[M+f]}function kt(h,f,x,C,q,M,B){var z;if(h==null)lt(null,null,x,C,q,M,B);else for(z=0;z<B;++z)q[M+z]=h[f+z]+x[C+z]&255}function Jt(h,f,x,C,q,M,B){if(h==null)lt(null,null,x,C,q,M,B);else{var z,W=h[f+0],G=W,ie=W;for(z=0;z<B;++z)G=ie+(W=h[f+z])-G,ie=x[C+z]+(-256&G?0>G?0:255:G)&255,G=W,q[M+z]=ie}}function jn(h,f,x,C){var q=f.width,M=f.o;if(e(h!=null&&f!=null),0>x||0>=C||x+C>M)return null;if(!h.Cc){if(h.ga==null){var B;if(h.ga=new rt,(B=h.ga==null)||(B=f.width*f.o,e(h.Gb.length==0),h.Gb=i(B),h.Uc=0,h.Gb==null?B=0:(h.mb=h.Gb,h.nb=h.Uc,h.rc=null,B=1),B=!B),!B){B=h.ga;var z=h.Fa,W=h.P,G=h.qc,ie=h.mb,ve=h.nb,K=W+1,ce=G-1,pe=B.l;if(e(z!=null&&ie!=null&&f!=null),Oa[0]=null,Oa[1]=lt,Oa[2]=kt,Oa[3]=Jt,B.ca=ie,B.tb=ve,B.c=f.width,B.i=f.height,e(0<B.c&&0<B.i),1>=G)f=0;else if(B.$a=3&z[W+0],B.Z=z[W+0]>>2&3,B.Lc=z[W+0]>>4&3,W=z[W+0]>>6&3,0>B.$a||1<B.$a||4<=B.Z||1<B.Lc||W)f=0;else if(pe.put=Ze,pe.ac=As,pe.bc=Ks,pe.ma=B,pe.width=f.width,pe.height=f.height,pe.Da=f.Da,pe.v=f.v,pe.va=f.va,pe.j=f.j,pe.o=f.o,B.$a)e:{e(B.$a==1),f=wi();t:for(;;){if(f==null){f=0;break e}if(e(B!=null),B.mc=f,f.c=B.c,f.i=B.i,f.l=B.l,f.l.ma=B,f.l.width=B.c,f.l.height=B.i,f.a=0,ae(f.m,z,K,ce),!Ds(B.c,B.i,1,f,null)||(f.ab==1&&f.gc[0].hc==3&&cs(f.s)?(B.ic=1,z=f.c*f.i,f.Ta=null,f.Ua=0,f.V=i(z),f.Ba=0,f.V==null?(f.a=1,f=0):f=1):(B.ic=0,f=ji(f,B.c)),!f))break t;f=1;break e}B.mc=null,f=0}else f=ce>=B.c*B.i;B=!f}if(B)return null;h.ga.Lc!=1?h.Ga=0:C=M-x}e(h.ga!=null),e(x+C<=M);e:{if(f=(z=h.ga).c,M=z.l.o,z.$a==0){if(K=h.rc,ce=h.Vc,pe=h.Fa,W=h.P+1+x*f,G=h.mb,ie=h.nb+x*f,e(W<=h.P+h.qc),z.Z!=0)for(e(Oa[z.Z]!=null),B=0;B<C;++B)Oa[z.Z](K,ce,pe,W,G,ie,f),K=G,ce=ie,ie+=f,W+=f;else for(B=0;B<C;++B)r(G,ie,pe,W,f),K=G,ce=ie,ie+=f,W+=f;h.rc=K,h.Vc=ce}else{if(e(z.mc!=null),f=x+C,e((B=z.mc)!=null),e(f<=B.i),B.C>=f)f=1;else if(z.ic||Kr(),z.ic){z=B.V,K=B.Ba,ce=B.c;var xe=B.i,ge=(pe=1,W=B.$/ce,G=B.$%ce,ie=B.m,ve=B.s,B.$),we=ce*xe,Se=ce*f,Ee=ve.wc,Ne=ge<Se?Bn(ve,G,W):null;e(ge<=we),e(f<=xe),e(cs(ve));t:for(;;){for(;!ie.h&&ge<Se;){if(G&Ee||(Ne=Bn(ve,G,W)),e(Ne!=null),le(ie),256>(xe=nn(Ne.G[0],Ne.H[0],ie)))z[K+ge]=xe,++ge,++G>=ce&&(G=0,++W<=f&&!(W%16)&&ds(B,W));else{if(!(280>xe)){pe=0;break t}xe=Wr(xe-256,ie);var We,Re=nn(Ne.G[4],Ne.H[4],ie);if(le(ie),!(ge>=(Re=Hr(ce,Re=Wr(Re,ie)))&&we-ge>=xe)){pe=0;break t}for(We=0;We<xe;++We)z[K+ge+We]=z[K+ge+We-Re];for(ge+=xe,G+=xe;G>=ce;)G-=ce,++W<=f&&!(W%16)&&ds(B,W);ge<Se&&G&Ee&&(Ne=Bn(ve,G,W))}e(ie.h==V(ie))}ds(B,W>f?f:W);break t}!pe||ie.h&&ge<we?(pe=0,B.a=ie.h?5:3):B.$=ge,f=pe}else f=us(B,B.V,B.Ba,B.c,B.i,f,bo);if(!f){C=0;break e}}x+C>=M&&(h.Cc=1),C=1}if(!C)return null;if(h.Cc&&((C=h.ga)!=null&&(C.mc=null),h.ga=null,0<h.Ga))return alert("todo:WebPDequantizeLevels"),null}return h.nb+x*q}function Bt(h,f,x,C,q,M){for(;0<q--;){var B,z=h,W=f+(x?1:0),G=h,ie=f+(x?0:3);for(B=0;B<C;++B){var ve=G[ie+4*B];ve!=255&&(ve*=32897,z[W+4*B+0]=z[W+4*B+0]*ve>>23,z[W+4*B+1]=z[W+4*B+1]*ve>>23,z[W+4*B+2]=z[W+4*B+2]*ve>>23)}f+=M}}function An(h,f,x,C,q){for(;0<C--;){var M;for(M=0;M<x;++M){var B=h[f+2*M+0],z=15&(G=h[f+2*M+1]),W=4369*z,G=(240&G|G>>4)*W>>16;h[f+2*M+0]=(240&B|B>>4)*W>>16&240|(15&B|B<<4)*W>>16>>4&15,h[f+2*M+1]=240&G|z}f+=q}}function Sn(h,f,x,C,q,M,B,z){var W,G,ie=255;for(G=0;G<q;++G){for(W=0;W<C;++W){var ve=h[f+W];M[B+4*W]=ve,ie&=ve}f+=x,B+=z}return ie!=255}function Un(h,f,x,C,q){var M;for(M=0;M<q;++M)x[C+M]=h[f+M]>>8}function Kr(){rc=Bt,R0=An,q0=Sn,O0=Un}function gr(h,f,x){A[h]=function(C,q,M,B,z,W,G,ie,ve,K,ce,pe,xe,ge,we,Se,Ee){var Ne,We=Ee-1>>1,Re=z[W+0]|G[ie+0]<<16,pt=ve[K+0]|ce[pe+0]<<16;e(C!=null);var Me=3*Re+pt+131074>>2;for(f(C[q+0],255&Me,Me>>16,xe,ge),M!=null&&(Me=3*pt+Re+131074>>2,f(M[B+0],255&Me,Me>>16,we,Se)),Ne=1;Ne<=We;++Ne){var _t=z[W+Ne]|G[ie+Ne]<<16,Dn=ve[K+Ne]|ce[pe+Ne]<<16,mt=Re+_t+pt+Dn+524296,Be=mt+2*(_t+pt)>>3;Me=Be+Re>>1,Re=(mt=mt+2*(Re+Dn)>>3)+_t>>1,f(C[q+2*Ne-1],255&Me,Me>>16,xe,ge+(2*Ne-1)*x),f(C[q+2*Ne-0],255&Re,Re>>16,xe,ge+(2*Ne-0)*x),M!=null&&(Me=mt+pt>>1,Re=Be+Dn>>1,f(M[B+2*Ne-1],255&Me,Me>>16,we,Se+(2*Ne-1)*x),f(M[B+2*Ne+0],255&Re,Re>>16,we,Se+(2*Ne+0)*x)),Re=_t,pt=Dn}1&Ee||(Me=3*Re+pt+131074>>2,f(C[q+Ee-1],255&Me,Me>>16,xe,ge+(Ee-1)*x),M!=null&&(Me=3*pt+Re+131074>>2,f(M[B+Ee-1],255&Me,Me>>16,we,Se+(Ee-1)*x)))}}function qd(){Xr[Ud]=ew,Xr[$d]=K0,Xr[z0]=tw,Xr[zd]=Z0,Xr[Wd]=Y0,Xr[Sf]=J0,Xr[W0]=nw,Xr[kf]=K0,Xr[Nf]=Z0,Xr[Hd]=Y0,Xr[Cf]=J0}function Co(h){return h&-16384?0>h?0:255:h>>rw}function Ti(h,f){return Co((19077*h>>8)+(26149*f>>8)-14234)}function Aa(h,f,x){return Co((19077*h>>8)-(6419*f>>8)-(13320*x>>8)+8708)}function Ii(h,f){return Co((19077*h>>8)+(33050*f>>8)-17685)}function Ri(h,f,x,C,q){C[q+0]=Ti(h,x),C[q+1]=Aa(h,f,x),C[q+2]=Ii(h,f)}function qi(h,f,x,C,q){C[q+0]=Ii(h,f),C[q+1]=Aa(h,f,x),C[q+2]=Ti(h,x)}function Qn(h,f,x,C,q){var M=Aa(h,f,x);f=M<<3&224|Ii(h,f)>>3,C[q+0]=248&Ti(h,x)|M>>5,C[q+1]=f}function Oi(h,f,x,C,q){var M=240&Ii(h,f)|15;C[q+0]=240&Ti(h,x)|Aa(h,f,x)>>4,C[q+1]=M}function Fi(h,f,x,C,q){C[q+0]=255,Ri(h,f,x,C,q+1)}function Gl(h,f,x,C,q){qi(h,f,x,C,q),C[q+3]=255}function Kl(h,f,x,C,q){Ri(h,f,x,C,q),C[q+3]=255}function rn(h,f){return 0>h?0:h>f?f:h}function ta(h,f,x){A[h]=function(C,q,M,B,z,W,G,ie,ve){for(var K=ie+(-2&ve)*x;ie!=K;)f(C[q+0],M[B+0],z[W+0],G,ie),f(C[q+1],M[B+0],z[W+0],G,ie+x),q+=2,++B,++W,ie+=2*x;1&ve&&f(C[q+0],M[B+0],z[W+0],G,ie)}}function Ao(h,f,x){return x==0?h==0?f==0?6:5:f==0?4:0:x}function Od(h,f,x,C,q){switch(h>>>30){case 3:$i(f,x,C,q,0);break;case 2:Yr(f,x,C,q);break;case 1:Ct(f,x,C,q)}}function Zr(h,f){var x,C,q=f.M,M=f.Nb,B=h.oc,z=h.pc+40,W=h.oc,G=h.pc+584,ie=h.oc,ve=h.pc+600;for(x=0;16>x;++x)B[z+32*x-1]=129;for(x=0;8>x;++x)W[G+32*x-1]=129,ie[ve+32*x-1]=129;for(0<q?B[z-1-32]=W[G-1-32]=ie[ve-1-32]=129:(s(B,z-32-1,127,21),s(W,G-32-1,127,9),s(ie,ve-32-1,127,9)),C=0;C<h.za;++C){var K=f.ya[f.aa+C];if(0<C){for(x=-1;16>x;++x)r(B,z+32*x-4,B,z+32*x+12,4);for(x=-1;8>x;++x)r(W,G+32*x-4,W,G+32*x+4,4),r(ie,ve+32*x-4,ie,ve+32*x+4,4)}var ce=h.Gd,pe=h.Hd+C,xe=K.ad,ge=K.Hc;if(0<q&&(r(B,z-32,ce[pe].y,0,16),r(W,G-32,ce[pe].f,0,8),r(ie,ve-32,ce[pe].ea,0,8)),K.Za){var we=B,Se=z-32+16;for(0<q&&(C>=h.za-1?s(we,Se,ce[pe].y[15],4):r(we,Se,ce[pe+1].y,0,4)),x=0;4>x;x++)we[Se+128+x]=we[Se+256+x]=we[Se+384+x]=we[Se+0+x];for(x=0;16>x;++x,ge<<=2)we=B,Se=z+Q0[x],fs[K.Ob[x]](we,Se),Od(ge,xe,16*+x,we,Se)}else if(we=Ao(C,q,K.Ob[0]),qa[we](B,z),ge!=0)for(x=0;16>x;++x,ge<<=2)Od(ge,xe,16*+x,B,z+Q0[x]);for(x=K.Gc,we=Ao(C,q,K.Dd),sa[we](W,G),sa[we](ie,ve),ge=xe,we=W,Se=G,255&(K=0|x)&&(170&K?Is(ge,256,we,Se):qt(ge,256,we,Se)),K=ie,ge=ve,255&(x>>=8)&&(170&x?Is(xe,320,K,ge):qt(xe,320,K,ge)),q<h.Ub-1&&(r(ce[pe].y,0,B,z+480,16),r(ce[pe].f,0,W,G+224,8),r(ce[pe].ea,0,ie,ve+224,8)),x=8*M*h.B,ce=h.sa,pe=h.ta+16*C+16*M*h.R,xe=h.qa,K=h.ra+8*C+x,ge=h.Ha,we=h.Ia+8*C+x,x=0;16>x;++x)r(ce,pe+x*h.R,B,z+32*x,16);for(x=0;8>x;++x)r(xe,K+x*h.B,W,G+32*x,8),r(ge,we+x*h.B,ie,ve+32*x,8)}}function Mi(h,f,x,C,q,M,B,z,W){var G=[0],ie=[0],ve=0,K=W!=null?W.kd:0,ce=W??new je;if(h==null||12>x)return 7;ce.data=h,ce.w=f,ce.ha=x,f=[f],x=[x],ce.gb=[ce.gb];e:{var pe=f,xe=x,ge=ce.gb;if(e(h!=null),e(xe!=null),e(ge!=null),ge[0]=0,12<=xe[0]&&!n(h,pe[0],"RIFF")){if(n(h,pe[0]+8,"WEBP")){ge=3;break e}var we=ye(h,pe[0]+4);if(12>we||4294967286<we){ge=3;break e}if(K&&we>xe[0]-8){ge=7;break e}ge[0]=we,pe[0]+=12,xe[0]-=12}ge=0}if(ge!=0)return ge;for(we=0<ce.gb[0],x=x[0];;){e:{var Se=h;xe=f,ge=x;var Ee=G,Ne=ie,We=pe=[0];if((Me=ve=[ve])[0]=0,8>ge[0])ge=7;else{if(!n(Se,xe[0],"VP8X")){if(ye(Se,xe[0]+4)!=10){ge=3;break e}if(18>ge[0]){ge=7;break e}var Re=ye(Se,xe[0]+8),pt=1+Ae(Se,xe[0]+12);if(2147483648<=pt*(Se=1+Ae(Se,xe[0]+15))){ge=3;break e}We!=null&&(We[0]=Re),Ee!=null&&(Ee[0]=pt),Ne!=null&&(Ne[0]=Se),xe[0]+=18,ge[0]-=18,Me[0]=1}ge=0}}if(ve=ve[0],pe=pe[0],ge!=0)return ge;if(xe=!!(2&pe),!we&&ve)return 3;if(M!=null&&(M[0]=!!(16&pe)),B!=null&&(B[0]=xe),z!=null&&(z[0]=0),B=G[0],pe=ie[0],ve&&xe&&W==null){ge=0;break}if(4>x){ge=7;break}if(we&&ve||!we&&!ve&&!n(h,f[0],"ALPH")){x=[x],ce.na=[ce.na],ce.P=[ce.P],ce.Sa=[ce.Sa];e:{Re=h,ge=f,we=x;var Me=ce.gb;Ee=ce.na,Ne=ce.P,We=ce.Sa,pt=22,e(Re!=null),e(we!=null),Se=ge[0];var _t=we[0];for(e(Ee!=null),e(We!=null),Ee[0]=null,Ne[0]=null,We[0]=0;;){if(ge[0]=Se,we[0]=_t,8>_t){ge=7;break e}var Dn=ye(Re,Se+4);if(4294967286<Dn){ge=3;break e}var mt=8+Dn+1&-2;if(pt+=mt,0<Me&&pt>Me){ge=3;break e}if(!n(Re,Se,"VP8 ")||!n(Re,Se,"VP8L")){ge=0;break e}if(_t[0]<mt){ge=7;break e}n(Re,Se,"ALPH")||(Ee[0]=Re,Ne[0]=Se+8,We[0]=Dn),Se+=mt,_t-=mt}}if(x=x[0],ce.na=ce.na[0],ce.P=ce.P[0],ce.Sa=ce.Sa[0],ge!=0)break}x=[x],ce.Ja=[ce.Ja],ce.xa=[ce.xa];e:if(Me=h,ge=f,we=x,Ee=ce.gb[0],Ne=ce.Ja,We=ce.xa,Re=ge[0],Se=!n(Me,Re,"VP8 "),pt=!n(Me,Re,"VP8L"),e(Me!=null),e(we!=null),e(Ne!=null),e(We!=null),8>we[0])ge=7;else{if(Se||pt){if(Me=ye(Me,Re+4),12<=Ee&&Me>Ee-12){ge=3;break e}if(K&&Me>we[0]-8){ge=7;break e}Ne[0]=Me,ge[0]+=8,we[0]-=8,We[0]=pt}else We[0]=5<=we[0]&&Me[Re+0]==47&&!(Me[Re+4]>>5),Ne[0]=we[0];ge=0}if(x=x[0],ce.Ja=ce.Ja[0],ce.xa=ce.xa[0],f=f[0],ge!=0)break;if(4294967286<ce.Ja)return 3;if(z==null||xe||(z[0]=ce.xa?2:1),B=[B],pe=[pe],ce.xa){if(5>x){ge=7;break}z=B,K=pe,xe=M,h==null||5>x?h=0:5<=x&&h[f+0]==47&&!(h[f+4]>>5)?(we=[0],Me=[0],Ee=[0],ae(Ne=new H,h,f,x),Zs(Ne,we,Me,Ee)?(z!=null&&(z[0]=we[0]),K!=null&&(K[0]=Me[0]),xe!=null&&(xe[0]=Ee[0]),h=1):h=0):h=0}else{if(10>x){ge=7;break}z=pe,h==null||10>x||!Cd(h,f+3,x-3)?h=0:(K=h[f+0]|h[f+1]<<8|h[f+2]<<16,xe=16383&(h[f+7]<<8|h[f+6]),h=16383&(h[f+9]<<8|h[f+8]),1&K||3<(K>>1&7)||!(K>>4&1)||K>>5>=ce.Ja||!xe||!h?h=0:(B&&(B[0]=xe),z&&(z[0]=h),h=1))}if(!h||(B=B[0],pe=pe[0],ve&&(G[0]!=B||ie[0]!=pe)))return 3;W!=null&&(W[0]=ce,W.offset=f-W.w,e(4294967286>f-W.w),e(W.offset==W.ha-x));break}return ge==0||ge==7&&ve&&W==null?(M!=null&&(M[0]|=ce.na!=null&&0<ce.na.length),C!=null&&(C[0]=B),q!=null&&(q[0]=pe),0):ge}function Zl(h,f,x){var C=f.width,q=f.height,M=0,B=0,z=C,W=q;if(f.Da=h!=null&&0<h.Da,f.Da&&(z=h.cd,W=h.bd,M=h.v,B=h.j,11>x||(M&=-2,B&=-2),0>M||0>B||0>=z||0>=W||M+z>C||B+W>q))return 0;if(f.v=M,f.j=B,f.va=M+z,f.o=B+W,f.U=z,f.T=W,f.da=h!=null&&0<h.da,f.da){if(!Ve(z,W,x=[h.ib],M=[h.hb]))return 0;f.ib=x[0],f.hb=M[0]}return f.ob=h!=null&&h.ob,f.Kb=h==null||!h.Sd,f.da&&(f.ob=f.ib<3*C/4&&f.hb<3*q/4,f.Kb=0),1}function Yl(h){if(h==null)return 2;if(11>h.S){var f=h.f.RGBA;f.fb+=(h.height-1)*f.A,f.A=-f.A}else f=h.f.kb,h=h.height,f.O+=(h-1)*f.fa,f.fa=-f.fa,f.N+=(h-1>>1)*f.Ab,f.Ab=-f.Ab,f.W+=(h-1>>1)*f.Db,f.Db=-f.Db,f.F!=null&&(f.J+=(h-1)*f.lb,f.lb=-f.lb);return 0}function Ea(h,f,x,C){if(C==null||0>=h||0>=f)return 2;if(x!=null){if(x.Da){var q=x.cd,M=x.bd,B=-2&x.v,z=-2&x.j;if(0>B||0>z||0>=q||0>=M||B+q>h||z+M>f)return 2;h=q,f=M}if(x.da){if(!Ve(h,f,q=[x.ib],M=[x.hb]))return 2;h=q[0],f=M[0]}}C.width=h,C.height=f;e:{var W=C.width,G=C.height;if(h=C.S,0>=W||0>=G||!(h>=Ud&&13>h))h=2;else{if(0>=C.Rd&&C.sd==null){B=M=q=f=0;var ie=(z=W*e1[h])*G;if(11>h||(M=(G+1)/2*(f=(W+1)/2),h==12&&(B=(q=W)*G)),(G=i(ie+2*M+B))==null){h=1;break e}C.sd=G,11>h?((W=C.f.RGBA).eb=G,W.fb=0,W.A=z,W.size=ie):((W=C.f.kb).y=G,W.O=0,W.fa=z,W.Fd=ie,W.f=G,W.N=0+ie,W.Ab=f,W.Cd=M,W.ea=G,W.W=0+ie+M,W.Db=f,W.Ed=M,h==12&&(W.F=G,W.J=0+ie+2*M),W.Tc=B,W.lb=q)}if(f=1,q=C.S,M=C.width,B=C.height,q>=Ud&&13>q)if(11>q)h=C.f.RGBA,f&=(z=Math.abs(h.A))*(B-1)+M<=h.size,f&=z>=M*e1[q],f&=h.eb!=null;else{h=C.f.kb,z=(M+1)/2,ie=(B+1)/2,W=Math.abs(h.fa),G=Math.abs(h.Ab);var ve=Math.abs(h.Db),K=Math.abs(h.lb),ce=K*(B-1)+M;f&=W*(B-1)+M<=h.Fd,f&=G*(ie-1)+z<=h.Cd,f=(f&=ve*(ie-1)+z<=h.Ed)&W>=M&G>=z&ve>=z,f&=h.y!=null,f&=h.f!=null,f&=h.ea!=null,q==12&&(f&=K>=M,f&=ce<=h.Tc,f&=h.F!=null)}else f=0;h=f?0:2}}return h!=0||x!=null&&x.fd&&(h=Yl(C)),h}var Bi=64,Ar=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Er=24,Da=32,na=8,Pa=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Pe("Predictor0","PredictorAdd0"),A.Predictor0=function(){return 4278190080},A.Predictor1=function(h){return h},A.Predictor2=function(h,f,x){return f[x+0]},A.Predictor3=function(h,f,x){return f[x+1]},A.Predictor4=function(h,f,x){return f[x-1]},A.Predictor5=function(h,f,x){return Fe(Fe(h,f[x+1]),f[x+0])},A.Predictor6=function(h,f,x){return Fe(h,f[x-1])},A.Predictor7=function(h,f,x){return Fe(h,f[x+0])},A.Predictor8=function(h,f,x){return Fe(f[x-1],f[x+0])},A.Predictor9=function(h,f,x){return Fe(f[x+0],f[x+1])},A.Predictor10=function(h,f,x){return Fe(Fe(h,f[x-1]),Fe(f[x+0],f[x+1]))},A.Predictor11=function(h,f,x){var C=f[x+0];return 0>=Je(C>>24&255,h>>24&255,(f=f[x-1])>>24&255)+Je(C>>16&255,h>>16&255,f>>16&255)+Je(C>>8&255,h>>8&255,f>>8&255)+Je(255&C,255&h,255&f)?C:h},A.Predictor12=function(h,f,x){var C=f[x+0];return(Ye((h>>24&255)+(C>>24&255)-((f=f[x-1])>>24&255))<<24|Ye((h>>16&255)+(C>>16&255)-(f>>16&255))<<16|Ye((h>>8&255)+(C>>8&255)-(f>>8&255))<<8|Ye((255&h)+(255&C)-(255&f)))>>>0},A.Predictor13=function(h,f,x){var C=f[x-1];return(Qe((h=Fe(h,f[x+0]))>>24&255,C>>24&255)<<24|Qe(h>>16&255,C>>16&255)<<16|Qe(h>>8&255,C>>8&255)<<8|Qe(255&h,255&C))>>>0};var Jl=A.PredictorAdd0;A.PredictorAdd1=Et,Pe("Predictor2","PredictorAdd2"),Pe("Predictor3","PredictorAdd3"),Pe("Predictor4","PredictorAdd4"),Pe("Predictor5","PredictorAdd5"),Pe("Predictor6","PredictorAdd6"),Pe("Predictor7","PredictorAdd7"),Pe("Predictor8","PredictorAdd8"),Pe("Predictor9","PredictorAdd9"),Pe("Predictor10","PredictorAdd10"),Pe("Predictor11","PredictorAdd11"),Pe("Predictor12","PredictorAdd12"),Pe("Predictor13","PredictorAdd13");var Eo=A.PredictorAdd2;Ge("ColorIndexInverseTransform","MapARGB","32b",function(h){return h>>8&255},function(h){return h}),Ge("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(h){return h},function(h){return h>>8&255});var hn,Fd=A.ColorIndexInverseTransform,Ls=A.MapARGB,Ts=A.VP8LColorIndexInverseTransformAlpha,Xl=A.MapAlpha,Ql=A.VP8LPredictorsAdd=[];Ql.length=16,(A.VP8LPredictors=[]).length=16,(A.VP8LPredictorsAdd_C=[]).length=16,(A.VP8LPredictors_C=[]).length=16;var ec,tc,La,Ta,Ia,Ui,Ra,$i,Yr,Is,Ct,qt,fn,En,ra,nc,Do,Md,E0,D0,P0,L0,T0,I0,rc,R0,q0,O0,F0=i(511),M0=i(2041),B0=i(225),U0=i(767),$0=0,jf=M0,Bd=B0,Dr=U0,Jr=F0,Ud=0,$d=1,z0=2,zd=3,Wd=4,Sf=5,W0=6,kf=7,Nf=8,Hd=9,Cf=10,Bx=[2,3,7],Ux=[3,3,11],H0=[280,256,256,256,40],$x=[0,1,1,1,0],zx=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Wx=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Hx=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Vx=8,Af=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Ef=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],sc=null,Gx=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Kx=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],V0=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Zx=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Yx=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Jx=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Xx=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],qa=[],fs=[],sa=[],Qx=1,G0=2,Oa=[],Xr=[];gr("UpsampleRgbLinePair",Ri,3),gr("UpsampleBgrLinePair",qi,3),gr("UpsampleRgbaLinePair",Kl,4),gr("UpsampleBgraLinePair",Gl,4),gr("UpsampleArgbLinePair",Fi,4),gr("UpsampleRgba4444LinePair",Oi,2),gr("UpsampleRgb565LinePair",Qn,2);var ew=A.UpsampleRgbLinePair,tw=A.UpsampleBgrLinePair,K0=A.UpsampleRgbaLinePair,Z0=A.UpsampleBgraLinePair,Y0=A.UpsampleArgbLinePair,J0=A.UpsampleRgba4444LinePair,nw=A.UpsampleRgb565LinePair,Vd=16,Gd=1<<Vd-1,ac=-227,Df=482,rw=6,X0=0,sw=i(256),aw=i(256),iw=i(256),ow=i(256),lw=i(Df-ac),cw=i(Df-ac);ta("YuvToRgbRow",Ri,3),ta("YuvToBgrRow",qi,3),ta("YuvToRgbaRow",Kl,4),ta("YuvToBgraRow",Gl,4),ta("YuvToArgbRow",Fi,4),ta("YuvToRgba4444Row",Oi,2),ta("YuvToRgb565Row",Qn,2);var Q0=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Kd=[0,2,8],dw=[8,7,6,4,4,2,2,2,1,1,1,1],uw=1;this.WebPDecodeRGBA=function(h,f,x,C,q){var M=$d,B=new he,z=new Rt;B.ba=z,z.S=M,z.width=[z.width],z.height=[z.height];var W=z.width,G=z.height,ie=new at;if(ie==null||h==null)var ve=2;else e(ie!=null),ve=Mi(h,f,x,ie.width,ie.height,ie.Pd,ie.Qd,ie.format,null);if(ve!=0?W=0:(W!=null&&(W[0]=ie.width[0]),G!=null&&(G[0]=ie.height[0]),W=1),W){z.width=z.width[0],z.height=z.height[0],C!=null&&(C[0]=z.width),q!=null&&(q[0]=z.height);e:{if(C=new wo,(q=new je).data=h,q.w=f,q.ha=x,q.kd=1,f=[0],e(q!=null),((h=Mi(q.data,q.w,q.ha,null,null,null,f,null,q))==0||h==7)&&f[0]&&(h=4),(f=h)==0){if(e(B!=null),C.data=q.data,C.w=q.w+q.offset,C.ha=q.ha-q.offset,C.put=Ze,C.ac=As,C.bc=Ks,C.ma=B,q.xa){if((h=wi())==null){B=1;break e}if(function(K,ce){var pe=[0],xe=[0],ge=[0];t:for(;;){if(K==null)return 0;if(ce==null)return K.a=2,0;if(K.l=ce,K.a=0,ae(K.m,ce.data,ce.w,ce.ha),!Zs(K.m,pe,xe,ge)){K.a=3;break t}if(K.xb=G0,ce.width=pe[0],ce.height=xe[0],!Ds(pe[0],xe[0],1,K,null))break t;return 1}return e(K.a!=0),0}(h,C)){if(C=(f=Ea(C.width,C.height,B.Oa,B.ba))==0){t:{C=h;n:for(;;){if(C==null){C=0;break t}if(e(C.s.yc!=null),e(C.s.Ya!=null),e(0<C.s.Wb),e((x=C.l)!=null),e((q=x.ma)!=null),C.xb!=0){if(C.ca=q.ba,C.tb=q.tb,e(C.ca!=null),!Zl(q.Oa,x,zd)){C.a=2;break n}if(!ji(C,x.width)||x.da)break n;if((x.da||ut(C.ca.S))&&Kr(),11>C.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),C.ca.f.kb.F!=null&&Kr()),C.Pb&&0<C.s.ua&&C.s.vb.X==null&&!Q(C.s.vb,C.s.Wa.Xa)){C.a=1;break n}C.xb=0}if(!us(C,C.V,C.Ba,C.c,C.i,x.o,ka))break n;q.Dc=C.Ma,C=1;break t}e(C.a!=0),C=0}C=!C}C&&(f=h.a)}else f=h.a}else{if((h=new lf)==null){B=1;break e}if(h.Fa=q.na,h.P=q.P,h.qc=q.Sa,Ad(h,C)){if((f=Ea(C.width,C.height,B.Oa,B.ba))==0){if(h.Aa=0,x=B.Oa,e((q=h)!=null),x!=null){if(0<(W=0>(W=x.Md)?0:100<W?255:255*W/100)){for(G=ie=0;4>G;++G)12>(ve=q.pb[G]).lc&&(ve.ia=W*dw[0>ve.lc?0:ve.lc]>>3),ie|=ve.ia;ie&&(alert("todo:VP8InitRandom"),q.ia=1)}q.Ga=x.Id,100<q.Ga?q.Ga=100:0>q.Ga&&(q.Ga=0)}(function(K,ce){if(K==null)return 0;if(ce==null)return wn(K,2,"NULL VP8Io parameter in VP8Decode().");if(!K.cb&&!Ad(K,ce))return 0;if(e(K.cb),ce.ac==null||ce.ac(ce)){ce.ob&&(K.L=0);var pe=Kd[K.L];if(K.L==2?(K.yb=0,K.zb=0):(K.yb=ce.v-pe>>4,K.zb=ce.j-pe>>4,0>K.yb&&(K.yb=0),0>K.zb&&(K.zb=0)),K.Va=ce.o+15+pe>>4,K.Hb=ce.va+15+pe>>4,K.Hb>K.za&&(K.Hb=K.za),K.Va>K.Ub&&(K.Va=K.Ub),0<K.L){var xe=K.ed;for(pe=0;4>pe;++pe){var ge;if(K.Qa.Cb){var we=K.Qa.Lb[pe];K.Qa.Fb||(we+=xe.Tb)}else we=xe.Tb;for(ge=0;1>=ge;++ge){var Se=K.gd[pe][ge],Ee=we;if(xe.Pc&&(Ee+=xe.vd[0],ge&&(Ee+=xe.od[0])),0<(Ee=0>Ee?0:63<Ee?63:Ee)){var Ne=Ee;0<xe.wb&&(Ne=4<xe.wb?Ne>>2:Ne>>1)>9-xe.wb&&(Ne=9-xe.wb),1>Ne&&(Ne=1),Se.dd=Ne,Se.tc=2*Ee+Ne,Se.ld=40<=Ee?2:15<=Ee?1:0}else Se.tc=0;Se.La=ge}}}pe=0}else wn(K,6,"Frame setup failed"),pe=K.a;if(pe=pe==0){if(pe){K.$c=0,0<K.Aa||(K.Ic=uw);t:{pe=K.Ic,xe=4*(Ne=K.za);var We=32*Ne,Re=Ne+1,pt=0<K.L?Ne*(0<K.Aa?2:1):0,Me=(K.Aa==2?2:1)*Ne;if((Se=xe+832+(ge=3*(16*pe+Kd[K.L])/2*We)+(we=K.Fa!=null&&0<K.Fa.length?K.Kc.c*K.Kc.i:0))!=Se)pe=0;else{if(Se>K.Vb){if(K.Vb=0,K.Ec=i(Se),K.Fc=0,K.Ec==null){pe=wn(K,1,"no memory during frame initialization.");break t}K.Vb=Se}Se=K.Ec,Ee=K.Fc,K.Ac=Se,K.Bc=Ee,Ee+=xe,K.Gd=o(We,kd),K.Hd=0,K.rb=o(Re+1,ql),K.sb=1,K.wa=pt?o(pt,Gr):null,K.Y=0,K.D.Nb=0,K.D.wa=K.wa,K.D.Y=K.Y,0<K.Aa&&(K.D.Y+=Ne),e(!0),K.oc=Se,K.pc=Ee,Ee+=832,K.ya=o(Me,Ol),K.aa=0,K.D.ya=K.ya,K.D.aa=K.aa,K.Aa==2&&(K.D.aa+=Ne),K.R=16*Ne,K.B=8*Ne,Ne=(We=Kd[K.L])*K.R,We=We/2*K.B,K.sa=Se,K.ta=Ee+Ne,K.qa=K.sa,K.ra=K.ta+16*pe*K.R+We,K.Ha=K.qa,K.Ia=K.ra+8*pe*K.B+We,K.$c=0,Ee+=ge,K.mb=we?Se:null,K.nb=we?Ee:null,e(Ee+we<=K.Fc+K.Vb),Si(K),s(K.Ac,K.Bc,0,xe),pe=1}}if(pe){if(ce.ka=0,ce.y=K.sa,ce.O=K.ta,ce.f=K.qa,ce.N=K.ra,ce.ea=K.Ha,ce.Vd=K.Ia,ce.fa=K.R,ce.Rc=K.B,ce.F=null,ce.J=0,!$0){for(pe=-255;255>=pe;++pe)F0[255+pe]=0>pe?-pe:pe;for(pe=-1020;1020>=pe;++pe)M0[1020+pe]=-128>pe?-128:127<pe?127:pe;for(pe=-112;112>=pe;++pe)B0[112+pe]=-16>pe?-16:15<pe?15:pe;for(pe=-255;510>=pe;++pe)U0[255+pe]=0>pe?0:255<pe?255:pe;$0=1}Ra=Dd,$i=df,Is=uf,Ct=Ps,qt=Ed,Yr=cf,fn=Td,En=Id,ra=v,nc=R,Do=Li,Md=Rd,E0=Y,D0=se,P0=Vl,L0=Pi,T0=Pd,I0=Ld,fs[0]=yf,fs[1]=Ml,fs[2]=gf,fs[3]=vf,fs[4]=bf,fs[5]=Xs,fs[6]=Js,fs[7]=_f,fs[8]=jo,fs[9]=xf,qa[0]=Ca,qa[1]=ff,qa[2]=pf,qa[3]=Bl,qa[4]=mf,qa[5]=Ci,qa[6]=Ul,sa[0]=ko,sa[1]=hf,sa[2]=$l,sa[3]=Ai,sa[4]=zl,sa[5]=wf,sa[6]=Wl,pe=1}else pe=0}pe&&(pe=function(_t,Dn){for(_t.M=0;_t.M<_t.Va;++_t.M){var mt,Be=_t.Jc[_t.M&_t.Xb],Le=_t.m,pn=_t;for(mt=0;mt<pn.za;++mt){var ht=Le,xt=pn,Ht=xt.Ac,$n=xt.Bc+4*mt,cr=xt.zc,sn=xt.ya[xt.aa+mt];if(xt.Qa.Bb?sn.$b=fe(ht,xt.Pa.jb[0])?2+fe(ht,xt.Pa.jb[2]):fe(ht,xt.Pa.jb[1]):sn.$b=0,xt.kc&&(sn.Ad=fe(ht,xt.Bd)),sn.Za=!fe(ht,145)+0,sn.Za){var er=sn.Ob,dr=0;for(xt=0;4>xt;++xt){var Pn,wt=cr[0+xt];for(Pn=0;4>Pn;++Pn){wt=Yx[Ht[$n+Pn]][wt];for(var Dt=V0[fe(ht,wt[0])];0<Dt;)Dt=V0[2*Dt+fe(ht,wt[Dt])];wt=-Dt,Ht[$n+Pn]=wt}r(er,dr,Ht,$n,4),dr+=4,cr[0+xt]=wt}}else wt=fe(ht,156)?fe(ht,128)?1:3:fe(ht,163)?2:0,sn.Ob[0]=wt,s(Ht,$n,wt,4),s(cr,0,wt,4);sn.Dd=fe(ht,142)?fe(ht,114)?fe(ht,183)?1:3:2:0}if(pn.m.Ka)return wn(_t,7,"Premature end-of-partition0 encountered.");for(;_t.ja<_t.za;++_t.ja){if(pn=Be,ht=(Le=_t).rb[Le.sb-1],Ht=Le.rb[Le.sb+Le.ja],mt=Le.ya[Le.aa+Le.ja],$n=Le.kc?mt.Ad:0)ht.la=Ht.la=0,mt.Za||(ht.Na=Ht.Na=0),mt.Hc=0,mt.Gc=0,mt.ia=0;else{var an,Pt;if(ht=Ht,Ht=pn,$n=Le.Pa.Xc,cr=Le.ya[Le.aa+Le.ja],sn=Le.pb[cr.$b],xt=cr.ad,er=0,dr=Le.rb[Le.sb-1],wt=Pn=0,s(xt,er,0,384),cr.Za)var zn=0,ps=$n[3];else{Dt=i(16);var mn=ht.Na+dr.Na;if(mn=sc(Ht,$n[1],mn,sn.Eb,0,Dt,0),ht.Na=dr.Na=(0<mn)+0,1<mn)Ra(Dt,0,xt,er);else{var vr=Dt[0]+3>>3;for(Dt=0;256>Dt;Dt+=16)xt[er+Dt]=vr}zn=1,ps=$n[0]}var Ot=15&ht.la,Ln=15&dr.la;for(Dt=0;4>Dt;++Dt){var Pr=1&Ln;for(vr=Pt=0;4>vr;++vr)Ot=Ot>>1|(Pr=(mn=sc(Ht,ps,mn=Pr+(1&Ot),sn.Sc,zn,xt,er))>zn)<<7,Pt=Pt<<2|(3<mn?3:1<mn?2:xt[er+0]!=0),er+=16;Ot>>=4,Ln=Ln>>1|Pr<<7,Pn=(Pn<<8|Pt)>>>0}for(ps=Ot,zn=Ln>>4,an=0;4>an;an+=2){for(Pt=0,Ot=ht.la>>4+an,Ln=dr.la>>4+an,Dt=0;2>Dt;++Dt){for(Pr=1&Ln,vr=0;2>vr;++vr)mn=Pr+(1&Ot),Ot=Ot>>1|(Pr=0<(mn=sc(Ht,$n[2],mn,sn.Qc,0,xt,er)))<<3,Pt=Pt<<2|(3<mn?3:1<mn?2:xt[er+0]!=0),er+=16;Ot>>=2,Ln=Ln>>1|Pr<<5}wt|=Pt<<4*an,ps|=Ot<<4<<an,zn|=(240&Ln)<<an}ht.la=ps,dr.la=zn,cr.Hc=Pn,cr.Gc=wt,cr.ia=43690&wt?0:sn.ia,$n=!(Pn|wt)}if(0<Le.L&&(Le.wa[Le.Y+Le.ja]=Le.gd[mt.$b][mt.Za],Le.wa[Le.Y+Le.ja].La|=!$n),pn.Ka)return wn(_t,7,"Premature end-of-file encountered.")}if(Si(_t),Le=Dn,pn=1,mt=(Be=_t).D,ht=0<Be.L&&Be.M>=Be.zb&&Be.M<=Be.Va,Be.Aa==0)t:{if(mt.M=Be.M,mt.uc=ht,Zr(Be,mt),pn=1,mt=(Pt=Be.D).Nb,ht=(wt=Kd[Be.L])*Be.R,Ht=wt/2*Be.B,Dt=16*mt*Be.R,vr=8*mt*Be.B,$n=Be.sa,cr=Be.ta-ht+Dt,sn=Be.qa,xt=Be.ra-Ht+vr,er=Be.Ha,dr=Be.Ia-Ht+vr,Ln=(Ot=Pt.M)==0,Pn=Ot>=Be.Va-1,Be.Aa==2&&Zr(Be,Pt),Pt.uc)for(Pr=(mn=Be).D.M,e(mn.D.uc),Pt=mn.yb;Pt<mn.Hb;++Pt){zn=Pt,ps=Pr;var ur=(Lr=(Wn=mn).D).Nb;an=Wn.R;var Lr=Lr.wa[Lr.Y+zn],Tr=Wn.sa,yr=Wn.ta+16*ur*an+16*zn,Ir=Lr.dd,Ut=Lr.tc;if(Ut!=0)if(e(3<=Ut),Wn.L==1)0<zn&&L0(Tr,yr,an,Ut+4),Lr.La&&I0(Tr,yr,an,Ut),0<ps&&P0(Tr,yr,an,Ut+4),Lr.La&&T0(Tr,yr,an,Ut);else{var Rr=Wn.B,ms=Wn.qa,zi=Wn.ra+8*ur*Rr+8*zn,aa=Wn.Ha,Wn=Wn.Ia+8*ur*Rr+8*zn;ur=Lr.ld,0<zn&&(En(Tr,yr,an,Ut+4,Ir,ur),nc(ms,zi,aa,Wn,Rr,Ut+4,Ir,ur)),Lr.La&&(Md(Tr,yr,an,Ut,Ir,ur),D0(ms,zi,aa,Wn,Rr,Ut,Ir,ur)),0<ps&&(fn(Tr,yr,an,Ut+4,Ir,ur),ra(ms,zi,aa,Wn,Rr,Ut+4,Ir,ur)),Lr.La&&(Do(Tr,yr,an,Ut,Ir,ur),E0(ms,zi,aa,Wn,Rr,Ut,Ir,ur))}}if(Be.ia&&alert("todo:DitherRow"),Le.put!=null){if(Pt=16*Ot,Ot=16*(Ot+1),Ln?(Le.y=Be.sa,Le.O=Be.ta+Dt,Le.f=Be.qa,Le.N=Be.ra+vr,Le.ea=Be.Ha,Le.W=Be.Ia+vr):(Pt-=wt,Le.y=$n,Le.O=cr,Le.f=sn,Le.N=xt,Le.ea=er,Le.W=dr),Pn||(Ot-=wt),Ot>Le.o&&(Ot=Le.o),Le.F=null,Le.J=null,Be.Fa!=null&&0<Be.Fa.length&&Pt<Ot&&(Le.J=jn(Be,Le,Pt,Ot-Pt),Le.F=Be.mb,Le.F==null&&Le.F.length==0)){pn=wn(Be,3,"Could not decode alpha data.");break t}Pt<Le.j&&(wt=Le.j-Pt,Pt=Le.j,e(!(1&wt)),Le.O+=Be.R*wt,Le.N+=Be.B*(wt>>1),Le.W+=Be.B*(wt>>1),Le.F!=null&&(Le.J+=Le.width*wt)),Pt<Ot&&(Le.O+=Le.v,Le.N+=Le.v>>1,Le.W+=Le.v>>1,Le.F!=null&&(Le.J+=Le.v),Le.ka=Pt-Le.j,Le.U=Le.va-Le.v,Le.T=Ot-Pt,pn=Le.put(Le))}mt+1!=Be.Ic||Pn||(r(Be.sa,Be.ta-ht,$n,cr+16*Be.R,ht),r(Be.qa,Be.ra-Ht,sn,xt+8*Be.B,Ht),r(Be.Ha,Be.Ia-Ht,er,dr+8*Be.B,Ht))}if(!pn)return wn(_t,6,"Output aborted.")}return 1}(K,ce)),ce.bc!=null&&ce.bc(ce),pe&=1}return pe?(K.cb=0,pe):0})(h,C)||(f=h.a)}}else f=h.a}f==0&&B.Oa!=null&&B.Oa.fd&&(f=Yl(B.ba))}B=f}M=B!=0?null:11>M?z.f.RGBA.eb:z.f.kb.y}else M=null;return M};var e1=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(A,$){for(var D="",F=0;F<4;F++)D+=String.fromCharCode(A[$++]);return D}function u(A,$){return A[$+0]|A[$+1]<<8}function p(A,$){return(A[$+0]|A[$+1]<<8|A[$+2]<<16)>>>0}function g(A,$){return(A[$+0]|A[$+1]<<8|A[$+2]<<16|A[$+3]<<24)>>>0}new c;var m=[0],j=[0],k=[],w=new c,y=t,_=function(A,$){var D={},F=0,L=!1,I=0,X=0;if(D.frames=[],!function(E,H){for(var J=0;J<4;J++)if(E[H+J]!="RIFF".charCodeAt(J))return!0;return!1}(A,$)){for(g(A,$+=4),$+=8;$<A.length;){var te=d(A,$),oe=g(A,$+=4);$+=4;var Z=oe+(1&oe);switch(te){case"VP8 ":case"VP8L":D.frames[F]===void 0&&(D.frames[F]={}),(de=D.frames[F]).src_off=L?X:$-8,de.src_size=I+oe+8,F++,L&&(L=!1,I=0,X=0);break;case"VP8X":(de=D.header={}).feature_flags=A[$];var ae=$+4;de.canvas_width=1+p(A,ae),ae+=3,de.canvas_height=1+p(A,ae),ae+=3;break;case"ALPH":L=!0,I=Z+8,X=$-8;break;case"ANIM":(de=D.header).bgcolor=g(A,$),ae=$+4,de.loop_count=u(A,ae),ae+=2;break;case"ANMF":var ee,de;(de=D.frames[F]={}).offset_x=2*p(A,$),$+=3,de.offset_y=2*p(A,$),$+=3,de.width=1+p(A,$),$+=3,de.height=1+p(A,$),$+=3,de.duration=p(A,$),$+=3,ee=A[$++],de.dispose=1&ee,de.blend=ee>>1&1}te!="ANMF"&&($+=Z)}return D}}(y,0);_.response=y,_.rgbaoutput=!0,_.dataurl=!1;var S=_.header?_.header:null,N=_.frames?_.frames:null;if(S){S.loop_counter=S.loop_count,m=[S.canvas_height],j=[S.canvas_width];for(var T=0;T<N.length&&N[T].blend!=0;T++);}var U=N[0],P=w.WebPDecodeRGBA(y,U.src_off,U.src_size,j,m);U.rgba=P,U.imgwidth=j[0],U.imgheight=m[0];for(var b=0;b<j[0]*m[0]*4;b++)k[b]=P[b];return this.width=j,this.height=m,this.data=k,this}(function(t){var e,n,r,s,i,o,l,c,d,u=function(E){return E=E||{},this.isStrokeTransparent=E.isStrokeTransparent||!1,this.strokeOpacity=E.strokeOpacity||1,this.strokeStyle=E.strokeStyle||"#000000",this.fillStyle=E.fillStyle||"#000000",this.isFillTransparent=E.isFillTransparent||!1,this.fillOpacity=E.fillOpacity||1,this.font=E.font||"10px sans-serif",this.textBaseline=E.textBaseline||"alphabetic",this.textAlign=E.textAlign||"left",this.lineWidth=E.lineWidth||1,this.lineJoin=E.lineJoin||"miter",this.lineCap=E.lineCap||"butt",this.path=E.path||[],this.transform=E.transform!==void 0?E.transform.clone():new c,this.globalCompositeOperation=E.globalCompositeOperation||"normal",this.globalAlpha=E.globalAlpha||1,this.clip_path=E.clip_path||[],this.currentPoint=E.currentPoint||new o,this.miterLimit=E.miterLimit||10,this.lastPoint=E.lastPoint||new o,this.lineDashOffset=E.lineDashOffset||0,this.lineDash=E.lineDash||[],this.margin=E.margin||[0,0,0,0],this.prevPageLastElemOffset=E.prevPageLastElemOffset||0,this.ignoreClearRect=typeof E.ignoreClearRect!="boolean"||E.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new p(this),e=this.internal.f2,n=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,d=new u}]);var p=function(E){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var H=E;Object.defineProperty(this,"pdf",{get:function(){return H}});var J=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return J},set:function(ye){J=!!ye}});var V=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return V},set:function(ye){V=!!ye}});var ne=0;Object.defineProperty(this,"posX",{get:function(){return ne},set:function(ye){isNaN(ye)||(ne=ye)}});var le=0;Object.defineProperty(this,"posY",{get:function(){return le},set:function(ye){isNaN(ye)||(le=ye)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(ye){var Q;typeof ye=="number"?Q=[ye,ye,ye,ye]:((Q=new Array(4))[0]=ye[0],Q[1]=ye.length>=2?ye[1]:Q[0],Q[2]=ye.length>=3?ye[2]:Q[0],Q[3]=ye.length>=4?ye[3]:Q[1]),d.margin=Q}});var me=!1;Object.defineProperty(this,"autoPaging",{get:function(){return me},set:function(ye){me=ye}});var re=0;Object.defineProperty(this,"lastBreak",{get:function(){return re},set:function(ye){re=ye}});var fe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return fe},set:function(ye){fe=ye}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(ye){ye instanceof u&&(d=ye)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(ye){d.path=ye}});var _e=[];Object.defineProperty(this,"ctxStack",{get:function(){return _e},set:function(ye){_e=ye}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ye){var Q;Q=g(ye),this.ctx.fillStyle=Q.style,this.ctx.isFillTransparent=Q.a===0,this.ctx.fillOpacity=Q.a,this.pdf.setFillColor(Q.r,Q.g,Q.b,{a:Q.a}),this.pdf.setTextColor(Q.r,Q.g,Q.b,{a:Q.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ye){var Q=g(ye);this.ctx.strokeStyle=Q.style,this.ctx.isStrokeTransparent=Q.a===0,this.ctx.strokeOpacity=Q.a,Q.a===0?this.pdf.setDrawColor(255,255,255):(Q.a,this.pdf.setDrawColor(Q.r,Q.g,Q.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ye){["butt","round","square"].indexOf(ye)!==-1&&(this.ctx.lineCap=ye,this.pdf.setLineCap(ye))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ye){isNaN(ye)||(this.ctx.lineWidth=ye,this.pdf.setLineWidth(ye))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ye){["bevel","round","miter"].indexOf(ye)!==-1&&(this.ctx.lineJoin=ye,this.pdf.setLineJoin(ye))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ye){isNaN(ye)||(this.ctx.miterLimit=ye,this.pdf.setMiterLimit(ye))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ye){this.ctx.textBaseline=ye}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ye){["right","end","center","left","start"].indexOf(ye)!==-1&&(this.ctx.textAlign=ye)}});var ke=null,Ae=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ae},set:function(ye){ke=null,Ae=ye}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ye){var Q;if(this.ctx.font=ye,(Q=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ye))!==null){var st=Q[1];Q[2];var nt=Q[3],Ve=Q[4];Q[5];var ue=Q[6],Te=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ve)[2];Ve=Math.floor(Te==="px"?parseFloat(Ve)*this.pdf.internal.scaleFactor:Te==="em"?parseFloat(Ve)*this.pdf.getFontSize():parseFloat(Ve)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ve);var Pe=function(et){var Ge,Mt,St=[],ze=et.trim();if(ze==="")return Mp;if(ze in W2)return[W2[ze]];for(;ze!=="";){switch(Mt=null,Ge=(ze=V2(ze)).charAt(0)){case'"':case"'":Mt=u8(ze.substring(1),Ge);break;default:Mt=h8(ze)}if(Mt===null||(St.push(Mt[0]),(ze=V2(Mt[1]))!==""&&ze.charAt(0)!==","))return Mp;ze=ze.replace(/^,/,"")}return St}(ue);if(this.fontFaces){var Xe=function(et,Ge){if(ke===null){var Mt=function(St){var ze=[];return Object.keys(St).forEach(function(dt){St[dt].forEach(function(It){var Ke=null;switch(It){case"bold":Ke={family:dt,weight:"bold"};break;case"italic":Ke={family:dt,style:"italic"};break;case"bolditalic":Ke={family:dt,weight:"bold",style:"italic"};break;case"":case"normal":Ke={family:dt}}Ke!==null&&(Ke.ref={name:dt,style:It},ze.push(Ke))})}),ze}(et.getFontList());ke=function(St){for(var ze={},dt=0;dt<St.length;++dt){var It=Fp(St[dt]),Ke=It.family,bt=It.stretch,ut=It.style,dn=It.weight;ze[Ke]=ze[Ke]||{},ze[Ke][bt]=ze[Ke][bt]||{},ze[Ke][bt][ut]=ze[Ke][bt][ut]||{},ze[Ke][bt][ut][dn]=It}return ze}(Mt.concat(Ge))}return ke}(this.pdf,this.fontFaces),Fe=Pe.map(function(et){return{family:et,stretch:"normal",weight:nt,style:st}}),Ye=function(et,Ge,Mt){for(var St=(Mt=Mt||{}).defaultFontFamily||"times",ze=Object.assign({},d8,Mt.genericFontFamilies||{}),dt=null,It=null,Ke=0;Ke<Ge.length;++Ke)if(ze[(dt=Fp(Ge[Ke])).family]&&(dt.family=ze[dt.family]),et.hasOwnProperty(dt.family)){It=et[dt.family];break}if(!(It=It||et[St]))throw new Error("Could not find a font-family for the rule '"+H2(dt)+"' and default family '"+St+"'.");if(It=function(bt,ut){if(ut[bt])return ut[bt];var dn=fg[bt],Cn=dn<=fg.normal?-1:1,Rt=z2(ut,xx,dn,Cn);if(!Rt)throw new Error("Could not find a matching font-stretch value for "+bt);return Rt}(dt.stretch,It),It=function(bt,ut){if(ut[bt])return ut[bt];for(var dn=_x[bt],Cn=0;Cn<dn.length;++Cn)if(ut[dn[Cn]])return ut[dn[Cn]];throw new Error("Could not find a matching font-style for "+bt)}(dt.style,It),!(It=function(bt,ut){if(ut[bt])return ut[bt];if(bt===400&&ut[500])return ut[500];if(bt===500&&ut[400])return ut[400];var dn=c8[bt],Cn=z2(ut,wx,dn,bt<400?-1:1);if(!Cn)throw new Error("Could not find a matching font-weight for value "+bt);return Cn}(dt.weight,It)))throw new Error("Failed to resolve a font for the rule '"+H2(dt)+"'.");return It}(Xe,Fe);this.pdf.setFont(Ye.ref.name,Ye.ref.style)}else{var Qe="";(nt==="bold"||parseInt(nt,10)>=700||st==="bold")&&(Qe="bold"),st==="italic"&&(Qe+="italic"),Qe.length===0&&(Qe="normal");for(var Je="",Et={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},ot=0;ot<Pe.length;ot++){if(this.pdf.internal.getFont(Pe[ot],Qe,{noFallback:!0,disableWarning:!0})!==void 0){Je=Pe[ot];break}if(Qe==="bolditalic"&&this.pdf.internal.getFont(Pe[ot],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Je=Pe[ot],Qe="bold";else if(this.pdf.internal.getFont(Pe[ot],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Je=Pe[ot],Qe="normal";break}}if(Je===""){for(var Ue=0;Ue<Pe.length;Ue++)if(Et[Pe[Ue]]){Je=Et[Pe[Ue]];break}}Je=Je===""?"Times":Je,this.pdf.setFont(Je,Qe)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ye){this.ctx.globalCompositeOperation=ye}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ye){this.ctx.globalAlpha=ye}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ye){this.ctx.lineDashOffset=ye,de.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ye){this.ctx.lineDash=ye,de.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ye){this.ctx.ignoreClearRect=!!ye}})};p.prototype.setLineDash=function(E){this.lineDash=E},p.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},p.prototype.fill=function(){N.call(this,"fill",!1)},p.prototype.stroke=function(){N.call(this,"stroke",!1)},p.prototype.beginPath=function(){this.path=[{type:"begin"}]},p.prototype.moveTo=function(E,H){if(isNaN(E)||isNaN(H))throw Ft.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var J=this.ctx.transform.applyToPoint(new o(E,H));this.path.push({type:"mt",x:J.x,y:J.y}),this.ctx.lastPoint=new o(E,H)},p.prototype.closePath=function(){var E=new o(0,0),H=0;for(H=this.path.length-1;H!==-1;H--)if(this.path[H].type==="begin"&&Lt(this.path[H+1])==="object"&&typeof this.path[H+1].x=="number"){E=new o(this.path[H+1].x,this.path[H+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(E.x,E.y)},p.prototype.lineTo=function(E,H){if(isNaN(E)||isNaN(H))throw Ft.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var J=this.ctx.transform.applyToPoint(new o(E,H));this.path.push({type:"lt",x:J.x,y:J.y}),this.ctx.lastPoint=new o(J.x,J.y)},p.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),N.call(this,null,!0)},p.prototype.quadraticCurveTo=function(E,H,J,V){if(isNaN(J)||isNaN(V)||isNaN(E)||isNaN(H))throw Ft.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ne=this.ctx.transform.applyToPoint(new o(J,V)),le=this.ctx.transform.applyToPoint(new o(E,H));this.path.push({type:"qct",x1:le.x,y1:le.y,x:ne.x,y:ne.y}),this.ctx.lastPoint=new o(ne.x,ne.y)},p.prototype.bezierCurveTo=function(E,H,J,V,ne,le){if(isNaN(ne)||isNaN(le)||isNaN(E)||isNaN(H)||isNaN(J)||isNaN(V))throw Ft.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var me=this.ctx.transform.applyToPoint(new o(ne,le)),re=this.ctx.transform.applyToPoint(new o(E,H)),fe=this.ctx.transform.applyToPoint(new o(J,V));this.path.push({type:"bct",x1:re.x,y1:re.y,x2:fe.x,y2:fe.y,x:me.x,y:me.y}),this.ctx.lastPoint=new o(me.x,me.y)},p.prototype.arc=function(E,H,J,V,ne,le){if(isNaN(E)||isNaN(H)||isNaN(J)||isNaN(V)||isNaN(ne))throw Ft.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(le=!!le,!this.ctx.transform.isIdentity){var me=this.ctx.transform.applyToPoint(new o(E,H));E=me.x,H=me.y;var re=this.ctx.transform.applyToPoint(new o(0,J)),fe=this.ctx.transform.applyToPoint(new o(0,0));J=Math.sqrt(Math.pow(re.x-fe.x,2)+Math.pow(re.y-fe.y,2))}Math.abs(ne-V)>=2*Math.PI&&(V=0,ne=2*Math.PI),this.path.push({type:"arc",x:E,y:H,radius:J,startAngle:V,endAngle:ne,counterclockwise:le})},p.prototype.arcTo=function(E,H,J,V,ne){throw new Error("arcTo not implemented.")},p.prototype.rect=function(E,H,J,V){if(isNaN(E)||isNaN(H)||isNaN(J)||isNaN(V))throw Ft.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(E,H),this.lineTo(E+J,H),this.lineTo(E+J,H+V),this.lineTo(E,H+V),this.lineTo(E,H),this.lineTo(E+J,H),this.lineTo(E,H)},p.prototype.fillRect=function(E,H,J,V){if(isNaN(E)||isNaN(H)||isNaN(J)||isNaN(V))throw Ft.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var ne={};this.lineCap!=="butt"&&(ne.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ne.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(E,H,J,V),this.fill(),ne.hasOwnProperty("lineCap")&&(this.lineCap=ne.lineCap),ne.hasOwnProperty("lineJoin")&&(this.lineJoin=ne.lineJoin)}},p.prototype.strokeRect=function(E,H,J,V){if(isNaN(E)||isNaN(H)||isNaN(J)||isNaN(V))throw Ft.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");j.call(this)||(this.beginPath(),this.rect(E,H,J,V),this.stroke())},p.prototype.clearRect=function(E,H,J,V){if(isNaN(E)||isNaN(H)||isNaN(J)||isNaN(V))throw Ft.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(E,H,J,V))},p.prototype.save=function(E){E=typeof E!="boolean"||E;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,J=0;J<this.pdf.internal.getNumberOfPages();J++)this.pdf.setPage(J+1),this.pdf.internal.out("q");if(this.pdf.setPage(H),E){this.ctx.fontSize=this.pdf.internal.getFontSize();var V=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=V}},p.prototype.restore=function(E){E=typeof E!="boolean"||E;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,J=0;J<this.pdf.internal.getNumberOfPages();J++)this.pdf.setPage(J+1),this.pdf.internal.out("Q");this.pdf.setPage(H),E&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},p.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var g=function(E){var H,J,V,ne;if(E.isCanvasGradient===!0&&(E=E.getColor()),!E)return{r:0,g:0,b:0,a:0,style:E};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(E))H=0,J=0,V=0,ne=0;else{var le=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(E);if(le!==null)H=parseInt(le[1]),J=parseInt(le[2]),V=parseInt(le[3]),ne=1;else if((le=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(E))!==null)H=parseInt(le[1]),J=parseInt(le[2]),V=parseInt(le[3]),ne=parseFloat(le[4]);else{if(ne=1,typeof E=="string"&&E.charAt(0)!=="#"){var me=new fx(E);E=me.ok?me.toHex():"#000000"}E.length===4?(H=E.substring(1,2),H+=H,J=E.substring(2,3),J+=J,V=E.substring(3,4),V+=V):(H=E.substring(1,3),J=E.substring(3,5),V=E.substring(5,7)),H=parseInt(H,16),J=parseInt(J,16),V=parseInt(V,16)}}return{r:H,g:J,b:V,a:ne,style:E}},m=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},j=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};p.prototype.fillText=function(E,H,J,V){if(isNaN(H)||isNaN(J)||typeof E!="string")throw Ft.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(V=isNaN(V)?void 0:V,!m.call(this)){var ne=Z(this.ctx.transform.rotation),le=this.ctx.transform.scaleX;F.call(this,{text:E,x:H,y:J,scale:le,angle:ne,align:this.textAlign,maxWidth:V})}},p.prototype.strokeText=function(E,H,J,V){if(isNaN(H)||isNaN(J)||typeof E!="string")throw Ft.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!j.call(this)){V=isNaN(V)?void 0:V;var ne=Z(this.ctx.transform.rotation),le=this.ctx.transform.scaleX;F.call(this,{text:E,x:H,y:J,scale:le,renderingMode:"stroke",angle:ne,align:this.textAlign,maxWidth:V})}},p.prototype.measureText=function(E){if(typeof E!="string")throw Ft.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var H=this.pdf,J=this.pdf.internal.scaleFactor,V=H.internal.getFontSize(),ne=H.getStringUnitWidth(E)*V/H.internal.scaleFactor;return new function(le){var me=(le=le||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return me}}),this}({width:ne*=Math.round(96*J/72*1e4)/1e4})},p.prototype.scale=function(E,H){if(isNaN(E)||isNaN(H))throw Ft.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var J=new c(E,0,0,H,0,0);this.ctx.transform=this.ctx.transform.multiply(J)},p.prototype.rotate=function(E){if(isNaN(E))throw Ft.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var H=new c(Math.cos(E),Math.sin(E),-Math.sin(E),Math.cos(E),0,0);this.ctx.transform=this.ctx.transform.multiply(H)},p.prototype.translate=function(E,H){if(isNaN(E)||isNaN(H))throw Ft.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var J=new c(1,0,0,1,E,H);this.ctx.transform=this.ctx.transform.multiply(J)},p.prototype.transform=function(E,H,J,V,ne,le){if(isNaN(E)||isNaN(H)||isNaN(J)||isNaN(V)||isNaN(ne)||isNaN(le))throw Ft.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var me=new c(E,H,J,V,ne,le);this.ctx.transform=this.ctx.transform.multiply(me)},p.prototype.setTransform=function(E,H,J,V,ne,le){E=isNaN(E)?1:E,H=isNaN(H)?0:H,J=isNaN(J)?0:J,V=isNaN(V)?1:V,ne=isNaN(ne)?0:ne,le=isNaN(le)?0:le,this.ctx.transform=new c(E,H,J,V,ne,le)};var k=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};p.prototype.drawImage=function(E,H,J,V,ne,le,me,re,fe){var _e=this.pdf.getImageProperties(E),ke=1,Ae=1,ye=1,Q=1;V!==void 0&&re!==void 0&&(ye=re/V,Q=fe/ne,ke=_e.width/V*re/V,Ae=_e.height/ne*fe/ne),le===void 0&&(le=H,me=J,H=0,J=0),V!==void 0&&re===void 0&&(re=V,fe=ne),V===void 0&&re===void 0&&(re=_e.width,fe=_e.height);for(var st,nt=this.ctx.transform.decompose(),Ve=Z(nt.rotate.shx),ue=new c,Te=(ue=(ue=(ue=ue.multiply(nt.translate)).multiply(nt.skew)).multiply(nt.scale)).applyToRectangle(new l(le-H*ye,me-J*Q,V*ke,ne*Ae)),Pe=w.call(this,Te),Xe=[],Fe=0;Fe<Pe.length;Fe+=1)Xe.indexOf(Pe[Fe])===-1&&Xe.push(Pe[Fe]);if(S(Xe),this.autoPaging)for(var Ye=Xe[0],Qe=Xe[Xe.length-1],Je=Ye;Je<Qe+1;Je++){this.pdf.setPage(Je);var Et=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ot=Je===1?this.posY+this.margin[0]:this.margin[0],Ue=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],et=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ge=Je===1?0:Ue+(Je-2)*et;if(this.ctx.clip_path.length!==0){var Mt=this.path;st=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=_(st,this.posX+this.margin[3],-Ge+ot+this.ctx.prevPageLastElemOffset),T.call(this,"fill",!0),this.path=Mt}var St=JSON.parse(JSON.stringify(Te));St=_([St],this.posX+this.margin[3],-Ge+ot+this.ctx.prevPageLastElemOffset)[0];var ze=(Je>Ye||Je<Qe)&&k.call(this);ze&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Et,et,null).clip().discardPath()),this.pdf.addImage(E,"JPEG",St.x,St.y,St.w,St.h,null,null,Ve),ze&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(E,"JPEG",Te.x,Te.y,Te.w,Te.h,null,null,Ve)};var w=function(E,H,J){var V=[];H=H||this.pdf.internal.pageSize.width,J=J||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ne=this.posY+this.ctx.prevPageLastElemOffset;switch(E.type){default:case"mt":case"lt":V.push(Math.floor((E.y+ne)/J)+1);break;case"arc":V.push(Math.floor((E.y+ne-E.radius)/J)+1),V.push(Math.floor((E.y+ne+E.radius)/J)+1);break;case"qct":var le=ae(this.ctx.lastPoint.x,this.ctx.lastPoint.y,E.x1,E.y1,E.x,E.y);V.push(Math.floor((le.y+ne)/J)+1),V.push(Math.floor((le.y+le.h+ne)/J)+1);break;case"bct":var me=ee(this.ctx.lastPoint.x,this.ctx.lastPoint.y,E.x1,E.y1,E.x2,E.y2,E.x,E.y);V.push(Math.floor((me.y+ne)/J)+1),V.push(Math.floor((me.y+me.h+ne)/J)+1);break;case"rect":V.push(Math.floor((E.y+ne)/J)+1),V.push(Math.floor((E.y+E.h+ne)/J)+1)}for(var re=0;re<V.length;re+=1)for(;this.pdf.internal.getNumberOfPages()<V[re];)y.call(this);return V},y=function(){var E=this.fillStyle,H=this.strokeStyle,J=this.font,V=this.lineCap,ne=this.lineWidth,le=this.lineJoin;this.pdf.addPage(),this.fillStyle=E,this.strokeStyle=H,this.font=J,this.lineCap=V,this.lineWidth=ne,this.lineJoin=le},_=function(E,H,J){for(var V=0;V<E.length;V++)switch(E[V].type){case"bct":E[V].x2+=H,E[V].y2+=J;case"qct":E[V].x1+=H,E[V].y1+=J;default:E[V].x+=H,E[V].y+=J}return E},S=function(E){return E.sort(function(H,J){return H-J})},N=function(E,H){for(var J,V,ne=this.fillStyle,le=this.strokeStyle,me=this.lineCap,re=this.lineWidth,fe=Math.abs(re*this.ctx.transform.scaleX),_e=this.lineJoin,ke=JSON.parse(JSON.stringify(this.path)),Ae=JSON.parse(JSON.stringify(this.path)),ye=[],Q=0;Q<Ae.length;Q++)if(Ae[Q].x!==void 0)for(var st=w.call(this,Ae[Q]),nt=0;nt<st.length;nt+=1)ye.indexOf(st[nt])===-1&&ye.push(st[nt]);for(var Ve=0;Ve<ye.length;Ve++)for(;this.pdf.internal.getNumberOfPages()<ye[Ve];)y.call(this);if(S(ye),this.autoPaging)for(var ue=ye[0],Te=ye[ye.length-1],Pe=ue;Pe<Te+1;Pe++){this.pdf.setPage(Pe),this.fillStyle=ne,this.strokeStyle=le,this.lineCap=me,this.lineWidth=fe,this.lineJoin=_e;var Xe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Fe=Pe===1?this.posY+this.margin[0]:this.margin[0],Ye=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Qe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Je=Pe===1?0:Ye+(Pe-2)*Qe;if(this.ctx.clip_path.length!==0){var Et=this.path;J=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=_(J,this.posX+this.margin[3],-Je+Fe+this.ctx.prevPageLastElemOffset),T.call(this,E,!0),this.path=Et}if(V=JSON.parse(JSON.stringify(ke)),this.path=_(V,this.posX+this.margin[3],-Je+Fe+this.ctx.prevPageLastElemOffset),H===!1||Pe===0){var ot=(Pe>ue||Pe<Te)&&k.call(this);ot&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Xe,Qe,null).clip().discardPath()),T.call(this,E,H),ot&&this.pdf.restoreGraphicsState()}this.lineWidth=re}else this.lineWidth=fe,T.call(this,E,H),this.lineWidth=re;this.path=ke},T=function(E,H){if((E!=="stroke"||H||!j.call(this))&&(E==="stroke"||H||!m.call(this))){for(var J,V,ne=[],le=this.path,me=0;me<le.length;me++){var re=le[me];switch(re.type){case"begin":ne.push({begin:!0});break;case"close":ne.push({close:!0});break;case"mt":ne.push({start:re,deltas:[],abs:[]});break;case"lt":var fe=ne.length;if(le[me-1]&&!isNaN(le[me-1].x)&&(J=[re.x-le[me-1].x,re.y-le[me-1].y],fe>0)){for(;fe>=0;fe--)if(ne[fe-1].close!==!0&&ne[fe-1].begin!==!0){ne[fe-1].deltas.push(J),ne[fe-1].abs.push(re);break}}break;case"bct":J=[re.x1-le[me-1].x,re.y1-le[me-1].y,re.x2-le[me-1].x,re.y2-le[me-1].y,re.x-le[me-1].x,re.y-le[me-1].y],ne[ne.length-1].deltas.push(J);break;case"qct":var _e=le[me-1].x+2/3*(re.x1-le[me-1].x),ke=le[me-1].y+2/3*(re.y1-le[me-1].y),Ae=re.x+2/3*(re.x1-re.x),ye=re.y+2/3*(re.y1-re.y),Q=re.x,st=re.y;J=[_e-le[me-1].x,ke-le[me-1].y,Ae-le[me-1].x,ye-le[me-1].y,Q-le[me-1].x,st-le[me-1].y],ne[ne.length-1].deltas.push(J);break;case"arc":ne.push({deltas:[],abs:[],arc:!0}),Array.isArray(ne[ne.length-1].abs)&&ne[ne.length-1].abs.push(re)}}V=H?null:E==="stroke"?"stroke":"fill";for(var nt=!1,Ve=0;Ve<ne.length;Ve++)if(ne[Ve].arc)for(var ue=ne[Ve].abs,Te=0;Te<ue.length;Te++){var Pe=ue[Te];Pe.type==="arc"?b.call(this,Pe.x,Pe.y,Pe.radius,Pe.startAngle,Pe.endAngle,Pe.counterclockwise,void 0,H,!nt):L.call(this,Pe.x,Pe.y),nt=!0}else if(ne[Ve].close===!0)this.pdf.internal.out("h"),nt=!1;else if(ne[Ve].begin!==!0){var Xe=ne[Ve].start.x,Fe=ne[Ve].start.y;I.call(this,ne[Ve].deltas,Xe,Fe),nt=!0}V&&A.call(this,V),H&&$.call(this)}},U=function(E){var H=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,J=H*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return E-J;case"top":return E+H-J;case"hanging":return E+H-2*J;case"middle":return E+H/2-J;default:return E}},P=function(E){return E+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};p.prototype.createLinearGradient=function(){var E=function(){};return E.colorStops=[],E.addColorStop=function(H,J){this.colorStops.push([H,J])},E.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},E.isCanvasGradient=!0,E},p.prototype.createPattern=function(){return this.createLinearGradient()},p.prototype.createRadialGradient=function(){return this.createLinearGradient()};var b=function(E,H,J,V,ne,le,me,re,fe){for(var _e=te.call(this,J,V,ne,le),ke=0;ke<_e.length;ke++){var Ae=_e[ke];ke===0&&(fe?D.call(this,Ae.x1+E,Ae.y1+H):L.call(this,Ae.x1+E,Ae.y1+H)),X.call(this,E,H,Ae.x2,Ae.y2,Ae.x3,Ae.y3,Ae.x4,Ae.y4)}re?$.call(this):A.call(this,me)},A=function(E){switch(E){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},$=function(){this.pdf.clip(),this.pdf.discardPath()},D=function(E,H){this.pdf.internal.out(n(E)+" "+r(H)+" m")},F=function(E){var H;switch(E.align){case"right":case"end":H="right";break;case"center":H="center";break;default:H="left"}var J=this.pdf.getTextDimensions(E.text),V=U.call(this,E.y),ne=P.call(this,V)-J.h,le=this.ctx.transform.applyToPoint(new o(E.x,V)),me=this.ctx.transform.decompose(),re=new c;re=(re=(re=re.multiply(me.translate)).multiply(me.skew)).multiply(me.scale);for(var fe,_e,ke,Ae=this.ctx.transform.applyToRectangle(new l(E.x,V,J.w,J.h)),ye=re.applyToRectangle(new l(E.x,ne,J.w,J.h)),Q=w.call(this,ye),st=[],nt=0;nt<Q.length;nt+=1)st.indexOf(Q[nt])===-1&&st.push(Q[nt]);if(S(st),this.autoPaging)for(var Ve=st[0],ue=st[st.length-1],Te=Ve;Te<ue+1;Te++){this.pdf.setPage(Te);var Pe=Te===1?this.posY+this.margin[0]:this.margin[0],Xe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Fe=this.pdf.internal.pageSize.height-this.margin[2],Ye=Fe-this.margin[0],Qe=this.pdf.internal.pageSize.width-this.margin[1],Je=Qe-this.margin[3],Et=Te===1?0:Xe+(Te-2)*Ye;if(this.ctx.clip_path.length!==0){var ot=this.path;fe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=_(fe,this.posX+this.margin[3],-1*Et+Pe),T.call(this,"fill",!0),this.path=ot}var Ue=_([JSON.parse(JSON.stringify(ye))],this.posX+this.margin[3],-Et+Pe+this.ctx.prevPageLastElemOffset)[0];E.scale>=.01&&(_e=this.pdf.internal.getFontSize(),this.pdf.setFontSize(_e*E.scale),ke=this.lineWidth,this.lineWidth=ke*E.scale);var et=this.autoPaging!=="text";if(et||Ue.y+Ue.h<=Fe){if(et||Ue.y>=Pe&&Ue.x<=Qe){var Ge=et?E.text:this.pdf.splitTextToSize(E.text,E.maxWidth||Qe-Ue.x)[0],Mt=_([JSON.parse(JSON.stringify(Ae))],this.posX+this.margin[3],-Et+Pe+this.ctx.prevPageLastElemOffset)[0],St=et&&(Te>Ve||Te<ue)&&k.call(this);St&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Je,Ye,null).clip().discardPath()),this.pdf.text(Ge,Mt.x,Mt.y,{angle:E.angle,align:H,renderingMode:E.renderingMode}),St&&this.pdf.restoreGraphicsState()}}else Ue.y<Fe&&(this.ctx.prevPageLastElemOffset+=Fe-Ue.y);E.scale>=.01&&(this.pdf.setFontSize(_e),this.lineWidth=ke)}else E.scale>=.01&&(_e=this.pdf.internal.getFontSize(),this.pdf.setFontSize(_e*E.scale),ke=this.lineWidth,this.lineWidth=ke*E.scale),this.pdf.text(E.text,le.x+this.posX,le.y+this.posY,{angle:E.angle,align:H,renderingMode:E.renderingMode,maxWidth:E.maxWidth}),E.scale>=.01&&(this.pdf.setFontSize(_e),this.lineWidth=ke)},L=function(E,H,J,V){J=J||0,V=V||0,this.pdf.internal.out(n(E+J)+" "+r(H+V)+" l")},I=function(E,H,J){return this.pdf.lines(E,H,J,null,null)},X=function(E,H,J,V,ne,le,me,re){this.pdf.internal.out([e(s(J+E)),e(i(V+H)),e(s(ne+E)),e(i(le+H)),e(s(me+E)),e(i(re+H)),"c"].join(" "))},te=function(E,H,J,V){for(var ne=2*Math.PI,le=Math.PI/2;H>J;)H-=ne;var me=Math.abs(J-H);me<ne&&V&&(me=ne-me);for(var re=[],fe=V?-1:1,_e=H;me>1e-5;){var ke=_e+fe*Math.min(me,le);re.push(oe.call(this,E,_e,ke)),me-=Math.abs(ke-_e),_e=ke}return re},oe=function(E,H,J){var V=(J-H)/2,ne=E*Math.cos(V),le=E*Math.sin(V),me=ne,re=-le,fe=me*me+re*re,_e=fe+me*ne+re*le,ke=4/3*(Math.sqrt(2*fe*_e)-_e)/(me*le-re*ne),Ae=me-ke*re,ye=re+ke*me,Q=Ae,st=-ye,nt=V+H,Ve=Math.cos(nt),ue=Math.sin(nt);return{x1:E*Math.cos(H),y1:E*Math.sin(H),x2:Ae*Ve-ye*ue,y2:Ae*ue+ye*Ve,x3:Q*Ve-st*ue,y3:Q*ue+st*Ve,x4:E*Math.cos(J),y4:E*Math.sin(J)}},Z=function(E){return 180*E/Math.PI},ae=function(E,H,J,V,ne,le){var me=E+.5*(J-E),re=H+.5*(V-H),fe=ne+.5*(J-ne),_e=le+.5*(V-le),ke=Math.min(E,ne,me,fe),Ae=Math.max(E,ne,me,fe),ye=Math.min(H,le,re,_e),Q=Math.max(H,le,re,_e);return new l(ke,ye,Ae-ke,Q-ye)},ee=function(E,H,J,V,ne,le,me,re){var fe,_e,ke,Ae,ye,Q,st,nt,Ve,ue,Te,Pe,Xe,Fe,Ye=J-E,Qe=V-H,Je=ne-J,Et=le-V,ot=me-ne,Ue=re-le;for(_e=0;_e<41;_e++)Ve=(st=(ke=E+(fe=_e/40)*Ye)+fe*((ye=J+fe*Je)-ke))+fe*(ye+fe*(ne+fe*ot-ye)-st),ue=(nt=(Ae=H+fe*Qe)+fe*((Q=V+fe*Et)-Ae))+fe*(Q+fe*(le+fe*Ue-Q)-nt),_e==0?(Te=Ve,Pe=ue,Xe=Ve,Fe=ue):(Te=Math.min(Te,Ve),Pe=Math.min(Pe,ue),Xe=Math.max(Xe,Ve),Fe=Math.max(Fe,ue));return new l(Math.round(Te),Math.round(Pe),Math.round(Xe-Te),Math.round(Fe-Pe))},de=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var E,H,J=(E=this.ctx.lineDash,H=this.ctx.lineDashOffset,JSON.stringify({lineDash:E,lineDashOffset:H}));this.prevLineDash!==J&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=J)}}})(He.API),function(t){var e=function(o){var l,c,d,u,p,g,m,j,k,w;for(c=[],d=0,u=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;u>d;d+=4)(p=(o.charCodeAt(d)<<24)+(o.charCodeAt(d+1)<<16)+(o.charCodeAt(d+2)<<8)+o.charCodeAt(d+3))!==0?(g=(p=((p=((p=((p=(p-(w=p%85))/85)-(k=p%85))/85)-(j=p%85))/85)-(m=p%85))/85)%85,c.push(g+33,m+33,j+33,k+33,w+33)):c.push(122);return function(y,_){for(var S=_;S>0;S--)y.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},n=function(o){var l,c,d,u,p,g=String,m="length",j=255,k="charCodeAt",w="slice",y="replace";for(o[w](-2),o=o[w](0,-2)[y](/\s/g,"")[y]("z","!!!!!"),d=[],u=0,p=(o+=l="uuuuu"[w](o[m]%5||5))[m];p>u;u+=5)c=52200625*(o[k](u)-33)+614125*(o[k](u+1)-33)+7225*(o[k](u+2)-33)+85*(o[k](u+3)-33)+(o[k](u+4)-33),d.push(j&c>>24,j&c>>16,j&c>>8,j&c);return function(_,S){for(var N=S;N>0;N--)_.pop()}(d,l[m]),g.fromCharCode.apply(g,d)},r=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",d=0;d<o.length;d+=2)c+=String.fromCharCode("0x"+(o[d]+o[d+1]));return c},i=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=ig(l)).reduce(function(d,u){return d+String.fromCharCode(u)},"")};t.processDataByFilters=function(o,l){var c=0,d=o||"",u=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":d=n(d),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=e(d),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=s(d),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=r(d),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=i(d),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:d,reverseChain:u.reverse().join(" ")}}}(He.API),function(t){t.loadFile=function(e,n,r){return function(s,i,o){i=i!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,d,u){var p=new XMLHttpRequest,g=0,m=function(j){var k=j.length,w=[],y=String.fromCharCode;for(g=0;g<k;g+=1)w.push(y(255&j.charCodeAt(g)));return w.join("")};if(p.open("GET",c,!d),p.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(p.onload=function(){p.status===200?u(m(this.responseText)):u(void 0)}),p.send(null),d&&p.status===200)return m(p.responseText)}(s,i,o)}catch{}return l}(e,n,r)},t.loadImageFile=t.loadFile}(He.API),function(t){function e(){return(tt.html2canvas?Promise.resolve(tt.html2canvas):ui(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function n(){return(tt.DOMPurify?Promise.resolve(tt.DOMPurify):ui(()=>import("./purify.es-aGzT-_H7.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var r=function(l){var c=Lt(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},s=function(l,c){var d=document.createElement(l);for(var u in c.className&&(d.className=c.className),c.innerHTML&&c.dompurify&&(d.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)d.style[u]=c.style[u];return d},i=function l(c,d){for(var u=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),p=c.firstChild;p;p=p.nextSibling)d!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||u.appendChild(l(p,d));return c.nodeType===1&&(c.nodeName==="CANVAS"?(u.width=c.width,u.height=c.height,u.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(u.value=c.value),u.addEventListener("load",function(){u.scrollTop=c.scrollTop,u.scrollLeft=c.scrollLeft},!0)),u},o=function l(c){var d=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),u=l.convert(Promise.resolve(),d);return(u=u.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(d){switch(r(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(n).then(function(d){return this.set({src:s("div",{innerHTML:l,dompurify:d})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,c(this.prop.container,d)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var d=this.opt.jsPDF,u=this.opt.fontFaces,p=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,g=Object.assign({async:!0,allowTaint:!0,scale:p,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete g.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=u,u)for(var m=0;m<u.length;++m){var j=u[m],k=j.src.find(function(w){return w.format==="truetype"});k&&d.addFont(k.url,j.ref.name,j.ref.style)}return g.windowHeight=g.windowHeight||0,g.windowHeight=g.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):g.windowHeight,d.context2d.save(!0),c(this.prop.container,g)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(r(l)!=="object")return this;var c=Object.keys(l||{}).map(function(d){if(d in o.template.prop)return function(){this.prop[d]=l[d]};switch(d){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[d]=l[d]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var d=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(d):d})},o.prototype.setMargin=function(l){return this.then(function(){switch(r(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(d,u){return Math.floor(d*u/72*96)}return this.then(function(){(l=l||He.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,d,u){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),d!=null&&(this.progress.n=d),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,d,u){return this.setProgress(l?this.progress.val+l:null,c||null,d?this.progress.n+d:null,u?this.progress.stack.concat(u):null)},o.prototype.then=function(l,c){var d=this;return this.thenCore(l,c,function(u,p){return d.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(g){return d.updateProgress(null,u),g}).then(u,p).then(function(g){return d.updateProgress(1),g})})},o.prototype.thenCore=function(l,c,d){d=d||Promise.prototype.then;var u=this;l&&(l=l.bind(u)),c&&(c=c.bind(u));var p=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:o.convert(Object.assign({},u),Promise.prototype),g=d.call(p,l,c);return o.convert(g,u.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(d){c=c.thenCore(d)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,He.getPageSize=function(l,c,d){if(Lt(l)==="object"){var u=l;l=u.orientation,c=u.unit||c,d=u.format||d}c=c||"mm",d=d||"a4",l=(""+(l||"P")).toLowerCase();var p,g=(""+d).toLowerCase(),m={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":p=1;break;case"mm":p=72/25.4;break;case"cm":p=72/2.54;break;case"in":p=72;break;case"px":p=.75;break;case"pc":case"em":p=12;break;case"ex":p=6;break;default:throw"Invalid unit: "+c}var j,k=0,w=0;if(m.hasOwnProperty(g))k=m[g][1]/p,w=m[g][0]/p;else try{k=d[1],w=d[0]}catch{throw new Error("Invalid format: "+d)}if(l==="p"||l==="portrait")l="p",w>k&&(j=w,w=k,k=j);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",k>w&&(j=w,w=k,k=j)}return{width:w,height:k,unit:c,k:p,orientation:l}},t.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(Fp):null;var d=new o(c);return c.worker?d:d.from(l).doCallback()}}(He.API),He.API.addJS=function(t){return K2=t,this.internal.events.subscribe("postPutResources",function(){Eu=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Eu+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),G2=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+K2+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Eu!==void 0&&G2!==void 0&&this.internal.out("/Names <</JavaScript "+Eu+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var n=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=n.outline.render().split(/\r\n/),i=0;i<s.length;i++){var o=s[i],l=r.exec(o);if(l!=null){var c=l[1];n.internal.newObjectDeferredBegin(c,!1)}n.internal.write(o)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,u=[];for(i=0;i<d;i++){var p=n.internal.newObject();u.push(p);var g=n.internal.getPageInfo(i+1);n.internal.write("<< /D["+g.objId+" 0 R /XYZ null null null]>> endobj")}var m=n.internal.newObject();for(n.internal.write("<< /Names [ "),i=0;i<u.length;i++)n.internal.write("(page_"+(i+1)+")"+u[i]+" 0 R");n.internal.write(" ] >>","endobj"),e=n.internal.newObject(),n.internal.write("<< /Dests "+m+" 0 R"),n.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var n=this;n.outline.root.children.length>0&&(n.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&n.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(r,s,i){var o={title:s,options:i,children:[]};return r==null&&(r=this.root),r.children.push(o),o},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(r){r.id=n.internal.newObjectDeferred();for(var s=0;s<r.children.length;s++)this.genIds_r(r.children[s])},n.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},n.outline.renderItems=function(r){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<r.children.length;i++){var o=r.children[i];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(r)),i>0&&this.line("/Prev "+this.makeRef(r.children[i-1])),i<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[i+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=n.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var d=0;d<r.children.length;d++)this.renderItems(r.children[d])},n.outline.line=function(r){this.ctx.val+=r+`\r
`},n.outline.makeRef=function(r){return r.id+" 0 R"},n.outline.makeString=function(r){return"("+n.internal.pdfEscape(r)+")"},n.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(r,s){for(var i=0;i<s.children.length;i++)r.count++,this.count_r(r,s.children[i]);return r.count}}])}(He.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(n,r,s,i,o,l){var c,d=this.decode.DCT_DECODE,u=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=o||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,c=function(p){for(var g,m=256*p.charCodeAt(4)+p.charCodeAt(5),j=p.length,k={width:0,height:0,numcomponents:1},w=4;w<j;w+=2){if(w+=m,e.indexOf(p.charCodeAt(w+1))!==-1){g=256*p.charCodeAt(w+5)+p.charCodeAt(w+6),k={width:256*p.charCodeAt(w+7)+p.charCodeAt(w+8),height:g,numcomponents:p.charCodeAt(w+9)};break}m=256*p.charCodeAt(w+2)+p.charCodeAt(w+3)}return k}(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}u={data:n,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:d,index:r,alias:s}}return u}}(He.API),He.API.processPNG=function(t,e,n,r){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var s,i=ZA(t,{checkCrc:!0}),o=i.width,l=i.height,c=i.channels,d=i.palette,u=i.depth;s=d&&c===1?function(b){for(var A=b.width,$=b.height,D=b.data,F=b.palette,L=b.depth,I=!1,X=[],te=[],oe=void 0,Z=!1,ae=0,ee=0;ee<F.length;ee++){var de=Xv(F[ee],4),E=de[0],H=de[1],J=de[2],V=de[3];X.push(E,H,J),V!=null&&(V===0?(ae++,te.length<1&&te.push(ee)):V<255&&(Z=!0))}if(Z||ae>1){I=!0,te=void 0;var ne=A*$;oe=new Uint8Array(ne);for(var le=new DataView(D.buffer),me=0;me<ne;me++){var re=Bp(le,me,L),fe=Xv(F[re],4)[3];oe[me]=fe}}else ae===0&&(te=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:I?8:void 0,colorBytes:D,alphaBytes:oe,needSMask:I,palette:X,mask:te}}(i):c===2||c===4?function(b){for(var A=b.data,$=b.width,D=b.height,F=b.channels,L=b.depth,I=F===2?"DeviceGray":"DeviceRGB",X=F-1,te=$*D,oe=X,Z=te*oe,ae=1*te,ee=Math.ceil(Z*L/8),de=Math.ceil(ae*L/8),E=new Uint8Array(ee),H=new Uint8Array(de),J=new DataView(A.buffer),V=new DataView(E.buffer),ne=new DataView(H.buffer),le=!1,me=0;me<te;me++){for(var re=me*F,fe=0;fe<oe;fe++)ry(V,Bp(J,re+fe,L),me*oe+fe,L);var _e=Bp(J,re+oe,L);_e<(1<<L)-1&&(le=!0),ry(ne,_e,1*me,L)}return{colorSpace:I,colorsPerPixel:X,sMaskBitsPerComponent:le?L:void 0,colorBytes:E,alphaBytes:H,needSMask:le}}(i):function(b){var A=b.data,$=b.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:$,colorsPerPixel:$==="DeviceGray"?1:3,colorBytes:A instanceof Uint16Array?function(D){for(var F=D.length,L=new Uint8Array(2*F),I=new DataView(L.buffer,L.byteOffset,L.byteLength),X=0;X<F;X++)I.setUint16(2*X,D[X],!1);return L}(A):A,needSMask:!1}}(i);var p,g,m,j=s,k=j.colorSpace,w=j.colorsPerPixel,y=j.sMaskBitsPerComponent,_=j.colorBytes,S=j.alphaBytes,N=j.needSMask,T=j.palette,U=j.mask,P=null;return r!==He.API.image_compression.NONE&&typeof ig=="function"?(P=function(b){var A;switch(b){case He.API.image_compression.FAST:A=11;break;case He.API.image_compression.MEDIUM:A=13;break;case He.API.image_compression.SLOW:A=14;break;default:A=12}return A}(r),p=this.decode.FLATE_DECODE,g="/Predictor ".concat(P," /Colors ").concat(w," /BitsPerComponent ").concat(u," /Columns ").concat(o),t=X2(_,Math.ceil(o*w*u/8),w,u,r),N&&(m=X2(S,Math.ceil(o*y/8),1,y,r))):(p=void 0,g=void 0,t=_,N&&(m=S)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(m&&this.__addimage__.isArrayBuffer(m)||this.__addimage__.isArrayBufferView(m))&&(m=this.__addimage__.arrayBufferToBinaryString(m)),{alias:n,data:t,index:e,filter:p,decodeParameters:g,transparency:U,palette:T,sMask:m,predictor:P,width:o,height:l,bitsPerComponent:u,sMaskBitsPerComponent:y,colorSpace:k}}},function(t){t.processGIF89A=function(e,n,r,s){var i=new g8(e),o=i.width,l=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var d={data:c,width:o,height:l},u=new Up(100).encode(d,100);return t.processJPEG.call(this,u,n,r,s)},t.processGIF87A=t.processGIF89A}(He.API),vs.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:s,green:r,blue:n,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},vs.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(n){Ft.log("bit decode error:"+n)}},vs.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),n=e%4;for(t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,s=0;s<e;s++)for(var i=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+8*s*4,l=0;l<8&&8*s+l<this.width;l++){var c=this.palette[i>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}n!==0&&(this.pos+=4-n)}},vs.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,s=0;s<t;s++){var i=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+2*s*4,l=i>>4,c=15&i,d=this.palette[l];if(this.data[o]=d.blue,this.data[o+1]=d.green,this.data[o+2]=d.red,this.data[o+3]=255,2*s+1>=this.width)break;d=this.palette[c],this.data[o+4]=d.blue,this.data[o+4+1]=d.green,this.data[o+4+2]=d.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},vs.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var s=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+4*r;if(s<this.palette.length){var o=this.palette[s];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}t!==0&&(this.pos+=4-t)}},vs.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&e)/e*255|0,l=(i>>5&e)/e*255|0,c=(i>>10&e)/e*255|0,d=i>>15?255:0,u=r*this.width*4+4*s;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=d}this.pos+=t}},vs.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),n=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var s=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&n)/n*255|0,d=(o>>11)/e*255|0,u=s*this.width*4+4*i;this.data[u]=d,this.data[u+1]=c,this.data[u+2]=l,this.data[u+3]=255}this.pos+=t}},vs.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*n;this.data[o]=i,this.data[o+1]=s,this.data[o+2]=r,this.data[o+3]=255}this.pos+=this.width%4}},vs.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*n;this.data[l]=i,this.data[l+1]=s,this.data[l+2]=r,this.data[l+3]=o}},vs.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,n,r,s){var i=new vs(e,!1),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},d=new Up(100).encode(c,100);return t.processJPEG.call(this,d,n,r,s)}}(He.API),ay.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,n,r,s){var i=new ay(e),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},d=new Up(100).encode(c,100);return t.processJPEG.call(this,d,n,r,s)}}(He.API),He.API.processRGBA=function(t,e,n){for(var r=t.data,s=r.length,i=new Uint8Array(s/4*3),o=new Uint8Array(s/4),l=0,c=0,d=0;d<s;d+=4){var u=r[d],p=r[d+1],g=r[d+2],m=r[d+3];i[l++]=u,i[l++]=p,i[l++]=g,o[c++]=m}var j=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:j,index:e,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},He.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Bo=He.API,Du=Bo.getCharWidthsArray=function(t,e){var n,r,s=(e=e||{}).font||this.internal.getFont(),i=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:s.metadata.Unicode.widths,c=l.fof?l.fof:1,d=e.kerning?e.kerning:s.metadata.Unicode.kerning,u=d.fof?d.fof:1,p=e.doKerning!==!1,g=0,m=t.length,j=0,k=l[0]||c,w=[];for(n=0;n<m;n++)r=t.charCodeAt(n),typeof s.metadata.widthOfString=="function"?w.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(r))+o*(1e3/i)||0)/1e3):(g=p&&Lt(d[r])==="object"&&!isNaN(parseInt(d[r][j],10))?d[r][j]/u:0,w.push((l[r]||k)/c+g)),j=r;return w},Z2=Bo.getStringUnitWidth=function(t,e){var n=(e=e||{}).fontSize||this.internal.getFontSize(),r=e.font||this.internal.getFont(),s=e.charSpace||this.internal.getCharSpace();return Bo.processArabic&&(t=Bo.processArabic(t)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(t,n,s)/n:Du.apply(this,arguments).reduce(function(i,o){return i+o},0)},Y2=function(t,e,n,r){for(var s=[],i=0,o=t.length,l=0;i!==o&&l+e[i]<n;)l+=e[i],i++;s.push(t.slice(0,i));var c=i;for(l=0;i!==o;)l+e[i]>r&&(s.push(t.slice(c,i)),l=0,c=i),l+=e[i],i++;return c!==i&&s.push(t.slice(c,i)),s},J2=function(t,e,n){n||(n={});var r,s,i,o,l,c,d,u=[],p=[u],g=n.textIndent||0,m=0,j=0,k=t.split(" "),w=Du.apply(this,[" ",n])[0];if(c=n.lineIndent===-1?k[0].length+2:n.lineIndent||0){var y=Array(c).join(" "),_=[];k.map(function(N){(N=N.split(/\s*\n/)).length>1?_=_.concat(N.map(function(T,U){return(U&&T.length?`
`:"")+T})):_.push(N[0])}),k=_,c=Z2.apply(this,[y,n])}for(i=0,o=k.length;i<o;i++){var S=0;if(r=k[i],c&&r[0]==`
`&&(r=r.substr(1),S=1),g+m+(j=(s=Du.apply(this,[r,n])).reduce(function(N,T){return N+T},0))>e||S){if(j>e){for(l=Y2.apply(this,[r,s,e-(g+m),e]),u.push(l.shift()),u=[l.pop()];l.length;)p.push([l.shift()]);j=s.slice(r.length-(u[0]?u[0].length:0)).reduce(function(N,T){return N+T},0)}else u=[r];p.push(u),g=j+c,m=w}else u.push(r),g+=m+j,m=w}return d=c?function(N,T){return(T?y:"")+N.join(" ")}:function(N){return N.join(" ")},p.map(d)},Bo.splitTextToSize=function(t,e,n){var r,s=(n=n||{}).fontSize||this.internal.getFontSize(),i=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var p=this.internal.getFont(u.fontName,u.fontStyle),g="Unicode";return p.metadata[g]?{widths:p.metadata[g].widths||{0:1},kerning:p.metadata[g].kerning||{}}:{font:p.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);r=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/s;i.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/s:0,i.lineIndent=n.lineIndent;var l,c,d=[];for(l=0,c=r.length;l<c;l++)d=d.concat(J2.apply(this,[r[l],o,i]));return d},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",n="klmnopqrstuvwxyz",r={},s={},i=0;i<16;i++)r[n[i]]=e[i],s[e[i]]=n[i];var o=function(g){return"0x"+parseInt(g,10).toString(16)},l=t.__fontmetrics__.compress=function(g){var m,j,k,w,y=["{"];for(var _ in g){if(m=g[_],isNaN(parseInt(_,10))?j="'"+_+"'":(_=parseInt(_,10),j=(j=o(_).slice(2)).slice(0,-1)+s[j.slice(-1)]),typeof m=="number")m<0?(k=o(m).slice(3),w="-"):(k=o(m).slice(2),w=""),k=w+k.slice(0,-1)+s[k.slice(-1)];else{if(Lt(m)!=="object")throw new Error("Don't know what to do with value type "+Lt(m)+".");k=l(m)}y.push(j+k)}return y.push("}"),y.join("")},c=t.__fontmetrics__.uncompress=function(g){if(typeof g!="string")throw new Error("Invalid argument passed to uncompress.");for(var m,j,k,w,y={},_=1,S=y,N=[],T="",U="",P=g.length-1,b=1;b<P;b+=1)(w=g[b])=="'"?m?(k=m.join(""),m=void 0):m=[]:m?m.push(w):w=="{"?(N.push([S,k]),S={},k=void 0):w=="}"?((j=N.pop())[0][j[1]]=S,k=void 0,S=j[0]):w=="-"?_=-1:k===void 0?r.hasOwnProperty(w)?(T+=r[w],k=parseInt(T,16)*_,_=1,T=""):T+=w:r.hasOwnProperty(w)?(U+=r[w],S[k]=parseInt(U,16)*_,_=1,k=void 0,U=""):U+=w;return y},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},p={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(g){var m=g.font,j=p.Unicode[m.postScriptName];j&&(m.metadata.Unicode={},m.metadata.Unicode.widths=j.widths,m.metadata.Unicode.kerning=j.kerning);var k=u.Unicode[m.postScriptName];k&&(m.metadata.Unicode.encoding=k,m.encoding=k.codePages[0])}])}(He.API),function(t){var e=function(n){for(var r=n.length,s=new Uint8Array(r),i=0;i<r;i++)s[i]=n.charCodeAt(i);return s};t.API.events.push(["addFont",function(n){var r=void 0,s=n.font,i=n.instance;if(!s.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(r=i.existsFileInVFS(s.postScriptName)===!1?i.loadFile(s.postScriptName):i.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(Wu(l)),o.metadata=t.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(s,r)}}])}(He),He.API.addSvgAsImage=function(t,e,n,r,s,i,o,l){if(isNaN(e)||isNaN(n))throw Ft.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(s))throw Ft.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=r,c.height=s;var d=c.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,c.width,c.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},p=this;return(tt.canvg?Promise.resolve(tt.canvg):ui(()=>import("./index.es-Cg90lcMS.js"),[])).catch(function(g){return Promise.reject(new Error("Could not load canvg: "+g))}).then(function(g){return g.default?g.default:g}).then(function(g){return g.fromString(d,t,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(g){return g.render(u)}).then(function(){p.addImage(c.toDataURL("image/jpeg",1),e,n,r,s,o,l)})},He.API.putTotalPages=function(t){var e,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),n=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var s=0;s<this.internal.pages[r].length;s++)this.internal.pages[r][s]=this.internal.pages[r][s].replace(e,n);return this},He.API.viewerPreferences=function(t,e){var n;t=t||{},e=e||!1;var r,s,i,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],d=0,u=0,p=0;function g(j,k){var w,y=!1;for(w=0;w<j.length;w+=1)j[w]===k&&(y=!0);return y}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var m=l.length;for(p=0;p<m;p+=1)n[l[p]].value=n[l[p]].defaultValue,n[l[p]].explicitSet=!1}if(Lt(t)==="object"){for(s in t)if(i=t[s],g(l,s)&&i!==void 0){if(n[s].type==="boolean"&&typeof i=="boolean")n[s].value=i;else if(n[s].type==="name"&&g(n[s].valueSet,i))n[s].value=i;else if(n[s].type==="integer"&&Number.isInteger(i))n[s].value=i;else if(n[s].type==="array"){for(d=0;d<i.length;d+=1)if(r=!0,i[d].length===1&&typeof i[d][0]=="number")c.push(String(i[d]-1));else if(i[d].length>1){for(u=0;u<i[d].length;u+=1)typeof i[d][u]!="number"&&(r=!1);r===!0&&c.push([i[d][0]-1,i[d][1]-1].join(" "))}n[s].value="["+c.join(" ")+"]"}else n[s].value=n[s].defaultValue;n[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var j,k=[];for(j in n)n[j].explicitSet===!0&&(n[j].type==="name"?k.push("/"+j+" /"+n[j].value):k.push("/"+j+" "+n[j].value));k.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+k.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(t){var e=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(r)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),d=i.length+o.length+l.length+s.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(s+i+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(r,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",e)),this}}(He.API),function(t){var e=t.API,n=e.pdfEscape16=function(i,o){for(var l,c=o.metadata.Unicode.widths,d=["","0","00","000","0000"],u=[""],p=0,g=i.length;p<g;++p){if(l=o.metadata.characterToGlyph(i.charCodeAt(p)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=i.charCodeAt(p),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return u.join("");l=l.toString(16),u.push(d[4-l.length],l)}return u.join("")},r=function(i){var o,l,c,d,u,p,g;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],p=0,g=(l=Object.keys(i).sort(function(m,j){return m-j})).length;p<g;p++)o=l[p],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[o]!==void 0&&i[o]!==null&&typeof i[o].toString=="function"&&(d=("0000"+i[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+d+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,d=o.newObject,u=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var p=l.metadata.Unicode.widths,g=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),m="",j=0;j<g.length;j++)m+=String.fromCharCode(g[j]);var k=d();u({data:m,addLength1:!0,objectId:k}),c("endobj");var w=d();u({data:r(l.metadata.toUnicode),addLength1:!0,objectId:w}),c("endobj");var y=d();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Wo(l.fontName)),c("/FontFile2 "+k+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var _=d();c("<<"),c("/Type /Font"),c("/BaseFont /"+Wo(l.fontName)),c("/FontDescriptor "+y+" 0 R"),c("/W "+t.API.PDFObject.convert(p)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=d(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+w+" 0 R"),c("/BaseFont /"+Wo(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+_+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]),e.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,d=o.newObject,u=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var p=l.metadata.rawData,g="",m=0;m<p.length;m++)g+=String.fromCharCode(p[m]);var j=d();u({data:g,addLength1:!0,objectId:j}),c("endobj");var k=d();u({data:r(l.metadata.toUnicode),addLength1:!0,objectId:k}),c("endobj");var w=d();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+j+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Wo(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=d();for(var y=0;y<l.metadata.hmtx.widths.length;y++)l.metadata.hmtx.widths[y]=parseInt(l.metadata.hmtx.widths[y]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+k+" 0 R/BaseFont/"+Wo(l.fontName)+"/FontDescriptor "+w+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]);var s=function(i){var o,l=i.text||"",c=i.x,d=i.y,u=i.options||{},p=i.mutex||{},g=p.pdfEscape,m=p.activeFontKey,j=p.fonts,k=m,w="",y=0,_="",S=j[k].encoding;if(j[k].encoding!=="Identity-H")return{text:l,x:c,y:d,options:u,mutex:p};for(_=l,k=m,Array.isArray(l)&&(_=l[0]),y=0;y<_.length;y+=1)j[k].metadata.hasOwnProperty("cmap")&&(o=j[k].metadata.cmap.unicode.codeMap[_[y].charCodeAt(0)]),o||_[y].charCodeAt(0)<256&&j[k].metadata.hasOwnProperty("Unicode")?w+=_[y]:w+="";var N="";return parseInt(k.slice(1))<14||S==="WinAnsiEncoding"?N=g(w,k).split("").map(function(T){return T.charCodeAt(0).toString(16)}).join(""):S==="Identity-H"&&(N=n(w,j[k])),p.isHex=!0,{text:N,x:c,y:d,options:u,mutex:p}};e.events.push(["postProcessText",function(i){var o=i.text||"",l=[],c={text:o,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(o)){var d=0;for(d=0;d<o.length;d+=1)Array.isArray(o[d])&&o[d].length===3?l.push([s(Object.assign({},c,{text:o[d][0]})).text,o[d][1],o[d][2]]):l.push(s(Object.assign({},c,{text:o[d]})).text);i.text=l}else i.text=s(Object.assign({},c,{text:o})).text}])}(He),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0},t.addFileToVFS=function(n,r){return e.call(this),this.internal.vFS[n]=r,this},t.getFileFromVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}}(He.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(r){var s,i,o,l,c,d,u,p=e,g=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],j={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},k={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},w=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],y=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),_=!1,S=0;this.__bidiEngine__={};var N=function(D){var F=D.charCodeAt(),L=F>>8,I=k[L];return I!==void 0?p[256*I+(255&F)]:L===252||L===253?"AL":y.test(L)?"L":L===8?"R":"N"},T=function(D){for(var F,L=0;L<D.length;L++){if((F=N(D.charAt(L)))==="L")return!1;if(F==="R")return!0}return!1},U=function(D,F,L,I){var X,te,oe,Z,ae=F[I];switch(ae){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":_=!1;break;case"N":case"AN":break;case"EN":_&&(ae="AN");break;case"AL":_=!0,ae="R";break;case"WS":case"BN":ae="N";break;case"CS":I<1||I+1>=F.length||(X=L[I-1])!=="EN"&&X!=="AN"||(te=F[I+1])!=="EN"&&te!=="AN"?ae="N":_&&(te="AN"),ae=te===X?te:"N";break;case"ES":ae=(X=I>0?L[I-1]:"B")==="EN"&&I+1<F.length&&F[I+1]==="EN"?"EN":"N";break;case"ET":if(I>0&&L[I-1]==="EN"){ae="EN";break}if(_){ae="N";break}for(oe=I+1,Z=F.length;oe<Z&&F[oe]==="ET";)oe++;ae=oe<Z&&F[oe]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(Z=F.length,oe=I+1;oe<Z&&F[oe]==="NSM";)oe++;if(oe<Z){var ee=D[I],de=ee>=1425&&ee<=2303||ee===64286;if(X=F[oe],de&&(X==="R"||X==="AL")){ae="R";break}}}ae=I<1||(X=F[I-1])==="B"?"N":L[I-1];break;case"B":_=!1,s=!0,ae=S;break;case"S":i=!0,ae="N"}return ae},P=function(D,F,L){var I=D.split("");return L&&b(I,L,{hiLevel:S}),I.reverse(),F&&F.reverse(),I.join("")},b=function(D,F,L){var I,X,te,oe,Z,ae=-1,ee=D.length,de=0,E=[],H=S?m:g,J=[];for(_=!1,s=!1,i=!1,X=0;X<ee;X++)J[X]=N(D[X]);for(te=0;te<ee;te++){if(Z=de,E[te]=U(D,J,E,te),I=240&(de=H[Z][j[E[te]]]),de&=15,F[te]=oe=H[de][5],I>0)if(I===16){for(X=ae;X<te;X++)F[X]=1;ae=-1}else ae=-1;if(H[de][6])ae===-1&&(ae=te);else if(ae>-1){for(X=ae;X<te;X++)F[X]=oe;ae=-1}J[te]==="B"&&(F[te]=0),L.hiLevel|=oe}i&&function(V,ne,le){for(var me=0;me<le;me++)if(V[me]==="S"){ne[me]=S;for(var re=me-1;re>=0&&V[re]==="WS";re--)ne[re]=S}}(J,F,ee)},A=function(D,F,L,I,X){if(!(X.hiLevel<D)){if(D===1&&S===1&&!s)return F.reverse(),void(L&&L.reverse());for(var te,oe,Z,ae,ee=F.length,de=0;de<ee;){if(I[de]>=D){for(Z=de+1;Z<ee&&I[Z]>=D;)Z++;for(ae=de,oe=Z-1;ae<oe;ae++,oe--)te=F[ae],F[ae]=F[oe],F[oe]=te,L&&(te=L[ae],L[ae]=L[oe],L[oe]=te);de=Z}de++}}},$=function(D,F,L){var I=D.split(""),X={hiLevel:S};return L||(L=[]),b(I,L,X),function(te,oe,Z){if(Z.hiLevel!==0&&u)for(var ae,ee=0;ee<te.length;ee++)oe[ee]===1&&(ae=w.indexOf(te[ee]))>=0&&(te[ee]=w[ae+1])}(I,L,X),A(2,I,F,L,X),A(1,I,F,L,X),I.join("")};return this.__bidiEngine__.doBidiReorder=function(D,F,L){if(function(X,te){if(te)for(var oe=0;oe<X.length;oe++)te[oe]=oe;l===void 0&&(l=T(X)),d===void 0&&(d=T(X))}(D,F),o||!c||d)if(o&&c&&l^d)S=l?1:0,D=P(D,F,L);else if(!o&&c&&d)S=l?1:0,D=$(D,F,L),D=P(D,F);else if(!o||l||c||d){if(o&&!c&&l^d)D=P(D,F),l?(S=0,D=$(D,F,L)):(S=1,D=$(D,F,L),D=P(D,F));else if(o&&l&&!c&&d)S=1,D=$(D,F,L),D=P(D,F);else if(!o&&!c&&l^d){var I=u;l?(S=1,D=$(D,F,L),S=0,u=!1,D=$(D,F,L),u=I):(S=0,D=$(D,F,L),D=P(D,F),S=1,u=!1,D=$(D,F,L),u=I,D=P(D,F))}}else S=0,D=$(D,F,L);else S=l?1:0,D=$(D,F,L);return D},this.__bidiEngine__.setOptions=function(D){D&&(o=D.isInputVisual,c=D.isOutputVisual,l=D.isInputRtl,d=D.isOutputRtl,u=D.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(r){var s=r.text;r.x,r.y;var i=r.options||{};r.mutex,i.lang;var o=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,n.setOptions(i),Object.prototype.toString.call(s)==="[object Array]"){var l=0;for(o=[],l=0;l<s.length;l+=1)Object.prototype.toString.call(s[l])==="[object Array]"?o.push([n.doBidiReorder(s[l][0]),s[l][1],s[l][2]]):o.push([n.doBidiReorder(s[l])]);r.text=o}else r.text=n.doBidiReorder(s);n.setOptions({isInputVisual:!0})}])}(He),He.API.TTFFont=function(){function t(e){var n;if(this.rawData=e,n=this.contents=new pi(e),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new P8(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new v8(this.contents),this.head=new b8(this),this.name=new S8(this),this.cmap=new Sx(this),this.toUnicode={},this.hhea=new _8(this),this.maxp=new k8(this),this.hmtx=new N8(this),this.post=new w8(this),this.os2=new x8(this),this.loca=new D8(this),this.glyf=new C8(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,n,r,s,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,d;for(d=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],d.push(Math.round(e*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(r=255&(s=this.post.italic_angle),32768&(n=s>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var n;return((n=this.cmap.unicode)!=null?n.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*n},t.prototype.widthOfString=function(e,n,r){var s,i,o,l;for(o=0,i=0,l=(e=""+e).length;0<=l?i<l:i>l;i=0<=l?++i:--i)s=e.charCodeAt(i),o+=this.widthOfGlyph(this.characterToGlyph(s))+r*(1e3/n)||0;return o*(n/1e3)},t.prototype.lineHeight=function(e,n){var r;return n==null&&(n=!1),r=n?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},t}();var Cs,pi=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var n,r;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r[n]=String.fromCharCode(this.readByte());return r.join("")},t.prototype.writeString=function(e){var n,r,s;for(s=[],n=0,r=e.length;0<=r?n<r:n>r;n=0<=r?++n:--n)s.push(this.writeByte(e.charCodeAt(n)));return s},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,n,r,s,i,o,l,c;return e=this.readByte(),n=this.readByte(),r=this.readByte(),s=this.readByte(),i=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^n)+1099511627776*(255^r)+4294967296*(255^s)+16777216*(255^i)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*n+1099511627776*r+4294967296*s+16777216*i+65536*o+256*l+c},t.prototype.writeLongLong=function(e){var n,r;return n=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var n,r;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n.push(this.readByte());return n},t.prototype.write=function(e){var n,r,s,i;for(i=[],r=0,s=e.length;r<s;r++)n=e[r],i.push(this.writeByte(n));return i},t}(),v8=function(){var t;function e(n){var r,s,i;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},s=0,i=this.tableCount;0<=i?s<i:s>i;s=0<=i?++s:--s)r={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[r.tag]=r}return e.prototype.encode=function(n){var r,s,i,o,l,c,d,u,p,g,m,j,k;for(k in m=Object.keys(n).length,c=Math.log(2),p=16*Math.floor(Math.log(m)/c),o=Math.floor(p/c),u=16*m-p,(s=new pi).writeInt(this.scalarType),s.writeShort(m),s.writeShort(p),s.writeShort(o),s.writeShort(u),i=16*m,d=s.pos+i,l=null,j=[],n)for(g=n[k],s.writeString(k),s.writeInt(t(g)),s.writeInt(d),s.writeInt(g.length),j=j.concat(g),k==="head"&&(l=d),d+=g.length;d%4;)j.push(0),d++;return s.write(j),r=2981146554-t(s.data),s.pos=l+8,s.writeUInt32(r),s.data},t=function(n){var r,s,i,o;for(n=kx.call(n);n.length%4;)n.push(0);for(i=new pi(n),s=0,r=0,o=n.length;r<o;r=r+=4)s+=i.readUInt32();return 4294967295&s},e}(),y8={}.hasOwnProperty,Vs=function(t,e){for(var n in e)y8.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Cs=function(){function t(e){var n;this.file=e,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var b8=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Vs(t,Cs),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var n;return(n=new pi).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(e),n.writeShort(this.glyphDataFormat),n.data},t}(),iy=function(){function t(e,n){var r,s,i,o,l,c,d,u,p,g,m,j,k,w,y,_,S;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=n+e.readInt(),p=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(m=e.readUInt16(),g=m/2,e.pos+=6,i=function(){var N,T;for(T=[],c=N=0;0<=g?N<g:N>g;c=0<=g?++N:--N)T.push(e.readUInt16());return T}(),e.pos+=2,k=function(){var N,T;for(T=[],c=N=0;0<=g?N<g:N>g;c=0<=g?++N:--N)T.push(e.readUInt16());return T}(),d=function(){var N,T;for(T=[],c=N=0;0<=g?N<g:N>g;c=0<=g?++N:--N)T.push(e.readUInt16());return T}(),u=function(){var N,T;for(T=[],c=N=0;0<=g?N<g:N>g;c=0<=g?++N:--N)T.push(e.readUInt16());return T}(),s=(this.length-e.pos+this.offset)/2,l=function(){var N,T;for(T=[],c=N=0;0<=s?N<s:N>s;c=0<=s?++N:--N)T.push(e.readUInt16());return T}(),c=y=0,S=i.length;y<S;c=++y)for(w=i[c],r=_=j=k[c];j<=w?_<=w:_>=w;r=j<=w?++_:--_)u[c]===0?o=r+d[c]:(o=l[u[c]/2+(r-j)-(g-c)]||0)!==0&&(o+=d[c]),this.codeMap[r]=65535&o}e.pos=p}return t.encode=function(e,n){var r,s,i,o,l,c,d,u,p,g,m,j,k,w,y,_,S,N,T,U,P,b,A,$,D,F,L,I,X,te,oe,Z,ae,ee,de,E,H,J,V,ne,le,me,re,fe,_e,ke;switch(I=new pi,o=Object.keys(e).sort(function(Ae,ye){return Ae-ye}),n){case"macroman":for(k=0,w=function(){var Ae=[];for(j=0;j<256;++j)Ae.push(0);return Ae}(),_={0:0},i={},X=0,ae=o.length;X<ae;X++)_[re=e[s=o[X]]]==null&&(_[re]=++k),i[s]={old:e[s],new:_[e[s]]},w[s]=_[e[s]];return I.writeUInt16(1),I.writeUInt16(0),I.writeUInt32(12),I.writeUInt16(0),I.writeUInt16(262),I.writeUInt16(0),I.write(w),{charMap:i,subtable:I.data,maxGlyphID:k+1};case"unicode":for(F=[],p=[],S=0,_={},r={},y=d=null,te=0,ee=o.length;te<ee;te++)_[T=e[s=o[te]]]==null&&(_[T]=++S),r[s]={old:T,new:_[T]},l=_[T]-s,y!=null&&l===d||(y&&p.push(y),F.push(s),d=l),y=s;for(y&&p.push(y),p.push(65535),F.push(65535),$=2*(A=F.length),b=2*Math.pow(Math.log(A)/Math.LN2,2),g=Math.log(b/2)/Math.LN2,P=2*A-b,c=[],U=[],m=[],j=oe=0,de=F.length;oe<de;j=++oe){if(D=F[j],u=p[j],D===65535){c.push(0),U.push(0);break}if(D-(L=r[D].new)>=32768)for(c.push(0),U.push(2*(m.length+A-j)),s=Z=D;D<=u?Z<=u:Z>=u;s=D<=u?++Z:--Z)m.push(r[s].new);else c.push(L-D),U.push(0)}for(I.writeUInt16(3),I.writeUInt16(1),I.writeUInt32(12),I.writeUInt16(4),I.writeUInt16(16+8*A+2*m.length),I.writeUInt16(0),I.writeUInt16($),I.writeUInt16(b),I.writeUInt16(g),I.writeUInt16(P),le=0,E=p.length;le<E;le++)s=p[le],I.writeUInt16(s);for(I.writeUInt16(0),me=0,H=F.length;me<H;me++)s=F[me],I.writeUInt16(s);for(fe=0,J=c.length;fe<J;fe++)l=c[fe],I.writeUInt16(l);for(_e=0,V=U.length;_e<V;_e++)N=U[_e],I.writeUInt16(N);for(ke=0,ne=m.length;ke<ne;ke++)k=m[ke],I.writeUInt16(k);return{charMap:r,subtable:I.data,maxGlyphID:S+1}}},t}(),Sx=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Vs(t,Cs),t.prototype.tag="cmap",t.prototype.parse=function(e){var n,r,s;for(e.pos=this.offset,this.version=e.readUInt16(),s=e.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=s?r<s:r>s;r=0<=s?++r:--r)n=new iy(e,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(e,n){var r,s;return n==null&&(n="macroman"),r=iy.encode(e,n),(s=new pi).writeUInt16(0),s.writeUInt16(1),r.table=s.data.concat(r.subtable),r},t}(),_8=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Vs(t,Cs),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),x8=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Vs(t,Cs),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var n,r;for(r=[],n=0;n<10;++n)r.push(e.readByte());return r}(),this.charRange=function(){var n,r;for(r=[],n=0;n<4;++n)r.push(e.readInt());return r}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var n,r;for(r=[],n=0;n<2;n=++n)r.push(e.readInt());return r}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),w8=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Vs(t,Cs),t.prototype.tag="post",t.prototype.parse=function(e){var n,r,s;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var i;for(r=e.readUInt16(),this.glyphNameIndex=[],i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],s=[];e.pos<this.offset+this.length;)n=e.readByte(),s.push(this.names.push(e.readString(n)));return s;case 151552:return r=e.readUInt16(),this.offsets=e.read(r);case 262144:return this.map=(function(){var o,l,c;for(c=[],i=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;i=0<=l?++o:--o)c.push(e.readUInt32());return c}).call(this)}},t}(),j8=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},S8=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Vs(t,Cs),t.prototype.tag="name",t.prototype.parse=function(e){var n,r,s,i,o,l,c,d,u,p,g;for(e.pos=this.offset,e.readShort(),n=e.readShort(),l=e.readShort(),r=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)r.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(c={},i=u=0,p=r.length;u<p;i=++u)s=r[i],e.pos=s.offset,d=e.readString(s.length),o=new j8(d,s),c[g=s.nameID]==null&&(c[g]=[]),c[s.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t}(),k8=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Vs(t,Cs),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),N8=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Vs(t,Cs),t.prototype.tag="hmtx",t.prototype.parse=function(e){var n,r,s,i,o,l,c;for(e.pos=this.offset,this.metrics=[],n=0,l=this.file.hhea.numberOfMetrics;0<=l?n<l:n>l;n=0<=l?++n:--n)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,u;for(u=[],n=d=0;0<=s?d<s:d>s;n=0<=s?++d:--d)u.push(e.readInt16());return u}(),this.widths=(function(){var d,u,p,g;for(g=[],d=0,u=(p=this.metrics).length;d<u;d++)i=p[d],g.push(i.advance);return g}).call(this),r=this.widths[this.widths.length-1],c=[],n=o=0;0<=s?o<s:o>s;n=0<=s?++o:--o)c.push(this.widths.push(r));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),kx=[].slice,C8=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Vs(t,Cs),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var n,r,s,i,o,l,c,d,u,p;return e in this.cache?this.cache[e]:(i=this.file.loca,n=this.file.contents,r=i.indexOf(e),(s=i.lengthOf(e))===0?this.cache[e]=null:(n.pos=this.offset+r,o=(l=new pi(n.read(s))).readShort(),d=l.readShort(),p=l.readShort(),c=l.readShort(),u=l.readShort(),this.cache[e]=o===-1?new E8(l,d,p,c,u):new A8(l,o,d,p,c,u),this.cache[e]))},t.prototype.encode=function(e,n,r){var s,i,o,l,c;for(o=[],i=[],l=0,c=n.length;l<c;l++)s=e[n[l]],i.push(o.length),s&&(o=o.concat(s.encode(r)));return i.push(o.length),{table:o,offsets:i}},t}(),A8=function(){function t(e,n,r,s,i,o){this.raw=e,this.numberOfContours=n,this.xMin=r,this.yMin=s,this.xMax=i,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),E8=function(){function t(e,n,r,s,i){var o,l;for(this.raw=e,this.xMin=n,this.yMin=r,this.xMax=s,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return t.prototype.encode=function(){var e,n,r;for(n=new pi(kx.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)n.pos=this.glyphOffsets[e];return n.data},t}(),D8=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Vs(t,Cs),t.prototype.tag="loca",t.prototype.parse=function(e){var n,r;return e.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var s,i;for(i=[],r=0,s=this.length;r<s;r+=2)i.push(2*e.readUInt16());return i}).call(this):(function(){var s,i;for(i=[],r=0,s=this.length;r<s;r+=4)i.push(e.readUInt32());return i}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,n){for(var r=new Uint32Array(this.offsets.length),s=0,i=0,o=0;o<r.length;++o)if(r[o]=s,i<n.length&&n[i]==o){++i,r[o]=s;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(s+=c)}for(var d=new Array(4*r.length),u=0;u<r.length;++u)d[4*u+3]=255&r[u],d[4*u+2]=(65280&r[u])>>8,d[4*u+1]=(16711680&r[u])>>16,d[4*u]=(4278190080&r[u])>>24;return d},t}(),P8=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,n,r,s,i;for(n in s=this.font.cmap.tables[0].codeMap,e={},i=this.subset)r=i[n],e[n]=s[r];return e},t.prototype.glyphsFor=function(e){var n,r,s,i,o,l,c;for(s={},o=0,l=e.length;o<l;o++)s[i=e[o]]=this.font.glyf.glyphFor(i);for(i in n=[],s)(r=s[i])!=null&&r.compound&&n.push.apply(n,r.glyphIDs);if(n.length>0)for(i in c=this.glyphsFor(n))r=c[i],s[i]=r;return s},t.prototype.encode=function(e,n){var r,s,i,o,l,c,d,u,p,g,m,j,k,w,y;for(s in r=Sx.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),m={0:0},y=r.charMap)m[(c=y[s]).old]=c.new;for(j in g=r.maxGlyphID,o)j in m||(m[j]=g++);return u=function(_){var S,N;for(S in N={},_)N[_[S]]=S;return N}(m),p=Object.keys(u).sort(function(_,S){return _-S}),k=function(){var _,S,N;for(N=[],_=0,S=p.length;_<S;_++)l=p[_],N.push(u[l]);return N}(),i=this.font.glyf.encode(o,k,m),d=this.font.loca.encode(i.offsets,k),w={cmap:this.font.cmap.raw(),glyf:i.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(w["OS/2"]=this.font.os2.raw()),this.font.directory.encode(w)},t}();He.API.PDFObject=function(){var t;function e(){}return t=function(n,r){return(Array(r+1).join("0")+n).slice(-r)},e.convert=function(n){var r,s,i,o;if(Array.isArray(n))return"["+function(){var l,c,d;for(d=[],l=0,c=n.length;l<c;l++)r=n[l],d.push(e.convert(r));return d}().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+t(n.getUTCFullYear(),4)+t(n.getUTCMonth(),2)+t(n.getUTCDate(),2)+t(n.getUTCHours(),2)+t(n.getUTCMinutes(),2)+t(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(s in i=["<<"],n)o=n[s],i.push("/"+s+" "+e.convert(o));return i.push(">>"),i.join(`
`)}return""+n},e}();function Nx(t,e,n,r,s){r=r||{};var i=1.15,o=s.internal.scaleFactor,l=s.internal.getFontSize()/o,c=s.getLineHeightFactor?s.getLineHeightFactor():i,d=l*c,u=/\r\n|\r|\n/g,p="",g=1;if((r.valign==="middle"||r.valign==="bottom"||r.halign==="center"||r.halign==="right")&&(p=typeof t=="string"?t.split(u):t,g=p.length||1),n+=l*(2-i),r.valign==="middle"?n-=g/2*d:r.valign==="bottom"&&(n-=g*d),r.halign==="center"||r.halign==="right"){var m=l;if(r.halign==="center"&&(m*=.5),p&&g>=1){for(var j=0;j<p.length;j++)s.text(p[j],e-s.getStringUnitWidth(p[j])*m,n),n+=d;return s}e-=s.getStringUnitWidth(t)*m}return r.halign==="justify"?s.text(t,e,n,{maxWidth:r.maxWidth||100,align:"justify"}):s.text(t,e,n),s}var oy={},gl=function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,n){n===void 0&&(n=null),n?n.__autoTableDocumentDefaults=e:oy=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,n){var r,s,i;n===void 0&&(n=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var o=this.jsPDFDocument.internal.getFont(),l=o.fontStyle,c=o.fontName;if(e.font&&(c=e.font),e.fontStyle){l=e.fontStyle;var d=this.getFontList()[c];d&&d.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(d[0]),l=d[0])}if(this.jsPDFDocument.setFont(c,l),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!n){var u=t.unifyColor(e.fillColor);u&&(r=this.jsPDFDocument).setFillColor.apply(r,u),u=t.unifyColor(e.textColor),u&&(s=this.jsPDFDocument).setTextColor.apply(s,u),u=t.unifyColor(e.lineColor),u&&(i=this.jsPDFDocument).setDrawColor.apply(i,u),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,n,r){return this.jsPDFDocument.splitTextToSize(e,n,r)},t.prototype.rect=function(e,n,r,s,i){return this.jsPDFDocument.rect(e,n,r,s,i)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return oy||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t}(),pg=function(t,e){return pg=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},pg(t,e)};function Cx(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");pg(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Ax=function(t){Cx(e,t);function e(n){var r=t.call(this)||this;return r._element=n,r}return e}(Array);function L8(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function T8(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function Ch(t,e,n){n.applyStyles(e,!0);var r=Array.isArray(t)?t:[t],s=r.map(function(i){return n.getTextWidth(i)}).reduce(function(i,o){return Math.max(i,o)},0);return s}function Ex(t,e,n,r){var s=e.settings.tableLineWidth,i=e.settings.tableLineColor;t.applyStyles({lineWidth:s,lineColor:i});var o=Dx(s,!1);o&&t.rect(n.x,n.y,e.getWidth(t.pageSize().width),r.y-n.y,o)}function Dx(t,e){var n=t>0,r=e||e===0;return n&&r?"DF":n?"S":r?"F":null}function af(t,e){var n,r,s,i;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(n=t.left)!==null&&n!==void 0?n:e,top:(r=t.top)!==null&&r!==void 0?r:e,right:(s=t.right)!==null&&s!==void 0?s:e,bottom:(i=t.bottom)!==null&&i!==void 0?i:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function Px(t,e){var n=af(e.settings.margin,0);return t.pageSize().width-(n.left+n.right)}function I8(t,e,n,r,s){var i={},o=1.3333333333333333,l=$p(e,function(S){return s.getComputedStyle(S).backgroundColor});l!=null&&(i.fillColor=l);var c=$p(e,function(S){return s.getComputedStyle(S).color});c!=null&&(i.textColor=c);var d=q8(r,n);d&&(i.cellPadding=d);var u="borderTopColor",p=o*n,g=r.borderTopWidth;if(r.borderBottomWidth===g&&r.borderRightWidth===g&&r.borderLeftWidth===g){var m=(parseFloat(g)||0)/p;m&&(i.lineWidth=m)}else i.lineWidth={top:(parseFloat(r.borderTopWidth)||0)/p,right:(parseFloat(r.borderRightWidth)||0)/p,bottom:(parseFloat(r.borderBottomWidth)||0)/p,left:(parseFloat(r.borderLeftWidth)||0)/p},i.lineWidth.top||(i.lineWidth.right?u="borderRightColor":i.lineWidth.bottom?u="borderBottomColor":i.lineWidth.left&&(u="borderLeftColor"));var j=$p(e,function(S){return s.getComputedStyle(S)[u]});j!=null&&(i.lineColor=j);var k=["left","right","center","justify"];k.indexOf(r.textAlign)!==-1&&(i.halign=r.textAlign),k=["middle","bottom","top"],k.indexOf(r.verticalAlign)!==-1&&(i.valign=r.verticalAlign);var w=parseInt(r.fontSize||"");isNaN(w)||(i.fontSize=w/o);var y=R8(r);y&&(i.fontStyle=y);var _=(r.fontFamily||"").toLowerCase();return t.indexOf(_)!==-1&&(i.font=_),i}function R8(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function $p(t,e){var n=Lx(t,e);if(!n)return null;var r=n.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!r||!Array.isArray(r))return null;var s=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3])],i=parseInt(r[4]);return i===0||isNaN(s[0])||isNaN(s[1])||isNaN(s[2])?null:s}function Lx(t,e){var n=e(t);return n==="rgba(0, 0, 0, 0)"||n==="transparent"||n==="initial"||n==="inherit"?t.parentElement==null?null:Lx(t.parentElement,e):n}function q8(t,e){var n=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],r=96/(72/e),s=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,i=n.map(function(l){return parseInt(l||"0")/r}),o=af(i,0);return s>o.top&&(o.top=s),s>o.bottom&&(o.bottom=s),o}function Tx(t,e,n,r,s){var i,o;r===void 0&&(r=!1),s===void 0&&(s=!1);var l;typeof e=="string"?l=n.document.querySelector(e):l=e;var c=Object.keys(t.getFontList()),d=t.scaleFactor(),u=[],p=[],g=[];if(!l)return console.error("Html table could not be found with input: ",e),{head:u,body:p,foot:g};for(var m=0;m<l.rows.length;m++){var j=l.rows[m],k=(o=(i=j==null?void 0:j.parentElement)===null||i===void 0?void 0:i.tagName)===null||o===void 0?void 0:o.toLowerCase(),w=O8(c,d,n,j,r,s);w&&(k==="thead"?u.push(w):k==="tfoot"?g.push(w):p.push(w))}return{head:u,body:p,foot:g}}function O8(t,e,n,r,s,i){for(var o=new Ax(r),l=0;l<r.cells.length;l++){var c=r.cells[l],d=n.getComputedStyle(c);if(s||d.display!=="none"){var u=void 0;i&&(u=I8(t,c,e,d,n)),o.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:u,_element:c,content:F8(c)})}}var p=n.getComputedStyle(r);if(o.length>0&&(s||p.display!=="none"))return o}function F8(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(n){return n.trim()}).join(`
`),e.innerText||e.textContent||""}function M8(t,e,n){for(var r=0,s=[t,e,n];r<s.length;r++){var i=s[r];i&&typeof i!="object"&&console.error("The options parameter should be of type object, is: "+typeof i),i.startY&&typeof i.startY!="number"&&(console.error("Invalid value for startY option",i.startY),delete i.startY)}}function ga(t,e,n,r,s){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),o=1;o<arguments.length;o++){var l=arguments[o];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(i[c]=l[c])}return i}function B8(t,e){var n=new gl(t),r=n.getDocumentOptions(),s=n.getGlobalOptions();M8(s,r,e);var i=ga({},s,r,e),o;typeof window<"u"&&(o=window);var l=U8(s,r,e),c=$8(s,r,e),d=z8(n,i),u=H8(n,i,o);return{id:e.tableId,content:u,hooks:c,styles:l,settings:d}}function U8(t,e,n){for(var r={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},s=function(c){if(c==="columnStyles"){var d=t[c],u=e[c],p=n[c];r.columnStyles=ga({},d,u,p)}else{var g=[t,e,n],m=g.map(function(j){return j[c]||{}});r[c]=ga({},m[0],m[1],m[2])}},i=0,o=Object.keys(r);i<o.length;i++){var l=o[i];s(l)}return r}function $8(t,e,n){for(var r=[t,e,n],s={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},i=0,o=r;i<o.length;i++){var l=o[i];l.didParseCell&&s.didParseCell.push(l.didParseCell),l.willDrawCell&&s.willDrawCell.push(l.willDrawCell),l.didDrawCell&&s.didDrawCell.push(l.didDrawCell),l.willDrawPage&&s.willDrawPage.push(l.willDrawPage),l.didDrawPage&&s.didDrawPage.push(l.didDrawPage)}return s}function z8(t,e){var n,r,s,i,o,l,c,d,u,p,g,m,j=af(e.margin,40/t.scaleFactor()),k=(n=W8(t,e.startY))!==null&&n!==void 0?n:j.top,w;e.showFoot===!0?w="everyPage":e.showFoot===!1?w="never":w=(r=e.showFoot)!==null&&r!==void 0?r:"everyPage";var y;e.showHead===!0?y="everyPage":e.showHead===!1?y="never":y=(s=e.showHead)!==null&&s!==void 0?s:"everyPage";var _=(i=e.useCss)!==null&&i!==void 0?i:!1,S=e.theme||(_?"plain":"striped"),N=!!e.horizontalPageBreak,T=(o=e.horizontalPageBreakRepeat)!==null&&o!==void 0?o:null;return{includeHiddenHtml:(l=e.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:_,theme:S,startY:k,margin:j,pageBreak:(c=e.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(d=e.rowPageBreak)!==null&&d!==void 0?d:"auto",tableWidth:(u=e.tableWidth)!==null&&u!==void 0?u:"auto",showHead:y,showFoot:w,tableLineWidth:(p=e.tableLineWidth)!==null&&p!==void 0?p:0,tableLineColor:(g=e.tableLineColor)!==null&&g!==void 0?g:200,horizontalPageBreak:N,horizontalPageBreakRepeat:T,horizontalPageBreakBehaviour:(m=e.horizontalPageBreakBehaviour)!==null&&m!==void 0?m:"afterAllRows"}}function W8(t,e){var n=t.getLastAutoTable(),r=t.scaleFactor(),s=t.pageNumber(),i=!1;if(n&&n.startPageNumber){var o=n.startPageNumber+n.pageNumber-1;i=o===s}return typeof e=="number"?e:(e==null||e===!1)&&i&&(n==null?void 0:n.finalY)!=null?n.finalY+20/r:null}function H8(t,e,n){var r=e.head||[],s=e.body||[],i=e.foot||[];if(e.html){var o=e.includeHiddenHtml;if(n){var l=Tx(t,e.html,n,o,e.useCss)||{};r=l.head||r,s=l.body||r,i=l.foot||r}else console.error("Cannot parse html in non browser environment")}var c=e.columns||V8(r,s,i);return{columns:c,head:r,body:s,foot:i}}function V8(t,e,n){var r=t[0]||e[0]||n[0]||[],s=[];return Object.keys(r).filter(function(i){return i!=="_element"}).forEach(function(i){var o=1,l;Array.isArray(r)?l=r[parseInt(i)]:l=r[i],typeof l=="object"&&!Array.isArray(l)&&(o=(l==null?void 0:l.colSpan)||1);for(var c=0;c<o;c++){var d=void 0;Array.isArray(r)?d=s.length:d=i+(c>0?"_".concat(c):"");var u={dataKey:d};s.push(u)}}),s}var mg=function(){function t(e,n,r){this.table=n,this.pageNumber=n.pageNumber,this.settings=n.settings,this.cursor=r,this.doc=e.getDocument()}return t}(),G8=function(t){Cx(e,t);function e(n,r,s,i,o,l){var c=t.call(this,n,r,l)||this;return c.cell=s,c.row=i,c.column=o,c.section=i.section,c}return e}(mg),K8=function(){function t(e,n){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=n.columns,this.head=n.head,this.body=n.body,this.foot=n.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(n,r){return n+r.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(n,r){return n+r.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,n,r,s,i,o){for(var l=0,c=n;l<c.length;l++){var d=c[l],u=new G8(e,this,r,s,i,o),p=d(u)===!1;if(r.text=Array.isArray(r.text)?r.text:[r.text],p)return!1}return!0},t.prototype.callEndPageHooks=function(e,n){e.applyStyles(e.userStyles);for(var r=0,s=this.hooks.didDrawPage;r<s.length;r++){var i=s[r];i(new mg(e,this,n))}},t.prototype.callWillDrawPageHooks=function(e,n){for(var r=0,s=this.hooks.willDrawPage;r<s.length;r++){var i=s[r];i(new mg(e,this,n))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var n=this.columns.reduce(function(s,i){return s+i.wrappedWidth},0);return n}else{var r=this.settings.margin;return e-r.left-r.right}},t}(),Ix=function(){function t(e,n,r,s,i){i===void 0&&(i=!1),this.height=0,this.raw=e,e instanceof Ax&&(this.raw=e._element,this.element=e._element),this.index=n,this.section=r,this.cells=s,this.spansMultiplePages=i}return t.prototype.getMaxCellHeight=function(e){var n=this;return e.reduce(function(r,s){var i;return Math.max(r,((i=n.cells[s.index])===null||i===void 0?void 0:i.height)||0)},0)},t.prototype.hasRowSpan=function(e){var n=this;return e.filter(function(r){var s=n.cells[r.index];return s?s.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,n){return this.getMaxCellHeight(n)<=e},t.prototype.getMinimumRowHeight=function(e,n){var r=this;return e.reduce(function(s,i){var o=r.cells[i.index];if(!o)return 0;var l=n.getLineHeight(o.styles.fontSize),c=o.padding("vertical"),d=c+l;return d>s?d:s},0)},t}(),Rx=function(){function t(e,n,r){var s;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=n,this.section=r,this.raw=e;var i=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,i=(s=e.content)!==null&&s!==void 0?s:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var o=i!=null?""+i:"",l=/\r\n|\r|\n/g;this.text=o.split(l)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var n=this.height-this.padding("vertical");e=this.y+n/2+this.padding("top")}var r;if(this.styles.halign==="right")r=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var s=this.width-this.padding("horizontal");r=this.x+s/2+this.padding("left")}else r=this.x+this.padding("left");return{x:r,y:e}},t.prototype.getContentHeight=function(e,n){n===void 0&&(n=1.15);var r=Array.isArray(this.text)?this.text.length:1,s=this.styles.fontSize/e*n,i=r*s+this.padding("vertical");return Math.max(i,this.styles.minCellHeight)},t.prototype.padding=function(e){var n=af(this.styles.cellPadding,0);return e==="vertical"?n.top+n.bottom:e==="horizontal"?n.left+n.right:n[e]},t}(),Z8=function(){function t(e,n,r){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=n,this.index=r}return t.prototype.getMaxCustomCellWidth=function(e){for(var n=0,r=0,s=e.allRows();r<s.length;r++){var i=s[r],o=i.cells[this.index];o&&typeof o.styles.cellWidth=="number"&&(n=Math.max(n,o.styles.cellWidth))}return n},t}();function Y8(t,e){J8(t,e);var n=[],r=0;e.columns.forEach(function(i){var o=i.getMaxCustomCellWidth(e);o?i.width=o:(i.width=i.wrappedWidth,n.push(i)),r+=i.width});var s=e.getWidth(t.pageSize().width)-r;s&&(s=gg(n,s,function(i){return Math.max(i.minReadableWidth,i.minWidth)})),s&&(s=gg(n,s,function(i){return i.minWidth})),s=Math.abs(s),!e.settings.horizontalPageBreak&&s>.1/t.scaleFactor()&&(s=s<1?s:Math.round(s),console.warn("Of the table content, ".concat(s," units width could not fit page"))),Q8(e),eE(e,t),X8(e)}function J8(t,e){var n=t.scaleFactor(),r=e.settings.horizontalPageBreak,s=Px(t,e);e.allRows().forEach(function(i){for(var o=0,l=e.columns;o<l.length;o++){var c=l[o],d=i.cells[c.index];if(d){var u=e.hooks.didParseCell;e.callCellHooks(t,u,d,i,c,null);var p=d.padding("horizontal");d.contentWidth=Ch(d.text,d.styles,t)+p;var g=Ch(d.text.join(" ").split(/[^\S\u00A0]+/),d.styles,t);if(d.minReadableWidth=g+d.padding("horizontal"),typeof d.styles.cellWidth=="number")d.minWidth=d.styles.cellWidth,d.wrappedWidth=d.styles.cellWidth;else if(d.styles.cellWidth==="wrap"||r===!0)d.contentWidth>s?(d.minWidth=s,d.wrappedWidth=s):(d.minWidth=d.contentWidth,d.wrappedWidth=d.contentWidth);else{var m=10/n;d.minWidth=d.styles.minCellWidth||m,d.wrappedWidth=d.contentWidth,d.minWidth>d.wrappedWidth&&(d.wrappedWidth=d.minWidth)}}}}),e.allRows().forEach(function(i){for(var o=0,l=e.columns;o<l.length;o++){var c=l[o],d=i.cells[c.index];if(d&&d.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,d.wrappedWidth),c.minWidth=Math.max(c.minWidth,d.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,d.minReadableWidth);else{var u=e.styles.columnStyles[c.dataKey]||e.styles.columnStyles[c.index]||{},p=u.cellWidth||u.minCellWidth;p&&typeof p=="number"&&(c.minWidth=p,c.wrappedWidth=p)}d&&(d.colSpan>1&&!c.minWidth&&(c.minWidth=d.minWidth),d.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=d.minWidth))}})}function gg(t,e,n){for(var r=e,s=t.reduce(function(m,j){return m+j.wrappedWidth},0),i=0;i<t.length;i++){var o=t[i],l=o.wrappedWidth/s,c=r*l,d=o.width+c,u=n(o),p=d<u?u:d;e-=p-o.width,o.width=p}if(e=Math.round(e*1e10)/1e10,e){var g=t.filter(function(m){return e<0?m.width>n(m):!0});g.length&&(e=gg(g,e,n))}return e}function X8(t){for(var e={},n=1,r=t.allRows(),s=0;s<r.length;s++)for(var i=r[s],o=0,l=t.columns;o<l.length;o++){var c=l[o],d=e[c.index];if(n>1)n--,delete i.cells[c.index];else if(d)d.cell.height+=i.height,n=d.cell.colSpan,delete i.cells[c.index],d.left--,d.left<=1&&delete e[c.index];else{var u=i.cells[c.index];if(!u)continue;if(u.height=i.height,u.rowSpan>1){var p=r.length-s,g=u.rowSpan>p?p:u.rowSpan;e[c.index]={cell:u,left:g,row:i}}}}}function Q8(t){for(var e=t.allRows(),n=0;n<e.length;n++)for(var r=e[n],s=null,i=0,o=0,l=0;l<t.columns.length;l++){var c=t.columns[l];if(o-=1,o>1&&t.columns[l+1])i+=c.width,delete r.cells[c.index];else if(s){var d=s;delete r.cells[c.index],s=null,d.width=c.width+i}else{var d=r.cells[c.index];if(!d)continue;if(o=d.colSpan,i=0,d.colSpan>1){s=d,i+=c.width;continue}d.width=c.width+i}}}function eE(t,e){for(var n={count:0,height:0},r=0,s=t.allRows();r<s.length;r++){for(var i=s[r],o=0,l=t.columns;o<l.length;o++){var c=l[o],d=i.cells[c.index];if(d){e.applyStyles(d.styles,!0);var u=d.width-d.padding("horizontal");if(d.styles.overflow==="linebreak")d.text=e.splitTextToSize(d.text,u+1/e.scaleFactor(),{fontSize:d.styles.fontSize});else if(d.styles.overflow==="ellipsize")d.text=ly(d.text,u,d.styles,e,"...");else if(d.styles.overflow==="hidden")d.text=ly(d.text,u,d.styles,e,"");else if(typeof d.styles.overflow=="function"){var p=d.styles.overflow(d.text,u);typeof p=="string"?d.text=[p]:d.text=p}d.contentHeight=d.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var g=d.contentHeight/d.rowSpan;d.rowSpan>1&&n.count*n.height<g*d.rowSpan?n={height:g,count:d.rowSpan}:n&&n.count>0&&n.height>g&&(g=n.height),g>i.height&&(i.height=g)}}n.count--}}function ly(t,e,n,r,s){return t.map(function(i){return tE(i,e,n,r,s)})}function tE(t,e,n,r,s){var i=1e4*r.scaleFactor();if(e=Math.ceil(e*i)/i,e>=Ch(t,n,r))return t;for(;e<Ch(t+s,n,r)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+s}function nE(t,e){var n=new gl(t),r=rE(e,n.scaleFactor()),s=new K8(e,r);return Y8(n,s),n.applyStyles(n.userStyles),s}function rE(t,e){var n=t.content,r=aE(n.columns);if(n.head.length===0){var s=cy(r,"head");s&&n.head.push(s)}if(n.foot.length===0){var s=cy(r,"foot");s&&n.foot.push(s)}var i=t.settings.theme,o=t.styles;return{columns:r,head:zp("head",n.head,r,o,i,e),body:zp("body",n.body,r,o,i,e),foot:zp("foot",n.foot,r,o,i,e)}}function zp(t,e,n,r,s,i){var o={},l=e.map(function(c,d){for(var u=0,p={},g=0,m=0,j=0,k=n;j<k.length;j++){var w=k[j];if(o[w.index]==null||o[w.index].left===0)if(m===0){var y=void 0;Array.isArray(c)?y=c[w.index-g-u]:y=c[w.dataKey];var _={};typeof y=="object"&&!Array.isArray(y)&&(_=(y==null?void 0:y.styles)||{});var S=iE(t,w,d,s,r,i,_),N=new Rx(y,S,t);p[w.dataKey]=N,p[w.index]=N,m=N.colSpan-1,o[w.index]={left:N.rowSpan-1,times:m}}else m--,g++;else o[w.index].left--,m=o[w.index].times,u++}return new Ix(c,d,t,p)});return l}function cy(t,e){var n={};return t.forEach(function(r){if(r.raw!=null){var s=sE(e,r.raw);s!=null&&(n[r.dataKey]=s)}}),Object.keys(n).length>0?n:null}function sE(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function aE(t){return t.map(function(e,n){var r,s;return typeof e=="object"?s=(r=e.dataKey)!==null&&r!==void 0?r:n:s=n,new Z8(s,e,n)})}function iE(t,e,n,r,s,i,o){var l=T8(r),c;t==="head"?c=s.headStyles:t==="body"?c=s.bodyStyles:t==="foot"&&(c=s.footStyles);var d=ga({},l.table,l[t],s.styles,c),u=s.columnStyles[e.dataKey]||s.columnStyles[e.index]||{},p=t==="body"?u:{},g=t==="body"&&n%2===0?ga({},l.alternateRow,s.alternateRowStyles):{},m=L8(i),j=ga({},m,d,g,p);return ga(j,o)}function oE(t,e,n){var r;n===void 0&&(n={});var s=Px(t,e),i=new Map,o=[],l=[],c=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?c=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(c=[e.settings.horizontalPageBreakRepeat]),c.forEach(function(g){var m=e.columns.find(function(j){return j.dataKey===g||j.index===g});m&&!i.has(m.index)&&(i.set(m.index,!0),o.push(m.index),l.push(e.columns[m.index]),s-=m.wrappedWidth)});for(var d=!0,u=(r=n==null?void 0:n.start)!==null&&r!==void 0?r:0;u<e.columns.length;){if(i.has(u)){u++;continue}var p=e.columns[u].wrappedWidth;if(d||s>=p)d=!1,o.push(u),l.push(e.columns[u]),s-=p;else break;u++}return{colIndexes:o,columns:l,lastIndex:u-1}}function lE(t,e){for(var n=[],r=0;r<e.columns.length;r++){var s=oE(t,e,{start:r});s.columns.length&&(n.push(s),r=s.lastIndex)}return n}function cE(t,e){var n=e.settings,r=n.startY,s=n.margin,i={x:s.left,y:r},o=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),l=r+s.bottom+o;if(n.pageBreak==="avoid"){var c=e.body,d=c.reduce(function(g,m){return g+m.height},0);l+=d}var u=new gl(t);(n.pageBreak==="always"||n.startY!=null&&l>u.pageSize().height)&&(Ox(u),i.y=s.top),e.callWillDrawPageHooks(u,i);var p=ga({},i);e.startPageNumber=u.pageNumber(),n.horizontalPageBreak?dE(u,e,p,i):(u.applyStyles(u.userStyles),(n.showHead==="firstPage"||n.showHead==="everyPage")&&e.head.forEach(function(g){return wa(u,e,g,i,e.columns)}),u.applyStyles(u.userStyles),e.body.forEach(function(g,m){var j=m===e.body.length-1;Ah(u,e,g,j,p,i,e.columns)}),u.applyStyles(u.userStyles),(n.showFoot==="lastPage"||n.showFoot==="everyPage")&&e.foot.forEach(function(g){return wa(u,e,g,i,e.columns)})),Ex(u,e,p,i),e.callEndPageHooks(u,i),e.finalY=i.y,t.lastAutoTable=e,u.applyStyles(u.userStyles)}function dE(t,e,n,r){var s=lE(t,e),i=e.settings;if(i.horizontalPageBreakBehaviour==="afterAllRows")s.forEach(function(d,u){t.applyStyles(t.userStyles),u>0?Uc(t,e,n,r,d.columns,!0):dy(t,e,r,d.columns),uE(t,e,n,r,d.columns),Wp(t,e,r,d.columns)});else for(var o=-1,l=s[0],c=function(){var d=o;if(l){t.applyStyles(t.userStyles);var u=l.columns;o>=0?Uc(t,e,n,r,u,!0):dy(t,e,r,u),d=uy(t,e,o+1,r,u),Wp(t,e,r,u)}var p=d-o;s.slice(1).forEach(function(g){t.applyStyles(t.userStyles),Uc(t,e,n,r,g.columns,!0),uy(t,e,o+1,r,g.columns,p),Wp(t,e,r,g.columns)}),o=d};o<e.body.length-1;)c()}function dy(t,e,n,r){var s=e.settings;t.applyStyles(t.userStyles),(s.showHead==="firstPage"||s.showHead==="everyPage")&&e.head.forEach(function(i){return wa(t,e,i,n,r)})}function uE(t,e,n,r,s){t.applyStyles(t.userStyles),e.body.forEach(function(i,o){var l=o===e.body.length-1;Ah(t,e,i,l,n,r,s)})}function uy(t,e,n,r,s,i){t.applyStyles(t.userStyles),i=i??e.body.length;var o=Math.min(n+i,e.body.length),l=-1;return e.body.slice(n,o).forEach(function(c,d){var u=n+d===e.body.length-1,p=qx(t,e,u,r);c.canEntireRowFit(p,s)&&(wa(t,e,c,r,s),l=n+d)}),l}function Wp(t,e,n,r){var s=e.settings;t.applyStyles(t.userStyles),(s.showFoot==="lastPage"||s.showFoot==="everyPage")&&e.foot.forEach(function(i){return wa(t,e,i,n,r)})}function hE(t,e,n){var r=n.getLineHeight(t.styles.fontSize),s=t.padding("vertical"),i=Math.floor((e-s)/r);return Math.max(0,i)}function fE(t,e,n,r){var s={};t.spansMultiplePages=!0,t.height=0;for(var i=0,o=0,l=n.columns;o<l.length;o++){var c=l[o],d=t.cells[c.index];if(d){Array.isArray(d.text)||(d.text=[d.text]);var u=new Rx(d.raw,d.styles,d.section);u=ga(u,d),u.text=[];var p=hE(d,e,r);d.text.length>p&&(u.text=d.text.splice(p,d.text.length));var g=r.scaleFactor(),m=r.getLineHeightFactor();d.contentHeight=d.getContentHeight(g,m),d.contentHeight>=e&&(d.contentHeight=e,u.styles.minCellHeight-=e),d.contentHeight>t.height&&(t.height=d.contentHeight),u.contentHeight=u.getContentHeight(g,m),u.contentHeight>i&&(i=u.contentHeight),s[c.index]=u}}var j=new Ix(t.raw,-1,t.section,s,!0);j.height=i;for(var k=0,w=n.columns;k<w.length;k++){var c=w[k],u=j.cells[c.index];u&&(u.height=j.height);var d=t.cells[c.index];d&&(d.height=t.height)}return j}function pE(t,e,n,r){var s=t.pageSize().height,i=r.settings.margin,o=i.top+i.bottom,l=s-o;e.section==="body"&&(l-=r.getHeadHeight(r.columns)+r.getFootHeight(r.columns));var c=e.getMinimumRowHeight(r.columns,t),d=c<n;if(c>l)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!d)return!1;var u=e.hasRowSpan(r.columns),p=e.getMaxCellHeight(r.columns)>l;return p?(u&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(u||r.settings.rowPageBreak==="avoid")}function Ah(t,e,n,r,s,i,o){var l=qx(t,e,r,i);if(n.canEntireRowFit(l,o))wa(t,e,n,i,o);else if(pE(t,n,l,e)){var c=fE(n,l,e,t);wa(t,e,n,i,o),Uc(t,e,s,i,o),Ah(t,e,c,r,s,i,o)}else Uc(t,e,s,i,o),Ah(t,e,n,r,s,i,o)}function wa(t,e,n,r,s){r.x=e.settings.margin.left;for(var i=0,o=s;i<o.length;i++){var l=o[i],c=n.cells[l.index];if(!c){r.x+=l.width;continue}t.applyStyles(c.styles),c.x=r.x,c.y=r.y;var d=e.callCellHooks(t,e.hooks.willDrawCell,c,n,l,r);if(d===!1){r.x+=l.width;continue}mE(t,c,r);var u=c.getTextPos();Nx(c.text,u.x,u.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,c,n,l,r),r.x+=l.width}r.y+=n.height}function mE(t,e,n){var r=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof r.lineWidth=="number"){var s=Dx(r.lineWidth,r.fillColor);s&&t.rect(e.x,n.y,e.width,e.height,s)}else typeof r.lineWidth=="object"&&(r.fillColor&&t.rect(e.x,n.y,e.width,e.height,"F"),gE(t,e,n,r.lineWidth))}function gE(t,e,n,r){var s,i,o,l;r.top&&(s=n.x,i=n.y,o=n.x+e.width,l=n.y,r.right&&(o+=.5*r.right),r.left&&(s-=.5*r.left),c(r.top,s,i,o,l)),r.bottom&&(s=n.x,i=n.y+e.height,o=n.x+e.width,l=n.y+e.height,r.right&&(o+=.5*r.right),r.left&&(s-=.5*r.left),c(r.bottom,s,i,o,l)),r.left&&(s=n.x,i=n.y,o=n.x,l=n.y+e.height,r.top&&(i-=.5*r.top),r.bottom&&(l+=.5*r.bottom),c(r.left,s,i,o,l)),r.right&&(s=n.x+e.width,i=n.y,o=n.x+e.width,l=n.y+e.height,r.top&&(i-=.5*r.top),r.bottom&&(l+=.5*r.bottom),c(r.right,s,i,o,l));function c(d,u,p,g,m){t.getDocument().setLineWidth(d),t.getDocument().line(u,p,g,m,"S")}}function qx(t,e,n,r){var s=e.settings.margin.bottom,i=e.settings.showFoot;return(i==="everyPage"||i==="lastPage"&&n)&&(s+=e.getFootHeight(e.columns)),t.pageSize().height-r.y-s}function Uc(t,e,n,r,s,i){s===void 0&&(s=[]),i===void 0&&(i=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!i&&e.foot.forEach(function(l){return wa(t,e,l,r,s)}),e.callEndPageHooks(t,r);var o=e.settings.margin;Ex(t,e,n,r),Ox(t),e.pageNumber++,r.x=o.left,r.y=o.top,n.y=o.top,e.callWillDrawPageHooks(t,r),e.settings.showHead==="everyPage"&&(e.head.forEach(function(l){return wa(t,e,l,r,s)}),t.applyStyles(t.userStyles))}function Ox(t){var e=t.pageNumber();t.setPage(e+1);var n=t.pageNumber();return n===e?(t.addPage(),!0):!1}function vE(t){t.API.autoTable=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=e[0],s=B8(this,r),i=nE(this,s);return cE(this,i),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,n,r,s){Nx(e,n,r,s,this)},t.API.autoTableSetDefaults=function(e){return gl.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,n){gl.setDefaults(e,n)},t.API.autoTableHtmlToJson=function(e,n){var r;if(n===void 0&&(n=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var s=new gl(this),i=Tx(s,e,window,n,!1),o=i.head,l=i.body,c=((r=o[0])===null||r===void 0?void 0:r.map(function(d){return d.content}))||[];return{columns:c,rows:l,data:l}}}var Hp;try{if(typeof window<"u"&&window){var hy=window,fy=hy.jsPDF||((Hp=hy.jspdf)===null||Hp===void 0?void 0:Hp.jsPDF);fy&&vE(fy)}}catch(t){console.error("Could not apply autoTable plugin",t)}function yE(){const[t,e]=O.useState({totalBookings:0,approvalRate:0,popularEquipment:[],bookingsByDepartment:{},bookingsByStatus:{},filteredBookings:[]}),[n,r]=O.useState(!0),[s,i]=O.useState("all"),[o,l]=O.useState("all"),[c,d]=O.useState(""),[u,p]=O.useState(""),[g,m]=O.useState([]),[j,k]=O.useState([]),[w,y]=O.useState([]);O.useEffect(()=>{_()},[]),O.useEffect(()=>{w.length>0&&S()},[s,o,c,u,w]);const _=async()=>{try{const P=await be.query("bookings"),b=await be.query("equipment"),A=await be.query("users");y(P),k(A);const $=[...new Set(A.map(D=>D.department))].filter(Boolean);m($)}catch(P){console.error("Failed to load data:",P)}finally{r(!1)}},S=async()=>{try{const P=await be.query("equipment");let b=[...w];s!=="all"&&(b=b.filter(te=>{const oe=j.find(Z=>Z.id===te.user_id);return(oe==null?void 0:oe.department)===s})),o!=="all"&&(b=b.filter(te=>te.user_id===o)),c&&(b=b.filter(te=>new Date(te.start_date)>=new Date(c))),u&&(b=b.filter(te=>new Date(te.start_date)<=new Date(u)));const A=b.filter(te=>te.status!=="pending").length,$=b.filter(te=>te.status==="approved").length,D=A>0?Math.round($/A*100):0,F={};b.forEach(te=>{F[te.equipment_id]=(F[te.equipment_id]||0)+1});const L=Object.entries(F).sort((te,oe)=>oe[1]-te[1]).slice(0,5).map(([te,oe])=>{const Z=P.find(ae=>ae.id===te);return{name:(Z==null?void 0:Z.product_name)||"Unknown",count:oe}}),I={};for(const te of b){const oe=j.find(ae=>ae.id===te.user_id),Z=(oe==null?void 0:oe.department)||"Unknown";I[Z]=(I[Z]||0)+1}const X={};b.forEach(te=>{X[te.status]=(X[te.status]||0)+1}),e({totalBookings:b.length,approvalRate:D,popularEquipment:L,bookingsByDepartment:I,bookingsByStatus:X,filteredBookings:b})}catch(P){console.error("Failed to calculate analytics:",P)}},N=async()=>{try{const P=new He,b=P.internal.pageSize.getWidth(),A=P.internal.pageSize.getHeight(),$=[156,39,176],D=[243,229,245],F=[26,26,26],L=[84,110,122];P.setFillColor(...$),P.rect(0,0,b,45,"F"),P.setTextColor(255,255,255),P.setFontSize(24),P.setFont("helvetica","bold"),P.text("NCAD Equipment Booking System",b/2,20,{align:"center"}),P.setFontSize(14),P.setFont("helvetica","normal"),P.text("Analytics & Reports",b/2,30,{align:"center"}),P.setFontSize(9),P.setTextColor(255,255,255),P.text(`Generated: ${new Date().toLocaleString("en-IE")}`,b/2,38,{align:"center"});let I=55;P.setFillColor(...D),P.roundedRect(14,I,b-28,25,2,2,"F"),P.setTextColor(...F),P.setFontSize(10),P.setFont("helvetica","bold"),P.text("Applied Filters:",20,I+7),P.setFont("helvetica","normal"),P.setFontSize(9);let X=[];if(s!=="all"&&X.push(`Department: ${s}`),o!=="all"){const E=j.find(H=>H.id===o);X.push(`User: ${(E==null?void 0:E.full_name)||"Unknown"}`)}c&&X.push(`From: ${new Date(c).toLocaleDateString("en-IE")}`),u&&X.push(`To: ${new Date(u).toLocaleDateString("en-IE")}`),X.length===0&&X.push("No filters applied - showing all data"),P.text(X.join("  "),20,I+15),I=90,P.setFontSize(12),P.setFont("helvetica","bold"),P.setTextColor(...$),P.text("Summary Statistics",20,I),I+=10,P.autoTable({startY:I,head:[["Metric","Value"]],body:[["Total Bookings",t.totalBookings.toString()],["Approval Rate",`${t.approvalRate}%`],["Pending Bookings",(t.bookingsByStatus.pending||0).toString()],["Approved Bookings",(t.bookingsByStatus.approved||0).toString()],["Rejected Bookings",(t.bookingsByStatus.rejected||0).toString()]],theme:"grid",headStyles:{fillColor:$,textColor:[255,255,255],fontStyle:"bold",fontSize:10},bodyStyles:{fontSize:9,textColor:F},alternateRowStyles:{fillColor:[250,250,250]},margin:{left:20,right:20}}),I=P.lastAutoTable.finalY+15,I>A-80&&(P.addPage(),I=20),P.setFontSize(12),P.setFont("helvetica","bold"),P.setTextColor(...$),P.text("Top 5 Popular Equipment",20,I),I+=5;const te=t.popularEquipment.map(E=>[E.name,E.count.toString(),`${Math.round(E.count/t.totalBookings*100)}%`]);P.autoTable({startY:I,head:[["Equipment Name","Bookings","Usage %"]],body:te,theme:"grid",headStyles:{fillColor:$,textColor:[255,255,255],fontStyle:"bold",fontSize:10},bodyStyles:{fontSize:9,textColor:F},alternateRowStyles:{fillColor:[250,250,250]},margin:{left:20,right:20}}),I=P.lastAutoTable.finalY+15,I>A-60&&(P.addPage(),I=20),P.setFontSize(12),P.setFont("helvetica","bold"),P.setTextColor(...$),P.text("Bookings by Department",20,I),I+=5;const oe=Object.entries(t.bookingsByDepartment).map(([E,H])=>[E,H.toString(),`${Math.round(H/t.totalBookings*100)}%`]);P.autoTable({startY:I,head:[["Department","Bookings","Percentage"]],body:oe,theme:"grid",headStyles:{fillColor:$,textColor:[255,255,255],fontStyle:"bold",fontSize:10},bodyStyles:{fontSize:9,textColor:F},alternateRowStyles:{fillColor:[250,250,250]},margin:{left:20,right:20}}),I=P.lastAutoTable.finalY+15,I>A-60&&(P.addPage(),I=20),P.setFontSize(12),P.setFont("helvetica","bold"),P.setTextColor(...$),P.text("Bookings by Status",20,I),I+=5;const Z=Object.entries(t.bookingsByStatus).map(([E,H])=>[E.charAt(0).toUpperCase()+E.slice(1),H.toString(),`${Math.round(H/t.totalBookings*100)}%`]);P.autoTable({startY:I,head:[["Status","Count","Percentage"]],body:Z,theme:"grid",headStyles:{fillColor:$,textColor:[255,255,255],fontStyle:"bold",fontSize:10},bodyStyles:{fontSize:9,textColor:F},alternateRowStyles:{fillColor:[250,250,250]},margin:{left:20,right:20}});const ae=P.internal.getNumberOfPages();for(let E=1;E<=ae;E++)P.setPage(E),P.setFontSize(8),P.setTextColor(...L),P.setFont("helvetica","normal"),P.text("NCAD Equipment Booking System - Confidential",b/2,A-10,{align:"center"}),P.text(`Page ${E} of ${ae}`,b-20,A-10,{align:"right"});const de=`NCAD_Analytics_Report_${new Date().toISOString().split("T")[0]}.pdf`;P.save(de),alert("PDF report generated successfully!")}catch(P){console.error("Failed to generate PDF:",P),alert("Failed to generate PDF report. Please try again.")}},T=()=>{try{const P={};let b=`Booking ID,User,Department,Equipment,Start Date,End Date,Status,Created
`;t.filteredBookings.forEach(F=>{const L=j.find(X=>X.id===F.user_id),I=P[F.equipment_id]||"Unknown";b+=`${F.id},"${(L==null?void 0:L.full_name)||"Unknown"}","${(L==null?void 0:L.department)||"Unknown"}","${I}",${F.start_date},${F.end_date},${F.status},${F.created_at}
`});const A=new Blob([b],{type:"text/csv"}),$=window.URL.createObjectURL(A),D=document.createElement("a");D.href=$,D.download=`analytics_${new Date().toISOString().split("T")[0]}.csv`,D.click(),window.URL.revokeObjectURL($)}catch(P){console.error("Failed to export CSV:",P),alert("Failed to export CSV. Please try again.")}},U=()=>{i("all"),l("all"),d(""),p("")};return n?a.jsx("div",{className:"loading",children:"Loading analytics..."}):a.jsxs("div",{className:"analytics-dashboard",children:[a.jsxs("div",{className:"analytics-header",children:[a.jsxs("div",{children:[a.jsx("h2",{children:"Analytics & Reports"}),a.jsx("p",{className:"subtitle",children:"Filter and export booking statistics"})]}),a.jsxs("div",{className:"analytics-actions",children:[a.jsx("button",{onClick:T,className:"btn btn-secondary",children:" Export CSV"}),a.jsx("button",{onClick:N,className:"btn btn-primary",children:" Generate PDF Report"})]})]}),a.jsxs("div",{className:"analytics-filters",children:[a.jsx("h3",{children:"Filters"}),a.jsxs("div",{className:"filter-grid",children:[a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{htmlFor:"filter-department",children:"Department"}),a.jsxs("select",{id:"filter-department",value:s,onChange:P=>i(P.target.value),className:"select-input",children:[a.jsx("option",{value:"all",children:"All Departments"}),g.map(P=>a.jsx("option",{value:P,children:P},P))]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{htmlFor:"filter-user",children:"User"}),a.jsxs("select",{id:"filter-user",value:o,onChange:P=>l(P.target.value),className:"select-input",children:[a.jsx("option",{value:"all",children:"All Users"}),j.map(P=>a.jsxs("option",{value:P.id,children:[P.full_name," (",P.department,")"]},P.id))]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{htmlFor:"filter-start-date",children:"Start Date"}),a.jsx("input",{id:"filter-start-date",type:"date",value:c,onChange:P=>d(P.target.value),className:"date-input"})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{htmlFor:"filter-end-date",children:"End Date"}),a.jsx("input",{id:"filter-end-date",type:"date",value:u,onChange:P=>p(P.target.value),className:"date-input"})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:""}),a.jsx("button",{onClick:U,className:"btn btn-secondary btn-reset",children:"Reset Filters"})]})]})]}),a.jsxs("div",{className:"stats-grid",children:[a.jsxs("div",{className:"stat-card stat-primary",children:[a.jsx("div",{className:"stat-icon",style:{background:"var(--master-bg-tertiary)",color:"var(--master-accent-primary)"},children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:t.totalBookings}),a.jsx("p",{children:"Total Bookings"})]})]}),a.jsxs("div",{className:"stat-card stat-success",children:[a.jsx("div",{className:"stat-icon",style:{background:"#F3E5F5",color:"#7B1FA2"},children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsxs("h3",{children:[t.approvalRate,"%"]}),a.jsx("p",{children:"Approval Rate"})]})]})]}),a.jsxs("div",{className:"analytics-grid",children:[a.jsxs("div",{className:"analytics-card",children:[a.jsx("h3",{children:"Popular Equipment"}),a.jsx("div",{className:"chart-list",children:t.popularEquipment.length>0?t.popularEquipment.map((P,b)=>a.jsxs("div",{className:"chart-item",children:[a.jsx("span",{className:"item-name",children:P.name}),a.jsx("div",{className:"progress-bar",children:a.jsx("div",{className:"progress-fill",style:{width:`${P.count/t.totalBookings*100}%`,background:"var(--master-accent-primary)"}})}),a.jsxs("span",{className:"item-count",children:[P.count," bookings"]})]},b)):a.jsx("p",{className:"empty-message",children:"No data available"})})]}),a.jsxs("div",{className:"analytics-card",children:[a.jsx("h3",{children:"Bookings by Department"}),a.jsx("div",{className:"chart-list",children:Object.entries(t.bookingsByDepartment).length>0?Object.entries(t.bookingsByDepartment).map(([P,b])=>a.jsxs("div",{className:"chart-item",children:[a.jsx("span",{className:"item-name",children:P}),a.jsx("div",{className:"progress-bar",children:a.jsx("div",{className:"progress-fill",style:{width:`${b/t.totalBookings*100}%`,background:"var(--master-accent-primary)"}})}),a.jsx("span",{className:"item-count",children:b})]},P)):a.jsx("p",{className:"empty-message",children:"No data available"})})]}),a.jsxs("div",{className:"analytics-card",children:[a.jsx("h3",{children:"Bookings by Status"}),a.jsx("div",{className:"chart-list",children:Object.entries(t.bookingsByStatus).length>0?Object.entries(t.bookingsByStatus).map(([P,b])=>a.jsxs("div",{className:"chart-item",children:[a.jsx("span",{className:"item-name",children:P}),a.jsx("div",{className:"progress-bar",children:a.jsx("div",{className:"progress-fill",style:{width:`${b/t.totalBookings*100}%`,background:"var(--master-accent-primary)"}})}),a.jsx("span",{className:"item-count",children:b})]},P)):a.jsx("p",{className:"empty-message",children:"No data available"})})]})]})]})}function bE(){const{user:t}=Nr(),[e,n]=O.useState([]),[r,s]=O.useState(!0),[i,o]=O.useState({serviceId:"",publicKey:"",templateConfirm:"",templateApproved:"",templateDenied:"",templateOverdue:"",templateReminder:""}),[l,c]=O.useState(!1),[d,u]=O.useState("");O.useEffect(()=>{p(),g()},[]);const p=async()=>{try{const w=await be.query("featureFlags");n(w)}catch(w){console.error("Failed to load feature flags:",w)}finally{s(!1)}},g=()=>{const w=Vn.getConfig();o({serviceId:w.serviceId,publicKey:w.publicKey,templateConfirm:w.templates.bookingConfirmation,templateApproved:w.templates.bookingApproved,templateDenied:w.templates.bookingDenied,templateOverdue:w.templates.bookingOverdue,templateReminder:w.templates.bookingReminder})},m=()=>{if(t.role!=="master_admin"){alert("Only master admins can update email configuration");return}Vn.updateConfig({serviceId:i.serviceId,publicKey:i.publicKey,templates:{bookingConfirmation:i.templateConfirm,bookingApproved:i.templateApproved,bookingDenied:i.templateDenied,bookingOverdue:i.templateOverdue,bookingReminder:i.templateReminder}}),alert("Email configuration saved successfully!"),c(!1)},j=async w=>{u(`Testing ${w} email...`);const y={id:"TEST123",start_date:new Date().toISOString(),end_date:new Date(Date.now()+864e5*3).toISOString(),purpose:"Test booking for email verification"},_=[{product_name:"Test Equipment (Canon EOS R5)"}];try{let S;switch(w){case"confirmation":S=await Vn.sendBookingConfirmation(y,t,_);break;case"approved":S=await Vn.sendBookingApproved(y,t,_,t);break;case"denied":S=await Vn.sendBookingDenied(y,t,_,t,"Test denial reason");break;case"overdue":S=await Vn.sendOverdueReminder(y,t,_,3);break;case"reminder":S=await Vn.sendBookingReminder(y,t,_,2);break}S.success?u(` ${w} email sent successfully!`):u(` Failed: ${S.error}`)}catch(S){u(` Error: ${S.message}`)}setTimeout(()=>u(""),5e3)},k=async w=>{if(t.role!=="master_admin"){alert("Only master admins can toggle feature flags");return}try{const y=e.find(_=>_.id===w);await be.update("featureFlags",{id:w},{enabled:!y.enabled,updated_by:t.id,updated_at:new Date().toISOString()}),await p(),alert(`Feature flag ${y.enabled?"disabled":"enabled"} successfully`)}catch(y){alert("Failed to toggle feature flag: "+y.message)}};return r?a.jsx("div",{className:"loading",children:"Loading feature flags..."}):a.jsxs("div",{className:"feature-flags",children:[a.jsx("h2",{children:"Feature Flag Management"}),a.jsx("p",{className:"subtitle",children:"Control system-wide features and access"}),t.role!=="master_admin"&&a.jsx("div",{className:"warning-banner",children:" You are viewing feature flags in read-only mode. Only Master Admins can toggle flags."}),a.jsx("div",{className:"flags-list",children:e.map(w=>a.jsxs("div",{className:"flag-item",children:[a.jsxs("div",{className:"flag-info",children:[a.jsx("h3",{children:w.name.replace(/_/g," ").toUpperCase()}),a.jsx("p",{className:"flag-description",children:w.description}),a.jsx("p",{className:"flag-meta",children:a.jsx("span",{className:"role-badge",children:w.required_role})})]}),a.jsxs("div",{className:"flag-toggle",children:[a.jsxs("label",{className:"switch",children:[a.jsx("input",{type:"checkbox",checked:w.enabled,onChange:()=>k(w.id),disabled:t.role!=="master_admin"}),a.jsx("span",{className:"slider"})]}),a.jsx("span",{className:w.enabled?"status-enabled":"status-disabled",children:w.enabled?"Enabled":"Disabled"})]})]},w.id))}),a.jsxs("div",{className:"flags-info",children:[a.jsx("h3",{children:"About Feature Flags"}),a.jsxs("ul",{children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Room Booking:"})," Allows staff to book rooms and spaces by the hour"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Analytics Export:"})," Enables CSV/PDF export of analytics data"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"CSV Import:"})," Allows bulk import of users and equipment"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Interdisciplinary Access:"})," Permits cross-department equipment borrowing"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Advanced Reporting:"})," Unlocks detailed reporting features"]})]})]}),a.jsxs("div",{className:"email-config-section",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("h2",{children:" Email Notifications Configuration"}),a.jsx("button",{onClick:()=>c(!l),className:"btn btn-secondary btn-sm",disabled:t.role!=="master_admin",children:l?"Hide":"Configure EmailJS"})]}),a.jsxs("div",{className:"email-status",children:[Vn.isConfigured()?a.jsx("span",{className:"status-badge status-success",children:" EmailJS Configured"}):a.jsx("span",{className:"status-badge status-warning",children:" EmailJS Not Configured"}),a.jsxs("p",{className:"help-text",children:["Email notifications are sent automatically for booking confirmations, approvals, and denials.",a.jsx("br",{}),"See ",a.jsx("code",{children:"EMAIL_TEMPLATES.md"})," for setup instructions."]})]}),l&&a.jsxs("div",{className:"email-config-form",children:[a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"serviceId",children:"EmailJS Service ID"}),a.jsx("input",{id:"serviceId",type:"text",value:i.serviceId,onChange:w=>o({...i,serviceId:w.target.value}),placeholder:"service_xxxxxxxxx",disabled:t.role!=="master_admin"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"publicKey",children:"EmailJS Public Key"}),a.jsx("input",{id:"publicKey",type:"text",value:i.publicKey,onChange:w=>o({...i,publicKey:w.target.value}),placeholder:"Your public key",disabled:t.role!=="master_admin"})]})]}),a.jsx("h3",{children:"Email Template IDs"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"templateConfirm",children:"Booking Confirmation"}),a.jsx("input",{id:"templateConfirm",type:"text",value:i.templateConfirm,onChange:w=>o({...i,templateConfirm:w.target.value}),placeholder:"template_booking_confirm",disabled:t.role!=="master_admin"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"templateApproved",children:"Booking Approved"}),a.jsx("input",{id:"templateApproved",type:"text",value:i.templateApproved,onChange:w=>o({...i,templateApproved:w.target.value}),placeholder:"template_booking_approved",disabled:t.role!=="master_admin"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"templateDenied",children:"Booking Denied"}),a.jsx("input",{id:"templateDenied",type:"text",value:i.templateDenied,onChange:w=>o({...i,templateDenied:w.target.value}),placeholder:"template_booking_denied",disabled:t.role!=="master_admin"})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"templateOverdue",children:"Overdue Reminder"}),a.jsx("input",{id:"templateOverdue",type:"text",value:i.templateOverdue,onChange:w=>o({...i,templateOverdue:w.target.value}),placeholder:"template_booking_overdue",disabled:t.role!=="master_admin"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"templateReminder",children:"Booking Reminder"}),a.jsx("input",{id:"templateReminder",type:"text",value:i.templateReminder,onChange:w=>o({...i,templateReminder:w.target.value}),placeholder:"template_booking_reminder",disabled:t.role!=="master_admin"})]})]}),a.jsx("div",{className:"form-actions",children:a.jsx("button",{onClick:m,className:"btn btn-primary",disabled:t.role!=="master_admin",children:"Save Configuration"})}),Vn.isConfigured()&&a.jsxs("div",{className:"email-test-section",children:[a.jsx("h3",{children:"Test Email Templates"}),a.jsxs("p",{className:"help-text",children:["Send test emails to ",t.email]}),a.jsxs("div",{className:"test-buttons",children:[a.jsx("button",{onClick:()=>j("confirmation"),className:"btn btn-secondary btn-sm",children:"Test Confirmation"}),a.jsx("button",{onClick:()=>j("approved"),className:"btn btn-secondary btn-sm",children:"Test Approved"}),a.jsx("button",{onClick:()=>j("denied"),className:"btn btn-secondary btn-sm",children:"Test Denied"}),a.jsx("button",{onClick:()=>j("overdue"),className:"btn btn-secondary btn-sm",children:"Test Overdue"}),a.jsx("button",{onClick:()=>j("reminder"),className:"btn btn-secondary btn-sm",children:"Test Reminder"})]}),d&&a.jsx("div",{className:"test-status",children:d})]})]})]})]})}function _E(){const{user:t}=cn(),[e,n]=O.useState([]),[r,s]=O.useState([]),[i,o]=O.useState(!0),[l,c]=O.useState("all"),[d,u]=O.useState("all"),[p,g]=O.useState(""),[m,j]=O.useState(1),k=20,[w,y]=O.useState(!1),[_,S]=O.useState(!1),[N,T]=O.useState(null),[U,P]=O.useState({email:"",password:"",first_name:"",surname:"",role:"student",department:"Moving Image"});if(t.role!=="master_admin")return a.jsxs("div",{className:"access-denied",children:[a.jsx("h2",{children:"Access Denied"}),a.jsx("p",{children:"Only Master Admins can manage users."})]});O.useEffect(()=>{b()},[l,d]),O.useEffect(()=>{let ee=e;if(p.trim()){const de=p.toLowerCase();ee=ee.filter(E=>E.full_name.toLowerCase().includes(de)||E.email.toLowerCase().includes(de))}s(ee),j(1)},[e,p]);const b=async()=>{o(!0);try{let ee={};l!=="all"&&(ee.role=l),d!=="all"&&(ee.department=d);let de=await be.query("users",ee);n(de)}catch(ee){console.error("Failed to load users:",ee)}finally{o(!1)}},A=async()=>{if(!U.email||!U.password||!U.first_name||!U.surname){alert("Please fill in all required fields");return}try{const ee={id:Date.now().toString(),...U,full_name:`${U.first_name} ${U.surname}`,created_at:new Date().toISOString().split("T")[0]};await be.insert("users",ee),y(!1),P({email:"",password:"",first_name:"",surname:"",role:"student",department:"Moving Image"}),b(),alert("User created successfully")}catch(ee){alert("Failed to create user: "+ee.message)}},$=async()=>{if(!U.first_name||!U.surname){alert("Please fill in all required fields");return}try{const ee={...U,full_name:`${U.first_name} ${U.surname}`};await be.update("users",{id:N.id},ee),S(!1),T(null),b(),alert("User updated successfully")}catch(ee){alert("Failed to update user: "+ee.message)}},D=async(ee,de)=>{if(["1","2","3","4"].includes(ee)){alert("Cannot delete demo test accounts");return}if(confirm(`Are you sure you want to delete ${de}? This action cannot be undone.`))try{await be.delete("users",{id:ee}),b(),alert("User deleted successfully")}catch(E){alert("Failed to delete user: "+E.message)}},F=ee=>{T(ee),P({email:ee.email,password:ee.password,first_name:ee.first_name,surname:ee.surname,role:ee.role,department:ee.department}),S(!0)},L=["Moving Image","Graphic Design","Illustration","Administration"],I=[{value:"student",label:"Student"},{value:"staff",label:"Staff"},{value:"admin",label:"Admin"},{value:"master_admin",label:"Master Admin"}],X=ee=>{g(ee)},te=ee=>{j(ee),window.scrollTo({top:0,behavior:"smooth"})},oe=(m-1)*k,Z=oe+k,ae=r.slice(oe,Z);return a.jsxs("div",{className:"user-management",children:[a.jsx("h2",{children:"User Management"}),a.jsx("p",{className:"subtitle",children:"Manage user accounts, roles, and permissions"}),a.jsx(nf,{onSearch:X,placeholder:"Search by name or email...",ariaLabel:"Search users"}),a.jsx("div",{className:"management-controls",children:a.jsxs("div",{className:"filter-controls",children:[a.jsxs("select",{value:l,onChange:ee=>c(ee.target.value),className:"select-input",children:[a.jsx("option",{value:"all",children:"All Roles"}),I.map(ee=>a.jsx("option",{value:ee.value,children:ee.label},ee.value))]}),a.jsxs("select",{value:d,onChange:ee=>u(ee.target.value),className:"select-input",children:[a.jsx("option",{value:"all",children:"All Departments"}),L.map(ee=>a.jsx("option",{value:ee,children:ee},ee))]}),a.jsx("button",{onClick:()=>y(!0),className:"btn btn-primary",children:"+ Add User"})]})}),i?a.jsx("div",{className:"users-table",children:a.jsxs("table",{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Name"}),a.jsx("th",{children:"Email"}),a.jsx("th",{children:"Role"}),a.jsx("th",{children:"Department"}),a.jsx("th",{children:"Created"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:a.jsx(cd,{type:"table-row",count:10})})]})}):r.length===0?a.jsx("div",{className:"empty-state",children:a.jsxs("p",{children:["No users found",p?" matching your search":""]})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"users-table",children:a.jsxs("table",{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Name"}),a.jsx("th",{children:"Email"}),a.jsx("th",{children:"Role"}),a.jsx("th",{children:"Department"}),a.jsx("th",{children:"Created"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:ae.map(ee=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("strong",{children:ee.full_name})}),a.jsx("td",{children:ee.email}),a.jsx("td",{children:a.jsx("span",{className:`role-badge role-${ee.role}`,children:ee.role.replace("_"," ")})}),a.jsx("td",{children:ee.department}),a.jsx("td",{children:new Date(ee.created_at).toLocaleDateString("en-IE")}),a.jsx("td",{children:a.jsxs("div",{className:"action-buttons",children:[a.jsx("button",{onClick:()=>F(ee),className:"btn btn-secondary btn-sm",children:"Edit"}),a.jsx("button",{onClick:()=>D(ee.id,ee.full_name),className:"btn btn-danger btn-sm",disabled:["1","2","3","4"].includes(ee.id),children:"Delete"})]})})]},ee.id))})]})}),a.jsx(ld,{currentPage:m,totalItems:r.length,itemsPerPage:k,onPageChange:te,loading:i})]}),w&&a.jsx("div",{className:"modal-overlay",onClick:()=>y(!1),children:a.jsxs("div",{className:"modal-content",onClick:ee=>ee.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:"Add New User"}),a.jsx("button",{className:"modal-close",onClick:()=>y(!1),children:""})]}),a.jsxs("div",{className:"modal-body",children:[a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"first-name",children:"First Name *"}),a.jsx("input",{id:"first-name",type:"text",value:U.first_name,onChange:ee=>P({...U,first_name:ee.target.value}),className:"form-input"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"surname",children:"Surname *"}),a.jsx("input",{id:"surname",type:"text",value:U.surname,onChange:ee=>P({...U,surname:ee.target.value}),className:"form-input"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email *"}),a.jsx("input",{id:"email",type:"email",value:U.email,onChange:ee=>P({...U,email:ee.target.value}),className:"form-input",placeholder:"user@ncad.ie"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"Password *"}),a.jsx("input",{id:"password",type:"password",value:U.password,onChange:ee=>P({...U,password:ee.target.value}),className:"form-input"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"role",children:"Role *"}),a.jsx("select",{id:"role",value:U.role,onChange:ee=>P({...U,role:ee.target.value}),className:"select-input",children:I.map(ee=>a.jsx("option",{value:ee.value,children:ee.label},ee.value))})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"department",children:"Department *"}),a.jsx("select",{id:"department",value:U.department,onChange:ee=>P({...U,department:ee.target.value}),className:"select-input",children:L.map(ee=>a.jsx("option",{value:ee,children:ee},ee))})]})]}),a.jsxs("div",{className:"modal-actions",children:[a.jsx("button",{onClick:()=>y(!1),className:"btn btn-secondary",children:"Cancel"}),a.jsx("button",{onClick:A,className:"btn btn-primary",children:"Add User"})]})]})]})}),_&&N&&a.jsx("div",{className:"modal-overlay",onClick:()=>S(!1),children:a.jsxs("div",{className:"modal-content",onClick:ee=>ee.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsxs("h2",{children:["Edit User - ",N.full_name]}),a.jsx("button",{className:"modal-close",onClick:()=>S(!1),children:""})]}),a.jsxs("div",{className:"modal-body",children:[a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"edit-first-name",children:"First Name *"}),a.jsx("input",{id:"edit-first-name",type:"text",value:U.first_name,onChange:ee=>P({...U,first_name:ee.target.value}),className:"form-input"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"edit-surname",children:"Surname *"}),a.jsx("input",{id:"edit-surname",type:"text",value:U.surname,onChange:ee=>P({...U,surname:ee.target.value}),className:"form-input"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"edit-email",children:"Email"}),a.jsx("input",{id:"edit-email",type:"email",value:U.email,className:"form-input",disabled:!0,title:"Email cannot be changed"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"edit-password",children:"Password"}),a.jsx("input",{id:"edit-password",type:"password",value:U.password,onChange:ee=>P({...U,password:ee.target.value}),className:"form-input",placeholder:"Leave blank to keep current"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"edit-role",children:"Role *"}),a.jsx("select",{id:"edit-role",value:U.role,onChange:ee=>P({...U,role:ee.target.value}),className:"select-input",children:I.map(ee=>a.jsx("option",{value:ee.value,children:ee.label},ee.value))})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"edit-department",children:"Department *"}),a.jsx("select",{id:"edit-department",value:U.department,onChange:ee=>P({...U,department:ee.target.value}),className:"select-input",children:L.map(ee=>a.jsx("option",{value:ee,children:ee},ee))})]})]}),a.jsxs("div",{className:"modal-actions",children:[a.jsx("button",{onClick:()=>S(!1),className:"btn btn-secondary",children:"Cancel"}),a.jsx("button",{onClick:$,className:"btn btn-primary",children:"Save Changes"})]})]})]})})]})}class xE{parseCSV(e){const n=e.trim().split(`
`);if(n.length<2)throw new Error("CSV file must contain at least a header row and one data row");const r=n[0].split(",").map(i=>i.trim().toLowerCase().replace(/^["']|["']$/g,"")),s=[];for(let i=1;i<n.length;i++){const o=n[i].trim();if(!o)continue;const l=this.parseCSVLine(o);if(l.length!==r.length){console.warn(`Row ${i+1} has ${l.length} columns, expected ${r.length}. Skipping.`);continue}const c={};r.forEach((d,u)=>{c[d]=l[u].trim()}),s.push(c)}return s}parseCSVLine(e){const n=[];let r="",s=!1;for(let i=0;i<e.length;i++){const o=e[i],l=e[i+1];o==='"'||o==="'"?s&&l===o?(r+=o,i++):s=!s:o===","&&!s?(n.push(r),r=""):r+=o}return n.push(r),n.map(i=>i.replace(/^["']|["']$/g,""))}validateUsers(e){const n=[],r=[],s=["first_name","surname","full_name","email","department"],i=["student","staff","admin","master_admin"],o=["Moving Image Design","Graphic Design","Illustration"],l=Object.keys(e[0]||{}),c=s.filter(d=>!l.includes(d));return c.length>0?(n.push(`Missing required columns: ${c.join(", ")}`),{valid:!1,errors:n,warnings:r}):(e.forEach((d,u)=>{const p=u+2;if(s.forEach(g=>{(!d[g]||d[g].trim()==="")&&n.push(`Row ${p}: Missing required field '${g}'`)}),d.email&&!this.isValidEmail(d.email)&&n.push(`Row ${p}: Invalid email format '${d.email}'`),d.role&&!i.includes(d.role)&&r.push(`Row ${p}: Invalid role '${d.role}', will default to 'student'`),d.department&&!o.includes(d.department)&&r.push(`Row ${p}: Department '${d.department}' not in standard list`),d.first_name&&d.surname&&d.full_name){const g=`${d.first_name} ${d.surname}`;d.full_name!==g&&r.push(`Row ${p}: full_name '${d.full_name}' doesn't match '${g}'`)}}),{valid:n.length===0,errors:n,warnings:r})}validateEquipment(e){const n=[],r=[],s=["product_name","tracking_number","description","link_to_image"],i=["Camera","Lens","Lighting","Audio","Tripod & Support","Computer","Printer","Scanner","Projector","Other"],o=["Moving Image Design","Graphic Design","Illustration","Shared"],l=Object.keys(e[0]||{}),c=s.filter(d=>!l.includes(d));return c.length>0?(n.push(`Missing required columns: ${c.join(", ")}`),{valid:!1,errors:n,warnings:r}):(e.forEach((d,u)=>{const p=u+2;s.forEach(g=>{(!d[g]||d[g].trim()==="")&&n.push(`Row ${p}: Missing required field '${g}'`)}),d.tracking_number&&d.tracking_number.length<3&&r.push(`Row ${p}: Tracking number '${d.tracking_number}' seems too short`),d.category&&!i.includes(d.category)&&r.push(`Row ${p}: Category '${d.category}' not in standard list`),d.department&&!o.includes(d.department)&&r.push(`Row ${p}: Department '${d.department}' not in standard list`),d.status&&!["available","booked","maintenance","out_of_service"].includes(d.status)&&r.push(`Row ${p}: Invalid status '${d.status}', will default to 'available'`)}),{valid:n.length===0,errors:n,warnings:r})}async detectUserDuplicates(e){const n=await be.query("users"),r=[],s=[];return e.forEach(i=>{const o=n.find(l=>l.email.toLowerCase()===i.email.toLowerCase());o?r.push({row:i,existingId:o.id,existingName:o.full_name,action:"skip"}):s.push(i)}),{duplicates:r,unique:s}}async detectEquipmentDuplicates(e){const n=await be.query("equipment"),r=[],s=[];return e.forEach(i=>{const o=n.find(l=>l.tracking_number.toLowerCase()===i.tracking_number.toLowerCase());o?r.push({row:i,existingId:o.id,existingName:o.product_name,action:"skip"}):s.push(i)}),{duplicates:r,unique:s}}async importUsers(e,n={skipDuplicates:!0,updateDuplicates:!1}){let r=0,s=0,i=0;for(const o of e)try{const c=(await be.query("users")).find(d=>d.email.toLowerCase()===o.email.toLowerCase());if(c)n.updateDuplicates?(await be.update("users",{id:c.id},{first_name:o.first_name,surname:o.surname,full_name:o.full_name||`${o.first_name} ${o.surname}`,department:o.department,role:o.role||"student",year:o.year||null}),i++):s++;else{const d={id:`${Date.now()}_${Math.random().toString(36).substr(2,9)}`,first_name:o.first_name,surname:o.surname,full_name:o.full_name||`${o.first_name} ${o.surname}`,email:o.email.toLowerCase(),department:o.department,role:o.role||"student",year:o.year||null,created_at:new Date().toISOString().split("T")[0]};await be.insert("users",d),r++}}catch(l){console.error(`Failed to import user ${o.email}:`,l),s++}return{imported:r,skipped:s,updated:i}}async importEquipment(e,n={skipDuplicates:!0,updateDuplicates:!1}){let r=0,s=0,i=0;for(const o of e)try{const c=(await be.query("equipment")).find(d=>d.tracking_number.toLowerCase()===o.tracking_number.toLowerCase());if(c)n.updateDuplicates?(await be.update("equipment",{id:c.id},{product_name:o.product_name,description:o.description,category:o.category||c.category,department:o.department||c.department,link_to_image:o.link_to_image,requires_justification:o.requires_justification==="true"||o.requires_justification===!0}),i++):s++;else{const d={id:`eq${Date.now()}_${Math.random().toString(36).substr(2,9)}`,product_name:o.product_name,tracking_number:o.tracking_number,description:o.description,category:o.category||"Other",department:o.department||"Shared",status:o.status||"available",link_to_image:o.link_to_image,requires_justification:o.requires_justification==="true"||o.requires_justification===!0||!1};await be.insert("equipment",d),r++}}catch(l){console.error(`Failed to import equipment ${o.tracking_number}:`,l),s++}return{imported:r,skipped:s,updated:i}}generateUserTemplate(){const e=["first_name","surname","full_name","email","department","role","year"],n=[["John","Doe","John Doe","john.doe@ncad.ie","Moving Image Design","student","2"],["Jane","Smith","Jane Smith","jane.smith@ncad.ie","Graphic Design","student","3"],["Bob","Admin","Bob Admin","bob.admin@ncad.ie","Moving Image Design","admin",""]];let r=e.join(",")+`
`;return n.forEach(s=>{r+=s.map(i=>`"${i}"`).join(",")+`
`}),r}generateEquipmentTemplate(){const e=["product_name","tracking_number","description","category","department","link_to_image","status","requires_justification"],n=[["Canon EOS R5","CAM001","Professional mirrorless camera","Camera","Moving Image Design","https://example.com/camera.jpg","available","true"],["Rode NTG3","AUD050","Shotgun microphone","Audio","Moving Image Design","https://example.com/mic.jpg","available","false"],['MacBook Pro 16"',"COMP020","M1 Max laptop","Computer","Shared","https://example.com/laptop.jpg","available","true"]];let r=e.join(",")+`
`;return n.forEach(s=>{r+=s.map(i=>`"${i}"`).join(",")+`
`}),r}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}}const ca=new xE;function wE(){const{user:t}=Nr(),[e,n]=O.useState("users"),[r,s]=O.useState(null),[i,o]=O.useState(null),[l,c]=O.useState(null),[d,u]=O.useState(null),[p,g]=O.useState(1),[m,j]=O.useState({skipDuplicates:!0,updateDuplicates:!1}),[k,w]=O.useState(null),[y,_]=O.useState(!1);if(t.role!=="master_admin")return a.jsxs("div",{className:"access-denied",children:[a.jsx("h2",{children:"Access Denied"}),a.jsx("p",{children:"Only Master Admins can import CSV data."})]});const S=b=>{const A=b.target.files[0];if(A){if(!A.name.endsWith(".csv")){alert("Please select a CSV file");return}s(A)}},N=async()=>{if(!r){alert("Please select a file first");return}_(!0);try{const b=await r.text(),A=ca.parseCSV(b);if(A.length===0){alert("CSV file is empty or invalid"),_(!1);return}const $=e==="users"?ca.validateUsers(A):ca.validateEquipment(A);if(!$.valid){c($),o(null),g(2),_(!1);return}const D=e==="users"?await ca.detectUserDuplicates(A):await ca.detectEquipmentDuplicates(A);o(A),c($),u(D),g(2)}catch(b){alert("Failed to parse CSV file: "+b.message)}finally{_(!1)}},T=async()=>{if(i){_(!0),g(3);try{const b=e==="users"?await ca.importUsers(i,m):await ca.importEquipment(i,m);w(b),g(4)}catch(b){alert("Import failed: "+b.message),g(2)}finally{_(!1)}}},U=()=>{s(null),o(null),c(null),u(null),g(1),w(null),j({skipDuplicates:!0,updateDuplicates:!1})},P=()=>{const b=e==="users"?ca.generateUserTemplate():ca.generateEquipmentTemplate(),A=new Blob([b],{type:"text/csv"}),$=window.URL.createObjectURL(A),D=document.createElement("a");D.href=$,D.download=`${e}_template.csv`,D.click(),window.URL.revokeObjectURL($)};return a.jsxs("div",{className:"csv-import",children:[a.jsxs("div",{className:"import-header",children:[a.jsx("h2",{children:"CSV Import"}),a.jsx("p",{className:"subtitle",children:"Bulk import users or equipment from CSV files"})]}),p===1&&a.jsxs("div",{className:"import-step",children:[a.jsxs("div",{className:"import-type-selector",children:[a.jsxs("label",{children:[a.jsx("input",{type:"radio",value:"users",checked:e==="users",onChange:b=>n(b.target.value)}),a.jsx("span",{children:"Import Users"})]}),a.jsxs("label",{children:[a.jsx("input",{type:"radio",value:"equipment",checked:e==="equipment",onChange:b=>n(b.target.value)}),a.jsx("span",{children:"Import Equipment"})]})]}),a.jsxs("div",{className:"template-download",children:[a.jsxs("button",{onClick:P,className:"btn btn-secondary",children:[" Download ",e==="users"?"Users":"Equipment"," Template"]}),a.jsx("p",{className:"help-text",children:"Download the template CSV file to see required columns and format"})]}),a.jsxs("div",{className:"file-upload-section",children:[a.jsx("label",{htmlFor:"csv-file",className:"file-upload-label",children:r?r.name:"Choose CSV file..."}),a.jsx("input",{id:"csv-file",type:"file",accept:".csv",onChange:S,className:"file-input"})]}),a.jsx("div",{className:"import-actions",children:a.jsx("button",{onClick:N,className:"btn btn-primary",disabled:!r||y,children:y?"Processing...":"Upload and Validate"})}),a.jsxs("div",{className:"import-info",children:[a.jsxs("h3",{children:[" ",e==="users"?"User":"Equipment"," CSV Requirements"]}),e==="users"?a.jsxs("ul",{children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Required columns:"})," first_name, surname, full_name, email, department"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Optional columns:"})," role (student/staff/admin/master_admin), year"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Valid departments:"})," Moving Image Design, Graphic Design, Illustration"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"GDPR:"})," All imports are logged and previewed before confirmation"]})]}):a.jsxs("ul",{children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Required columns:"})," product_name, tracking_number, description, link_to_image"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Optional columns:"})," category, department, status, requires_justification"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Tracking numbers:"})," Must be unique (duplicates will be detected)"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Status options:"})," available, booked, maintenance, out_of_service"]})]})]})]}),p===2&&a.jsxs("div",{className:"import-step",children:[a.jsx("h3",{children:" Validation Results"}),l&&l.errors.length>0&&a.jsxs("div",{className:"validation-errors",children:[a.jsxs("h4",{children:[" Errors (",l.errors.length,")"]}),a.jsx("ul",{children:l.errors.map((b,A)=>a.jsx("li",{className:"error-item",children:b},A))}),a.jsx("p",{className:"error-message",children:"Please fix these errors in your CSV file and try again."})]}),l&&l.warnings.length>0&&l.valid&&a.jsxs("div",{className:"validation-warnings",children:[a.jsxs("h4",{children:[" Warnings (",l.warnings.length,")"]}),a.jsx("ul",{children:l.warnings.map((b,A)=>a.jsx("li",{className:"warning-item",children:b},A))}),a.jsx("p",{className:"help-text",children:"These warnings won't stop the import, but you may want to review them."})]}),d&&l&&l.valid&&a.jsxs("div",{className:"duplicate-detection",children:[a.jsx("h4",{children:" Duplicate Detection"}),a.jsxs("div",{className:"duplicate-stats",children:[a.jsxs("div",{className:"stat-card",children:[a.jsx("span",{className:"stat-number",children:d.unique.length}),a.jsxs("span",{className:"stat-label",children:["New ",e]})]}),a.jsxs("div",{className:"stat-card warning",children:[a.jsx("span",{className:"stat-number",children:d.duplicates.length}),a.jsx("span",{className:"stat-label",children:"Duplicates found"})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("span",{className:"stat-number",children:i.length}),a.jsx("span",{className:"stat-label",children:"Total in CSV"})]})]}),d.duplicates.length>0&&a.jsxs("div",{className:"duplicate-list",children:[a.jsxs("h5",{children:["Duplicate ",e==="users"?"Emails":"Tracking Numbers"]}),a.jsxs("table",{className:"duplicate-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"CSV Row"}),a.jsx("th",{children:"Existing Record"}),a.jsx("th",{children:"Action"})]})}),a.jsx("tbody",{children:d.duplicates.slice(0,10).map((b,A)=>a.jsxs("tr",{children:[a.jsxs("td",{children:[e==="users"?b.row.email:b.row.tracking_number,a.jsx("br",{}),a.jsx("small",{children:e==="users"?b.row.full_name:b.row.product_name})]}),a.jsxs("td",{children:["ID: ",b.existingId,a.jsx("br",{}),a.jsx("small",{children:b.existingName})]}),a.jsx("td",{children:a.jsx("span",{className:"action-badge",children:"Will be skipped"})})]},A))})]}),d.duplicates.length>10&&a.jsxs("p",{className:"help-text",children:["Showing 10 of ",d.duplicates.length," duplicates"]})]}),a.jsxs("div",{className:"import-options",children:[a.jsx("h5",{children:"Import Options"}),a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:m.skipDuplicates,onChange:b=>j({...m,skipDuplicates:b.target.checked})}),a.jsx("span",{children:"Skip duplicates (recommended)"})]}),a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:m.updateDuplicates,onChange:b=>j({...m,updateDuplicates:b.target.checked}),disabled:m.skipDuplicates}),a.jsx("span",{children:"Update existing records with CSV data ( use with caution)"})]})]})]}),a.jsxs("div",{className:"import-actions",children:[a.jsx("button",{onClick:U,className:"btn btn-secondary",children:"Cancel"}),l&&l.valid&&a.jsx("button",{onClick:T,className:"btn btn-primary",disabled:y,children:y?"Importing...":`Import ${(d==null?void 0:d.unique.length)||0} ${e}`}),l&&!l.valid&&a.jsx("button",{onClick:U,className:"btn btn-primary",children:"Try Again"})]})]}),p===3&&a.jsx("div",{className:"import-step",children:a.jsxs("div",{className:"loading-spinner",children:[a.jsxs("h3",{children:[" Importing ",e,"..."]}),a.jsx("p",{children:"Please wait while we import your data."})]})}),p===4&&k&&a.jsxs("div",{className:"import-step",children:[a.jsx("h3",{children:" Import Complete!"}),a.jsxs("div",{className:"import-results",children:[a.jsxs("div",{className:"result-card success",children:[a.jsx("span",{className:"result-number",children:k.imported}),a.jsxs("span",{className:"result-label",children:["New ",e," imported"]})]}),k.updated>0&&a.jsxs("div",{className:"result-card warning",children:[a.jsx("span",{className:"result-number",children:k.updated}),a.jsxs("span",{className:"result-label",children:[e," updated"]})]}),k.skipped>0&&a.jsxs("div",{className:"result-card",children:[a.jsx("span",{className:"result-number",children:k.skipped}),a.jsxs("span",{className:"result-label",children:[e," skipped"]})]})]}),a.jsx("div",{className:"import-actions",children:a.jsx("button",{onClick:U,className:"btn btn-primary",children:"Import Another File"})})]})]})}async function jE(t=null){try{let n=(await be.query("users")).filter(r=>r.role==="staff"||r.role==="department_admin"||r.role==="master_admin");return t&&(n=n.filter(r=>r.department===t)),n}catch(e){throw console.error("Failed to get staff:",e),e}}async function Fx(t){try{const e=await be.findOne("users",{id:t});return(e==null?void 0:e.staff_permissions)||{can_create_bookings:!0,can_view_analytics:!1,can_add_equipment_notes:!1,can_request_access:!1,accessible_departments:[]}}catch(e){throw console.error("Failed to get staff permissions:",e),e}}async function Eh(t,e){try{return await be.update("users",{id:t},{staff_permissions:e})}catch(n){throw console.error("Failed to update staff permissions:",n),n}}async function SE(){try{return(await be.query("users")).filter(e=>e.role==="department_admin"||e.role==="master_admin")}catch(t){throw console.error("Failed to get admins:",t),t}}async function Dh(t,e){try{return await be.update("users",{id:t},{admin_permissions:e})}catch(n){throw console.error("Failed to update admin permissions:",n),n}}function kE(){return{admin:{full_access:{name:"Full Access",permissions:{manage_equipment:!0,manage_users:!0,manage_bookings:!0,view_analytics:!0,export_data:!0,add_equipment_notes:!0,csv_import:!0,manage_kits:!0,accessible_departments:[]}},booking_manager:{name:"Booking Manager",permissions:{manage_equipment:!1,manage_users:!1,manage_bookings:!0,view_analytics:!0,export_data:!0,add_equipment_notes:!0,csv_import:!1,manage_kits:!1,accessible_departments:[]}},equipment_manager:{name:"Equipment Manager",permissions:{manage_equipment:!0,manage_users:!1,manage_bookings:!1,view_analytics:!0,export_data:!1,add_equipment_notes:!0,csv_import:!1,manage_kits:!0,accessible_departments:[]}},view_only:{name:"View Only",permissions:{manage_equipment:!1,manage_users:!1,manage_bookings:!1,view_analytics:!0,export_data:!1,add_equipment_notes:!1,csv_import:!1,manage_kits:!1,accessible_departments:[]}}},staff:{full_staff:{name:"Full Staff Access",permissions:{can_create_bookings:!0,can_view_analytics:!0,can_add_equipment_notes:!0,can_request_access:!0,accessible_departments:[]}},basic_staff:{name:"Basic Staff Access",permissions:{can_create_bookings:!0,can_view_analytics:!1,can_add_equipment_notes:!1,can_request_access:!0,accessible_departments:[]}}}}}async function NE(t,e,n=null,r=!0){var s;try{const i=r?((s=await be.findOne("users",{id:t}))==null?void 0:s.admin_permissions)||{}:await Fx(t),o=i.accessible_departments||[];o.includes(e)||o.push(e);const l=i.department_access_expiry||{};n&&(l[e]={expiry:n,granted_at:new Date().toISOString()});const c={...i,accessible_departments:o,department_access_expiry:l};return r?await Dh(t,c):await Eh(t,c),c}catch(i){throw console.error("Failed to grant department access with expiry:",i),i}}async function CE(t,e,n=!0){var r;try{const s=n?((r=await be.findOne("users",{id:t}))==null?void 0:r.admin_permissions)||{}:await Fx(t),i=(s.accessible_departments||[]).filter(c=>c!==e),o={...s.department_access_expiry};delete o[e];const l={...s,accessible_departments:i,department_access_expiry:o};return n?await Dh(t,l):await Eh(t,l),l}catch(s){throw console.error("Failed to revoke department access:",s),s}}async function Mx(t){try{return(await be.query("users")).filter(n=>n.role==="staff"&&n.managed_department_id===t)}catch(e){throw console.error("Failed to get department staff:",e),e}}async function AE(t,e,n){try{const r={...e,modified_by:n,modified_at:new Date().toISOString()};return await be.update("users",{id:t},{view_permissions:r})}catch(r){throw console.error("Failed to update staff view permissions:",r),r}}function py(){return{can_view_catalog:!0,can_create_bookings:!0,can_cancel_bookings:!0,can_view_history:!0,can_view_analytics:!1,can_export_data:!1,can_request_access:!0,email_notifications:!0}}async function my(t,e){try{const n=await Mx(t);let r=0;for(const s of n)await be.update("users",{id:s.id},{view_permissions:e}),r++;return r}catch(n){throw console.error("Failed to bulk update department staff:",n),n}}async function EE(){try{return await be.query("sub_areas")||[]}catch(t){throw console.error("Failed to get departments:",t),t}}function DE(){const{user:t}=Nr(),[e,n]=O.useState("admins"),[r,s]=O.useState([]),[i,o]=O.useState([]),[l,c]=O.useState([]),[d,u]=O.useState(!0),[p,g]=O.useState(null),[m,j]=O.useState(""),[k,w]=O.useState("all"),[y,_]=O.useState("all"),[S,N]=O.useState(!1),[T,U]=O.useState(null),[P,b]=O.useState(!1),[A,$]=O.useState(null),[D,F]=O.useState({}),{toasts:L,showToast:I,removeToast:X}=Yn();O.useEffect(()=>{(t==null?void 0:t.role)==="master_admin"&&te()},[t,e]);const te=async()=>{u(!0);try{const[V,ne,le]=await Promise.all([SE(),jE(),EE()]);s(V),o(ne.filter(me=>me.role==="staff")),c(le)}catch(V){console.error("Failed to load data:",V),I("Failed to load users and permissions","error")}finally{u(!1)}},oe=async(V,ne,le=!0)=>{try{const me=le?r.find(ke=>ke.id===V):i.find(ke=>ke.id===V);if(!me)return;const fe=me[le?"admin_permissions":"staff_permissions"]||{},_e={...fe,[ne]:!fe[ne]};le?(await Dh(V,_e),s(ke=>ke.map(Ae=>Ae.id===V?{...Ae,admin_permissions:_e}:Ae))):(await Eh(V,_e),o(ke=>ke.map(Ae=>Ae.id===V?{...Ae,staff_permissions:_e}:Ae))),I(`Permission ${ne} ${_e[ne]?"granted":"revoked"}`,"success")}catch(me){console.error("Failed to update permissions:",me),I("Failed to update permissions","error")}};if((t==null?void 0:t.role)!=="master_admin")return a.jsxs("div",{className:"access-denied",children:[a.jsx("h2",{children:"Access Denied"}),a.jsx("p",{children:"Only master administrators can manage permissions."})]});if(d)return a.jsx("div",{className:"loading",children:"Loading users and permissions..."});const Z=[{key:"manage_equipment",label:"Manage Equipment",description:"Add, edit, and remove equipment"},{key:"manage_users",label:"Manage Users",description:"View and manage user accounts"},{key:"manage_bookings",label:"Approve Bookings",description:"Approve/deny booking requests"},{key:"view_analytics",label:"View Analytics",description:"Access analytics and reports"},{key:"export_data",label:"Export Data",description:"Export data as CSV/PDF"},{key:"add_equipment_notes",label:"Add Notes",description:"Add notes to equipment"},{key:"csv_import",label:"CSV Import",description:"Import users/equipment via CSV"},{key:"manage_kits",label:"Manage Kits",description:"Create and manage equipment kits"}],ae=[{key:"can_create_bookings",label:"Create Bookings",description:"Can create equipment bookings"},{key:"can_view_analytics",label:"View Analytics",description:"Can view department analytics"},{key:"can_add_equipment_notes",label:"Add Notes",description:"Can add notes to equipment"},{key:"can_request_access",label:"Request Access",description:"Can request cross-department access"}],ee=async(V,ne,le=!0)=>{try{const me=kE(),re=le?me.admin[ne]:me.staff[ne];if(!re){I("Invalid preset","error");return}le?(await Dh(V,re.permissions),s(fe=>fe.map(_e=>_e.id===V?{..._e,admin_permissions:re.permissions}:_e))):(await Eh(V,re.permissions),o(fe=>fe.map(_e=>_e.id===V?{..._e,staff_permissions:re.permissions}:_e))),I(`Applied "${re.name}" preset successfully`,"success"),N(!1)}catch(me){console.error("Failed to apply preset:",me),I("Failed to apply preset","error")}},de=async(V,ne,le=!0)=>{const me=le?r.find(Ae=>Ae.id===V):i.find(Ae=>Ae.id===V);if(!me)return;if(((me[le?"admin_permissions":"staff_permissions"]||{}).accessible_departments||[]).includes(ne))$({message:`Revoke access to this department for ${me.full_name}?`,onConfirm:async()=>{try{await CE(V,ne,le),await te(),I("Department access revoked","success"),b(!1)}catch{I("Failed to revoke access","error")}}}),b(!0);else{const Ae=`${V}-${ne}`,ye=D[Ae];try{await NE(V,ne,ye,le),await te(),I(ye?`Department access granted until ${new Date(ye).toLocaleDateString()}`:"Department access granted (no expiry)","success"),F(Q=>{const st={...Q};return delete st[Ae],st})}catch{I("Failed to grant access","error")}}},E=(e==="admins"?r:i).filter(V=>{const ne=m===""||V.full_name.toLowerCase().includes(m.toLowerCase())||V.email.toLowerCase().includes(m.toLowerCase()),le=k==="all"||V.department===k,me=y==="all"||V.role===y;return ne&&le&&me}),H=e==="admins"?Z:ae,J=e==="admins";return a.jsxs("div",{className:"admin-permissions",children:[a.jsxs("div",{className:"page-header",children:[a.jsx("h2",{children:"Staff & Admin Permissions"}),a.jsx("p",{className:"subtitle",children:"Manage access control for all staff members and admins across departments"})]}),a.jsxs("div",{className:"warning-banner",children:[" ",a.jsx("strong",{children:"Warning:"})," Permission changes take effect immediately. Only grant permissions to trusted users."]}),a.jsxs("div",{className:"view-toggle",style:{marginTop:"1.5rem",marginBottom:"1.5rem"},children:[a.jsxs("button",{className:`btn ${e==="admins"?"btn-primary":"btn-secondary"}`,onClick:()=>n("admins"),children:["Admin Permissions (",r.length,")"]}),a.jsxs("button",{className:`btn ${e==="staff"?"btn-primary":"btn-secondary"}`,onClick:()=>n("staff"),style:{marginLeft:"1rem"},children:["Staff Permissions (",i.length,")"]})]}),a.jsxs("div",{className:"filters-section",style:{marginBottom:"2rem",display:"flex",gap:"1rem",flexWrap:"wrap"},children:[a.jsx("div",{style:{flex:"1 1 300px"},children:a.jsx("input",{type:"text",placeholder:"Search by name or email...",value:m,onChange:V=>j(V.target.value),className:"input",style:{width:"100%"}})}),a.jsx("div",{style:{flex:"0 1 200px"},children:a.jsxs("select",{value:k,onChange:V=>w(V.target.value),className:"input",style:{width:"100%"},children:[a.jsx("option",{value:"all",children:"All Departments"}),l.map(V=>a.jsx("option",{value:V.name,children:V.name},V.id))]})}),a.jsx("div",{style:{flex:"0 1 200px"},children:a.jsxs("select",{value:y,onChange:V=>_(V.target.value),className:"input",style:{width:"100%"},children:[a.jsx("option",{value:"all",children:"All Roles"}),a.jsx("option",{value:"master_admin",children:"Master Admin"}),a.jsx("option",{value:"department_admin",children:"Department Admin"}),a.jsx("option",{value:"staff",children:"Staff"})]})})]}),a.jsxs("div",{className:"stats-grid",style:{marginBottom:"2rem"},children:[a.jsx("div",{className:"stat-card stat-primary",children:a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:r.length}),a.jsx("p",{children:"Total Admins"})]})}),a.jsx("div",{className:"stat-card stat-secondary",children:a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:i.length}),a.jsx("p",{children:"Total Staff"})]})}),a.jsx("div",{className:"stat-card stat-tertiary",children:a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:l.length}),a.jsx("p",{children:"Departments"})]})})]}),a.jsx("div",{style:{overflowX:"auto"},children:a.jsxs("table",{className:"users-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{width:"30px"}}),a.jsx("th",{children:"Name"}),a.jsx("th",{children:"Email"}),a.jsx("th",{children:"Role"}),a.jsx("th",{children:"Primary Department"}),H.map(V=>a.jsx("th",{style:{textAlign:"center",minWidth:"100px"},children:a.jsx("div",{style:{fontSize:"0.75rem"},children:V.label})},V.key)),a.jsx("th",{style:{textAlign:"center",minWidth:"120px"},children:"Actions"})]})}),a.jsx("tbody",{children:E.map(V=>{const le=V[J?"admin_permissions":"staff_permissions"]||{},me=V.role==="master_admin",re=p===V.id;return a.jsxs(a.Fragment,{children:[a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("button",{onClick:()=>g(re?null:V.id),className:"btn btn-sm",style:{padding:"0.25rem 0.5rem"},children:re?"":""})}),a.jsxs("td",{children:[a.jsx("strong",{children:V.full_name}),V.id===t.id&&a.jsx("span",{style:{marginLeft:"0.5rem",fontSize:"0.875rem",color:"var(--color-primary)"},children:"(You)"})]}),a.jsx("td",{children:V.email}),a.jsx("td",{children:a.jsxs("span",{className:`role-badge role-${V.role}`,children:[V.role==="master_admin"&&"Master Admin",V.role==="department_admin"&&"Department Admin",V.role==="staff"&&"Staff"]})}),a.jsx("td",{children:V.department}),H.map(fe=>a.jsx("td",{style:{textAlign:"center"},children:me?a.jsx("span",{style:{color:"var(--color-success)",fontWeight:"bold"},children:""}):a.jsxs("label",{className:"switch",children:[a.jsx("input",{type:"checkbox",checked:le[fe.key]||!1,onChange:()=>oe(V.id,fe.key,J),"data-testid":`permission-${V.id}-${fe.key}`}),a.jsx("span",{className:"slider"})]})},fe.key)),a.jsx("td",{style:{textAlign:"center"},children:a.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center"},children:[a.jsx("button",{onClick:()=>{U(V),N(!0)},className:"btn btn-sm btn-primary",title:"Manage detailed permissions",children:"Details"}),a.jsx("button",{onClick:()=>g(re?null:V.id),className:"btn btn-sm btn-secondary",title:"Manage department access",children:re?"Hide":"Depts"})]})})]},V.id),re&&a.jsx("tr",{children:a.jsx("td",{colSpan:H.length+6,style:{background:"var(--bg-secondary)",padding:"1.5rem"},children:a.jsxs("div",{children:[a.jsxs("h4",{style:{marginBottom:"1rem"},children:["Department Access for ",V.full_name]}),a.jsxs("p",{style:{fontSize:"0.875rem",marginBottom:"1rem",color:"var(--text-muted)"},children:["Grant access to additional departments beyond their primary department (",V.department,")"]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:"1rem"},children:l.map(fe=>{var Q,st;const _e=((Q=le.accessible_departments)==null?void 0:Q.includes(fe.id))||!1,ke=V.department===fe.name||V.managed_department_id===fe.id&&J,Ae=`${V.id}-${fe.id}`,ye=(st=le.department_access_expiry)==null?void 0:st[fe.id];return a.jsxs("div",{style:{padding:"0.75rem",border:`2px solid ${ke?"var(--color-primary)":_e?"var(--color-success)":"var(--border-color)"}`,borderRadius:"var(--radius-md)",background:ke?"var(--color-primary-pale)":_e?"var(--color-success-pale)":"var(--bg-card)"},children:[a.jsxs("div",{style:{marginBottom:"0.5rem"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("strong",{style:{fontSize:"0.875rem"},children:fe.name}),!ke&&a.jsxs("label",{className:"switch",style:{marginLeft:"0.5rem"},children:[a.jsx("input",{type:"checkbox",checked:_e,onChange:()=>de(V.id,fe.id,J)}),a.jsx("span",{className:"slider"})]})]}),ke&&a.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-primary)",marginTop:"0.25rem"},children:"Home Department"}),!ke&&_e&&(ye==null?void 0:ye.expiry)&&a.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:["Expires: ",new Date(ye.expiry).toLocaleDateString()]})]}),!ke&&!_e&&a.jsx("input",{type:"date",placeholder:"Expiry date (optional)",value:D[Ae]||"",onChange:nt=>F(Ve=>({...Ve,[Ae]:nt.target.value})),className:"input",style:{fontSize:"0.75rem",padding:"0.25rem",marginTop:"0.25rem",width:"100%"},min:new Date().toISOString().split("T")[0]})]},fe.id)})})]})})})]})})})]})}),a.jsxs("div",{className:"flags-info",style:{marginTop:"2rem"},children:[a.jsxs("h3",{children:[e==="admins"?"Admin":"Staff"," Permission Descriptions"]}),a.jsx("ul",{children:H.map(V=>a.jsxs("li",{children:[a.jsxs("strong",{children:[V.label,":"]})," ",V.description]},V.key))})]}),S&&T&&a.jsx("div",{className:"modal-overlay",onClick:()=>N(!1),children:a.jsxs("div",{className:"modal-content",onClick:V=>V.stopPropagation(),style:{maxWidth:"600px"},children:[a.jsxs("div",{className:"modal-header",children:[a.jsxs("h3",{children:["Manage Permissions: ",T.full_name]}),a.jsx("button",{onClick:()=>N(!1),className:"modal-close",children:""})]}),a.jsxs("div",{className:"modal-body",children:[a.jsx("div",{style:{marginBottom:"1.5rem"},children:a.jsxs("p",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:[a.jsx("strong",{children:"Role:"})," ",T.role," | ",a.jsx("strong",{children:"Department:"})," ",T.department]})}),a.jsxs("div",{style:{marginBottom:"1.5rem"},children:[a.jsx("h4",{style:{marginBottom:"0.75rem"},children:"Quick Apply Preset"}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"0.5rem"},children:J?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>ee(T.id,"full_access",!0),className:"btn btn-sm btn-primary",children:"Full Access"}),a.jsx("button",{onClick:()=>ee(T.id,"booking_manager",!0),className:"btn btn-sm btn-secondary",children:"Booking Manager"}),a.jsx("button",{onClick:()=>ee(T.id,"equipment_manager",!0),className:"btn btn-sm btn-secondary",children:"Equipment Manager"}),a.jsx("button",{onClick:()=>ee(T.id,"view_only",!0),className:"btn btn-sm btn-secondary",children:"View Only"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>ee(T.id,"full_staff",!1),className:"btn btn-sm btn-primary",children:"Full Staff"}),a.jsx("button",{onClick:()=>ee(T.id,"basic_staff",!1),className:"btn btn-sm btn-secondary",children:"Basic Staff"})]})})]}),a.jsxs("div",{children:[a.jsx("h4",{style:{marginBottom:"0.75rem"},children:"Individual Permissions"}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:H.map(V=>{const le=T[J?"admin_permissions":"staff_permissions"]||{},me=T.role==="master_admin";return a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius-md)"},children:[a.jsxs("div",{children:[a.jsx("strong",{style:{fontSize:"0.875rem"},children:V.label}),a.jsx("p",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:V.description})]}),me?a.jsx("span",{style:{color:"var(--color-success)",fontWeight:"bold"},children:""}):a.jsxs("label",{className:"switch",children:[a.jsx("input",{type:"checkbox",checked:le[V.key]||!1,onChange:()=>oe(T.id,V.key,J)}),a.jsx("span",{className:"slider"})]})]},V.key)})})]}),T.permissions_updated_at&&a.jsxs("div",{style:{marginTop:"1.5rem",fontSize:"0.75rem",color:"var(--text-muted)"},children:["Last modified: ",new Date(T.permissions_updated_at).toLocaleString(),T.permissions_updated_by&&` by ${T.permissions_updated_by}`]})]}),a.jsx("div",{className:"modal-footer",children:a.jsx("button",{onClick:()=>N(!1),className:"btn btn-secondary",children:"Close"})})]})}),P&&A&&a.jsx("div",{className:"modal-overlay",onClick:()=>b(!1),children:a.jsxs("div",{className:"modal-content",onClick:V=>V.stopPropagation(),style:{maxWidth:"400px"},children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h3",{children:"Confirm Action"}),a.jsx("button",{onClick:()=>b(!1),className:"modal-close",children:""})]}),a.jsx("div",{className:"modal-body",children:a.jsx("p",{children:A.message})}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{onClick:()=>b(!1),className:"btn btn-secondary",children:"Cancel"}),a.jsx("button",{onClick:A.onConfirm,className:"btn btn-danger",children:"Confirm"})]})]})}),L.map(V=>a.jsx(Jn,{message:V.message,type:V.type,onClose:()=>X(V.id)},V.id))]})}function PE(){Nr();const[t,e]=O.useState([]),[n,r]=O.useState([]),[s,i]=O.useState(!1),[o,l]=O.useState(null),{toasts:c,showToast:d,removeToast:u}=Yn();O.useEffect(()=>{p()},[]);const p=async()=>{try{const w=await be.query("equipment");r(w);const y=rl.getAdminKits();e(y)}catch(w){console.error("Failed to load data:",w),d("Failed to load data","error")}},g=()=>{l({name:"",description:"",department:"all",equipment_ids:[]}),i(!0)},m=w=>{try{w.id?(rl.updateAdminKit(w.id,w),d("Kit updated successfully","success")):(rl.saveAdminKit(w),d("Kit created successfully","success")),p(),i(!1),l(null)}catch{d("Failed to save kit","error")}},j=w=>{if(confirm("Are you sure you want to delete this kit?"))try{rl.deleteAdminKit(w),d("Kit deleted successfully","success"),p()}catch{d("Failed to delete kit","error")}},k=w=>{l(w),i(!0)};return a.jsxs("div",{className:"kit-management",children:[a.jsxs("div",{className:"page-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[a.jsxs("div",{children:[a.jsx("h2",{children:"Equipment Kits Management"}),a.jsx("p",{className:"subtitle",children:"Create preset equipment kits that students can quickly book"})]}),a.jsx("button",{onClick:g,className:"btn btn-primary","data-testid":"create-kit-btn",children:"+ Create New Kit"})]}),t.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx("h3",{children:"No Equipment Kits Yet"}),a.jsx("p",{children:"Create your first equipment kit to help students quickly book common equipment combinations."}),a.jsx("button",{onClick:g,className:"btn btn-primary",children:"Create First Kit"})]}):a.jsx("div",{style:{display:"grid",gap:"1rem"},children:t.map(w=>{const y=n.filter(_=>{var S;return(S=w.equipment_ids)==null?void 0:S.includes(_.id)});return a.jsxs("div",{style:{background:"white",border:"1px solid var(--border-color)",borderRadius:"var(--border-radius)",padding:"1.5rem"},"data-testid":"kit-item",children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"1rem"},children:[a.jsxs("div",{children:[a.jsx("h3",{style:{margin:"0 0 0.5rem 0"},children:w.name}),a.jsx("p",{style:{margin:"0 0 0.5rem 0",color:"var(--text-secondary)"},children:w.description}),a.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:[a.jsx("span",{className:"role-badge",children:w.department==="all"?"All Departments":w.department}),a.jsxs("span",{style:{marginLeft:"1rem"},children:[y.length," item",y.length!==1?"s":""]})]})]}),a.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[a.jsx("button",{onClick:()=>k(w),className:"btn btn-secondary btn-sm","data-testid":"edit-kit-btn",children:"Edit"}),a.jsx("button",{onClick:()=>j(w.id),className:"btn btn-danger btn-sm","data-testid":"delete-kit-btn",children:"Delete"})]})]}),y.length>0&&a.jsxs("div",{children:[a.jsx("h4",{style:{margin:"1rem 0 0.5rem 0",fontSize:"0.875rem",fontWeight:"600"},children:"Equipment in this kit:"}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"0.5rem"},children:y.map(_=>a.jsxs("div",{style:{padding:"0.5rem",background:"var(--surface)",borderRadius:"var(--border-radius)",fontSize:"0.875rem"},children:[a.jsx("div",{style:{fontWeight:"600"},children:_.product_name}),a.jsx("div",{style:{color:"var(--text-secondary)",fontSize:"0.75rem"},children:_.category})]},_.id))})]})]},w.id)})}),s&&a.jsx(LE,{kit:o,equipment:n,onSave:m,onClose:()=>{i(!1),l(null)}}),c.map(w=>a.jsx(Jn,{message:w.message,type:w.type,onClose:()=>u(w.id)},w.id))]})}function LE({kit:t,equipment:e,onSave:n,onClose:r}){const[s,i]=O.useState({id:(t==null?void 0:t.id)||null,name:(t==null?void 0:t.name)||"",description:(t==null?void 0:t.description)||"",department:(t==null?void 0:t.department)||"all",equipment_ids:(t==null?void 0:t.equipment_ids)||[]}),o=["all","Moving Image Design","Graphic Design","Illustration"],l=[...new Set(e.map(u=>u.category))],c=u=>{i(p=>({...p,equipment_ids:p.equipment_ids.includes(u)?p.equipment_ids.filter(g=>g!==u):[...p.equipment_ids,u]}))},d=u=>{if(u.preventDefault(),s.equipment_ids.length===0){alert("Please select at least one piece of equipment");return}n(s)};return a.jsx("div",{className:"modal-overlay",onClick:r,children:a.jsxs("div",{className:"modal-content",onClick:u=>u.stopPropagation(),style:{maxWidth:"900px",maxHeight:"90vh",overflow:"auto"},children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:t!=null&&t.id?"Edit Equipment Kit":"Create New Equipment Kit"}),a.jsx("button",{onClick:r,className:"modal-close",children:""})]}),a.jsx("div",{className:"modal-body",children:a.jsxs("form",{onSubmit:d,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Kit Name *"}),a.jsx("input",{type:"text",value:s.name,onChange:u=>i({...s,name:u.target.value}),placeholder:"e.g., 'Documentary Filming Kit'",className:"form-input",required:!0,"data-testid":"kit-name-input"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Description *"}),a.jsx("textarea",{value:s.description,onChange:u=>i({...s,description:u.target.value}),placeholder:"Describe what this kit is for...",rows:3,required:!0,"data-testid":"kit-description-input"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Department Access"}),a.jsx("select",{value:s.department,onChange:u=>i({...s,department:u.target.value}),className:"form-input","data-testid":"kit-department-select",children:o.map(u=>a.jsx("option",{value:u,children:u==="all"?"All Departments":u},u))})]}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{children:["Select Equipment (",s.equipment_ids.length," selected) *"]}),a.jsx("div",{style:{maxHeight:"400px",overflowY:"auto",border:"1px solid var(--border-color)",borderRadius:"var(--border-radius)",padding:"1rem"},children:l.map(u=>{const p=e.filter(g=>g.category===u);return a.jsxs("div",{style:{marginBottom:"1.5rem"},children:[a.jsx("h4",{style:{margin:"0 0 0.75rem 0",color:"var(--text-primary)"},children:u}),a.jsx("div",{style:{display:"grid",gap:"0.5rem"},children:p.map(g=>a.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem",background:s.equipment_ids.includes(g.id)?"rgba(102, 126, 234, 0.1)":"var(--surface)",borderRadius:"var(--border-radius)",cursor:"pointer",border:`1px solid ${s.equipment_ids.includes(g.id)?"var(--primary-color)":"var(--border-color)"}`},children:[a.jsx("input",{type:"checkbox",checked:s.equipment_ids.includes(g.id),onChange:()=>c(g.id),style:{width:"18px",height:"18px"}}),a.jsxs("div",{style:{flex:1},children:[a.jsx("div",{style:{fontWeight:"600"},children:g.product_name}),a.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:g.description})]})]},g.id))})]},u)})})]}),a.jsxs("div",{className:"modal-actions",children:[a.jsx("button",{type:"button",onClick:r,className:"btn btn-secondary",children:"Cancel"}),a.jsx("button",{type:"submit",className:"btn btn-primary","data-testid":"save-kit-btn",children:t!=null&&t.id?"Update Kit":"Create Kit"})]})]})})]})})}function TE(){const{user:t}=Nr(),[e,n]=O.useState([]),[r,s]=O.useState(!0),[i,o]=O.useState(!1),[l,c]=O.useState(null),[d,u]=O.useState({name:"",description:"",parent_department:""}),{toasts:p,showToast:g,removeToast:m}=Yn(),j=(t==null?void 0:t.role)==="master_admin";O.useEffect(()=>{k()},[]);const k=async()=>{s(!0);try{const N=await be.query("sub_areas")||[];n(N)}catch(N){console.error("Failed to load departments:",N),g("Failed to load departments","error")}finally{s(!1)}},w=(N=null)=>{N?(c(N),u({name:N.name,description:N.description||"",parent_department:N.parent_department||""})):(c(null),u({name:"",description:"",parent_department:""})),o(!0)},y=()=>{o(!1),c(null),u({name:"",description:"",parent_department:""})},_=async N=>{if(N.preventDefault(),!d.name.trim()){g("Department name is required","error");return}try{l?(await be.update("sub_areas",l.id,d),g("Department updated successfully","success")):(await be.insert("sub_areas",d),g("Department created successfully","success")),y(),await k()}catch(T){g(`Failed to ${l?"update":"create"} department: ${T.message}`,"error")}},S=async N=>{if(confirm("Are you sure you want to delete this department? This will affect all associated equipment and users."))try{await be.delete("sub_areas",N),g("Department deleted successfully","success"),await k()}catch(T){g("Failed to delete department: "+T.message,"error")}};return j?r?a.jsx("div",{className:"loading",children:"Loading departments..."}):a.jsxs("div",{className:"department-management",children:[a.jsxs("div",{className:"approvals-header",children:[a.jsxs("div",{children:[a.jsx("h2",{children:"Department Management"}),a.jsx("p",{className:"subtitle",children:"Manage departments and areas within NCAD"})]}),a.jsx("button",{onClick:()=>w(),className:"btn btn-primary","data-testid":"add-department-btn",children:"Add Department"})]}),a.jsxs("div",{className:"stats-grid",style:{marginBottom:"var(--spacing-xl)"},children:[a.jsx("div",{className:"stat-card stat-primary",children:a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:e.length}),a.jsx("p",{children:"Total Departments"})]})}),a.jsx("div",{className:"stat-card stat-secondary",children:a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:new Set(e.map(N=>N.parent_department).filter(Boolean)).size}),a.jsx("p",{children:"Parent Schools"})]})})]}),e.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx("h2",{children:"No Departments Yet"}),a.jsx("p",{children:"Create your first department to organize equipment and students."}),a.jsx("button",{onClick:()=>w(),className:"btn btn-primary",children:"Create Department"})]}):a.jsx("div",{className:"equipment-table",children:a.jsxs("table",{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Name"}),a.jsx("th",{children:"Description"}),a.jsx("th",{children:"Parent School"}),a.jsx("th",{children:"Created"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:e.map(N=>a.jsxs("tr",{"data-testid":"department-row",children:[a.jsx("td",{style:{fontWeight:"600"},children:N.name}),a.jsx("td",{children:N.description||"-"}),a.jsx("td",{children:N.parent_department||"-"}),a.jsx("td",{children:new Date(N.created_at).toLocaleDateString()}),a.jsx("td",{children:a.jsxs("div",{className:"action-buttons",children:[a.jsx("button",{onClick:()=>w(N),className:"btn btn-sm btn-secondary","data-testid":"edit-department-btn",children:"Edit"}),a.jsx("button",{onClick:()=>S(N.id),className:"btn btn-sm btn-danger","data-testid":"delete-department-btn",children:"Delete"})]})})]},N.id))})]})}),i&&a.jsx("div",{className:"modal-overlay",onClick:y,children:a.jsxs("div",{className:"modal-content",onClick:N=>N.stopPropagation(),"data-testid":"department-modal",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:l?"Edit Department":"Create Department"}),a.jsx("button",{className:"modal-close",onClick:y,children:""})]}),a.jsx("form",{onSubmit:_,children:a.jsxs("div",{className:"modal-body",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"name",children:"Name *"}),a.jsx("input",{type:"text",id:"name",className:"form-input",value:d.name,onChange:N=>u({...d,name:N.target.value}),placeholder:"e.g., Communication Design",required:!0,"data-testid":"department-name-input"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"description",children:"Description"}),a.jsx("textarea",{id:"description",className:"form-textarea",value:d.description,onChange:N=>u({...d,description:N.target.value}),placeholder:"Brief description of this department",rows:"3","data-testid":"department-description-input"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"parent_department",children:"Parent School"}),a.jsxs("select",{id:"parent_department",className:"form-select",value:d.parent_department,onChange:N=>u({...d,parent_department:N.target.value}),"data-testid":"department-parent-select",children:[a.jsx("option",{value:"",children:"-- Select School --"}),a.jsx("option",{value:"School of Design",children:"School of Design"}),a.jsx("option",{value:"School of Fine Art",children:"School of Fine Art"}),a.jsx("option",{value:"School of Education",children:"School of Education"}),a.jsx("option",{value:"School of Visual Culture",children:"School of Visual Culture"})]})]}),a.jsxs("div",{className:"modal-actions",children:[a.jsx("button",{type:"button",onClick:y,className:"btn btn-secondary",children:"Cancel"}),a.jsxs("button",{type:"submit",className:"btn btn-primary","data-testid":"save-department-btn",children:[l?"Update":"Create"," Department"]})]})]})})]})}),p.map(N=>a.jsx(Jn,{message:N.message,type:N.type,onClose:()=>m(N.id)},N.id))]}):a.jsxs("div",{className:"access-denied",children:[a.jsx("h2",{children:"Access Denied"}),a.jsx("p",{children:"Only master administrators can manage departments."})]})}function IE(){const{user:t}=Nr(),[e,n]=O.useState([]),[r,s]=O.useState([]),[i,o]=O.useState([]),[l,c]=O.useState(!0),[d,u]=O.useState([]),[p,g]=O.useState(""),[m,j]=O.useState(""),[k,w]=O.useState("all"),{toasts:y,showToast:_,removeToast:S}=Yn(),N=(t==null?void 0:t.role)==="master_admin"||(t==null?void 0:t.role)==="department_admin";O.useEffect(()=>{T()},[]);const T=async()=>{c(!0);try{const I=await be.query("users",{role:"student"});n(I||[]);const X=await be.query("sub_areas")||[];s(X);const te=await be.query("user_sub_areas")||[];o(te)}catch(I){console.error("Failed to load data:",I),_("Failed to load data","error")}finally{c(!1)}},U=I=>i.filter(X=>X.user_id===I).map(X=>r.find(te=>te.id===X.sub_area_id)).filter(Boolean),P=I=>{u(X=>X.includes(I)?X.filter(te=>te!==I):[...X,I])},b=()=>{const I=D();d.length===I.length?u([]):u(I.map(X=>X.id))},A=async()=>{if(d.length===0){_("Please select at least one student","error");return}if(!p){_("Please select a department","error");return}try{const I=d.map(X=>({user_id:X,sub_area_id:p,assigned_by:t.id,assigned_at:new Date().toISOString()}));for(const X of I)i.find(oe=>oe.user_id===X.user_id&&oe.sub_area_id===X.sub_area_id)||await be.insert("user_sub_areas",X);_(`Successfully assigned ${d.length} student(s) to department`,"success"),u([]),g(""),await T()}catch(I){_("Failed to assign students: "+I.message,"error")}},$=async(I,X)=>{if(confirm("Remove this department assignment?"))try{const te=i.find(oe=>oe.user_id===I&&oe.sub_area_id===X);te&&(await be.delete("user_sub_areas",te.id),_("Assignment removed successfully","success"),await T())}catch(te){_("Failed to remove assignment: "+te.message,"error")}},D=()=>e.filter(I=>{var oe,Z;const X=!m||((oe=I.full_name)==null?void 0:oe.toLowerCase().includes(m.toLowerCase()))||((Z=I.email)==null?void 0:Z.toLowerCase().includes(m.toLowerCase())),te=k==="all"||I.department===k;return X&&te});if(!N)return a.jsxs("div",{className:"access-denied",children:[a.jsx("h2",{children:"Access Denied"}),a.jsx("p",{children:"Only administrators can manage student assignments."})]});if(l)return a.jsx("div",{className:"loading",children:"Loading students..."});const F=D(),L=[...new Set(e.map(I=>I.department).filter(Boolean))];return a.jsxs("div",{className:"student-assignment",children:[a.jsx("h2",{children:"Student Department Assignment"}),a.jsx("p",{className:"subtitle",children:"Assign students to departments for equipment access"}),a.jsxs("div",{className:"dashboard-card",style:{marginBottom:"var(--spacing-xl)"},children:[a.jsx("h3",{children:"Bulk Assignment"}),a.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"var(--spacing-lg)"},children:"Select students below and assign them to a department"}),a.jsxs("div",{style:{display:"flex",gap:"var(--spacing-md)",alignItems:"center",flexWrap:"wrap"},children:[a.jsxs("div",{className:"form-group",style:{flex:"1",minWidth:"250px",marginBottom:0},children:[a.jsx("label",{htmlFor:"bulk-sub-area",children:"Department"}),a.jsxs("select",{id:"bulk-sub-area",className:"form-select",value:p,onChange:I=>g(I.target.value),"data-testid":"bulk-sub-area-select",children:[a.jsx("option",{value:"",children:"-- Select Department --"}),r.map(I=>a.jsx("option",{value:I.id,children:I.name},I.id))]})]}),a.jsxs("button",{onClick:A,className:"btn btn-primary",disabled:d.length===0||!p,"data-testid":"bulk-assign-btn",style:{marginTop:"var(--spacing-lg)"},children:["Assign Selected (",d.length,")"]})]})]}),a.jsx("div",{className:"management-controls",style:{marginBottom:"var(--spacing-lg)"},children:a.jsxs("div",{className:"filter-controls",children:[a.jsx("input",{type:"text",className:"search-input",placeholder:"Search by name or email...",value:m,onChange:I=>j(I.target.value),"data-testid":"student-search-input"}),a.jsxs("select",{className:"form-select",value:k,onChange:I=>w(I.target.value),"data-testid":"department-filter-select",children:[a.jsx("option",{value:"all",children:"All Departments"}),L.map(I=>a.jsx("option",{value:I,children:I},I))]}),a.jsx("button",{onClick:b,className:"btn btn-secondary","data-testid":"select-all-btn",children:d.length===F.length?"Deselect All":"Select All"})]})}),a.jsxs("div",{className:"stats-grid",style:{marginBottom:"var(--spacing-xl)"},children:[a.jsx("div",{className:"stat-card stat-info",children:a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:F.length}),a.jsx("p",{children:"Students Found"})]})}),a.jsx("div",{className:"stat-card stat-primary",children:a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:d.length}),a.jsx("p",{children:"Selected"})]})}),a.jsx("div",{className:"stat-card stat-secondary",children:a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:i.length}),a.jsx("p",{children:"Total Assignments"})]})})]}),F.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx("h2",{children:"No Students Found"}),a.jsx("p",{children:"Try adjusting your search or filter criteria."})]}):a.jsx("div",{className:"users-table",children:a.jsxs("table",{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{width:"40px"},children:a.jsx("input",{type:"checkbox",checked:d.length===F.length,onChange:b,"data-testid":"select-all-checkbox"})}),a.jsx("th",{children:"Name"}),a.jsx("th",{children:"Email"}),a.jsx("th",{children:"Department"}),a.jsx("th",{children:"Current Departments"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:F.map(I=>{const X=U(I.id);return a.jsxs("tr",{"data-testid":"student-row",children:[a.jsx("td",{children:a.jsx("input",{type:"checkbox",checked:d.includes(I.id),onChange:()=>P(I.id),"data-testid":`student-checkbox-${I.id}`})}),a.jsx("td",{style:{fontWeight:"600"},children:I.full_name}),a.jsx("td",{children:I.email}),a.jsx("td",{children:I.department||"-"}),a.jsx("td",{children:X.length===0?a.jsx("span",{style:{color:"var(--text-muted)"},children:"Not assigned"}):a.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:X.map(te=>a.jsxs("span",{className:"role-badge",style:{background:"var(--color-info-pale)",color:"var(--color-info)",display:"inline-flex",alignItems:"center",gap:"0.25rem"},children:[te.name,a.jsx("button",{onClick:()=>$(I.id,te.id),style:{background:"none",border:"none",color:"var(--color-error)",cursor:"pointer",padding:"0 0.25rem",fontSize:"1rem",fontWeight:"bold"},title:"Remove assignment","data-testid":`remove-assignment-${I.id}-${te.id}`,children:""})]},te.id))})}),a.jsx("td",{children:a.jsx("button",{onClick:()=>{u([I.id])},className:"btn btn-sm btn-secondary","data-testid":`assign-btn-${I.id}`,children:"Assign"})})]},I.id)})})]})}),a.jsxs("div",{className:"users-stats",children:["Showing ",F.length," of ",e.length," students"]}),y.map(I=>a.jsx(Jn,{message:I.message,type:I.type,onClose:()=>S(I.id)},I.id))]})}function RE(){const{user:t}=Nr(),[e,n]=O.useState([]),[r,s]=O.useState([]),[i,o]=O.useState(!0),[l,c]=O.useState(!1),[d,u]=O.useState({from_sub_area_id:"",to_sub_area_id:"",expires_at:"",notes:""}),{toasts:p,showToast:g,removeToast:m}=Yn(),j=(t==null?void 0:t.role)==="master_admin"||(t==null?void 0:t.role)==="department_admin";O.useEffect(()=>{k()},[]);const k=async()=>{o(!0);try{const A=await be.query("sub_areas")||[];n(A);const $=await be.query("interdisciplinary_access")||[];s($)}catch(A){console.error("Failed to load data:",A),g("Failed to load data","error")}finally{o(!1)}},w=A=>{const $=e.find(D=>D.id===A);return $?$.name:"Unknown"},y=()=>{u({from_sub_area_id:"",to_sub_area_id:"",expires_at:"",notes:""}),c(!0)},_=()=>{c(!1),u({from_sub_area_id:"",to_sub_area_id:"",expires_at:"",notes:""})},S=async A=>{if(A.preventDefault(),!d.from_sub_area_id||!d.to_sub_area_id){g("Please select both departments","error");return}if(d.from_sub_area_id===d.to_sub_area_id){g("Cannot grant access to the same department","error");return}if(r.find(D=>D.from_sub_area_id===d.from_sub_area_id&&D.to_sub_area_id===d.to_sub_area_id)){g("This access grant already exists","error");return}try{const D={...d,granted_by:t.id,granted_at:new Date().toISOString(),is_active:!0,expires_at:d.expires_at||null};await be.insert("interdisciplinary_access",D),g("Interdisciplinary access granted successfully","success"),_(),await k()}catch(D){g("Failed to grant access: "+D.message,"error")}},N=async(A,$)=>{try{await be.update("interdisciplinary_access",A,{is_active:!$}),g(`Access ${$?"deactivated":"activated"}`,"success"),await k()}catch(D){g("Failed to update access status: "+D.message,"error")}},T=async A=>{if(confirm("Are you sure you want to revoke this access grant?"))try{await be.delete("interdisciplinary_access",A),g("Access grant revoked successfully","success"),await k()}catch($){g("Failed to revoke access: "+$.message,"error")}},U=A=>A.expires_at?new Date(A.expires_at)<new Date:!1;if(!j)return a.jsxs("div",{className:"access-denied",children:[a.jsx("h2",{children:"Access Denied"}),a.jsx("p",{children:"Only administrators can manage interdisciplinary access."})]});if(i)return a.jsx("div",{className:"loading",children:"Loading access grants..."});const P=r.filter(A=>A.is_active&&!U(A)),b=r.filter(A=>!A.is_active||U(A));return a.jsxs("div",{className:"interdisciplinary-access",children:[a.jsxs("div",{className:"approvals-header",children:[a.jsxs("div",{children:[a.jsx("h2",{children:"Interdisciplinary Access Management"}),a.jsx("p",{className:"subtitle",children:"Grant cross-departmental equipment access between departments"})]}),a.jsx("button",{onClick:y,className:"btn btn-primary","data-testid":"grant-access-btn",children:"Grant Access"})]}),a.jsxs("div",{style:{background:"var(--color-info-pale)",border:"1px solid var(--color-info)",borderRadius:"var(--radius-md)",padding:"var(--spacing-lg)",marginBottom:"var(--spacing-xl)"},children:[a.jsx("h4",{style:{margin:"0 0 var(--spacing-sm) 0",color:"var(--color-info)"},children:"How Interdisciplinary Access Works"}),a.jsx("p",{style:{margin:0,color:"var(--text-primary)"},children:"When you grant access FROM Department A TO Department B, students in Department A will be able to view and book equipment from Department B. This is useful for collaborative projects between departments."})]}),a.jsxs("div",{className:"stats-grid",style:{marginBottom:"var(--spacing-xl)"},children:[a.jsx("div",{className:"stat-card stat-success",children:a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:P.length}),a.jsx("p",{children:"Active Grants"})]})}),a.jsx("div",{className:"stat-card stat-warning",children:a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:b.length}),a.jsx("p",{children:"Inactive/Expired"})]})}),a.jsx("div",{className:"stat-card stat-info",children:a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:r.length}),a.jsx("p",{children:"Total Grants"})]})})]}),a.jsxs("div",{style:{marginBottom:"var(--spacing-2xl)"},children:[a.jsx("h3",{children:"Active Access Grants"}),P.length===0?a.jsx("div",{className:"empty-state",children:a.jsx("p",{children:"No active interdisciplinary access grants"})}):a.jsx("div",{className:"equipment-table",children:a.jsxs("table",{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"From Department"}),a.jsx("th",{children:"To Department"}),a.jsx("th",{children:"Granted"}),a.jsx("th",{children:"Expires"}),a.jsx("th",{children:"Notes"}),a.jsx("th",{children:"Status"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:P.map(A=>a.jsxs("tr",{"data-testid":"access-grant-row",children:[a.jsx("td",{style:{fontWeight:"600"},children:w(A.from_sub_area_id)}),a.jsx("td",{style:{fontWeight:"600"},children:w(A.to_sub_area_id)}),a.jsx("td",{children:new Date(A.granted_at).toLocaleDateString()}),a.jsx("td",{children:A.expires_at?a.jsx("span",{style:{color:U(A)?"var(--color-error)":"var(--text-primary)"},children:new Date(A.expires_at).toLocaleDateString()}):a.jsx("span",{style:{color:"var(--text-muted)"},children:"Never"})}),a.jsx("td",{children:A.notes||"-"}),a.jsx("td",{children:a.jsx("span",{className:"status status-success",children:"Active"})}),a.jsx("td",{children:a.jsxs("div",{className:"action-buttons",children:[a.jsx("button",{onClick:()=>N(A.id,A.is_active),className:"btn btn-sm btn-secondary","data-testid":"deactivate-grant-btn",children:"Deactivate"}),a.jsx("button",{onClick:()=>T(A.id),className:"btn btn-sm btn-danger","data-testid":"revoke-grant-btn",children:"Revoke"})]})})]},A.id))})]})})]}),b.length>0&&a.jsxs("div",{children:[a.jsx("h3",{children:"Inactive/Expired Access Grants"}),a.jsx("div",{className:"equipment-table",children:a.jsxs("table",{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"From Department"}),a.jsx("th",{children:"To Department"}),a.jsx("th",{children:"Granted"}),a.jsx("th",{children:"Expires"}),a.jsx("th",{children:"Status"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:b.map(A=>a.jsxs("tr",{style:{opacity:.7},"data-testid":"inactive-grant-row",children:[a.jsx("td",{children:w(A.from_sub_area_id)}),a.jsx("td",{children:w(A.to_sub_area_id)}),a.jsx("td",{children:new Date(A.granted_at).toLocaleDateString()}),a.jsx("td",{children:A.expires_at?new Date(A.expires_at).toLocaleDateString():"Never"}),a.jsx("td",{children:a.jsx("span",{className:"status status-secondary",children:U(A)?"Expired":"Inactive"})}),a.jsx("td",{children:a.jsxs("div",{className:"action-buttons",children:[!U(A)&&a.jsx("button",{onClick:()=>N(A.id,A.is_active),className:"btn btn-sm btn-secondary","data-testid":"activate-grant-btn",children:"Activate"}),a.jsx("button",{onClick:()=>T(A.id),className:"btn btn-sm btn-danger",children:"Delete"})]})})]},A.id))})]})})]}),l&&a.jsx("div",{className:"modal-overlay",onClick:_,children:a.jsxs("div",{className:"modal-content",onClick:A=>A.stopPropagation(),"data-testid":"grant-access-modal",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:"Grant Interdisciplinary Access"}),a.jsx("button",{className:"modal-close",onClick:_,children:""})]}),a.jsx("form",{onSubmit:S,children:a.jsxs("div",{className:"modal-body",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"from-sub-area",children:"From Department *"}),a.jsxs("select",{id:"from-sub-area",className:"form-select",value:d.from_sub_area_id,onChange:A=>u({...d,from_sub_area_id:A.target.value}),required:!0,"data-testid":"from-sub-area-select",children:[a.jsx("option",{value:"",children:"-- Select Department --"}),e.map(A=>a.jsx("option",{value:A.id,children:A.name},A.id))]}),a.jsx("small",{style:{color:"var(--text-secondary)"},children:"Students in this department will gain access"})]}),a.jsx("div",{style:{textAlign:"center",margin:"var(--spacing-md) 0",fontSize:"var(--font-size-sm)",color:"var(--text-muted)",fontWeight:"500"},children:"will have access to"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"to-sub-area",children:"To Department (Equipment Source) *"}),a.jsxs("select",{id:"to-sub-area",className:"form-select",value:d.to_sub_area_id,onChange:A=>u({...d,to_sub_area_id:A.target.value}),required:!0,"data-testid":"to-sub-area-select",children:[a.jsx("option",{value:"",children:"-- Select Department --"}),e.map(A=>a.jsx("option",{value:A.id,disabled:A.id===d.from_sub_area_id,children:A.name},A.id))]}),a.jsx("small",{style:{color:"var(--text-secondary)"},children:"Equipment from this department will be accessible"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"expires-at",children:"Expiration Date (Optional)"}),a.jsx("input",{type:"date",id:"expires-at",className:"form-input",value:d.expires_at,onChange:A=>u({...d,expires_at:A.target.value}),min:new Date().toISOString().split("T")[0],"data-testid":"expires-at-input"}),a.jsx("small",{style:{color:"var(--text-secondary)"},children:"Leave blank for permanent access"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"notes",children:"Notes (Optional)"}),a.jsx("textarea",{id:"notes",className:"form-textarea",value:d.notes,onChange:A=>u({...d,notes:A.target.value}),placeholder:"e.g., For collaborative project between departments",rows:"3","data-testid":"notes-input"})]}),a.jsxs("div",{className:"modal-actions",children:[a.jsx("button",{type:"button",onClick:_,className:"btn btn-secondary",children:"Cancel"}),a.jsx("button",{type:"submit",className:"btn btn-primary","data-testid":"confirm-grant-btn",children:"Grant Access"})]})]})})]})}),p.map(A=>a.jsx(Jn,{message:A.message,type:A.type,onClose:()=>m(A.id)},A.id))]})}function qE(){const{user:t}=cn(),[e,n]=O.useState([]),[r,s]=O.useState([]),[i,o]=O.useState(null),[l,c]=O.useState(""),[d,u]=O.useState(!0),[p,g]=O.useState(!1),[m,j]=O.useState(null),[k,w]=O.useState(null);O.useEffect(()=>{y()},[t]);async function y(){try{u(!0);const[P,b]=await Promise.all([j0(),gC(t.id)]);n(P),s(b),j(null)}catch(P){console.error("Failed to load data:",P),j("Failed to load data. Please try again.")}finally{u(!1)}}async function _(P){if(P.preventDefault(),!i){j("Please select a sub-area to request access to");return}if(!l.trim()){j("Please provide a reason for your request");return}if(i===t.managed_sub_area_id){j("You already have access to your own sub-area");return}if(r.find(A=>A.to_sub_area_id===i&&A.status==="pending")){j("You already have a pending request for this sub-area");return}try{g(!0),j(null),await pC(t.id,t.managed_sub_area_id,i,l),w("Access request submitted successfully!"),o(null),c(""),await y(),setTimeout(()=>w(null),3e3)}catch(A){console.error("Failed to submit request:",A),j("Failed to submit request. Please try again.")}finally{g(!1)}}function S(P){switch(P){case"pending":return"badge-warning";case"approved":return"badge-success";case"denied":return"badge-error";default:return"badge-default"}}function N(P){return P?new Date(P).toLocaleDateString("en-IE",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"}if(d)return a.jsx("div",{className:"loading",children:"Loading access requests..."});const T=e.find(P=>P.id===t.managed_sub_area_id),U=e.filter(P=>P.id!==t.managed_sub_area_id);return a.jsxs("div",{className:"access-requests-page",children:[a.jsxs("div",{className:"page-header",children:[a.jsx("h1",{children:"Request Equipment Access"}),a.jsxs("p",{className:"page-description",children:["You manage ",a.jsx("strong",{children:(T==null?void 0:T.name)||"your department"}),". Request access to equipment from other departments for your students."]})]}),m&&a.jsx("div",{className:"alert alert-error",children:m}),k&&a.jsx("div",{className:"alert alert-success",children:k}),a.jsxs("div",{className:"card",children:[a.jsx("h2",{children:"Submit New Access Request"}),a.jsxs("form",{onSubmit:_,className:"access-request-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"subArea",children:"Select Department to Access:"}),a.jsxs("select",{id:"subArea",value:i||"",onChange:P=>o(P.target.value),required:!0,className:"form-select",children:[a.jsx("option",{value:"",children:"-- Select a department --"}),U.map(P=>a.jsxs("option",{value:P.id,children:[P.name," (",P.parent_department,")"]},P.id))]}),a.jsx("p",{className:"form-help",children:"Choose the department whose equipment your students need access to."})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"reason",children:"Reason for Request:"}),a.jsx("textarea",{id:"reason",value:l,onChange:P=>c(P.target.value),required:!0,rows:4,className:"form-textarea",placeholder:"Explain why your students need access to this department's equipment..."}),a.jsx("p",{className:"form-help",children:"Provide a clear justification for your request. This will be reviewed by the master admin."})]}),a.jsx("button",{type:"submit",disabled:p,className:"btn btn-primary",children:p?"Submitting...":"Submit Request"})]})]}),a.jsxs("div",{className:"card",children:[a.jsxs("h2",{children:["My Access Requests (",r.length,")"]}),r.length===0?a.jsx("p",{className:"text-muted",children:"You haven't submitted any access requests yet."}):a.jsx("div",{className:"requests-list",children:r.map(P=>{const b=e.find(A=>A.id===P.to_sub_area_id);return a.jsxs("div",{className:"request-item",children:[a.jsxs("div",{className:"request-header",children:[a.jsx("h3",{children:(b==null?void 0:b.name)||"Unknown Department"}),a.jsx("span",{className:`badge ${S(P.status)}`,children:P.status.toUpperCase()})]}),a.jsxs("div",{className:"request-details",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Reason:"})," ",P.reason]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Requested:"})," ",N(P.requested_at)]}),P.status!=="pending"&&a.jsxs(a.Fragment,{children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Reviewed:"})," ",N(P.reviewed_at)]}),P.notes&&a.jsxs("p",{children:[a.jsx("strong",{children:"Admin Notes:"})," ",P.notes]})]})]})]},P.id)})})]}),a.jsxs("div",{className:"card",children:[a.jsx("h2",{children:"Browse Other Departments"}),a.jsx("p",{className:"text-muted",children:"View equipment from other departments (read-only). Submit a request to gain booking access."}),a.jsx("div",{className:"sub-areas-grid",children:U.map(P=>a.jsxs("div",{className:"sub-area-card",children:[a.jsx("h3",{children:P.name}),a.jsx("p",{className:"text-small text-muted",children:P.description}),a.jsxs("p",{className:"text-small",children:[a.jsx("strong",{children:"Department:"})," ",P.parent_department]}),(()=>{const b=r.find(A=>A.to_sub_area_id===P.id);return b?a.jsxs("p",{className:"text-small",children:[a.jsx("strong",{children:"Request Status:"})," ",a.jsx("span",{className:`badge ${S(b.status)}`,children:b.status})]}):null})()]},P.id))})]})]})}function OE(){const{user:t}=cn(),[e,n]=O.useState([]),[r,s]=O.useState([]),[i,o]=O.useState([]),[l,c]=O.useState("pending"),[d,u]=O.useState(!0),[p,g]=O.useState(null),[m,j]=O.useState(""),[k,w]=O.useState(null),[y,_]=O.useState(null),[S,N]=O.useState(null);O.useEffect(()=>{T()},[]);async function T(){try{u(!0);const[L,I,X]=await Promise.all([mC(),j0(),be.query("users",{role:"sub_area_admin"})]);n(L),s(I),o(X),_(null)}catch(L){console.error("Failed to load data:",L),_("Failed to load data. Please try again.")}finally{u(!1)}}async function U(L){if(confirm("Are you sure you want to approve this request? This will create an interdisciplinary access grant."))try{g(L),_(null),await vC(L,t.id),N("Request approved successfully! Interdisciplinary access grant has been created."),await T(),setTimeout(()=>N(null),3e3)}catch(I){console.error("Failed to approve request:",I),_(I.message||"Failed to approve request. Please try again.")}finally{g(null)}}async function P(L){if(!m.trim()){_("Please provide a reason for denying this request");return}try{g(L),_(null),await yC(L,t.id,m),N("Request denied successfully."),w(null),j(""),await T(),setTimeout(()=>N(null),3e3)}catch(I){console.error("Failed to deny request:",I),_(I.message||"Failed to deny request. Please try again.")}finally{g(null)}}function b(L){w(L),j(""),_(null)}function A(L){switch(L){case"pending":return"badge-warning";case"approved":return"badge-success";case"denied":return"badge-error";default:return"badge-default"}}function $(L){return L?new Date(L).toLocaleDateString("en-IE",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"}if(d)return a.jsx("div",{className:"loading",children:"Loading access requests..."});const D=l==="all"?e:e.filter(L=>L.status===l),F=e.filter(L=>L.status==="pending").length;return a.jsxs("div",{className:"manage-access-requests-page",children:[a.jsxs("div",{className:"page-header",children:[a.jsx("h1",{children:"Manage Access Requests"}),a.jsxs("p",{className:"page-description",children:["Review and approve access requests from department admins.",F>0&&a.jsxs("span",{className:"badge badge-warning ml-2",children:[F," pending"]})]})]}),y&&a.jsx("div",{className:"alert alert-error",children:y}),S&&a.jsx("div",{className:"alert alert-success",children:S}),a.jsxs("div",{className:"filter-tabs",children:[a.jsxs("button",{className:`tab ${l==="pending"?"active":""}`,onClick:()=>c("pending"),children:["Pending (",e.filter(L=>L.status==="pending").length,")"]}),a.jsxs("button",{className:`tab ${l==="approved"?"active":""}`,onClick:()=>c("approved"),children:["Approved (",e.filter(L=>L.status==="approved").length,")"]}),a.jsxs("button",{className:`tab ${l==="denied"?"active":""}`,onClick:()=>c("denied"),children:["Denied (",e.filter(L=>L.status==="denied").length,")"]}),a.jsxs("button",{className:`tab ${l==="all"?"active":""}`,onClick:()=>c("all"),children:["All (",e.length,")"]})]}),a.jsx("div",{className:"requests-list",children:D.length===0?a.jsx("div",{className:"card",children:a.jsxs("p",{className:"text-muted text-center",children:["No ",l!=="all"&&l," requests found."]})}):D.map(L=>{const I=r.find(Z=>Z.id===L.from_sub_area_id),X=r.find(Z=>Z.id===L.to_sub_area_id),te=i.find(Z=>Z.id===L.requesting_admin_id),oe=L.status==="pending";return a.jsxs("div",{className:"card request-card",children:[a.jsxs("div",{className:"request-header",children:[a.jsxs("div",{className:"request-title",children:[a.jsxs("h3",{children:[a.jsx("span",{className:"text-primary",children:I==null?void 0:I.name}),"  ",a.jsx("span",{className:"text-secondary",children:X==null?void 0:X.name})]}),a.jsx("span",{className:`badge ${A(L.status)}`,children:L.status.toUpperCase()})]}),a.jsxs("div",{className:"request-meta",children:[a.jsxs("p",{className:"text-small text-muted",children:["Requested by: ",a.jsx("strong",{children:te==null?void 0:te.full_name})," (",te==null?void 0:te.email,")"]}),a.jsxs("p",{className:"text-small text-muted",children:["Date: ",$(L.requested_at)]})]})]}),a.jsxs("div",{className:"request-body",children:[a.jsx("p",{children:a.jsx("strong",{children:"Reason:"})}),a.jsx("p",{className:"reason-text",children:L.reason}),L.status!=="pending"&&a.jsxs(a.Fragment,{children:[a.jsx("hr",{}),a.jsxs("p",{className:"text-small text-muted",children:["Reviewed: ",$(L.reviewed_at)]}),L.notes&&a.jsxs(a.Fragment,{children:[a.jsx("p",{children:a.jsx("strong",{children:"Admin Notes:"})}),a.jsx("p",{className:"notes-text",children:L.notes})]})]})]}),oe&&a.jsxs("div",{className:"request-actions",children:[a.jsx("button",{onClick:()=>U(L.id),disabled:p===L.id,className:"btn btn-success",children:p===L.id?"Processing...":"Approve"}),a.jsx("button",{onClick:()=>b(L.id),disabled:p===L.id,className:"btn btn-error",children:"Deny"})]})]},L.id)})}),k&&a.jsx("div",{className:"modal-overlay",onClick:()=>w(null),children:a.jsxs("div",{className:"modal-content",onClick:L=>L.stopPropagation(),children:[a.jsx("h2",{children:"Deny Access Request"}),a.jsx("p",{children:"Please provide a reason for denying this request:"}),a.jsx("textarea",{value:m,onChange:L=>j(L.target.value),rows:4,className:"form-textarea",placeholder:"Explain why this request is being denied...",autoFocus:!0}),a.jsxs("div",{className:"modal-actions",children:[a.jsx("button",{onClick:()=>P(k),disabled:!m.trim()||p===k,className:"btn btn-error",children:p===k?"Denying...":"Deny Request"}),a.jsx("button",{onClick:()=>w(null),className:"btn btn-secondary",children:"Cancel"})]})]})})]})}function FE(){const{user:t}=cn(),[e,n]=O.useState([]),[r,s]=O.useState([]),[i,o]=O.useState(!0),[l,c]=O.useState(""),[d,u]=O.useState(null),[p,g]=O.useState(null),{toasts:m,showToast:j,removeToast:k}=Yn();O.useEffect(()=>{w()},[t]),O.useEffect(()=>{if(l.trim()){const b=l.toLowerCase(),A=e.filter($=>$.full_name.toLowerCase().includes(b)||$.email.toLowerCase().includes(b));s(A)}else s(e)},[l,e]);const w=async()=>{o(!0);try{const b=t.managed_department_id;if(!b){j("You are not assigned to manage a department","error");return}const A=await Mx(b);n(A),s(A)}catch(b){console.error("Failed to load staff:",b),j("Failed to load staff members","error")}finally{o(!1)}},y=b=>{if(d===b)u(null),g(null);else{u(b);const A=e.find($=>$.id===b);g((A==null?void 0:A.view_permissions)||py())}},_=b=>{g(A=>({...A,[b]:!A[b]}))},S=async b=>{try{await AE(b,p,t.email),j("Permissions updated successfully","success"),await w(),u(null),g(null)}catch(A){console.error("Failed to update permissions:",A),j("Failed to update permissions","error")}},N=async()=>{if(window.confirm("Enable all permissions for all staff in your department? This cannot be undone."))try{const b={can_view_catalog:!0,can_create_bookings:!0,can_cancel_bookings:!0,can_view_history:!0,can_view_analytics:!0,can_export_data:!0,can_request_access:!0,email_notifications:!0,modified_by:t.email,modified_at:new Date().toISOString()};await my(t.managed_department_id,b),j("All staff permissions enabled","success"),await w()}catch(b){console.error("Failed to bulk update:",b),j("Failed to update all staff permissions","error")}},T=async()=>{if(window.confirm("Reset all staff permissions to defaults? This cannot be undone."))try{const b=py();await my(t.managed_department_id,{...b,modified_by:t.email,modified_at:new Date().toISOString()}),j("All staff permissions reset to defaults","success"),await w()}catch(b){console.error("Failed to reset permissions:",b),j("Failed to reset permissions","error")}},U=b=>b?Object.entries(b).filter(([A,$])=>A.startsWith("can_")&&$===!0).length:0,P=b=>b?new Date(b).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never";return i?a.jsx("div",{className:"loading",children:"Loading staff members..."}):a.jsxs("div",{className:"department-staff-permissions",children:[a.jsxs("div",{className:"page-header",children:[a.jsx("h1",{children:"Manage Staff Permissions"}),a.jsx("p",{className:"subtitle",children:"Control what your department staff can see and do"})]}),a.jsxs("div",{className:"alert alert-warning",style:{marginBottom:"1.5rem"},children:[a.jsx("strong",{children:"Department Restriction:"})," You can only manage staff in YOUR department (",t.department,")"]}),a.jsxs("div",{className:"actions-bar",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem",gap:"1rem",flexWrap:"wrap"},children:[a.jsx("input",{type:"text",placeholder:"Search by name or email...",value:l,onChange:b=>c(b.target.value),className:"search-input",style:{flex:"1",minWidth:"250px",padding:"0.5rem",border:"1px solid #ddd",borderRadius:"4px"}}),a.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[a.jsx("button",{onClick:N,className:"btn btn-primary btn-sm",children:"Enable All"}),a.jsx("button",{onClick:T,className:"btn btn-secondary btn-sm",children:"Reset to Default"})]})]}),r.length===0?a.jsx("div",{className:"empty-state",children:a.jsx("p",{children:"No staff members found in your department."})}):a.jsx("div",{className:"staff-table-container",children:a.jsxs("table",{className:"staff-permissions-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Staff Name"}),a.jsx("th",{children:"Email"}),a.jsx("th",{children:"Active Permissions"}),a.jsx("th",{children:"Last Modified"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:r.map(b=>{var A,$;return a.jsxs(a.Fragment,{children:[a.jsxs("tr",{className:d===b.id?"expanded":"",children:[a.jsxs("td",{children:[a.jsx("strong",{children:b.full_name}),a.jsx("div",{style:{fontSize:"0.85rem",color:"#666"},children:b.role==="staff"?"Staff Member":b.role})]}),a.jsx("td",{children:b.email}),a.jsx("td",{children:a.jsxs("span",{className:"badge badge-info",children:[U(b.view_permissions)," / 8 enabled"]})}),a.jsxs("td",{children:[a.jsx("div",{style:{fontSize:"0.9rem"},children:P((A=b.view_permissions)==null?void 0:A.modified_at)}),(($=b.view_permissions)==null?void 0:$.modified_by)&&a.jsxs("div",{style:{fontSize:"0.8rem",color:"#666"},children:["by ",b.view_permissions.modified_by]})]}),a.jsx("td",{children:a.jsx("button",{onClick:()=>y(b.id),className:"btn btn-sm btn-secondary",children:d===b.id?"Close":"Edit Permissions"})})]},b.id),d===b.id&&p&&a.jsx("tr",{className:"permissions-editor-row",children:a.jsx("td",{colSpan:"5",children:a.jsxs("div",{className:"permissions-editor",children:[a.jsxs("h3",{children:["Edit Permissions for ",b.full_name]}),a.jsxs("div",{className:"permissions-grid",children:[a.jsxs("label",{className:"permission-item",children:[a.jsx("input",{type:"checkbox",checked:p.can_view_catalog||!1,onChange:()=>_("can_view_catalog")}),a.jsxs("span",{children:[a.jsx("strong",{children:"View Equipment Catalog"}),a.jsx("small",{children:"Browse available equipment"})]})]}),a.jsxs("label",{className:"permission-item",children:[a.jsx("input",{type:"checkbox",checked:p.can_create_bookings||!1,onChange:()=>_("can_create_bookings")}),a.jsxs("span",{children:[a.jsx("strong",{children:"Create Bookings"}),a.jsx("small",{children:"Book equipment for projects"})]})]}),a.jsxs("label",{className:"permission-item",children:[a.jsx("input",{type:"checkbox",checked:p.can_cancel_bookings||!1,onChange:()=>_("can_cancel_bookings")}),a.jsxs("span",{children:[a.jsx("strong",{children:"Cancel Own Bookings"}),a.jsx("small",{children:"Cancel their own bookings"})]})]}),a.jsxs("label",{className:"permission-item",children:[a.jsx("input",{type:"checkbox",checked:p.can_view_history||!1,onChange:()=>_("can_view_history")}),a.jsxs("span",{children:[a.jsx("strong",{children:"View Booking History"}),a.jsx("small",{children:"Access past bookings"})]})]}),a.jsxs("label",{className:"permission-item",children:[a.jsx("input",{type:"checkbox",checked:p.can_view_analytics||!1,onChange:()=>_("can_view_analytics")}),a.jsxs("span",{children:[a.jsx("strong",{children:"View Analytics Dashboard"}),a.jsx("small",{children:"Read-only statistics access"})]})]}),a.jsxs("label",{className:"permission-item",children:[a.jsx("input",{type:"checkbox",checked:p.can_export_data||!1,onChange:()=>_("can_export_data")}),a.jsxs("span",{children:[a.jsx("strong",{children:"Export Own Booking Data"}),a.jsx("small",{children:"Download CSV reports"})]})]}),a.jsxs("label",{className:"permission-item",children:[a.jsx("input",{type:"checkbox",checked:p.can_request_access||!1,onChange:()=>_("can_request_access")}),a.jsxs("span",{children:[a.jsx("strong",{children:"Request Interdepartmental Access"}),a.jsx("small",{children:"Request access to other departments"})]})]}),a.jsxs("label",{className:"permission-item",children:[a.jsx("input",{type:"checkbox",checked:p.email_notifications||!1,onChange:()=>_("email_notifications")}),a.jsxs("span",{children:[a.jsx("strong",{children:"Receive Email Notifications"}),a.jsx("small",{children:"Get booking status updates"})]})]})]}),a.jsxs("div",{className:"permissions-actions",style:{marginTop:"1rem",display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:[a.jsx("button",{onClick:()=>{u(null),g(null)},className:"btn btn-secondary",children:"Cancel"}),a.jsx("button",{onClick:()=>S(b.id),className:"btn btn-primary",children:"Save Permissions"})]})]})})})]})})})]})}),m.map(b=>a.jsx(Jn,{message:b.message,type:b.type,onClose:()=>k(b.id)},b.id)),a.jsx("style",{jsx:!0,children:`
        .department-staff-permissions {
          padding: 2rem;
          max-width: 1400px;
          margin: 0 auto;
        }

        .page-header {
          margin-bottom: 2rem;
        }

        .page-header h1 {
          margin-bottom: 0.5rem;
        }

        .subtitle {
          color: #666;
          font-size: 1rem;
        }

        .staff-table-container {
          background: white;
          border-radius: 8px;
          overflow: hidden;
          box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .staff-permissions-table {
          width: 100%;
          border-collapse: collapse;
        }

        .staff-permissions-table th {
          background: #f5f5f5;
          padding: 1rem;
          text-align: left;
          font-weight: 600;
          border-bottom: 2px solid #ddd;
        }

        .staff-permissions-table td {
          padding: 1rem;
          border-bottom: 1px solid #eee;
        }

        .staff-permissions-table tbody tr:hover {
          background: #f9f9f9;
        }

        .staff-permissions-table tbody tr.expanded {
          background: #f0f7ff;
        }

        .permissions-editor-row {
          background: white !important;
        }

        .permissions-editor {
          padding: 2rem;
          background: #f9f9f9;
          border: 2px solid #e0e0e0;
          border-radius: 8px;
        }

        .permissions-editor h3 {
          margin-bottom: 1.5rem;
          color: #333;
        }

        .permissions-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
          gap: 1rem;
          margin-bottom: 1rem;
        }

        .permission-item {
          display: flex;
          align-items: flex-start;
          gap: 0.75rem;
          padding: 1rem;
          background: white;
          border: 1px solid #ddd;
          border-radius: 6px;
          cursor: pointer;
          transition: all 0.2s;
        }

        .permission-item:hover {
          border-color: #007bff;
          box-shadow: 0 2px 8px rgba(0,123,255,0.1);
        }

        .permission-item input[type="checkbox"] {
          margin-top: 0.25rem;
          width: 18px;
          height: 18px;
          cursor: pointer;
        }

        .permission-item span {
          flex: 1;
        }

        .permission-item strong {
          display: block;
          margin-bottom: 0.25rem;
          color: #333;
        }

        .permission-item small {
          display: block;
          color: #666;
          font-size: 0.875rem;
        }

        .badge {
          display: inline-block;
          padding: 0.25rem 0.75rem;
          border-radius: 12px;
          font-size: 0.875rem;
          font-weight: 600;
        }

        .badge-info {
          background: #e3f2fd;
          color: #1976d2;
        }

        .alert {
          padding: 1rem;
          border-radius: 6px;
          border-left: 4px solid;
        }

        .alert-warning {
          background: #fff3cd;
          border-color: #ffc107;
          color: #856404;
        }

        .empty-state {
          text-align: center;
          padding: 3rem;
          color: #666;
        }

        @media (max-width: 768px) {
          .department-staff-permissions {
            padding: 1rem;
          }

          .permissions-grid {
            grid-template-columns: 1fr;
          }

          .actions-bar {
            flex-direction: column;
            align-items: stretch !important;
          }

          .search-input {
            width: 100% !important;
          }
        }
      `})]})}function ME(){const{user:t}=cn(),[e,n]=O.useState([]),[r,s]=O.useState(!0),[i,o]=O.useState({}),{toasts:l,showToast:c,removeToast:d}=Yn(),[u,p]=O.useState({}),[g,m]=O.useState(!1),j=["Communication Design","Moving Image Design","Illustration","Fashion Design","Fine Art","Visual Culture"];O.useEffect(()=>{k(),w()},[]);const k=async()=>{s(!0);try{const b=await bC();n(b)}catch(b){console.error("Failed to load system settings:",b),c("Failed to load system settings","error")}finally{s(!1)}},w=()=>{const b=localStorage.getItem("ncadbook_department_access");if(b)p(JSON.parse(b));else{const A={};j.forEach($=>{A[$]=[]}),p(A)}},y=b=>{localStorage.setItem("ncadbook_department_access",JSON.stringify(b)),p(b)},_=(b,A)=>{const $=u[b]||[],D=$.includes(A),F={...u,[b]:D?$.filter(L=>L!==A):[...$,A]};y(F),c(`${b} ${D?"removed from":"granted access to"} ${A} equipment`,"success")},S=async(b,A)=>{o({...i,[b]:!0});try{const $=!A;await _C(b,$,t.id),n(e.map(D=>D.key===b?{...D,value:$,modified_by:t.id,modified_at:new Date().toISOString()}:D)),c("Setting updated successfully","success")}catch($){console.error("Failed to update setting:",$),c("Failed to update setting","error")}finally{o({...i,[b]:!1})}},N=b=>({cross_department_browsing_enabled:"Cross-Department Equipment Browsing",cross_department_booking_enabled:"Cross-Department Equipment Booking",cross_department_approval_required:"Cross-Department Approval Required",staff_cross_department_requests_enabled:"Staff Cross-Department Requests",equipment_kits_enabled:"Equipment Kits",room_bookings_visible_staff:"Room Bookings - Staff Portal",room_bookings_visible_dept_admin:"Room Bookings - Department Admin Portal",room_bookings_enabled:"Room Bookings System"})[b]||b,T=(b,A)=>({cross_department_browsing_enabled:"When enabled, students can browse and view equipment from departments other than their own. A department filter will appear in the equipment browse page.",cross_department_booking_enabled:"Allow students to book equipment from other departments. This setting works in conjunction with browsing and requires department admin approval unless auto-approval is enabled.",cross_department_approval_required:"When enabled, all cross-department bookings require explicit approval from the equipment's department admin. When disabled, bookings are auto-approved if the equipment is available.",staff_cross_department_requests_enabled:"Allow staff members to request equipment from other departments for workshops, projects, or special events.",equipment_kits_enabled:"Allow department admins to create equipment kits (bundles) that students can book as a single unit.",room_bookings_visible_staff:"Show room booking functionality in the Staff portal. Staff can view, create, and manage room bookings for their department.",room_bookings_visible_dept_admin:"Show room booking functionality in the Department Admin portal. Admins can view, approve, and manage room bookings.",room_bookings_enabled:"Master toggle for the entire room bookings system. When disabled, room bookings are hidden from all portals."})[b]||A,U=b=>({cross_department_browsing_enabled:{enabled:"Students will see a department dropdown to browse all equipment across NCAD. Department admins can control booking permissions.",disabled:"Students can only view equipment from their own department."},cross_department_booking_enabled:{enabled:"Students can request equipment from other departments. Booking availability is controlled by department admins.",disabled:"Students can only book equipment from their own department, even if browsing is enabled."},cross_department_approval_required:{enabled:'All cross-department bookings go to "pending" status and require explicit department admin approval.',disabled:"Cross-department bookings are auto-approved if equipment is available (still subject to department admin access control)."},staff_cross_department_requests_enabled:{enabled:"Staff can create cross-department equipment requests with smart routing based on availability.",disabled:"Staff cannot request equipment from other departments."},equipment_kits_enabled:{enabled:"Department admins can create equipment kits, students can book entire kits with auto-booking of individual items.",disabled:"Kit functionality is hidden from all users."},room_bookings_visible_staff:{enabled:"Room Bookings tab appears in Staff portal. Staff can create and manage room bookings.",disabled:"Room bookings are hidden from Staff portal, even if the system is enabled."},room_bookings_visible_dept_admin:{enabled:"Room Bookings section appears in Department Admin portal with approval and management features.",disabled:"Room bookings are hidden from Department Admin portal, even if the system is enabled."},room_bookings_enabled:{enabled:"Room bookings system is active. Visibility in portals is controlled by individual portal settings.",disabled:"Room bookings system is completely disabled across all portals."}})[b]||{};if(r)return a.jsxs("div",{className:"system-settings",children:[a.jsx("h2",{children:"System Settings"}),a.jsx("div",{className:"loading-state",children:a.jsx("p",{children:"Loading system settings..."})})]});const P=()=>{confirm("This will reset all demo data including the new system settings. Continue?")&&(localStorage.removeItem("ncadbook_demo_data"),window.location.reload())};return a.jsxs("div",{className:"system-settings",children:[a.jsxs("div",{className:"settings-header",children:[a.jsxs("div",{children:[a.jsx("h2",{children:"System Settings"}),a.jsx("p",{className:"settings-subtitle",children:"Global configuration for the NCAD Equipment Booking System. Changes take effect immediately for all users."})]}),a.jsx("button",{onClick:P,className:"btn-reset-demo",title:"Reset demo data to load new settings",children:" Reset Demo Data"})]}),a.jsx("div",{className:"settings-list",children:e.map(b=>{const A=U(b.key),$=i[b.key],D=b.key==="cross_department_browsing_enabled",F=b.value===!0||b.value==="true";return a.jsxs("div",{className:"setting-card",children:[a.jsxs("div",{className:"setting-header",children:[a.jsxs("div",{className:"setting-info",children:[a.jsx("h3",{children:N(b.key)}),a.jsx("p",{className:"setting-description",children:T(b.key,b.description)})]}),a.jsxs("div",{className:"setting-toggle",children:[a.jsxs("label",{className:"toggle-switch",children:[a.jsx("input",{type:"checkbox",checked:b.value===!0||b.value==="true",onChange:()=>S(b.key,b.value),disabled:$}),a.jsx("span",{className:"toggle-slider"})]}),a.jsx("span",{className:`toggle-label ${b.value?"enabled":"disabled"}`,children:$?"Saving...":b.value?"Enabled":"Disabled"})]})]}),A&&a.jsx("div",{className:"setting-impact",children:a.jsxs("div",{className:`impact-message ${b.value?"active":"inactive"}`,children:[a.jsx("strong",{children:b.value?" Active:":" Inactive:"}),a.jsx("span",{children:b.value?A.enabled:A.disabled})]})}),D&&F&&a.jsxs("div",{className:"department-access-matrix",children:[a.jsxs("div",{className:"matrix-header",children:[a.jsx("h4",{children:"Department Equipment Access Control"}),a.jsx("p",{children:"Configure which departments can access equipment from other departments"})]}),a.jsx("div",{className:"matrix-table-wrapper",children:a.jsxs("table",{className:"access-matrix-table",children:[a.jsxs("thead",{children:[a.jsxs("tr",{children:[a.jsx("th",{className:"department-column",children:"Requesting Department"}),a.jsx("th",{colSpan:j.length,className:"access-column-header",children:"Can Access Equipment From"})]}),a.jsxs("tr",{children:[a.jsx("th",{}),j.map(L=>a.jsx("th",{className:"target-dept",children:L.split(" ")[0]},L))]})]}),a.jsx("tbody",{children:j.map(L=>a.jsxs("tr",{children:[a.jsx("td",{className:"requesting-dept-name",children:L}),j.map(I=>{var oe;const X=L===I,te=(oe=u[L])==null?void 0:oe.includes(I);return a.jsx("td",{className:"access-cell",children:X?a.jsx("span",{className:"own-dept-indicator",title:"Own department - always has access",children:""}):a.jsxs("label",{className:"access-checkbox",children:[a.jsx("input",{type:"checkbox",checked:te||!1,onChange:()=>_(L,I),title:`Allow ${L} to access ${I} equipment`}),a.jsx("span",{className:"checkmark"})]})},I)})]},L))})]})}),a.jsxs("div",{className:"matrix-legend",children:[a.jsxs("div",{className:"legend-item",children:[a.jsx("span",{className:"legend-icon own",children:""}),a.jsx("span",{children:"Own department (always has access)"})]}),a.jsxs("div",{className:"legend-item",children:[a.jsx("span",{className:"legend-icon checked",children:""}),a.jsx("span",{children:"Has access to equipment"})]}),a.jsxs("div",{className:"legend-item",children:[a.jsx("span",{className:"legend-icon unchecked",children:""}),a.jsx("span",{children:"No access"})]})]})]}),b.modified_at&&a.jsx("div",{className:"setting-metadata",children:a.jsxs("small",{children:["Last modified: ",new Date(b.modified_at).toLocaleString()]})})]},b.key)})}),a.jsxs("div",{className:"settings-warning",children:[a.jsx("h4",{children:" Important Notes"}),a.jsxs("div",{className:"settings-info-sections",children:[a.jsxs("div",{className:"info-section",children:[a.jsx("h5",{children:"Cross-Department Equipment Access"}),a.jsxs("ul",{children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Browsing:"})," Allows students to ",a.jsx("em",{children:"view"})," equipment from all departments via a dropdown filter."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Booking:"})," Allows students to ",a.jsx("em",{children:"request bookings"})," for equipment from other departments."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Approval:"})," Controls whether cross-department bookings are auto-approved or require manual approval."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Department Control:"})," Department admins can grant/revoke individual student access via the Cross-Department Access management page."]})]})]}),a.jsxs("div",{className:"info-section",children:[a.jsx("h5",{children:"Room Bookings Visibility"}),a.jsxs("ul",{children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Master Toggle:"}),' The "Room Bookings System" setting controls the entire feature across all portals.']}),a.jsxs("li",{children:[a.jsx("strong",{children:"Staff Portal:"})," When enabled, staff can view and create room bookings for their department."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Dept Admin Portal:"})," When enabled, department admins can approve, manage, and view all room bookings."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Recommended:"})," Enable master toggle first, then selectively enable for each portal as needed."]})]})]}),a.jsxs("div",{className:"info-section",children:[a.jsx("h5",{children:"Other Settings"}),a.jsxs("ul",{children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Staff Requests:"})," All cross-department requests require department admin approval before equipment becomes accessible."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Equipment Kits:"})," Kits are department-specific. Students can only see and book kits from their own department."]})]})]})]})]}),l.map(b=>a.jsx(Jn,{message:b.message,type:b.type,onClose:()=>d(b.id)},b.id))]})}const gy=[{id:1,feature_key:"role_view_only_staff",feature_name:"View-Only Staff",description:"Read-only access to equipment catalog for teaching faculty",is_enabled:!0,created_at:"2024-03-01"},{id:2,feature_key:"role_accounts_officer",feature_name:"Accounts Officer",description:"Financial reporting, cost analysis, and budget tracking",is_enabled:!0,created_at:"2024-03-01"},{id:3,feature_key:"role_payroll_coordinator",feature_name:"Payroll Coordinator",description:"Staff cost center allocations and payroll data exports",is_enabled:!0,created_at:"2024-03-01"},{id:4,feature_key:"role_it_support_technician",feature_name:"IT Support Technician",description:"Equipment management, system logs, and technical functions",is_enabled:!0,created_at:"2024-03-01"},{id:5,feature_key:"role_budget_manager",feature_name:"Budget Manager",description:"Budget tracking, cost forecasting, and financial planning",is_enabled:!0,created_at:"2024-03-01"},{id:6,feature_key:"feature_financial_management",feature_name:"Financial Management Module",description:"Equipment costs, depreciation tracking, and financial reports",is_enabled:!0,created_at:"2024-03-01",metadata:{components:["Cost tracking","Depreciation","TCO calculations"]}},{id:7,feature_key:"feature_payroll_tracking",feature_name:"Payroll Tracking Module",description:"Staff allocations, cost centers, and payroll exports",is_enabled:!0,created_at:"2024-03-01",metadata:{components:["Cost centers","Staff allocations","Payroll exports"]}},{id:8,feature_key:"feature_it_asset_lifecycle",feature_name:"IT Asset Lifecycle Module",description:"Equipment lifecycle management and system logging",is_enabled:!0,created_at:"2024-03-01",metadata:{components:["Asset tracking","Maintenance logs","System diagnostics"]}},{id:9,feature_key:"feature_budget_analytics",feature_name:"Budget Analytics Module",description:"Budget forecasting, variance tracking, and spending analysis",is_enabled:!0,created_at:"2024-03-01",metadata:{components:["Budget forecasting","Variance tracking","Trend analysis"]}}];function BE(){const{user:t}=cn(),[e,n]=O.useState(gy),[r,s]=O.useState(!1),[i,o]=O.useState({view_only_staff:1,accounts_officer:1,payroll_coordinator:1,it_support_technician:1,budget_manager:1}),[l,c]=O.useState([]),{toasts:d,showToast:u,removeToast:p}=Yn(),g=()=>{n(gy)},m=(T,U)=>{const P=e.find($=>$.feature_key===T),b=U?"disable":"enable";if(U){const $=`Disable "${P.feature_name}"?

This will immediately block access for all users with this role/feature.`;if(!window.confirm($))return}const A=e.map($=>$.feature_key===T?{...$,is_enabled:!U,updated_at:new Date().toISOString()}:$);n(A),u(`${P.feature_name} ${b}d successfully (Demo Mode)`,"success")},j=()=>{if(!window.confirm(`Disable ALL advanced roles?

This will immediately disable View-Only Staff, Accounts Officer, Payroll Coordinator, IT Support, and Budget Manager roles.`))return;const T=e.filter(P=>P.feature_key.startsWith("role_")&&!["role_student","role_general_admin","role_master_admin"].includes(P.feature_key)).map(P=>P.feature_key),U=e.map(P=>T.includes(P.feature_key)?{...P,is_enabled:!1,updated_at:new Date().toISOString()}:P);n(U),u("All advanced roles disabled (Demo Mode)","success")},k=T=>({role_view_only_staff:"",role_accounts_officer:"",role_payroll_coordinator:"",role_it_support_technician:"",role_budget_manager:"",feature_financial_management:"",feature_payroll_tracking:"",feature_it_asset_lifecycle:"",feature_budget_analytics:""})[T]||"",w=T=>({role_accounts_officer:"feature_financial_management",role_payroll_coordinator:"feature_payroll_tracking",role_it_support_technician:"feature_it_asset_lifecycle",role_budget_manager:"feature_budget_analytics"})[T],y=T=>{const U=w(T);if(!U)return!0;const P=e.find(b=>b.feature_key===U);return(P==null?void 0:P.is_enabled)||!1};if(r)return a.jsx("div",{className:"loading",children:"Loading role management..."});if(e.length===0)return a.jsxs("div",{className:"role-management-error",children:[a.jsx("h2",{children:" Database Connection Error"}),a.jsx("p",{children:"Unable to load feature flags from Supabase."}),a.jsxs("div",{className:"error-instructions",children:[a.jsx("h3",{children:"To fix this:"}),a.jsxs("ol",{children:[a.jsx("li",{children:"Open your Supabase project dashboard"}),a.jsx("li",{children:"Go to Project Settings  API"}),a.jsx("li",{children:"Copy your Project URL and anon key"}),a.jsxs("li",{children:["Update ",a.jsx("code",{children:".env.local"})," with your credentials"]}),a.jsxs("li",{children:["Restart the dev server (",a.jsx("code",{children:"npm run dev"}),")"]})]}),a.jsx("p",{className:"check-console",children:"Check the browser console for detailed errors."})]})]});const _=e.filter(T=>T.feature_key.startsWith("role_")),S=e.filter(T=>T.feature_key.startsWith("feature_")),N=e.filter(T=>T.is_enabled).length;return a.jsxs("div",{className:"role-management",children:[a.jsxs("div",{className:"role-management-header",children:[a.jsxs("div",{children:[a.jsx("h2",{children:" Role Management"}),a.jsx("p",{className:"subtitle",children:"Activate/deactivate advanced user roles and feature modules. Test each role in demo portals."})]}),a.jsxs("div",{className:"header-stats",children:[a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-value",children:N}),a.jsx("div",{className:"stat-label",children:"Features Enabled"})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-value",children:Object.keys(i).length}),a.jsx("div",{className:"stat-label",children:"Active Roles"})]})]})]}),a.jsxs("div",{className:"quick-actions",children:[a.jsx("button",{onClick:()=>g(),className:"btn btn-secondary",children:" Refresh Status"}),a.jsx("button",{onClick:j,className:"btn btn-danger",children:" Disable All Advanced Roles"})]}),a.jsxs("section",{className:"role-section",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("h3",{children:" User Roles"}),a.jsx("p",{children:"Toggle availability of advanced user roles in the system"})]}),a.jsx("div",{className:"role-grid",children:_.map(T=>{var D,F;const U=T.feature_key.replace("role_",""),P=i[U]||0,b=w(T.feature_key),A=y(T.feature_key),$=T.is_enabled?!0:A;return a.jsxs("div",{className:`role-card ${T.is_enabled?"enabled":"disabled"}`,children:[a.jsxs("div",{className:"role-card-header",children:[a.jsx("div",{className:"role-icon",children:k(T.feature_key)}),a.jsxs("div",{className:"role-info",children:[a.jsx("h4",{children:T.feature_name}),a.jsx("span",{className:`status-badge ${T.is_enabled?"status-enabled":"status-disabled"}`,children:T.is_enabled?"Enabled":"Disabled"})]}),a.jsxs("label",{className:"toggle-switch",children:[a.jsx("input",{type:"checkbox",checked:T.is_enabled,onChange:()=>m(T.feature_key,T.is_enabled),disabled:!$&&!T.is_enabled}),a.jsx("span",{className:"toggle-slider"})]})]}),a.jsx("p",{className:"role-description",children:T.description}),a.jsxs("div",{className:"role-meta",children:[a.jsxs("div",{className:"meta-item",children:[a.jsx("strong",{children:"Users:"})," ",a.jsx("span",{children:P})]}),b&&a.jsxs("div",{className:`meta-item dependency ${A?"met":"unmet"}`,children:[a.jsx("strong",{children:"Requires:"}),a.jsx("span",{children:((D=e.find(L=>L.feature_key===b))==null?void 0:D.feature_name)||b}),!A&&a.jsx("span",{className:"warning-icon",children:""})]})]}),T.is_enabled&&a.jsx(rs,{to:`/demo/${U}`,className:"btn btn-demo",children:" Test Demo Portal"}),!$&&!T.is_enabled&&a.jsxs("div",{className:"warning-message",children:[" Enable ",(F=e.find(L=>L.feature_key===b))==null?void 0:F.feature_name," first"]})]},T.feature_key)})})]}),a.jsxs("section",{className:"role-section",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("h3",{children:" Feature Modules"}),a.jsx("p",{children:"Core functionality modules that power advanced roles"})]}),a.jsx("div",{className:"role-grid",children:S.map(T=>{const P=(T.metadata||{}).components||[];return a.jsxs("div",{className:`role-card ${T.is_enabled?"enabled":"disabled"}`,children:[a.jsxs("div",{className:"role-card-header",children:[a.jsx("div",{className:"role-icon",children:k(T.feature_key)}),a.jsxs("div",{className:"role-info",children:[a.jsx("h4",{children:T.feature_name}),a.jsx("span",{className:`status-badge ${T.is_enabled?"status-enabled":"status-disabled"}`,children:T.is_enabled?"Enabled":"Disabled"})]}),a.jsxs("label",{className:"toggle-switch",children:[a.jsx("input",{type:"checkbox",checked:T.is_enabled,onChange:()=>m(T.feature_key,T.is_enabled)}),a.jsx("span",{className:"toggle-slider"})]})]}),a.jsx("p",{className:"role-description",children:T.description}),P.length>0&&a.jsx("div",{className:"role-meta",children:a.jsxs("div",{className:"meta-item",children:[a.jsx("strong",{children:"Components:"}),a.jsx("span",{children:P.join(", ")})]})})]},T.feature_key)})})]}),a.jsxs("section",{className:"role-section",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("h3",{children:" Recent Configuration Changes"}),a.jsx("p",{children:"Last 20 role/feature modifications"})]}),a.jsx("div",{className:"activity-log",children:l.length===0?a.jsx("p",{className:"empty-state",children:"No configuration changes recorded yet"}):a.jsxs("table",{className:"activity-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Timestamp"}),a.jsx("th",{children:"Admin"}),a.jsx("th",{children:"Feature/Role"}),a.jsx("th",{children:"Action"}),a.jsx("th",{children:"Status"})]})}),a.jsx("tbody",{children:l.map(T=>{var P;const U=T.details||{};return a.jsxs("tr",{children:[a.jsx("td",{children:new Date(T.created_at).toLocaleString()}),a.jsx("td",{children:((P=T.users)==null?void 0:P.full_name)||"Unknown"}),a.jsx("td",{children:U.feature_name||U.feature_key||""}),a.jsx("td",{children:U.action||"Update"}),a.jsx("td",{children:a.jsx("span",{className:`status-badge ${U.new_status==="enabled"?"status-enabled":"status-disabled"}`,children:U.new_status||""})})]},T.id)})})]})})]}),d.map(T=>a.jsx(Jn,{message:T.message,type:T.type,onClose:()=>p(T.id)},T.id))]})}function UE(){const{user:t}=cn(),[e,n]=O.useState([]),[r,s]=O.useState(!0),[i,o]=O.useState("pending"),[l,c]=O.useState(null),[d,u]=O.useState(""),[p,g]=O.useState(""),[m,j]=O.useState(!1),{toasts:k,showToast:w,removeToast:y}=Yn();O.useEffect(()=>{_()},[i]);const _=async()=>{s(!0);try{const b=i==="all"?null:i,A=await PC(t.department,b);n(A)}catch(b){console.error("Failed to load requests:",b),w("Failed to load requests","error")}finally{s(!1)}},S=async()=>{if(!l||d.trim().length<20){w("Please provide detailed collection instructions (minimum 20 characters)","error");return}j(!0);try{await TC(l.id,t.id,d),w("Request approved successfully! Staff member will be notified.","success"),c(null),u(""),_()}catch(b){console.error("Failed to approve request:",b),w("Failed to approve request","error")}finally{j(!1)}},N=async()=>{if(!l||p.trim().length<20){w("Please provide a detailed reason for denial (minimum 20 characters)","error");return}j(!0);try{await IC(l.id,t.id,p),w("Request denied. Staff member will be notified.","success"),c(null),g(""),_()}catch(b){console.error("Failed to deny request:",b),w("Failed to deny request","error")}finally{j(!1)}},T=b=>{c(b),u("Equipment available for collection on [date] at [time] from [location]. Please return by [date/time]. Contact [email/phone] for any questions."),g("")},U=b=>{c(b),g(""),u("")},P=()=>{c(null),u(""),g("")};return r?a.jsxs("div",{className:"cross-dept-requests",children:[a.jsx("h2",{children:"Cross-Department Requests"}),a.jsx("p",{children:"Loading requests..."})]}):a.jsxs("div",{className:"cross-dept-requests",children:[a.jsx("h2",{children:"Cross-Department Equipment Requests"}),a.jsx("p",{className:"subtitle",children:"Review and approve/deny requests from staff members for your department's equipment"}),a.jsxs("div",{className:"filter-tabs",children:[a.jsxs("button",{onClick:()=>o("pending"),className:i==="pending"?"tab-active":"tab",children:["Pending (",e.filter(b=>b.status==="pending").length,")"]}),a.jsxs("button",{onClick:()=>o("approved"),className:i==="approved"?"tab-active":"tab",children:["Approved (",e.filter(b=>b.status==="approved").length,")"]}),a.jsxs("button",{onClick:()=>o("denied"),className:i==="denied"?"tab-active":"tab",children:["Denied (",e.filter(b=>b.status==="denied").length,")"]}),a.jsxs("button",{onClick:()=>o("all"),className:i==="all"?"tab-active":"tab",children:["All (",e.length,")"]})]}),e.length===0?a.jsx("div",{className:"empty-state",children:a.jsxs("p",{children:["No ",i," requests found."]})}):a.jsx("div",{className:"requests-grid",children:e.map(b=>a.jsxs("div",{className:"request-card",children:[a.jsx("div",{className:"request-header",children:a.jsxs("div",{children:[a.jsx("h3",{children:b.equipment_type}),a.jsx("span",{className:`status-badge status-${b.status}`,children:b.status.charAt(0).toUpperCase()+b.status.slice(1)}),b.routing_type==="broadcast"&&a.jsx("span",{className:"broadcast-badge",title:"This request was broadcast to multiple departments",children:" Broadcast"})]})}),a.jsxs("div",{className:"request-info",children:[a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Requesting Staff:"}),a.jsx("span",{className:"value",children:b.requesting_user_name})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Email:"}),a.jsx("span",{className:"value",children:b.requesting_user_email})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Quantity Needed:"}),a.jsx("span",{className:"value",children:a.jsx("strong",{children:b.quantity})})]}),b.available_at_department&&a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Available in Your Dept:"}),a.jsx("span",{className:"value",children:a.jsx("strong",{children:b.available_at_department})})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"label",children:"Dates:"}),a.jsxs("span",{className:"value",children:[new Date(b.start_date).toLocaleDateString()," - ",new Date(b.end_date).toLocaleDateString()]})]})]}),a.jsxs("div",{className:"request-justification",children:[a.jsx("strong",{children:"Justification:"}),a.jsx("p",{children:b.justification})]}),b.status==="pending"&&a.jsxs("div",{className:"request-actions",children:[a.jsx("button",{onClick:()=>T(b),className:"btn btn-success btn-sm",children:" Approve"}),a.jsx("button",{onClick:()=>U(b),className:"btn btn-danger btn-sm",children:" Deny"})]}),b.status!=="pending"&&b.review_notes&&a.jsxs("div",{className:`review-notes ${b.status}`,children:[a.jsx("strong",{children:b.status==="approved"?"Approval Instructions:":"Denial Reason:"}),a.jsx("p",{children:b.review_notes}),a.jsxs("small",{children:["Reviewed: ",new Date(b.reviewed_at).toLocaleString()]})]}),a.jsx("div",{className:"request-metadata",children:a.jsxs("small",{children:["Created: ",new Date(b.created_at).toLocaleString()]})})]},b.id))}),l&&d!==""&&a.jsx("div",{className:"modal-overlay",onClick:P,children:a.jsxs("div",{className:"modal-content approval-dialog",onClick:b=>b.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsxs("h3",{children:["Approve Request for ",l.equipment_type]}),a.jsx("button",{onClick:P,className:"modal-close",children:""})]}),a.jsxs("div",{className:"dialog-body",children:[a.jsxs("p",{children:["Provide collection and return instructions for ",a.jsx("strong",{children:l.requesting_user_name}),":"]}),a.jsx("textarea",{value:d,onChange:b=>u(b.target.value),rows:"6",placeholder:"Equipment available for collection on [date] at [time] from [location]...",style:{width:"100%",padding:"0.75rem",fontSize:"1rem",fontFamily:"inherit"}}),a.jsxs("small",{className:d.length<20?"text-error":"text-success",children:[d.length," / 20 characters minimum"]})]}),a.jsxs("div",{className:"dialog-actions",children:[a.jsx("button",{onClick:P,className:"btn btn-secondary",disabled:m,children:"Cancel"}),a.jsx("button",{onClick:S,className:"btn btn-success",disabled:m||d.length<20,children:m?"Approving...":"Approve Request"})]})]})}),l&&p!==""&&a.jsx("div",{className:"modal-overlay",onClick:P,children:a.jsxs("div",{className:"modal-content denial-dialog",onClick:b=>b.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsxs("h3",{children:["Deny Request for ",l.equipment_type]}),a.jsx("button",{onClick:P,className:"modal-close",children:""})]}),a.jsxs("div",{className:"dialog-body",children:[a.jsxs("p",{children:["Provide a detailed reason for denying this request to ",a.jsx("strong",{children:l.requesting_user_name}),":"]}),a.jsx("textarea",{value:p,onChange:b=>g(b.target.value),rows:"4",placeholder:"Unfortunately our equipment is fully booked during this period...",style:{width:"100%",padding:"0.75rem",fontSize:"1rem",fontFamily:"inherit"}}),a.jsxs("small",{className:p.length<20?"text-error":"text-success",children:[p.length," / 20 characters minimum"]})]}),a.jsxs("div",{className:"dialog-actions",children:[a.jsx("button",{onClick:P,className:"btn btn-secondary",disabled:m,children:"Cancel"}),a.jsx("button",{onClick:N,className:"btn btn-danger",disabled:m||p.length<20,children:m?"Denying...":"Deny Request"})]})]})}),k.map(b=>a.jsx(Jn,{message:b.message,type:b.type,onClose:()=>y(b.id)},b.id)),a.jsx("style",{jsx:!0,children:`
        .cross-dept-requests {
          padding: 2rem;
        }

        .subtitle {
          color: #666;
          margin-bottom: 2rem;
        }

        .filter-tabs {
          display: flex;
          gap: 0.5rem;
          margin-bottom: 2rem;
          border-bottom: 2px solid #eee;
        }

        .tab,
        .tab-active {
          padding: 0.75rem 1.5rem;
          border: none;
          background: none;
          cursor: pointer;
          font-weight: 600;
          color: #666;
          border-bottom: 3px solid transparent;
          transition: all 0.2s;
        }

        .tab:hover {
          color: #333;
          background-color: #f5f5f5;
        }

        .tab-active {
          color: #1976d2;
          border-bottom-color: #1976d2;
        }

        .requests-grid {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(450px, 1fr));
          gap: 1.5rem;
        }

        .request-card {
          background: #fff;
          border: 1px solid #ddd;
          border-radius: 8px;
          padding: 1.5rem;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .request-header {
          margin-bottom: 1rem;
        }

        .request-header h3 {
          margin: 0 0 0.5rem 0;
          color: #333;
        }

        .status-badge {
          display: inline-block;
          padding: 0.25rem 0.75rem;
          border-radius: 12px;
          font-size: 0.875rem;
          font-weight: 600;
          margin-right: 0.5rem;
        }

        .status-pending {
          background-color: #fff3cd;
          color: #856404;
        }

        .status-approved {
          background-color: #d4edda;
          color: #155724;
        }

        .status-denied {
          background-color: #f8d7da;
          color: #721c24;
        }

        .broadcast-badge {
          display: inline-block;
          padding: 0.25rem 0.5rem;
          background-color: #e3f2fd;
          border-radius: 4px;
          font-size: 0.75rem;
        }

        .request-info {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
          margin-bottom: 1rem;
        }

        .info-row {
          display: flex;
          gap: 0.5rem;
        }

        .info-row .label {
          font-weight: 600;
          color: #666;
          min-width: 140px;
        }

        .info-row .value {
          color: #333;
        }

        .request-justification {
          margin-top: 1rem;
          padding: 1rem;
          background-color: #f5f5f5;
          border-radius: 4px;
        }

        .request-justification strong {
          display: block;
          margin-bottom: 0.5rem;
          color: #333;
        }

        .request-justification p {
          margin: 0;
          color: #555;
          line-height: 1.5;
        }

        .request-actions {
          display: flex;
          gap: 1rem;
          margin-top: 1rem;
        }

        .review-notes {
          margin-top: 1rem;
          padding: 1rem;
          border-radius: 4px;
          border-left: 4px solid;
        }

        .review-notes.approved {
          background-color: #e8f5e9;
          border-left-color: #4caf50;
        }

        .review-notes.denied {
          background-color: #ffebee;
          border-left-color: #f44336;
        }

        .review-notes strong {
          display: block;
          margin-bottom: 0.5rem;
        }

        .review-notes p {
          margin: 0 0 0.5rem 0;
          line-height: 1.5;
        }

        .review-notes small {
          color: #999;
          font-size: 0.85rem;
        }

        .request-metadata {
          margin-top: 1rem;
          padding-top: 1rem;
          border-top: 1px solid #eee;
        }

        .request-metadata small {
          color: #999;
        }

        .empty-state {
          text-align: center;
          padding: 3rem;
          color: #666;
        }

        .approval-dialog,
        .denial-dialog {
          max-width: 600px;
        }

        .dialog-body {
          padding: 1.5rem 0;
        }

        .dialog-body textarea {
          margin-top: 1rem;
          margin-bottom: 0.5rem;
          border: 1px solid #ccc;
          border-radius: 4px;
          resize: vertical;
        }

        .dialog-body small.text-error {
          color: #d32f2f;
        }

        .dialog-body small.text-success {
          color: #4caf50;
        }

        .dialog-actions {
          display: flex;
          justify-content: flex-end;
          gap: 1rem;
          padding-top: 1.5rem;
          border-top: 1px solid #eee;
        }

        @media (max-width: 768px) {
          .cross-dept-requests {
            padding: 1rem;
          }

          .requests-grid {
            grid-template-columns: 1fr;
          }

          .filter-tabs {
            flex-wrap: wrap;
          }
        }
      `})]})}function $E({kit:t,departmentId:e,onClose:n,onSuccess:r}){const{user:s}=cn(),[i,o]=O.useState(""),[l,c]=O.useState(""),[d,u]=O.useState(""),[p,g]=O.useState([]),[m,j]=O.useState([]),[k,w]=O.useState(!1),[y,_]=O.useState(!0);O.useEffect(()=>{S(),t&&(o(t.name),c(t.description||""),u(t.image_url||""),g(t.equipment_ids||[]))},[t]);const S=async()=>{_(!0);try{const A=await be.query("equipment",{department:e});j(A)}catch(A){console.error("Failed to load equipment:",A)}finally{_(!1)}},N=A=>{g($=>$.includes(A)?$.filter(D=>D!==A):[...$,A])},T=()=>{g(m.map(A=>A.id))},U=()=>{g([])},P=async A=>{if(A.preventDefault(),!i.trim()||p.length===0){alert("Please provide a kit name and select at least one equipment item");return}w(!0);try{const $={name:i.trim(),description:l.trim(),department_id:e,created_by:s.id,equipment_ids:p,image_url:d.trim()};t?await C5(t.id,$):await cC($),r()}catch($){console.error("Failed to save kit:",$),alert("Failed to save kit. Please try again.")}finally{w(!1)}},b=m.reduce((A,$)=>{const D=$.category||"Other";return A[D]||(A[D]=[]),A[D].push($),A},{});return a.jsx("div",{className:"modal-overlay",onClick:n,children:a.jsxs("div",{className:"modal-content kit-form-modal",onClick:A=>A.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:t?"Edit Equipment Kit":"Create New Equipment Kit"}),a.jsx("button",{onClick:n,className:"modal-close",children:""})]}),a.jsxs("form",{onSubmit:P,children:[a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:"Kit Details"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"kit-name",children:"Kit Name *"}),a.jsx("input",{type:"text",id:"kit-name",value:i,onChange:A=>o(A.target.value),placeholder:"e.g., Video Production Starter Kit",required:!0,maxLength:"100"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"kit-description",children:"Description"}),a.jsx("textarea",{id:"kit-description",value:l,onChange:A=>c(A.target.value),placeholder:"Describe what this kit is for and when students should use it...",rows:"3",maxLength:"500"}),a.jsxs("small",{children:[l.length," / 500 characters"]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"kit-image",children:"Image URL (optional)"}),a.jsx("input",{type:"url",id:"kit-image",value:d,onChange:A=>u(A.target.value),placeholder:"https://example.com/kit-image.jpg"})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsxs("div",{className:"equipment-selection-header",children:[a.jsxs("h3",{children:["Select Equipment (",p.length," selected)"]}),a.jsxs("div",{className:"selection-actions",children:[a.jsx("button",{type:"button",onClick:T,className:"btn btn-secondary btn-sm",children:"Select All"}),a.jsx("button",{type:"button",onClick:U,className:"btn btn-secondary btn-sm",children:"Deselect All"})]})]}),y?a.jsx("p",{children:"Loading equipment..."}):m.length===0?a.jsx("div",{className:"empty-state-small",children:a.jsx("p",{children:"No equipment found in your department. Add equipment first to create kits."})}):a.jsx("div",{className:"equipment-selection-list",children:Object.entries(b).map(([A,$])=>a.jsxs("div",{className:"equipment-category",children:[a.jsxs("h4",{children:[A," (",$.length,")"]}),a.jsx("div",{className:"equipment-items",children:$.map(D=>a.jsxs("label",{className:"equipment-checkbox",children:[a.jsx("input",{type:"checkbox",checked:p.includes(D.id),onChange:()=>N(D.id)}),a.jsxs("span",{className:"equipment-label",children:[a.jsx("strong",{children:D.product_name}),a.jsx("small",{children:D.tracking_number})]}),a.jsx("span",{className:`equipment-status status-${D.status}`,children:D.status})]},D.id))})]},A))})]}),a.jsxs("div",{className:"modal-actions",children:[a.jsx("button",{type:"button",onClick:n,className:"btn btn-secondary",disabled:k,children:"Cancel"}),a.jsx("button",{type:"submit",className:"btn btn-primary",disabled:k||p.length===0,children:k?"Saving...":t?"Update Kit":"Create Kit"})]})]}),a.jsx("style",{jsx:!0,children:`
          .kit-form-modal {
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
          }

          .form-section {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid #eee;
          }

          .form-section:last-of-type {
            border-bottom: none;
          }

          .form-section h3 {
            margin: 0 0 1rem 0;
            color: #333;
            font-size: 1.1rem;
          }

          .form-group {
            margin-bottom: 1rem;
          }

          .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #333;
          }

          .form-group input[type="text"],
          .form-group input[type="url"],
          .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 1rem;
            font-family: inherit;
          }

          .form-group textarea {
            resize: vertical;
          }

          .form-group small {
            display: block;
            margin-top: 0.25rem;
            color: #666;
            font-size: 0.875rem;
          }

          .equipment-selection-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
          }

          .selection-actions {
            display: flex;
            gap: 0.5rem;
          }

          .equipment-selection-list {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 1rem;
          }

          .equipment-category {
            margin-bottom: 1.5rem;
          }

          .equipment-category:last-child {
            margin-bottom: 0;
          }

          .equipment-category h4 {
            margin: 0 0 0.75rem 0;
            color: #666;
            font-size: 0.95rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
          }

          .equipment-items {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
          }

          .equipment-checkbox {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            background-color: #f9f9f9;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
          }

          .equipment-checkbox:hover {
            background-color: #f0f0f0;
            border-color: #1976d2;
          }

          .equipment-checkbox input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
          }

          .equipment-label {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
          }

          .equipment-label strong {
            color: #333;
          }

          .equipment-label small {
            color: #666;
            font-size: 0.85rem;
          }

          .equipment-status {
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: capitalize;
          }

          .status-available {
            background-color: #d4edda;
            color: #155724;
          }

          .status-booked {
            background-color: #fff3cd;
            color: #856404;
          }

          .status-maintenance {
            background-color: #f8d7da;
            color: #721c24;
          }

          .empty-state-small {
            text-align: center;
            padding: 2rem;
            color: #666;
            background-color: #f5f5f5;
            border-radius: 4px;
          }

          .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid #eee;
          }

          @media (max-width: 768px) {
            .kit-form-modal {
              max-width: 95vw;
              padding: 1rem;
            }

            .equipment-selection-header {
              flex-direction: column;
              align-items: flex-start;
              gap: 1rem;
            }

            .selection-actions {
              width: 100%;
            }

            .selection-actions button {
              flex: 1;
            }
          }
        `})]})})}function zE(){const{user:t}=cn(),[e,n]=O.useState([]),[r,s]=O.useState(!0),[i,o]=O.useState(!1),[l,c]=O.useState(null),[d,u]=O.useState(!1),{toasts:p,showToast:g,removeToast:m}=Yn();O.useEffect(()=>{j()},[d]);const j=async()=>{s(!0);try{const N=await N5(t.department,!d);n(N)}catch(N){console.error("Failed to load kits:",N),g("Failed to load equipment kits","error")}finally{s(!1)}},k=()=>{c(null),o(!0)},w=N=>{c(N),o(!0)},y=async(N,T)=>{if(confirm(`Are you sure you want to deactivate "${T}"? It will no longer be visible to students.`))try{await dC(N),g("Kit deactivated successfully","success"),j()}catch(U){console.error("Failed to delete kit:",U),g("Failed to deactivate kit","error")}},_=()=>{o(!1),c(null)},S=()=>{g(l?"Kit updated successfully":"Kit created successfully","success"),j(),_()};return r?a.jsxs("div",{className:"equipment-kits-management",children:[a.jsx("h2",{children:"Equipment Kits Management"}),a.jsx("p",{children:"Loading kits..."})]}):a.jsxs("div",{className:"equipment-kits-management",children:[a.jsxs("div",{className:"page-header",children:[a.jsxs("div",{children:[a.jsx("h2",{children:"Equipment Kits Management"}),a.jsx("p",{className:"subtitle",children:"Create equipment bundles that students in your department can book as a single unit"})]}),a.jsx("button",{onClick:k,className:"btn btn-primary",children:"+ Create New Kit"})]}),a.jsxs("div",{className:"kits-controls",children:[a.jsxs("label",{className:"checkbox-label",children:[a.jsx("input",{type:"checkbox",checked:d,onChange:N=>u(N.target.checked)}),"Show inactive kits"]}),a.jsxs("div",{className:"kits-count",children:[e.length," kit",e.length!==1?"s":""," found"]})]}),e.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx("div",{className:"empty-icon",children:""}),a.jsx("h3",{children:"No equipment kits yet"}),a.jsx("p",{children:"Create your first equipment kit to help students book commonly used equipment bundles together."}),a.jsx("button",{onClick:k,className:"btn btn-primary",style:{marginTop:"1rem"},children:"Create Your First Kit"})]}):a.jsx("div",{className:"kits-grid",children:e.map(N=>a.jsxs("div",{className:`kit-card ${N.is_active?"":"inactive"}`,children:[a.jsxs("div",{className:"kit-header",children:[a.jsxs("div",{className:"kit-title-section",children:[a.jsx("h3",{children:N.name}),!N.is_active&&a.jsx("span",{className:"inactive-badge",children:"Inactive"})]}),N.image_url&&a.jsx("div",{className:"kit-image",children:a.jsx("img",{src:N.image_url,alt:N.name})})]}),a.jsx("p",{className:"kit-description",children:N.description}),a.jsxs("div",{className:"kit-equipment-list",children:[a.jsxs("strong",{children:["Equipment in this kit (",N.equipment_ids.length," items):"]}),a.jsxs("ul",{children:[N.equipment_ids.slice(0,5).map((T,U)=>a.jsxs("li",{children:["Equipment ID: ",T]},T)),N.equipment_ids.length>5&&a.jsxs("li",{className:"more-items",children:["+ ",N.equipment_ids.length-5," more items"]})]})]}),a.jsx("div",{className:"kit-metadata",children:a.jsxs("small",{children:["Created: ",new Date(N.created_at).toLocaleDateString()]})}),a.jsxs("div",{className:"kit-actions",children:[a.jsx("button",{onClick:()=>w(N),className:"btn btn-secondary btn-sm",children:"Edit"}),N.is_active&&a.jsx("button",{onClick:()=>y(N.id,N.name),className:"btn btn-danger btn-sm",children:"Deactivate"})]})]},N.id))}),i&&a.jsx($E,{kit:l,departmentId:t.department,onClose:_,onSuccess:S}),p.map(N=>a.jsx(Jn,{message:N.message,type:N.type,onClose:()=>m(N.id)},N.id))]})}function WE(){const{user:t,logout:e}=cn();return a.jsxs("div",{className:`admin-portal ${(t==null?void 0:t.role)==="master_admin"?"master-admin-portal":""}`,children:[a.jsx("header",{className:"admin-header",children:a.jsxs("div",{className:"admin-header-content",children:[a.jsxs("h1",{children:[" NCADbook ",(t==null?void 0:t.role)==="master_admin"?"Master Admin":"Department Admin"]}),a.jsxs("div",{className:"admin-header-actions",children:[a.jsx(y0,{}),a.jsxs("span",{className:"admin-user-info",children:[t==null?void 0:t.full_name,"  ",(t==null?void 0:t.department)||"System"]}),a.jsx("button",{onClick:e,className:"btn btn-secondary btn-sm",children:"Logout"})]})]})}),a.jsx("nav",{className:"admin-nav",children:a.jsxs("div",{className:"admin-nav-container",children:[a.jsx(vn,{to:"/admin",end:!0,className:({isActive:n})=>`admin-nav-link ${n?"active":""}`,children:" Dashboard"}),a.jsx(vn,{to:"/admin/approvals",className:({isActive:n})=>`admin-nav-link ${n?"active":""}`,children:" Approvals"}),a.jsx(vn,{to:"/admin/equipment",className:({isActive:n})=>`admin-nav-link ${n?"active":""}`,children:" Equipment"}),a.jsx(vn,{to:"/admin/equipment-kits",className:({isActive:n})=>`admin-nav-link ${n?"active":""}`,children:" Equipment Kits"}),(t==null?void 0:t.role)==="master_admin"&&a.jsxs(a.Fragment,{children:[a.jsx(vn,{to:"/admin/users",className:({isActive:n})=>`admin-nav-link ${n?"active":""}`,children:" Users"}),a.jsx(vn,{to:"/admin/analytics",className:({isActive:n})=>`admin-nav-link ${n?"active":""}`,children:" Analytics"}),a.jsx(vn,{to:"/admin/departments",className:({isActive:n})=>`admin-nav-link ${n?"active":""}`,children:" Departments"}),a.jsx(vn,{to:"/admin/csv-import",className:({isActive:n})=>`admin-nav-link ${n?"active":""}`,children:" CSV Import"}),a.jsx(vn,{to:"/admin/system-settings",className:({isActive:n})=>`admin-nav-link ${n?"active":""}`,children:" Settings"}),a.jsx(vn,{to:"/admin/role-management",className:({isActive:n})=>`admin-nav-link ${n?"active":""}`,children:" Role Management"})]}),(t==null?void 0:t.role)==="department_admin"&&a.jsxs(a.Fragment,{children:[a.jsx(vn,{to:"/admin/cross-department-requests",className:({isActive:n})=>`admin-nav-link ${n?"active":""}`,children:" Cross-Dept Requests"}),a.jsx(vn,{to:"/admin/department-staff-permissions",className:({isActive:n})=>`admin-nav-link ${n?"active":""}`,children:" Staff Permissions"})]})]})}),a.jsx("main",{className:"admin-main",children:a.jsxs(Yh,{children:[a.jsx(vt,{index:!0,element:a.jsx(FC,{})}),a.jsx(vt,{path:"approvals",element:a.jsx(UC,{})}),a.jsx(vt,{path:"equipment",element:a.jsx(zC,{})}),a.jsx(vt,{path:"analytics",element:a.jsx(yE,{})}),a.jsx(vt,{path:"users",element:a.jsx(_E,{})}),a.jsx(vt,{path:"kits",element:a.jsx(PE,{})}),a.jsx(vt,{path:"departments",element:a.jsx(TE,{})}),a.jsx(vt,{path:"student-assignment",element:a.jsx(IE,{})}),a.jsx(vt,{path:"interdisciplinary",element:a.jsx(RE,{})}),a.jsx(vt,{path:"access-requests",element:a.jsx(qE,{})}),a.jsx(vt,{path:"manage-access-requests",element:a.jsx(OE,{})}),a.jsx(vt,{path:"csv-import",element:a.jsx(wE,{})}),a.jsx(vt,{path:"permissions",element:a.jsx(DE,{})}),a.jsx(vt,{path:"features",element:a.jsx(bE,{})}),a.jsx(vt,{path:"department-staff-permissions",element:a.jsx(FE,{})}),a.jsx(vt,{path:"system-settings",element:a.jsx(ME,{})}),a.jsx(vt,{path:"role-management",element:a.jsx(BE,{})}),a.jsx(vt,{path:"cross-department-requests",element:a.jsx(UE,{})}),a.jsx(vt,{path:"equipment-kits",element:a.jsx(zE,{})})]})}),a.jsx(b0,{})]})}function HE(){var o;const[t,e]=O.useState(null),{login:n}=cn(),r=Pl(),s=async(l,c,d)=>{try{await n(l,c),r(d)}catch(u){console.error("Auto-login failed:",u)}},i=[{id:"student",email:"commdesign.student1@student.ncad.ie",password:"student123",name:"Student Portal",path:"/student",coords:"60,60,580,580"},{id:"staff",email:"staff.commdesign@ncad.ie",password:"staff123",name:"Staff Portal",path:"/staff",coords:"620,60,1140,580"},{id:"admin",email:"admin.commdesign@ncad.ie",password:"admin123",name:"Department Admin",path:"/admin",coords:"60,620,580,1140"},{id:"master",email:"master@ncad.ie",password:"master123",name:"Master Admin",path:"/admin",coords:"620,620,1140,1140"}];return a.jsxs("div",{className:"artistic-login-container",children:[a.jsxs("div",{className:"demo-header",children:[a.jsx("h1",{children:"NCADbook Demo"}),a.jsx("p",{children:"Click any portal to explore the system"})]}),a.jsxs("div",{className:"portal-map-container",children:[a.jsxs("div",{className:"map-wrapper",children:[a.jsx("img",{src:"/login-map-frame2.jpg",alt:"NCAD Portal Map",className:"base-map-image"}),a.jsx("svg",{viewBox:"0 0 1200 1200",className:"portal-overlay-svg",children:i.map(l=>{const[c,d,u,p]=l.coords.split(",").map(Number),g=t===l.id;return a.jsxs("g",{children:[a.jsx("rect",{x:c,y:d,width:u-c,height:p-d,className:`portal-quadrant ${g?"hovered":""}`,onMouseEnter:()=>e(l.id),onMouseLeave:()=>e(null),onClick:()=>s(l.email,l.password,l.path),style:{cursor:"pointer"}}),g&&a.jsx("text",{x:(c+u)/2,y:(d+p)/2,className:"portal-label",textAnchor:"middle",dominantBaseline:"middle",children:l.name})]},l.id)})})]}),a.jsx("p",{className:"instruction-text",children:t?`Click to enter ${(o=i.find(l=>l.id===t))==null?void 0:o.name}`:"Tap any quadrant to enter a portal"})]}),a.jsxs("div",{className:"specialized-roles-links",children:[a.jsx("h3",{children:"Specialized Role Demos"}),a.jsxs("div",{className:"role-links-grid",children:[a.jsxs("a",{href:"/demo/view_only_staff",className:"role-link",children:[a.jsx("span",{className:"role-icon",children:""}),a.jsx("span",{className:"role-name",children:"View-Only Staff"})]}),a.jsxs("a",{href:"/demo/accounts_officer",className:"role-link",children:[a.jsx("span",{className:"role-icon",children:""}),a.jsx("span",{className:"role-name",children:"Accounts Officer"})]}),a.jsxs("a",{href:"/demo/payroll_coordinator",className:"role-link",children:[a.jsx("span",{className:"role-icon",children:""}),a.jsx("span",{className:"role-name",children:"Payroll Coordinator"})]}),a.jsxs("a",{href:"/demo/it_support_technician",className:"role-link",children:[a.jsx("span",{className:"role-icon",children:""}),a.jsx("span",{className:"role-name",children:"IT Support"})]}),a.jsxs("a",{href:"/demo/budget_manager",className:"role-link",children:[a.jsx("span",{className:"role-icon",children:""}),a.jsx("span",{className:"role-name",children:"Budget Manager"})]})]})]})]})}function VE(){const[t,e]=O.useState([]),[n,r]=O.useState("");O.useEffect(()=>{s()},[]);const s=async()=>{const o=await be.query("equipment");e(o.slice(0,20))},i=t.filter(o=>o.product_name.toLowerCase().includes(n.toLowerCase()));return a.jsxs("div",{className:"portal-container",style:{padding:"2rem",maxWidth:"1200px",margin:"0 auto"},children:[a.jsxs("div",{className:"portal-header",style:{marginBottom:"2rem"},children:[a.jsx("h1",{style:{color:"#9C27B0",marginBottom:"0.5rem"},children:" View-Only Staff Portal"}),a.jsx("p",{style:{color:"#666",fontSize:"1.1rem"},children:"Read-only access to equipment catalog. No booking permissions."})]}),a.jsxs("div",{className:"permissions-notice",style:{background:"#E1BEE7",padding:"1rem",borderRadius:"8px",marginBottom:"2rem",border:"2px solid #9C27B0"},children:[a.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"#6A1B9A"},children:"Your Permissions:"}),a.jsxs("ul",{style:{margin:0,paddingLeft:"1.5rem"},children:[a.jsx("li",{children:" Can view equipment catalog"}),a.jsx("li",{children:" Can view equipment details and availability"}),a.jsx("li",{children:" Cannot create bookings"}),a.jsx("li",{children:" Cannot modify equipment"}),a.jsx("li",{children:" Cannot access admin features"})]})]}),a.jsx("div",{className:"search-section",style:{marginBottom:"2rem"},children:a.jsx("input",{type:"text",placeholder:" Search equipment...",value:n,onChange:o=>r(o.target.value),style:{width:"100%",padding:"0.75rem",fontSize:"1rem",border:"2px solid #9C27B0",borderRadius:"8px"}})}),a.jsx("div",{className:"equipment-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"1.5rem"},children:i.map(o=>{var l;return a.jsxs("div",{style:{border:"1px solid #ddd",borderRadius:"8px",padding:"1rem",background:"white"},children:[a.jsx("img",{src:o.link_to_image||"/placeholder-equipment.png",alt:o.product_name,style:{width:"100%",height:"200px",objectFit:"cover",borderRadius:"4px",marginBottom:"1rem"}}),a.jsx("h3",{style:{margin:"0 0 0.5rem 0",fontSize:"1.1rem"},children:o.product_name}),a.jsxs("p",{style:{color:"#666",fontSize:"0.9rem",margin:"0 0 0.5rem 0"},children:[(l=o.description)==null?void 0:l.substring(0,100),"..."]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"1rem"},children:[a.jsx("span",{style:{padding:"0.25rem 0.75rem",background:o.status==="available"?"#4CAF50":"#FF9800",color:"white",borderRadius:"4px",fontSize:"0.85rem"},children:o.status||"available"}),a.jsx("button",{disabled:!0,style:{padding:"0.5rem 1rem",background:"#ccc",color:"#666",border:"none",borderRadius:"4px",cursor:"not-allowed"},children:" Booking Disabled"})]})]},o.id)})}),i.length===0&&a.jsx("div",{style:{textAlign:"center",padding:"3rem",color:"#666"},children:a.jsxs("p",{children:['No equipment found matching "',n,'"']})})]})}function GE(){return a.jsxs("div",{className:"demo-portal-wrapper",children:[a.jsx("div",{className:"demo-header",style:{padding:"1rem 2rem",background:"#9C27B0",color:"white"},children:a.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("div",{children:[a.jsx("h2",{style:{margin:0},children:"View-Only Staff Role Demo"}),a.jsx("p",{style:{margin:"0.25rem 0 0 0",opacity:.9},children:"Read-only equipment catalog access"})]}),a.jsx(rs,{to:"/admin/role-management",className:"btn btn-secondary",style:{background:"white",color:"#9C27B0",padding:"0.5rem 1rem",borderRadius:"4px",textDecoration:"none"},children:" Back to Role Management"})]})}),a.jsx(VE,{})]})}function KE(){const[t,e]=O.useState([]),[n,r]=O.useState([]),[s,i]=O.useState(0);O.useEffect(()=>{o()},[]);const o=async()=>{const c=await be.query("equipment"),d=await be.query("bookings");e(c.slice(0,15)),r(d.slice(0,10));const u=c.reduce((p,g)=>p+(parseFloat(g.purchase_price)||0),0);i(u)},l=[{dept:"Communication Design",cost:45230,bookings:156},{dept:"Product Design",cost:32100,bookings:89},{dept:"Media",cost:58900,bookings:203},{dept:"Painting",cost:12400,bookings:34},{dept:"Sculpture",cost:28700,bookings:67}];return a.jsxs("div",{className:"portal-container",style:{padding:"2rem",maxWidth:"1400px",margin:"0 auto"},children:[a.jsxs("div",{className:"portal-header",style:{marginBottom:"2rem"},children:[a.jsx("h1",{style:{color:"#9C27B0",marginBottom:"0.5rem"},children:" Accounts Officer Portal"}),a.jsx("p",{style:{color:"#666",fontSize:"1.1rem"},children:"Financial overview, equipment costs, and department budgets"})]}),a.jsxs("div",{className:"permissions-notice",style:{background:"#E1BEE7",padding:"1rem",borderRadius:"8px",marginBottom:"2rem",border:"2px solid #9C27B0"},children:[a.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"#6A1B9A"},children:"Your Permissions:"}),a.jsxs("ul",{style:{margin:0,paddingLeft:"1.5rem"},children:[a.jsx("li",{children:" View equipment costs and purchase prices"}),a.jsx("li",{children:" Export financial reports (CSV/PDF)"}),a.jsx("li",{children:" Access all department budgets"}),a.jsx("li",{children:" View booking-related costs"}),a.jsx("li",{children:" Cannot modify equipment or bookings"})]})]}),a.jsxs("div",{className:"stats-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem",marginBottom:"2rem"},children:[a.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"1.5rem",borderRadius:"8px",color:"white"},children:[a.jsx("h3",{style:{margin:"0 0 0.5rem 0",fontSize:"0.9rem",opacity:.9},children:"Total Equipment Value"}),a.jsxs("p",{style:{margin:0,fontSize:"2rem",fontWeight:"bold"},children:["",s.toLocaleString()]})]}),a.jsxs("div",{style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",padding:"1.5rem",borderRadius:"8px",color:"white"},children:[a.jsx("h3",{style:{margin:"0 0 0.5rem 0",fontSize:"0.9rem",opacity:.9},children:"YTD Bookings"}),a.jsx("p",{style:{margin:0,fontSize:"2rem",fontWeight:"bold"},children:"549"})]}),a.jsxs("div",{style:{background:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",padding:"1.5rem",borderRadius:"8px",color:"white"},children:[a.jsx("h3",{style:{margin:"0 0 0.5rem 0",fontSize:"0.9rem",opacity:.9},children:"Avg Cost per Booking"}),a.jsxs("p",{style:{margin:0,fontSize:"2rem",fontWeight:"bold"},children:["",(s/549).toFixed(2)]})]})]}),a.jsx("h2",{style:{color:"#333",marginBottom:"1rem"},children:"Department Cost Breakdown"}),a.jsx("div",{style:{background:"white",border:"1px solid #ddd",borderRadius:"8px",overflow:"hidden",marginBottom:"2rem"},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#9C27B0",color:"white"},children:[a.jsx("th",{style:{padding:"1rem",textAlign:"left"},children:"Department"}),a.jsx("th",{style:{padding:"1rem",textAlign:"right"},children:"Equipment Value"}),a.jsx("th",{style:{padding:"1rem",textAlign:"right"},children:"Total Bookings"}),a.jsx("th",{style:{padding:"1rem",textAlign:"right"},children:"Avg per Booking"})]})}),a.jsx("tbody",{children:l.map((c,d)=>a.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[a.jsx("td",{style:{padding:"1rem"},children:c.dept}),a.jsxs("td",{style:{padding:"1rem",textAlign:"right",fontWeight:"bold"},children:["",c.cost.toLocaleString()]}),a.jsx("td",{style:{padding:"1rem",textAlign:"right"},children:c.bookings}),a.jsxs("td",{style:{padding:"1rem",textAlign:"right"},children:["",(c.cost/c.bookings).toFixed(2)]})]},d))})]})}),a.jsxs("div",{style:{textAlign:"center",marginTop:"2rem"},children:[a.jsx("button",{style:{padding:"0.75rem 2rem",background:"#9C27B0",color:"white",border:"none",borderRadius:"8px",fontSize:"1rem",cursor:"pointer",marginRight:"1rem"},children:" Export Financial Report (PDF)"}),a.jsx("button",{style:{padding:"0.75rem 2rem",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"1rem",cursor:"pointer"},children:" Export to Excel (CSV)"})]})]})}function ZE(){return a.jsxs("div",{className:"demo-portal-wrapper",children:[a.jsx("div",{className:"demo-header",style:{padding:"1rem 2rem",background:"#9C27B0",color:"white"},children:a.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("div",{children:[a.jsx("h2",{style:{margin:0},children:"Accounts Officer Role Demo"}),a.jsx("p",{style:{margin:"0.25rem 0 0 0",opacity:.9},children:"Financial reporting and cost analysis"})]}),a.jsx(rs,{to:"/admin/role-management",className:"btn btn-secondary",style:{background:"white",color:"#9C27B0",padding:"0.5rem 1rem",borderRadius:"4px",textDecoration:"none"},children:" Back to Role Management"})]})}),a.jsx(KE,{})]})}function YE(){const t=[{id:1,name:"Sarah Johnson",role:"Department Admin",dept:"Communication Design",hours:35,costCenter:"CC-001",allocation:"100%"},{id:2,name:"Mark Williams",role:"Department Admin",dept:"Product Design",hours:35,costCenter:"CC-002",allocation:"100%"},{id:3,name:"Anna Collins",role:"Staff",dept:"Communication Design",hours:20,costCenter:"CC-001",allocation:"60%"},{id:4,name:"Brian Hughes",role:"Staff",dept:"Product Design",hours:15,costCenter:"CC-002",allocation:"40%"},{id:5,name:"Lisa O'Brien",role:"Department Admin",dept:"Media",hours:28,costCenter:"CC-003",allocation:"80%"},{id:6,name:"Fiona McCarthy",role:"Staff",dept:"Media",hours:25,costCenter:"CC-003",allocation:"70%"}],e=[{code:"CC-001",name:"Communication Design",budget:125e3,allocated:118500,staff:5},{code:"CC-002",name:"Product Design",budget:95e3,allocated:87200,staff:4},{code:"CC-003",name:"Media Department",budget:14e4,allocated:132e3,staff:6},{code:"CC-004",name:"Sculpture & Applied Materials",budget:78e3,allocated:71500,staff:3}];return a.jsxs("div",{className:"portal-container",style:{padding:"2rem",maxWidth:"1400px",margin:"0 auto"},children:[a.jsxs("div",{className:"portal-header",style:{marginBottom:"2rem"},children:[a.jsx("h1",{style:{color:"#9C27B0",marginBottom:"0.5rem"},children:" Payroll Coordinator Portal"}),a.jsx("p",{style:{color:"#666",fontSize:"1.1rem"},children:"Staff cost center allocations and payroll data management"})]}),a.jsxs("div",{className:"permissions-notice",style:{background:"#E1BEE7",padding:"1rem",borderRadius:"8px",marginBottom:"2rem",border:"2px solid #9C27B0"},children:[a.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"#6A1B9A"},children:"Your Permissions:"}),a.jsxs("ul",{style:{margin:0,paddingLeft:"1.5rem"},children:[a.jsx("li",{children:" View staff cost center allocations"}),a.jsx("li",{children:" Export payroll data for finance system"}),a.jsx("li",{children:" Track staff hours across departments"}),a.jsx("li",{children:" Generate allocation reports"}),a.jsx("li",{children:" Cannot modify cost center budgets"})]})]}),a.jsx("h2",{style:{color:"#333",marginBottom:"1rem"},children:"Cost Center Overview"}),a.jsx("div",{style:{background:"white",border:"1px solid #ddd",borderRadius:"8px",overflow:"hidden",marginBottom:"2rem"},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#9C27B0",color:"white"},children:[a.jsx("th",{style:{padding:"1rem",textAlign:"left"},children:"Cost Center"}),a.jsx("th",{style:{padding:"1rem",textAlign:"left"},children:"Department"}),a.jsx("th",{style:{padding:"1rem",textAlign:"right"},children:"Budget"}),a.jsx("th",{style:{padding:"1rem",textAlign:"right"},children:"Allocated"}),a.jsx("th",{style:{padding:"1rem",textAlign:"right"},children:"Remaining"}),a.jsx("th",{style:{padding:"1rem",textAlign:"right"},children:"Staff Count"})]})}),a.jsx("tbody",{children:e.map(n=>{const r=n.budget-n.allocated,s=(n.allocated/n.budget*100).toFixed(1);return a.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[a.jsx("td",{style:{padding:"1rem",fontWeight:"bold"},children:n.code}),a.jsx("td",{style:{padding:"1rem"},children:n.name}),a.jsxs("td",{style:{padding:"1rem",textAlign:"right"},children:["",n.budget.toLocaleString()]}),a.jsxs("td",{style:{padding:"1rem",textAlign:"right"},children:["",n.allocated.toLocaleString()]}),a.jsxs("td",{style:{padding:"1rem",textAlign:"right",color:r>0?"#4CAF50":"#f44336"},children:["",r.toLocaleString()," (",s,"%)"]}),a.jsx("td",{style:{padding:"1rem",textAlign:"right"},children:n.staff})]},n.code)})})]})}),a.jsx("h2",{style:{color:"#333",marginBottom:"1rem"},children:"Staff Allocations"}),a.jsx("div",{style:{background:"white",border:"1px solid #ddd",borderRadius:"8px",overflow:"hidden",marginBottom:"2rem"},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#9C27B0",color:"white"},children:[a.jsx("th",{style:{padding:"1rem",textAlign:"left"},children:"Staff Member"}),a.jsx("th",{style:{padding:"1rem",textAlign:"left"},children:"Role"}),a.jsx("th",{style:{padding:"1rem",textAlign:"left"},children:"Department"}),a.jsx("th",{style:{padding:"1rem",textAlign:"right"},children:"Hours/Week"}),a.jsx("th",{style:{padding:"1rem",textAlign:"left"},children:"Cost Center"}),a.jsx("th",{style:{padding:"1rem",textAlign:"right"},children:"Allocation %"})]})}),a.jsx("tbody",{children:t.map(n=>a.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[a.jsx("td",{style:{padding:"1rem",fontWeight:"bold"},children:n.name}),a.jsx("td",{style:{padding:"1rem"},children:n.role}),a.jsx("td",{style:{padding:"1rem"},children:n.dept}),a.jsxs("td",{style:{padding:"1rem",textAlign:"right"},children:[n.hours,"h"]}),a.jsx("td",{style:{padding:"1rem"},children:n.costCenter}),a.jsx("td",{style:{padding:"1rem",textAlign:"right"},children:a.jsx("span",{style:{padding:"0.25rem 0.75rem",background:"#4CAF50",color:"white",borderRadius:"4px",fontSize:"0.85rem"},children:n.allocation})})]},n.id))})]})}),a.jsxs("div",{style:{textAlign:"center",marginTop:"2rem"},children:[a.jsx("button",{style:{padding:"0.75rem 2rem",background:"#9C27B0",color:"white",border:"none",borderRadius:"8px",fontSize:"1rem",cursor:"pointer",marginRight:"1rem"},children:" Export Payroll Report"}),a.jsx("button",{style:{padding:"0.75rem 2rem",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"1rem",cursor:"pointer"},children:" Export Allocation Data (CSV)"})]})]})}function JE(){return a.jsxs("div",{className:"demo-portal-wrapper",children:[a.jsx("div",{className:"demo-header",style:{padding:"1rem 2rem",background:"#9C27B0",color:"white"},children:a.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("div",{children:[a.jsx("h2",{style:{margin:0},children:"Payroll Coordinator Role Demo"}),a.jsx("p",{style:{margin:"0.25rem 0 0 0",opacity:.9},children:"Staff cost center allocations"})]}),a.jsx(rs,{to:"/admin/role-management",className:"btn btn-secondary",style:{background:"white",color:"#9C27B0",padding:"0.5rem 1rem",borderRadius:"4px",textDecoration:"none"},children:" Back to Role Management"})]})}),a.jsx(YE,{})]})}function XE(){const[t,e]=O.useState([]),[n,r]=O.useState([]);O.useEffect(()=>{s(),i()},[]);const s=async()=>{const l=await be.query("equipment");e(l.slice(0,10))},i=()=>{r([{time:"2024-03-15 14:23:12",type:"INFO",user:"commdesign.student1@student.ncad.ie",action:"Equipment booking created",details:"Canon EOS R5"},{time:"2024-03-15 14:18:45",type:"WARNING",user:"admin.media@ncad.ie",action:"Equipment status changed",details:"Sony A7IV  Maintenance"},{time:"2024-03-15 13:55:23",type:"INFO",user:"staff.product@ncad.ie",action:"User login successful",details:"Staff portal access"},{time:"2024-03-15 13:42:09",type:"ERROR",user:"media.student5@student.ncad.ie",action:"Booking conflict detected",details:"MacBook Pro M3 already booked"},{time:"2024-03-15 13:30:17",type:"INFO",user:"admin.commdesign@ncad.ie",action:"Equipment added",details:"New DSLR camera added to catalog"},{time:"2024-03-15 12:15:33",type:"WARNING",user:"system",action:"Scheduled maintenance",details:"Database backup completed"}])},o={total:150,available:98,booked:42,maintenance:8,outOfService:2};return a.jsxs("div",{className:"portal-container",style:{padding:"2rem",maxWidth:"1400px",margin:"0 auto"},children:[a.jsxs("div",{className:"portal-header",style:{marginBottom:"2rem"},children:[a.jsx("h1",{style:{color:"#9C27B0",marginBottom:"0.5rem"},children:" IT Support Portal"}),a.jsx("p",{style:{color:"#666",fontSize:"1.1rem"},children:"Equipment management, system logs, and technical administration"})]}),a.jsxs("div",{className:"permissions-notice",style:{background:"#E1BEE7",padding:"1rem",borderRadius:"8px",marginBottom:"2rem",border:"2px solid #9C27B0"},children:[a.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"#6A1B9A"},children:"Your Permissions:"}),a.jsxs("ul",{style:{margin:0,paddingLeft:"1.5rem"},children:[a.jsx("li",{children:" Manage equipment (add, edit, set maintenance status)"}),a.jsx("li",{children:" View system logs and audit trails"}),a.jsx("li",{children:" Monitor booking conflicts and errors"}),a.jsx("li",{children:" Access technical diagnostics"}),a.jsx("li",{children:" Cannot reset user passwords (security restriction)"})]})]}),a.jsx("h2",{style:{color:"#333",marginBottom:"1rem"},children:"Equipment Status Overview"}),a.jsxs("div",{className:"stats-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[a.jsxs("div",{style:{background:"#2196F3",padding:"1.5rem",borderRadius:"8px",color:"white",textAlign:"center"},children:[a.jsx("p",{style:{margin:"0 0 0.5rem 0",fontSize:"0.9rem",opacity:.9},children:"Total Equipment"}),a.jsx("p",{style:{margin:0,fontSize:"2.5rem",fontWeight:"bold"},children:o.total})]}),a.jsxs("div",{style:{background:"#4CAF50",padding:"1.5rem",borderRadius:"8px",color:"white",textAlign:"center"},children:[a.jsx("p",{style:{margin:"0 0 0.5rem 0",fontSize:"0.9rem",opacity:.9},children:"Available"}),a.jsx("p",{style:{margin:0,fontSize:"2.5rem",fontWeight:"bold"},children:o.available})]}),a.jsxs("div",{style:{background:"#FF9800",padding:"1.5rem",borderRadius:"8px",color:"white",textAlign:"center"},children:[a.jsx("p",{style:{margin:"0 0 0.5rem 0",fontSize:"0.9rem",opacity:.9},children:"Booked"}),a.jsx("p",{style:{margin:0,fontSize:"2.5rem",fontWeight:"bold"},children:o.booked})]}),a.jsxs("div",{style:{background:"#9C27B0",padding:"1.5rem",borderRadius:"8px",color:"white",textAlign:"center"},children:[a.jsx("p",{style:{margin:"0 0 0.5rem 0",fontSize:"0.9rem",opacity:.9},children:"Maintenance"}),a.jsx("p",{style:{margin:0,fontSize:"2.5rem",fontWeight:"bold"},children:o.maintenance})]}),a.jsxs("div",{style:{background:"#f44336",padding:"1.5rem",borderRadius:"8px",color:"white",textAlign:"center"},children:[a.jsx("p",{style:{margin:"0 0 0.5rem 0",fontSize:"0.9rem",opacity:.9},children:"Out of Service"}),a.jsx("p",{style:{margin:0,fontSize:"2.5rem",fontWeight:"bold"},children:o.outOfService})]})]}),a.jsx("h2",{style:{color:"#333",marginBottom:"1rem"},children:"System Activity Logs"}),a.jsx("div",{style:{background:"white",border:"1px solid #ddd",borderRadius:"8px",overflow:"hidden",marginBottom:"2rem"},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontFamily:"monospace",fontSize:"0.9rem"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#9C27B0",color:"white"},children:[a.jsx("th",{style:{padding:"0.75rem",textAlign:"left"},children:"Timestamp"}),a.jsx("th",{style:{padding:"0.75rem",textAlign:"left"},children:"Type"}),a.jsx("th",{style:{padding:"0.75rem",textAlign:"left"},children:"User"}),a.jsx("th",{style:{padding:"0.75rem",textAlign:"left"},children:"Action"}),a.jsx("th",{style:{padding:"0.75rem",textAlign:"left"},children:"Details"})]})}),a.jsx("tbody",{children:n.map((l,c)=>a.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[a.jsx("td",{style:{padding:"0.75rem",color:"#666"},children:l.time}),a.jsx("td",{style:{padding:"0.75rem"},children:a.jsx("span",{style:{padding:"0.25rem 0.5rem",background:l.type==="ERROR"?"#f44336":l.type==="WARNING"?"#FF9800":"#4CAF50",color:"white",borderRadius:"4px",fontSize:"0.75rem"},children:l.type})}),a.jsx("td",{style:{padding:"0.75rem"},children:l.user}),a.jsx("td",{style:{padding:"0.75rem"},children:l.action}),a.jsx("td",{style:{padding:"0.75rem",color:"#666"},children:l.details})]},c))})]})}),a.jsxs("div",{style:{textAlign:"center",marginTop:"2rem"},children:[a.jsx("button",{style:{padding:"0.75rem 2rem",background:"#9C27B0",color:"white",border:"none",borderRadius:"8px",fontSize:"1rem",cursor:"pointer",marginRight:"1rem"},children:" Export System Logs"}),a.jsx("button",{style:{padding:"0.75rem 2rem",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"1rem",cursor:"pointer",marginRight:"1rem"},children:" Run Diagnostics"}),a.jsx("button",{style:{padding:"0.75rem 2rem",background:"#FF9800",color:"white",border:"none",borderRadius:"8px",fontSize:"1rem",cursor:"pointer"},children:" System Settings"})]})]})}function QE(){return a.jsxs("div",{className:"demo-portal-wrapper",children:[a.jsx("div",{className:"demo-header",style:{padding:"1rem 2rem",background:"#9C27B0",color:"white"},children:a.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("div",{children:[a.jsx("h2",{style:{margin:0},children:"IT Support Technician Role Demo"}),a.jsx("p",{style:{margin:"0.25rem 0 0 0",opacity:.9},children:"Equipment management and system logs"})]}),a.jsx(rs,{to:"/admin/role-management",className:"btn btn-secondary",style:{background:"white",color:"#9C27B0",padding:"0.5rem 1rem",borderRadius:"4px",textDecoration:"none"},children:" Back to Role Management"})]})}),a.jsx(XE,{})]})}function eD(){const t=[{dept:"Communication Design",allocated:125e3,spent:98400,forecast:115e3,variance:1e4},{dept:"Product Design",allocated:95e3,spent:82300,forecast:91e3,variance:4e3},{dept:"Media",allocated:14e4,spent:132100,forecast:138500,variance:1500},{dept:"Painting",allocated:65e3,spent:48200,forecast:58e3,variance:7e3},{dept:"Sculpture",allocated:85e3,spent:71500,forecast:79e3,variance:6e3}],e=[{quarter:"Q1 2024",amount:98500},{quarter:"Q2 2024",amount:112300},{quarter:"Q3 2024",amount:125700},{quarter:"Q4 2024 (Forecast)",amount:95200}],n=t.reduce((i,o)=>i+o.allocated,0),r=t.reduce((i,o)=>i+o.spent,0),s=t.reduce((i,o)=>i+o.forecast,0);return a.jsxs("div",{className:"portal-container",style:{padding:"2rem",maxWidth:"1400px",margin:"0 auto"},children:[a.jsxs("div",{className:"portal-header",style:{marginBottom:"2rem"},children:[a.jsx("h1",{style:{color:"#9C27B0",marginBottom:"0.5rem"},children:" Budget Manager Portal"}),a.jsx("p",{style:{color:"#666",fontSize:"1.1rem"},children:"Department budgets, cost forecasting, and financial planning"})]}),a.jsxs("div",{className:"permissions-notice",style:{background:"#E1BEE7",padding:"1rem",borderRadius:"8px",marginBottom:"2rem",border:"2px solid #9C27B0"},children:[a.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"#6A1B9A"},children:"Your Permissions:"}),a.jsxs("ul",{style:{margin:0,paddingLeft:"1.5rem"},children:[a.jsx("li",{children:" View all department budgets and spending"}),a.jsx("li",{children:" Forecast future costs based on usage trends"}),a.jsx("li",{children:" Export budget reports (PDF/Excel)"}),a.jsx("li",{children:" Track variance and budget health"}),a.jsx("li",{children:" Cannot modify budget allocations (requires Finance Director approval)"})]})]}),a.jsx("h2",{style:{color:"#333",marginBottom:"1rem"},children:"Budget Summary"}),a.jsxs("div",{className:"stats-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem",marginBottom:"2rem"},children:[a.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"1.5rem",borderRadius:"8px",color:"white"},children:[a.jsx("h3",{style:{margin:"0 0 0.5rem 0",fontSize:"0.9rem",opacity:.9},children:"Total Allocated"}),a.jsxs("p",{style:{margin:0,fontSize:"2rem",fontWeight:"bold"},children:["",n.toLocaleString()]})]}),a.jsxs("div",{style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",padding:"1.5rem",borderRadius:"8px",color:"white"},children:[a.jsx("h3",{style:{margin:"0 0 0.5rem 0",fontSize:"0.9rem",opacity:.9},children:"YTD Spent"}),a.jsxs("p",{style:{margin:0,fontSize:"2rem",fontWeight:"bold"},children:["",r.toLocaleString()]}),a.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.9},children:[(r/n*100).toFixed(1),"% of budget"]})]}),a.jsxs("div",{style:{background:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",padding:"1.5rem",borderRadius:"8px",color:"white"},children:[a.jsx("h3",{style:{margin:"0 0 0.5rem 0",fontSize:"0.9rem",opacity:.9},children:"Forecasted Year-End"}),a.jsxs("p",{style:{margin:0,fontSize:"2rem",fontWeight:"bold"},children:["",s.toLocaleString()]}),a.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.9},children:["",(n-s).toLocaleString()," under budget"]})]})]}),a.jsx("h2",{style:{color:"#333",marginBottom:"1rem"},children:"Department Budget Breakdown"}),a.jsx("div",{style:{background:"white",border:"1px solid #ddd",borderRadius:"8px",overflow:"hidden",marginBottom:"2rem"},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#9C27B0",color:"white"},children:[a.jsx("th",{style:{padding:"1rem",textAlign:"left"},children:"Department"}),a.jsx("th",{style:{padding:"1rem",textAlign:"right"},children:"Allocated"}),a.jsx("th",{style:{padding:"1rem",textAlign:"right"},children:"YTD Spent"}),a.jsx("th",{style:{padding:"1rem",textAlign:"right"},children:"Forecast"}),a.jsx("th",{style:{padding:"1rem",textAlign:"right"},children:"Variance"}),a.jsx("th",{style:{padding:"1rem",textAlign:"center"},children:"Health"})]})}),a.jsx("tbody",{children:t.map((i,o)=>{const l=(i.spent/i.allocated*100).toFixed(1),c=i.variance>5e3?"Good":i.variance>0?"Fair":"At Risk",d=i.variance>5e3?"#4CAF50":i.variance>0?"#FF9800":"#f44336";return a.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[a.jsx("td",{style:{padding:"1rem",fontWeight:"bold"},children:i.dept}),a.jsxs("td",{style:{padding:"1rem",textAlign:"right"},children:["",i.allocated.toLocaleString()]}),a.jsxs("td",{style:{padding:"1rem",textAlign:"right"},children:["",i.spent.toLocaleString(),a.jsxs("span",{style:{fontSize:"0.85rem",color:"#666",marginLeft:"0.5rem"},children:["(",l,"%)"]})]}),a.jsxs("td",{style:{padding:"1rem",textAlign:"right"},children:["",i.forecast.toLocaleString()]}),a.jsxs("td",{style:{padding:"1rem",textAlign:"right",color:i.variance>0?"#4CAF50":"#f44336"},children:["",i.variance.toLocaleString()]}),a.jsx("td",{style:{padding:"1rem",textAlign:"center"},children:a.jsx("span",{style:{padding:"0.25rem 0.75rem",background:d,color:"white",borderRadius:"4px",fontSize:"0.85rem"},children:c})})]},o)})})]})}),a.jsx("h2",{style:{color:"#333",marginBottom:"1rem"},children:"Quarterly Spending Trend"}),a.jsx("div",{style:{background:"white",border:"1px solid #ddd",borderRadius:"8px",padding:"1.5rem",marginBottom:"2rem"},children:e.map((i,o)=>{const l=Math.max(...e.map(d=>d.amount)),c=i.amount/l*100;return a.jsxs("div",{style:{marginBottom:"1rem"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.25rem"},children:[a.jsx("span",{style:{fontWeight:"bold"},children:i.quarter}),a.jsxs("span",{style:{color:"#666"},children:["",i.amount.toLocaleString()]})]}),a.jsx("div",{style:{background:"#eee",height:"24px",borderRadius:"4px",overflow:"hidden"},children:a.jsx("div",{style:{width:`${c}%`,height:"100%",background:o===e.length-1?"linear-gradient(90deg, #9C27B0, #CE93D8)":"linear-gradient(90deg, #4CAF50, #81C784)",transition:"width 0.3s ease"}})})]},o)})}),a.jsxs("div",{style:{textAlign:"center",marginTop:"2rem"},children:[a.jsx("button",{style:{padding:"0.75rem 2rem",background:"#9C27B0",color:"white",border:"none",borderRadius:"8px",fontSize:"1rem",cursor:"pointer",marginRight:"1rem"},children:" Generate Budget Report (PDF)"}),a.jsx("button",{style:{padding:"0.75rem 2rem",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"1rem",cursor:"pointer",marginRight:"1rem"},children:" Export to Excel"}),a.jsx("button",{style:{padding:"0.75rem 2rem",background:"#FF9800",color:"white",border:"none",borderRadius:"8px",fontSize:"1rem",cursor:"pointer"},children:" Run Forecast Model"})]})]})}function tD(){return a.jsxs("div",{className:"demo-portal-wrapper",children:[a.jsx("div",{className:"demo-header",style:{padding:"1rem 2rem",background:"#9C27B0",color:"white"},children:a.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("div",{children:[a.jsx("h2",{style:{margin:0},children:"Budget Manager Role Demo"}),a.jsx("p",{style:{margin:"0.25rem 0 0 0",opacity:.9},children:"Budget tracking and cost forecasting"})]}),a.jsx(rs,{to:"/admin/role-management",className:"btn btn-secondary",style:{background:"white",color:"#9C27B0",padding:"0.5rem 1rem",borderRadius:"4px",textDecoration:"none"},children:" Back to Role Management"})]})}),a.jsx(eD,{})]})}function Vp({children:t,allowedRoles:e}){const{user:n}=cn();if(!n)return a.jsx($m,{to:"/"});if(!e.includes(n.role)){const r=()=>n.role==="master_admin"||n.role==="department_admin"?"/admin":n.role==="staff"?"/staff":"/student";return a.jsx($m,{to:r()})}return t}function nD(){const{user:t,loading:e}=cn();return e?a.jsxs("div",{className:"loading-container",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"Loading NCADbook..."})]}):a.jsxs(Yh,{children:[a.jsx(vt,{path:"/",element:t?a.jsx($m,{to:t.role==="master_admin"||t.role==="department_admin"?"/admin":t.role==="staff"?"/staff":"/student"}):a.jsx(HE,{})}),a.jsx(vt,{path:"/student/*",element:a.jsx(Vp,{allowedRoles:["student","staff","department_admin","master_admin"],children:a.jsx(SC,{})})}),a.jsx(vt,{path:"/staff/*",element:a.jsx(Vp,{allowedRoles:["staff","department_admin","master_admin"],children:a.jsx(OC,{})})}),a.jsx(vt,{path:"/admin/*",element:a.jsx(Vp,{allowedRoles:["department_admin","master_admin"],children:a.jsx(WE,{})})}),a.jsx(vt,{path:"/demo/view_only_staff",element:a.jsx(GE,{})}),a.jsx(vt,{path:"/demo/accounts_officer",element:a.jsx(ZE,{})}),a.jsx(vt,{path:"/demo/payroll_coordinator",element:a.jsx(JE,{})}),a.jsx(vt,{path:"/demo/it_support_technician",element:a.jsx(QE,{})}),a.jsx(vt,{path:"/demo/budget_manager",element:a.jsx(tD,{})})]})}function rD(){return a.jsx($3,{children:a.jsx(U3,{children:a.jsx(M3,{children:a.jsx(Yk,{children:a.jsx(nD,{})})})})})}Gp.createRoot(document.getElementById("root")).render(a.jsx(Cy.StrictMode,{children:a.jsx(rD,{})}));export{Lt as _,as as c,Nw as g};
//# sourceMappingURL=index-tm4UhZmS.js.map
